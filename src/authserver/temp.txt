Building the project before running tests...
Building Goiabada Auth Server...
Building Tailwind CSS...
â‰ˆ tailwindcss v4.1.17

Done in 38ms
Cleaning previous build...
Building Go binary...
Build completed successfully!
Running internal tests...
=== RUN   TestAuditLogger
=== RUN   TestAuditLogger/Basic_log_event
=== RUN   TestAuditLogger/Log_event_with_empty_details
=== RUN   TestAuditLogger/Log_event_with_nested_details
--- PASS: TestAuditLogger (0.00s)
    --- PASS: TestAuditLogger/Basic_log_event (0.00s)
    --- PASS: TestAuditLogger/Log_event_with_empty_details (0.00s)
    --- PASS: TestAuditLogger/Log_event_with_nested_details (0.00s)
=== RUN   TestAuditLoggerDisabled
--- PASS: TestAuditLoggerDisabled (0.00s)
PASS
ok  	github.com/leodip/goiabada/authserver/internal/audit	(cached)
?   	github.com/leodip/goiabada/authserver/internal/audit/mocks	[no test files]
?   	github.com/leodip/goiabada/authserver/internal/dtos	[no test files]
=== RUN   TestHandleAccountLogoutGet
=== RUN   TestHandleAccountLogoutGet/No_id_token_hint_given
=== RUN   TestHandleAccountLogoutGet/No_postLogoutRedirectURI_given
=== RUN   TestHandleAccountLogoutGet/Fails_to_decode_idTokenHint
=== RUN   TestHandleAccountLogoutGet/Fails_to_decrypt_idTokenHint
=== RUN   TestHandleAccountLogoutGet/Token_parser_fails_to_validate_id_token
=== RUN   TestHandleAccountLogoutGet/Issuer_does_not_match
=== RUN   TestHandleAccountLogoutGet/Aud_claim_does_not_match_any_client
=== RUN   TestHandleAccountLogoutGet/Post_logout_redirect_URI_not_authorized
=== RUN   TestHandleAccountLogoutGet/SessionIdentifier_exists_but_sid_claim_is_missing_from_ID_token
=== RUN   TestHandleAccountLogoutGet/Sid_claim_does_not_match
=== RUN   TestHandleAccountLogoutGet/Successful_logout_with_DeleteUserSession_call
--- PASS: TestHandleAccountLogoutGet (0.00s)
    --- PASS: TestHandleAccountLogoutGet/No_id_token_hint_given (0.00s)
    --- PASS: TestHandleAccountLogoutGet/No_postLogoutRedirectURI_given (0.00s)
    --- PASS: TestHandleAccountLogoutGet/Fails_to_decode_idTokenHint (0.00s)
    --- PASS: TestHandleAccountLogoutGet/Fails_to_decrypt_idTokenHint (0.00s)
    --- PASS: TestHandleAccountLogoutGet/Token_parser_fails_to_validate_id_token (0.00s)
    --- PASS: TestHandleAccountLogoutGet/Issuer_does_not_match (0.00s)
    --- PASS: TestHandleAccountLogoutGet/Aud_claim_does_not_match_any_client (0.00s)
    --- PASS: TestHandleAccountLogoutGet/Post_logout_redirect_URI_not_authorized (0.00s)
    --- PASS: TestHandleAccountLogoutGet/SessionIdentifier_exists_but_sid_claim_is_missing_from_ID_token (0.00s)
    --- PASS: TestHandleAccountLogoutGet/Sid_claim_does_not_match (0.00s)
    --- PASS: TestHandleAccountLogoutGet/Successful_logout_with_DeleteUserSession_call (0.00s)
=== RUN   TestPadClientSecret
=== RUN   TestPadClientSecret/Empty_string
=== RUN   TestPadClientSecret/String_shorter_than_32_characters
=== RUN   TestPadClientSecret/String_exactly_32_characters
=== RUN   TestPadClientSecret/String_longer_than_32_characters
--- PASS: TestPadClientSecret (0.00s)
    --- PASS: TestPadClientSecret/Empty_string (0.00s)
    --- PASS: TestPadClientSecret/String_shorter_than_32_characters (0.00s)
    --- PASS: TestPadClientSecret/String_exactly_32_characters (0.00s)
    --- PASS: TestPadClientSecret/String_longer_than_32_characters (0.00s)
=== RUN   TestDecryptIDTokenHint
=== RUN   TestDecryptIDTokenHint/Successful_decryption
=== RUN   TestDecryptIDTokenHint/Invalid_client
=== RUN   TestDecryptIDTokenHint/Invalid_base64_encoding
=== RUN   TestDecryptIDTokenHint/Decryption_failure
--- PASS: TestDecryptIDTokenHint (0.00s)
    --- PASS: TestDecryptIDTokenHint/Successful_decryption (0.00s)
    --- PASS: TestDecryptIDTokenHint/Invalid_client (0.00s)
    --- PASS: TestDecryptIDTokenHint/Invalid_base64_encoding (0.00s)
    --- PASS: TestDecryptIDTokenHint/Decryption_failure (0.00s)
=== RUN   TestValidateClientAndRedirectURI
=== RUN   TestValidateClientAndRedirectURI/Valid_client_and_redirect_URI
=== RUN   TestValidateClientAndRedirectURI/Missing_aud_claim
=== RUN   TestValidateClientAndRedirectURI/Invalid_client
=== RUN   TestValidateClientAndRedirectURI/Mismatched_client_id
=== RUN   TestValidateClientAndRedirectURI/Invalid_redirect_URI
--- PASS: TestValidateClientAndRedirectURI (0.00s)
    --- PASS: TestValidateClientAndRedirectURI/Valid_client_and_redirect_URI (0.00s)
    --- PASS: TestValidateClientAndRedirectURI/Missing_aud_claim (0.00s)
    --- PASS: TestValidateClientAndRedirectURI/Invalid_client (0.00s)
    --- PASS: TestValidateClientAndRedirectURI/Mismatched_client_id (0.00s)
    --- PASS: TestValidateClientAndRedirectURI/Invalid_redirect_URI (0.00s)
=== RUN   TestHandleExistingSessionOnLogout
=== RUN   TestHandleExistingSessionOnLogout/Invalid_session_identifier
=== RUN   TestHandleExistingSessionOnLogout/Session_not_found
=== RUN   TestHandleExistingSessionOnLogout/Delete_user_session_client
=== RUN   TestHandleExistingSessionOnLogout/Delete_entire_user_session
=== RUN   TestHandleExistingSessionOnLogout/Client_not_found_in_user_session
--- PASS: TestHandleExistingSessionOnLogout (0.00s)
    --- PASS: TestHandleExistingSessionOnLogout/Invalid_session_identifier (0.00s)
    --- PASS: TestHandleExistingSessionOnLogout/Session_not_found (0.00s)
    --- PASS: TestHandleExistingSessionOnLogout/Delete_user_session_client (0.00s)
    --- PASS: TestHandleExistingSessionOnLogout/Delete_entire_user_session (0.00s)
    --- PASS: TestHandleExistingSessionOnLogout/Client_not_found_in_user_session (0.00s)
=== RUN   TestHandleAccountLogoutPost
=== RUN   TestHandleAccountLogoutPost/Successful_logout
=== RUN   TestHandleAccountLogoutPost/Session_not_found
=== RUN   TestHandleAccountLogoutPost/Session_store_error
=== RUN   TestHandleAccountLogoutPost/Session_save_error
--- PASS: TestHandleAccountLogoutPost (0.00s)
    --- PASS: TestHandleAccountLogoutPost/Successful_logout (0.00s)
    --- PASS: TestHandleAccountLogoutPost/Session_not_found (0.00s)
    --- PASS: TestHandleAccountLogoutPost/Session_store_error (0.00s)
    --- PASS: TestHandleAccountLogoutPost/Session_save_error (0.00s)
=== RUN   TestHandleAuthCompletedGet
=== RUN   TestHandleAuthCompletedGet/Successful_flow,_existing_session,_consent_not_required
=== RUN   TestHandleAuthCompletedGet/Successful_flow,_new_session,_consent_not_required
=== RUN   TestHandleAuthCompletedGet/Error_in_GetAuthContext
=== RUN   TestHandleAuthCompletedGet/Invalid_AuthState
=== RUN   TestHandleAuthCompletedGet/Client_is_nil
=== RUN   TestHandleAuthCompletedGet/User_is_not_enabled
=== RUN   TestHandleAuthCompletedGet/authContext.Scope_is_filtered_and_becomes_empty
=== RUN   TestHandleAuthCompletedGet/Successful_flow,_new_session,_consent_required
=== RUN   TestHandleAuthCompletedGet/Successful_flow,_new_session,_offline_access_scope_requires_consent
--- PASS: TestHandleAuthCompletedGet (0.00s)
    --- PASS: TestHandleAuthCompletedGet/Successful_flow,_existing_session,_consent_not_required (0.00s)
    --- PASS: TestHandleAuthCompletedGet/Successful_flow,_new_session,_consent_not_required (0.00s)
    --- PASS: TestHandleAuthCompletedGet/Error_in_GetAuthContext (0.00s)
    --- PASS: TestHandleAuthCompletedGet/Invalid_AuthState (0.00s)
    --- PASS: TestHandleAuthCompletedGet/Client_is_nil (0.00s)
    --- PASS: TestHandleAuthCompletedGet/User_is_not_enabled (0.00s)
    --- PASS: TestHandleAuthCompletedGet/authContext.Scope_is_filtered_and_becomes_empty (0.00s)
    --- PASS: TestHandleAuthCompletedGet/Successful_flow,_new_session,_consent_required (0.00s)
    --- PASS: TestHandleAuthCompletedGet/Successful_flow,_new_session,_offline_access_scope_requires_consent (0.00s)
=== RUN   TestHandleIssueGet
=== RUN   TestHandleIssueGet/Error_when_getting_GetAuthContext
=== RUN   TestHandleIssueGet/Unexpected_AuthState
=== RUN   TestHandleIssueGet/Successfully_issues_a_code
--- PASS: TestHandleIssueGet (0.00s)
    --- PASS: TestHandleIssueGet/Error_when_getting_GetAuthContext (0.00s)
    --- PASS: TestHandleIssueGet/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleIssueGet/Successfully_issues_a_code (0.00s)
=== RUN   TestIssueAuthCode
=== RUN   TestIssueAuthCode/Query_response_mode
=== RUN   TestIssueAuthCode/Fragment_response_mode
=== RUN   TestIssueAuthCode/Form_post_response_mode
=== RUN   TestIssueAuthCode/Default_to_query_response_mode
=== RUN   TestIssueAuthCode/Error_parsing_template
--- PASS: TestIssueAuthCode (0.00s)
    --- PASS: TestIssueAuthCode/Query_response_mode (0.00s)
    --- PASS: TestIssueAuthCode/Fragment_response_mode (0.00s)
    --- PASS: TestIssueAuthCode/Form_post_response_mode (0.00s)
    --- PASS: TestIssueAuthCode/Default_to_query_response_mode (0.00s)
    --- PASS: TestIssueAuthCode/Error_parsing_template (0.00s)
=== RUN   TestHandleAuthLevel1Get
=== RUN   TestHandleAuthLevel1Get/Error_when_getting_GetAuthContext
=== RUN   TestHandleAuthLevel1Get/Unexpected_AuthState
=== RUN   TestHandleAuthLevel1Get/Successful_flow
--- PASS: TestHandleAuthLevel1Get (0.00s)
    --- PASS: TestHandleAuthLevel1Get/Error_when_getting_GetAuthContext (0.00s)
    --- PASS: TestHandleAuthLevel1Get/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleAuthLevel1Get/Successful_flow (0.00s)
=== RUN   TestHandleAuthLevel1CompletedGet
=== RUN   TestHandleAuthLevel1CompletedGet/Error_when_getting_GetAuthContext
=== RUN   TestHandleAuthLevel1CompletedGet/Unexpected_AuthState
=== RUN   TestHandleAuthLevel1CompletedGet/Successful_flow,_redirect_to_level2
=== RUN   TestHandleAuthLevel1CompletedGet/Successful_flow,_redirect_to_completed
=== RUN   TestHandleAuthLevel1CompletedGet/No_session,_auth_completed
=== RUN   TestHandleAuthLevel1CompletedGet/Level2_auth_config_has_changed
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel1_to_AcrLevel1
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel1_to_AcrLevel2Optional
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel1_to_AcrLevel2Mandatory
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Optional_to_AcrLevel1
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Optional_to_AcrLevel2Optional_(no_change)
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Optional_to_AcrLevel2Optional_(config_changed)
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Optional_to_AcrLevel2Mandatory
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Mandatory_to_AcrLevel1
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Mandatory_to_AcrLevel2Optional
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Mandatory_to_AcrLevel2Mandatory
=== RUN   TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Mandatory_to_AcrLevel2Mandatory_(config_changed)
--- PASS: TestHandleAuthLevel1CompletedGet (0.00s)
    --- PASS: TestHandleAuthLevel1CompletedGet/Error_when_getting_GetAuthContext (0.00s)
    --- PASS: TestHandleAuthLevel1CompletedGet/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleAuthLevel1CompletedGet/Successful_flow,_redirect_to_level2 (0.00s)
    --- PASS: TestHandleAuthLevel1CompletedGet/Successful_flow,_redirect_to_completed (0.00s)
    --- PASS: TestHandleAuthLevel1CompletedGet/No_session,_auth_completed (0.00s)
    --- PASS: TestHandleAuthLevel1CompletedGet/Level2_auth_config_has_changed (0.00s)
    --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel1_to_AcrLevel1 (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel1_to_AcrLevel2Optional (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel1_to_AcrLevel2Mandatory (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Optional_to_AcrLevel1 (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Optional_to_AcrLevel2Optional_(no_change) (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Optional_to_AcrLevel2Optional_(config_changed) (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Optional_to_AcrLevel2Mandatory (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Mandatory_to_AcrLevel1 (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Mandatory_to_AcrLevel2Optional (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Mandatory_to_AcrLevel2Mandatory (0.00s)
        --- PASS: TestHandleAuthLevel1CompletedGet/ACR_level_transitions/AcrLevel2Mandatory_to_AcrLevel2Mandatory_(config_changed) (0.00s)
=== RUN   TestHandleAuthLevel2Get
=== RUN   TestHandleAuthLevel2Get/Error_when_getting_GetAuthContext
=== RUN   TestHandleAuthLevel2Get/Unexpected_AuthState
=== RUN   TestHandleAuthLevel2Get/Client_not_found
=== RUN   TestHandleAuthLevel2Get/AcrLevel2Optional_with_OTP_enabled
=== RUN   TestHandleAuthLevel2Get/AcrLevel2Optional_with_OTP_disabled
=== RUN   TestHandleAuthLevel2Get/AcrLevel2Mandatory
=== RUN   TestHandleAuthLevel2Get/Invalid_AcrLevel
--- PASS: TestHandleAuthLevel2Get (0.00s)
    --- PASS: TestHandleAuthLevel2Get/Error_when_getting_GetAuthContext (0.00s)
    --- PASS: TestHandleAuthLevel2Get/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleAuthLevel2Get/Client_not_found (0.00s)
    --- PASS: TestHandleAuthLevel2Get/AcrLevel2Optional_with_OTP_enabled (0.00s)
    --- PASS: TestHandleAuthLevel2Get/AcrLevel2Optional_with_OTP_disabled (0.00s)
    --- PASS: TestHandleAuthLevel2Get/AcrLevel2Mandatory (0.00s)
    --- PASS: TestHandleAuthLevel2Get/Invalid_AcrLevel (0.00s)
=== RUN   TestHandleAuthOtpGet
=== RUN   TestHandleAuthOtpGet/Error_when_getting_GetAuthContext
=== RUN   TestHandleAuthOtpGet/Unexpected_AuthState
=== RUN   TestHandleAuthOtpGet/OTP_enabled_user
=== RUN   TestHandleAuthOtpGet/OTP_not_enabled_user
--- PASS: TestHandleAuthOtpGet (0.00s)
    --- PASS: TestHandleAuthOtpGet/Error_when_getting_GetAuthContext (0.00s)
    --- PASS: TestHandleAuthOtpGet/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleAuthOtpGet/OTP_enabled_user (0.00s)
    --- PASS: TestHandleAuthOtpGet/OTP_not_enabled_user (0.00s)
=== RUN   TestHandleAuthOtpPost
=== RUN   TestHandleAuthOtpPost/Error_when_getting_AuthContext
=== RUN   TestHandleAuthOtpPost/Unexpected_AuthState
=== RUN   TestHandleAuthOtpPost/User_not_found
=== RUN   TestHandleAuthOtpPost/User_disabled
=== RUN   TestHandleAuthOtpPost/Empty_OTP_code
=== RUN   TestHandleAuthOtpPost/Invalid_OTP_code_for_enabled_OTP
=== RUN   TestHandleAuthOtpPost/Invalid_OTP_code_for_disabled_OTP
=== RUN   TestHandleAuthOtpPost/Successful_OTP_validation_for_enabled_OTP
=== RUN   TestHandleAuthOtpPost/Successful_OTP_validation_for_disabled_OTP_(enrollment)
=== RUN   TestHandleAuthOtpPost/Error_updating_user_during_OTP_enrollment
=== RUN   TestHandleAuthOtpPost/User_account_is_disabled
--- PASS: TestHandleAuthOtpPost (0.00s)
    --- PASS: TestHandleAuthOtpPost/Error_when_getting_AuthContext (0.00s)
    --- PASS: TestHandleAuthOtpPost/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleAuthOtpPost/User_not_found (0.00s)
    --- PASS: TestHandleAuthOtpPost/User_disabled (0.00s)
    --- PASS: TestHandleAuthOtpPost/Empty_OTP_code (0.00s)
    --- PASS: TestHandleAuthOtpPost/Invalid_OTP_code_for_enabled_OTP (0.00s)
    --- PASS: TestHandleAuthOtpPost/Invalid_OTP_code_for_disabled_OTP (0.00s)
    --- PASS: TestHandleAuthOtpPost/Successful_OTP_validation_for_enabled_OTP (0.00s)
    --- PASS: TestHandleAuthOtpPost/Successful_OTP_validation_for_disabled_OTP_(enrollment) (0.00s)
    --- PASS: TestHandleAuthOtpPost/Error_updating_user_during_OTP_enrollment (0.00s)
    --- PASS: TestHandleAuthOtpPost/User_account_is_disabled (0.00s)
=== RUN   TestHandleAuthPwdGet
=== RUN   TestHandleAuthPwdGet/Error_when_getting_GetAuthContext
=== RUN   TestHandleAuthPwdGet/Unexpected_AuthState
=== RUN   TestHandleAuthPwdGet/Successful_rendering_with_email_from_user_session
=== RUN   TestHandleAuthPwdGet/Successful_rendering_without_email
--- PASS: TestHandleAuthPwdGet (0.00s)
    --- PASS: TestHandleAuthPwdGet/Error_when_getting_GetAuthContext (0.00s)
    --- PASS: TestHandleAuthPwdGet/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleAuthPwdGet/Successful_rendering_with_email_from_user_session (0.00s)
    --- PASS: TestHandleAuthPwdGet/Successful_rendering_without_email (0.00s)
=== RUN   TestHandleAuthPwdPost
=== RUN   TestHandleAuthPwdPost/Error_when_getting_AuthContext
=== RUN   TestHandleAuthPwdPost/Unexpected_AuthState
=== RUN   TestHandleAuthPwdPost/Missing_email
=== RUN   TestHandleAuthPwdPost/Missing_password
=== RUN   TestHandleAuthPwdPost/User_not_found
=== RUN   TestHandleAuthPwdPost/Successful_authentication
=== RUN   TestHandleAuthPwdPost/Disabled_user_account
--- PASS: TestHandleAuthPwdPost (0.14s)
    --- PASS: TestHandleAuthPwdPost/Error_when_getting_AuthContext (0.00s)
    --- PASS: TestHandleAuthPwdPost/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleAuthPwdPost/Missing_email (0.00s)
    --- PASS: TestHandleAuthPwdPost/Missing_password (0.00s)
    --- PASS: TestHandleAuthPwdPost/User_not_found (0.00s)
    --- PASS: TestHandleAuthPwdPost/Successful_authentication (0.07s)
    --- PASS: TestHandleAuthPwdPost/Disabled_user_account (0.07s)
=== RUN   TestHandleAuthorizeGet
=== RUN   TestHandleAuthorizeGet/Valid_request_with_existing_session
=== RUN   TestHandleAuthorizeGet/Valid_request_without_existing_session
=== RUN   TestHandleAuthorizeGet/Invalid_client_and_redirect_URI
=== RUN   TestHandleAuthorizeGet/Invalid_request
=== RUN   TestHandleAuthorizeGet/Invalid_scopes
=== RUN   TestHandleAuthorizeGet/Disabled_user_account
=== RUN   TestHandleAuthorizeGet/Missing_auth_context
=== RUN   TestHandleAuthorizeGet/Valid_request_with_AcrLevel2Optional
--- PASS: TestHandleAuthorizeGet (0.00s)
    --- PASS: TestHandleAuthorizeGet/Valid_request_with_existing_session (0.00s)
    --- PASS: TestHandleAuthorizeGet/Valid_request_without_existing_session (0.00s)
    --- PASS: TestHandleAuthorizeGet/Invalid_client_and_redirect_URI (0.00s)
    --- PASS: TestHandleAuthorizeGet/Invalid_request (0.00s)
    --- PASS: TestHandleAuthorizeGet/Invalid_scopes (0.00s)
    --- PASS: TestHandleAuthorizeGet/Disabled_user_account (0.00s)
    --- PASS: TestHandleAuthorizeGet/Missing_auth_context (0.00s)
    --- PASS: TestHandleAuthorizeGet/Valid_request_with_AcrLevel2Optional (0.00s)
=== RUN   TestRedirToClientWithError_QueryResponseMode
--- PASS: TestRedirToClientWithError_QueryResponseMode (0.00s)
=== RUN   TestRedirToClientWithError_FragmentResponseMode
--- PASS: TestRedirToClientWithError_FragmentResponseMode (0.00s)
=== RUN   TestRedirToClientWithError_FormPostResponseMode
--- PASS: TestRedirToClientWithError_FormPostResponseMode (0.00s)
=== RUN   TestRedirToClientWithError_DefaultToQueryResponseMode
--- PASS: TestRedirToClientWithError_DefaultToQueryResponseMode (0.00s)
=== RUN   TestHandleCertsGet
=== RUN   TestHandleCertsGet/Successfully_returns_JWKS
=== RUN   TestHandleCertsGet/Successfully_returns_JWKS_with_only_current_key
=== RUN   TestHandleCertsGet/Database_error
=== RUN   TestHandleCertsGet/Invalid_key_state
=== RUN   TestHandleCertsGet/Invalid_JSON_in_PublicKeyJWK
=== RUN   TestHandleCertsGet/No_keys_found
--- PASS: TestHandleCertsGet (0.00s)
    --- PASS: TestHandleCertsGet/Successfully_returns_JWKS (0.00s)
    --- PASS: TestHandleCertsGet/Successfully_returns_JWKS_with_only_current_key (0.00s)
    --- PASS: TestHandleCertsGet/Database_error (0.00s)
    --- PASS: TestHandleCertsGet/Invalid_key_state (0.00s)
    --- PASS: TestHandleCertsGet/Invalid_JSON_in_PublicKeyJWK (0.00s)
    --- PASS: TestHandleCertsGet/No_keys_found (0.00s)
=== RUN   TestBuildScopeInfoArray
=== RUN   TestBuildScopeInfoArray/Empty_scope
=== RUN   TestBuildScopeInfoArray/Single_ID_token_scope
=== RUN   TestBuildScopeInfoArray/Multiple_ID_token_scopes
=== RUN   TestBuildScopeInfoArray/Offline_access_scope
=== RUN   TestBuildScopeInfoArray/Custom_scope
=== RUN   TestBuildScopeInfoArray/With_existing_consent
=== RUN   TestBuildScopeInfoArray/Mixed_scopes_with_consent
--- PASS: TestBuildScopeInfoArray (0.00s)
    --- PASS: TestBuildScopeInfoArray/Empty_scope (0.00s)
    --- PASS: TestBuildScopeInfoArray/Single_ID_token_scope (0.00s)
    --- PASS: TestBuildScopeInfoArray/Multiple_ID_token_scopes (0.00s)
    --- PASS: TestBuildScopeInfoArray/Offline_access_scope (0.00s)
    --- PASS: TestBuildScopeInfoArray/Custom_scope (0.00s)
    --- PASS: TestBuildScopeInfoArray/With_existing_consent (0.00s)
    --- PASS: TestBuildScopeInfoArray/Mixed_scopes_with_consent (0.00s)
=== RUN   TestHandleConsentGet
=== RUN   TestHandleConsentGet/Error_when_getting_AuthContext
=== RUN   TestHandleConsentGet/Unexpected_AuthState
=== RUN   TestHandleConsentGet/User_not_found
=== RUN   TestHandleConsentGet/Client_not_found
=== RUN   TestHandleConsentGet/Successful_consent_page_rendering
=== RUN   TestHandleConsentGet/Fully_consented_scopes,_redirect_to_issue
=== RUN   TestHandleConsentGet/Partial_consent,_render_consent_page
--- PASS: TestHandleConsentGet (0.00s)
    --- PASS: TestHandleConsentGet/Error_when_getting_AuthContext (0.00s)
    --- PASS: TestHandleConsentGet/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleConsentGet/User_not_found (0.00s)
    --- PASS: TestHandleConsentGet/Client_not_found (0.00s)
    --- PASS: TestHandleConsentGet/Successful_consent_page_rendering (0.00s)
    --- PASS: TestHandleConsentGet/Fully_consented_scopes,_redirect_to_issue (0.00s)
    --- PASS: TestHandleConsentGet/Partial_consent,_render_consent_page (0.00s)
=== RUN   TestHandleConsentPost
=== RUN   TestHandleConsentPost/Error_when_getting_AuthContext
=== RUN   TestHandleConsentPost/Unexpected_AuthState
=== RUN   TestHandleConsentPost/User_cancels_consent
=== RUN   TestHandleConsentPost/User_provides_consent
=== RUN   TestHandleConsentPost/Partial_consent_given
=== RUN   TestHandleConsentPost/No_consent_given
--- PASS: TestHandleConsentPost (0.00s)
    --- PASS: TestHandleConsentPost/Error_when_getting_AuthContext (0.00s)
    --- PASS: TestHandleConsentPost/Unexpected_AuthState (0.00s)
    --- PASS: TestHandleConsentPost/User_cancels_consent (0.00s)
    --- PASS: TestHandleConsentPost/User_provides_consent (0.00s)
    --- PASS: TestHandleConsentPost/Partial_consent_given (0.00s)
    --- PASS: TestHandleConsentPost/No_consent_given (0.00s)
=== RUN   TestHandleForgotPasswordGet
=== RUN   TestHandleForgotPasswordGet/Successful_render
=== RUN   TestHandleForgotPasswordGet/RenderTemplate_error
=== RUN   TestHandleForgotPasswordGet/CSRF_field_is_included
--- PASS: TestHandleForgotPasswordGet (0.00s)
    --- PASS: TestHandleForgotPasswordGet/Successful_render (0.00s)
    --- PASS: TestHandleForgotPasswordGet/RenderTemplate_error (0.00s)
    --- PASS: TestHandleForgotPasswordGet/CSRF_field_is_included (0.00s)
=== RUN   TestHandleForgotPasswordPost
=== RUN   TestHandleForgotPasswordPost/Email_not_given
=== RUN   TestHandleForgotPasswordPost/User_not_found
=== RUN   TestHandleForgotPasswordPost/Success_path,_email_is_sent
--- PASS: TestHandleForgotPasswordPost (0.00s)
    --- PASS: TestHandleForgotPasswordPost/Email_not_given (0.00s)
    --- PASS: TestHandleForgotPasswordPost/User_not_found (0.00s)
    --- PASS: TestHandleForgotPasswordPost/Success_path,_email_is_sent (0.00s)
=== RUN   TestHandleHealthCheckGet
=== RUN   TestHandleHealthCheckGet/Successful_health_check
--- PASS: TestHandleHealthCheckGet (0.00s)
    --- PASS: TestHandleHealthCheckGet/Successful_health_check (0.00s)
=== RUN   TestHandleIndexGet
=== RUN   TestHandleIndexGet/Redirects_to_AdminConsoleBaseUrl
--- PASS: TestHandleIndexGet (0.00s)
    --- PASS: TestHandleIndexGet/Redirects_to_AdminConsoleBaseUrl (0.00s)
=== RUN   TestHandleNotFoundGet
=== RUN   TestHandleNotFoundGet/Successful_rendering
=== RUN   TestHandleNotFoundGet/Rendering_error
--- PASS: TestHandleNotFoundGet (0.00s)
    --- PASS: TestHandleNotFoundGet/Successful_rendering (0.00s)
    --- PASS: TestHandleNotFoundGet/Rendering_error (0.00s)
=== RUN   TestHandleResetPasswordGet
=== RUN   TestHandleResetPasswordGet/No_code_provided
=== RUN   TestHandleResetPasswordGet/No_email_provided
=== RUN   TestHandleResetPasswordGet/User_not_found
=== RUN   TestHandleResetPasswordGet/DecryptText_error
=== RUN   TestHandleResetPasswordGet/Forgot_password_code_doesn't_match
=== RUN   TestHandleResetPasswordGet/Forgot_password_code_is_expired
=== RUN   TestHandleResetPasswordGet/Happy_path_-_valid_code_and_not_expired
--- PASS: TestHandleResetPasswordGet (0.00s)
    --- PASS: TestHandleResetPasswordGet/No_code_provided (0.00s)
    --- PASS: TestHandleResetPasswordGet/No_email_provided (0.00s)
    --- PASS: TestHandleResetPasswordGet/User_not_found (0.00s)
    --- PASS: TestHandleResetPasswordGet/DecryptText_error (0.00s)
    --- PASS: TestHandleResetPasswordGet/Forgot_password_code_doesn't_match (0.00s)
    --- PASS: TestHandleResetPasswordGet/Forgot_password_code_is_expired (0.00s)
    --- PASS: TestHandleResetPasswordGet/Happy_path_-_valid_code_and_not_expired (0.00s)
=== RUN   TestHandleTokenPost
=== RUN   TestHandleTokenPost/ParseForm_gives_error
=== RUN   TestHandleTokenPost/ValidateTokenRequest_gives_error
=== RUN   TestHandleTokenPost/Authorization_code_GenerateTokenResponseForAuthCode_gives_error
=== RUN   TestHandleTokenPost/Authorization_code_UpdateCode_gives_error
=== RUN   TestHandleTokenPost/Authorization_code_successful_flow
=== RUN   TestHandleTokenPost/Client_credentials_successful_flow
=== RUN   TestHandleTokenPost/Refresh_token_and_token_is_revoked
=== RUN   TestHandleTokenPost/Refresh_token_UpdateRefreshToken_gives_error
=== RUN   TestHandleTokenPost/Refresh_token_GenerateTokenResponseForRefresh_gives_error
=== RUN   TestHandleTokenPost/Refresh_token_with_SessionIdentifier_bumps_user_session
=== RUN   TestHandleTokenPost/Refresh_token_success_path_without_session
=== RUN   TestHandleTokenPost/Unsupported_grant_type
--- PASS: TestHandleTokenPost (0.00s)
    --- PASS: TestHandleTokenPost/ParseForm_gives_error (0.00s)
    --- PASS: TestHandleTokenPost/ValidateTokenRequest_gives_error (0.00s)
    --- PASS: TestHandleTokenPost/Authorization_code_GenerateTokenResponseForAuthCode_gives_error (0.00s)
    --- PASS: TestHandleTokenPost/Authorization_code_UpdateCode_gives_error (0.00s)
    --- PASS: TestHandleTokenPost/Authorization_code_successful_flow (0.00s)
    --- PASS: TestHandleTokenPost/Client_credentials_successful_flow (0.00s)
    --- PASS: TestHandleTokenPost/Refresh_token_and_token_is_revoked (0.00s)
    --- PASS: TestHandleTokenPost/Refresh_token_UpdateRefreshToken_gives_error (0.00s)
    --- PASS: TestHandleTokenPost/Refresh_token_GenerateTokenResponseForRefresh_gives_error (0.00s)
    --- PASS: TestHandleTokenPost/Refresh_token_with_SessionIdentifier_bumps_user_session (0.00s)
    --- PASS: TestHandleTokenPost/Refresh_token_success_path_without_session (0.00s)
    --- PASS: TestHandleTokenPost/Unsupported_grant_type (0.00s)
=== RUN   TestParseBasicAuth
=== RUN   TestParseBasicAuth/Empty_header_returns_false
=== RUN   TestParseBasicAuth/Non-Basic_scheme_returns_false
=== RUN   TestParseBasicAuth/Invalid_base64_returns_false
=== RUN   TestParseBasicAuth/Missing_colon_separator_returns_false
=== RUN   TestParseBasicAuth/Valid_credentials_are_parsed_correctly
=== RUN   TestParseBasicAuth/Password_with_colons_is_parsed_correctly
=== RUN   TestParseBasicAuth/Empty_password_is_valid
=== RUN   TestParseBasicAuth/Empty_client_id_with_password_is_valid
=== RUN   TestParseBasicAuth/Special_characters_in_credentials
=== RUN   TestParseBasicAuth/Unicode_characters_in_credentials
=== RUN   TestParseBasicAuth/Lowercase_basic_prefix_is_rejected
=== RUN   TestParseBasicAuth/Extra_whitespace_after_Basic_is_handled
=== RUN   TestParseBasicAuth/Missing_space_after_Basic_is_rejected
=== RUN   TestParseBasicAuth/Very_long_credentials
--- PASS: TestParseBasicAuth (0.00s)
    --- PASS: TestParseBasicAuth/Empty_header_returns_false (0.00s)
    --- PASS: TestParseBasicAuth/Non-Basic_scheme_returns_false (0.00s)
    --- PASS: TestParseBasicAuth/Invalid_base64_returns_false (0.00s)
    --- PASS: TestParseBasicAuth/Missing_colon_separator_returns_false (0.00s)
    --- PASS: TestParseBasicAuth/Valid_credentials_are_parsed_correctly (0.00s)
    --- PASS: TestParseBasicAuth/Password_with_colons_is_parsed_correctly (0.00s)
    --- PASS: TestParseBasicAuth/Empty_password_is_valid (0.00s)
    --- PASS: TestParseBasicAuth/Empty_client_id_with_password_is_valid (0.00s)
    --- PASS: TestParseBasicAuth/Special_characters_in_credentials (0.00s)
    --- PASS: TestParseBasicAuth/Unicode_characters_in_credentials (0.00s)
    --- PASS: TestParseBasicAuth/Lowercase_basic_prefix_is_rejected (0.00s)
    --- PASS: TestParseBasicAuth/Extra_whitespace_after_Basic_is_handled (0.00s)
    --- PASS: TestParseBasicAuth/Missing_space_after_Basic_is_rejected (0.00s)
    --- PASS: TestParseBasicAuth/Very_long_credentials (0.00s)
=== RUN   TestExtractClientCredentials
=== RUN   TestExtractClientCredentials/Basic_auth_only_-_credentials_extracted_from_header
=== RUN   TestExtractClientCredentials/POST_body_only_-_credentials_extracted_from_form
=== RUN   TestExtractClientCredentials/Both_methods_provided_-_returns_error
=== RUN   TestExtractClientCredentials/No_credentials_provided_-_returns_empty_values
=== RUN   TestExtractClientCredentials/Basic_auth_with_client_id_in_POST_but_no_client_secret_-_allowed
=== RUN   TestExtractClientCredentials/Invalid_Basic_auth_header_falls_back_to_POST_body
=== RUN   TestExtractClientCredentials/Bearer_token_header_does_not_interfere_with_POST_body
=== RUN   TestExtractClientCredentials/Empty_client_secret_in_POST_body_is_not_considered_authentication
=== RUN   TestExtractClientCredentials/Public_client_-_only_client_id_in_POST,_no_secret
--- PASS: TestExtractClientCredentials (0.00s)
    --- PASS: TestExtractClientCredentials/Basic_auth_only_-_credentials_extracted_from_header (0.00s)
    --- PASS: TestExtractClientCredentials/POST_body_only_-_credentials_extracted_from_form (0.00s)
    --- PASS: TestExtractClientCredentials/Both_methods_provided_-_returns_error (0.00s)
    --- PASS: TestExtractClientCredentials/No_credentials_provided_-_returns_empty_values (0.00s)
    --- PASS: TestExtractClientCredentials/Basic_auth_with_client_id_in_POST_but_no_client_secret_-_allowed (0.00s)
    --- PASS: TestExtractClientCredentials/Invalid_Basic_auth_header_falls_back_to_POST_body (0.00s)
    --- PASS: TestExtractClientCredentials/Bearer_token_header_does_not_interfere_with_POST_body (0.00s)
    --- PASS: TestExtractClientCredentials/Empty_client_secret_in_POST_body_is_not_considered_authentication (0.00s)
    --- PASS: TestExtractClientCredentials/Public_client_-_only_client_id_in_POST,_no_secret (0.00s)
=== RUN   TestHandleUnauthorizedGet
=== RUN   TestHandleUnauthorizedGet/Successful_render
=== RUN   TestHandleUnauthorizedGet/Render_error
--- PASS: TestHandleUnauthorizedGet (0.00s)
    --- PASS: TestHandleUnauthorizedGet/Successful_render (0.00s)
    --- PASS: TestHandleUnauthorizedGet/Render_error (0.00s)
=== RUN   TestHandleUserInfoGetPost
=== RUN   TestHandleUserInfoGetPost/No_validated_token_in_the_context
=== RUN   TestHandleUserInfoGetPost/Could_not_type_assert_ContextKeyValidatedToken_to_oauth.JwtToken
=== RUN   TestHandleUserInfoGetPost/JwtToken_without_sub_claim
=== RUN   TestHandleUserInfoGetPost/GetUserBySubject_returns_nil
=== RUN   TestHandleUserInfoGetPost/User_is_not_enabled
=== RUN   TestHandleUserInfoGetPost/Success_path_with_all_claims
--- PASS: TestHandleUserInfoGetPost (0.00s)
    --- PASS: TestHandleUserInfoGetPost/No_validated_token_in_the_context (0.00s)
    --- PASS: TestHandleUserInfoGetPost/Could_not_type_assert_ContextKeyValidatedToken_to_oauth.JwtToken (0.00s)
    --- PASS: TestHandleUserInfoGetPost/JwtToken_without_sub_claim (0.00s)
    --- PASS: TestHandleUserInfoGetPost/GetUserBySubject_returns_nil (0.00s)
    --- PASS: TestHandleUserInfoGetPost/User_is_not_enabled (0.00s)
    --- PASS: TestHandleUserInfoGetPost/Success_path_with_all_claims (0.00s)
=== RUN   TestHandleWellKnownOIDCConfigGet
=== RUN   TestHandleWellKnownOIDCConfigGet/Returns_correct_OIDC_configuration
--- PASS: TestHandleWellKnownOIDCConfigGet (0.00s)
    --- PASS: TestHandleWellKnownOIDCConfigGet/Returns_correct_OIDC_configuration (0.00s)
PASS
ok  	github.com/leodip/goiabada/authserver/internal/handlers	(cached)
=== RUN   TestHandleAccountActivateGet
=== RUN   TestHandleAccountActivateGet/Missing_email
=== RUN   TestHandleAccountActivateGet/Missing_code
=== RUN   TestHandleAccountActivateGet/Pre-registration_not_found
=== RUN   TestHandleAccountActivateGet/Verification_code_mismatch
=== RUN   TestHandleAccountActivateGet/Verification_code_expired
=== RUN   TestHandleAccountActivateGet/Successful_activation
--- PASS: TestHandleAccountActivateGet (0.00s)
    --- PASS: TestHandleAccountActivateGet/Missing_email (0.00s)
    --- PASS: TestHandleAccountActivateGet/Missing_code (0.00s)
    --- PASS: TestHandleAccountActivateGet/Pre-registration_not_found (0.00s)
    --- PASS: TestHandleAccountActivateGet/Verification_code_mismatch (0.00s)
    --- PASS: TestHandleAccountActivateGet/Verification_code_expired (0.00s)
    --- PASS: TestHandleAccountActivateGet/Successful_activation (0.00s)
=== RUN   TestHandleAccountRegisterGet
=== RUN   TestHandleAccountRegisterGet/Self_registration_enabled
=== RUN   TestHandleAccountRegisterGet/Self_registration_disabled
--- PASS: TestHandleAccountRegisterGet (0.00s)
    --- PASS: TestHandleAccountRegisterGet/Self_registration_enabled (0.00s)
    --- PASS: TestHandleAccountRegisterGet/Self_registration_disabled (0.00s)
=== RUN   TestHandleAccountRegisterPost
=== RUN   TestHandleAccountRegisterPost/No_email_and_email_is_required
=== RUN   TestHandleAccountRegisterPost/Invalid_email_given
=== RUN   TestHandleAccountRegisterPost/Email_is_already_registered
=== RUN   TestHandleAccountRegisterPost/Pre_registration_already_exists
=== RUN   TestHandleAccountRegisterPost/Password_not_given
=== RUN   TestHandleAccountRegisterPost/Password_confirmation_is_required
=== RUN   TestHandleAccountRegisterPost/Password_confirmation_does_not_match
=== RUN   TestHandleAccountRegisterPost/ValidatePassword_fails
=== RUN   TestHandleAccountRegisterPost/Self_registration_is_disabled
=== RUN   TestHandleAccountRegisterPost/SMTP_enabled_and_requires_email_verification
=== RUN   TestHandleAccountRegisterPost/Direct_registration_without_email_verification
--- PASS: TestHandleAccountRegisterPost (0.07s)
    --- PASS: TestHandleAccountRegisterPost/No_email_and_email_is_required (0.00s)
    --- PASS: TestHandleAccountRegisterPost/Invalid_email_given (0.00s)
    --- PASS: TestHandleAccountRegisterPost/Email_is_already_registered (0.00s)
    --- PASS: TestHandleAccountRegisterPost/Pre_registration_already_exists (0.00s)
    --- PASS: TestHandleAccountRegisterPost/Password_not_given (0.00s)
    --- PASS: TestHandleAccountRegisterPost/Password_confirmation_is_required (0.00s)
    --- PASS: TestHandleAccountRegisterPost/Password_confirmation_does_not_match (0.00s)
    --- PASS: TestHandleAccountRegisterPost/ValidatePassword_fails (0.00s)
    --- PASS: TestHandleAccountRegisterPost/Self_registration_is_disabled (0.00s)
    --- PASS: TestHandleAccountRegisterPost/SMTP_enabled_and_requires_email_verification (0.04s)
    --- PASS: TestHandleAccountRegisterPost/Direct_registration_without_email_verification (0.04s)
PASS
ok  	github.com/leodip/goiabada/authserver/internal/handlers/accounthandlers	(cached)
?   	github.com/leodip/goiabada/authserver/internal/handlers/apihandlers	[no test files]
=== RUN   TestMiddlewareSessionIdentifier
=== RUN   TestMiddlewareSessionIdentifier/Session_store_error
2025/11/25 10:35:23 ERROR unable to get the session store: session store error request-id=""
=== RUN   TestMiddlewareSessionIdentifier/No_session_identifier
=== RUN   TestMiddlewareSessionIdentifier/Valid_session_identifier
=== RUN   TestMiddlewareSessionIdentifier/Invalid_session_identifier
2025/11/25 10:35:23 WARN session not found in the database, clearing the session state request-id=""
=== RUN   TestMiddlewareSessionIdentifier/Database_error
2025/11/25 10:35:23 ERROR unable to get the user session: database error request-id=""
--- PASS: TestMiddlewareSessionIdentifier (0.00s)
    --- PASS: TestMiddlewareSessionIdentifier/Session_store_error (0.00s)
    --- PASS: TestMiddlewareSessionIdentifier/No_session_identifier (0.00s)
    --- PASS: TestMiddlewareSessionIdentifier/Valid_session_identifier (0.00s)
    --- PASS: TestMiddlewareSessionIdentifier/Invalid_session_identifier (0.00s)
    --- PASS: TestMiddlewareSessionIdentifier/Database_error (0.00s)
PASS
ok  	github.com/leodip/goiabada/authserver/internal/middleware	(cached)
?   	github.com/leodip/goiabada/authserver/internal/server	[no test files]
?   	github.com/leodip/goiabada/authserver/internal/workers	[no test files]
Running tests for core module...
?   	github.com/leodip/goiabada/core/api	[no test files]
?   	github.com/leodip/goiabada/core/audit/mocks	[no test files]
=== RUN   TestSendEmail
--- PASS: TestSendEmail (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/communication	(cached)
?   	github.com/leodip/goiabada/core/communication/mocks	[no test files]
?   	github.com/leodip/goiabada/core/config	[no test files]
?   	github.com/leodip/goiabada/core/constants	[no test files]
=== RUN   TestNewErrorDetail
--- PASS: TestNewErrorDetail (0.00s)
=== RUN   TestNewErrorDetailWithHttpStatusCode
--- PASS: TestNewErrorDetailWithHttpStatusCode (0.00s)
=== RUN   TestErrorDetail_Error
--- PASS: TestErrorDetail_Error (0.00s)
=== RUN   TestErrorDetail_Error_OnlyDetailIsAvailable
--- PASS: TestErrorDetail_Error_OnlyDetailIsAvailable (0.00s)
=== RUN   TestErrorDetail_GetHttpStatusCode_Invalid
--- PASS: TestErrorDetail_GetHttpStatusCode_Invalid (0.00s)
=== RUN   TestErrorDetail_GetHttpStatusCode_Missing
--- PASS: TestErrorDetail_GetHttpStatusCode_Missing (0.00s)
=== RUN   TestNewErrorDetail_LargeValues
--- PASS: TestNewErrorDetail_LargeValues (0.00s)
=== RUN   TestNewErrorDetailWithHttpStatusCode_EdgeCases
=== RUN   TestNewErrorDetailWithHttpStatusCode_EdgeCases/Minimum_valid_HTTP_status_code
=== RUN   TestNewErrorDetailWithHttpStatusCode_EdgeCases/Maximum_valid_HTTP_status_code
=== RUN   TestNewErrorDetailWithHttpStatusCode_EdgeCases/Below_minimum_HTTP_status_code
=== RUN   TestNewErrorDetailWithHttpStatusCode_EdgeCases/Above_maximum_HTTP_status_code
=== RUN   TestNewErrorDetailWithHttpStatusCode_EdgeCases/Negative_HTTP_status_code
=== RUN   TestNewErrorDetailWithHttpStatusCode_EdgeCases/Zero_HTTP_status_code
--- PASS: TestNewErrorDetailWithHttpStatusCode_EdgeCases (0.00s)
    --- PASS: TestNewErrorDetailWithHttpStatusCode_EdgeCases/Minimum_valid_HTTP_status_code (0.00s)
    --- PASS: TestNewErrorDetailWithHttpStatusCode_EdgeCases/Maximum_valid_HTTP_status_code (0.00s)
    --- PASS: TestNewErrorDetailWithHttpStatusCode_EdgeCases/Below_minimum_HTTP_status_code (0.00s)
    --- PASS: TestNewErrorDetailWithHttpStatusCode_EdgeCases/Above_maximum_HTTP_status_code (0.00s)
    --- PASS: TestNewErrorDetailWithHttpStatusCode_EdgeCases/Negative_HTTP_status_code (0.00s)
    --- PASS: TestNewErrorDetailWithHttpStatusCode_EdgeCases/Zero_HTTP_status_code (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/customerrors	(cached)
?   	github.com/leodip/goiabada/core/data	[no test files]
?   	github.com/leodip/goiabada/core/data/commondb	[no test files]
?   	github.com/leodip/goiabada/core/data/mocks	[no test files]
?   	github.com/leodip/goiabada/core/data/mssqldb	[no test files]
?   	github.com/leodip/goiabada/core/data/mysqldb	[no test files]
?   	github.com/leodip/goiabada/core/data/postgresdb	[no test files]
?   	github.com/leodip/goiabada/core/data/sqlitedb	[no test files]
=== RUN   TestEncryptDecrypt
=== RUN   TestEncryptDecrypt/Empty
=== RUN   TestEncryptDecrypt/Short
=== RUN   TestEncryptDecrypt/Long
--- PASS: TestEncryptDecrypt (0.00s)
    --- PASS: TestEncryptDecrypt/Empty (0.00s)
    --- PASS: TestEncryptDecrypt/Short (0.00s)
    --- PASS: TestEncryptDecrypt/Long (0.00s)
=== RUN   TestInvalidKey
--- PASS: TestInvalidKey (0.00s)
=== RUN   TestDecryptInvalidText
--- PASS: TestDecryptInvalidText (0.00s)
=== RUN   TestEncryptDifferentResults
--- PASS: TestEncryptDifferentResults (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/encryption	(cached)
?   	github.com/leodip/goiabada/core/enums	[no test files]
=== RUN   TestGetAuthContext
=== RUN   TestGetAuthContext/Success
=== RUN   TestGetAuthContext/SessionError
=== RUN   TestGetAuthContext/NoAuthContext
=== RUN   TestGetAuthContext/UnmarshalError
--- PASS: TestGetAuthContext (0.00s)
    --- PASS: TestGetAuthContext/Success (0.00s)
    --- PASS: TestGetAuthContext/SessionError (0.00s)
    --- PASS: TestGetAuthContext/NoAuthContext (0.00s)
    --- PASS: TestGetAuthContext/UnmarshalError (0.00s)
=== RUN   TestGetLoggedInSubject
=== RUN   TestGetLoggedInSubject/Success
=== RUN   TestGetLoggedInSubject/NoJwtInfo
=== RUN   TestGetLoggedInSubject/InvalidJwtInfo
=== RUN   TestGetLoggedInSubject/NoIdToken
--- PASS: TestGetLoggedInSubject (0.00s)
    --- PASS: TestGetLoggedInSubject/Success (0.00s)
    --- PASS: TestGetLoggedInSubject/NoJwtInfo (0.00s)
    --- PASS: TestGetLoggedInSubject/InvalidJwtInfo (0.00s)
    --- PASS: TestGetLoggedInSubject/NoIdToken (0.00s)
=== RUN   TestSaveAuthContext
=== RUN   TestSaveAuthContext/Success
=== RUN   TestSaveAuthContext/SessionError
=== RUN   TestSaveAuthContext/SaveError
--- PASS: TestSaveAuthContext (0.00s)
    --- PASS: TestSaveAuthContext/Success (0.00s)
    --- PASS: TestSaveAuthContext/SessionError (0.00s)
    --- PASS: TestSaveAuthContext/SaveError (0.00s)
=== RUN   TestClearAuthContext
=== RUN   TestClearAuthContext/Success
=== RUN   TestClearAuthContext/SessionError
=== RUN   TestClearAuthContext/SaveError
--- PASS: TestClearAuthContext (0.00s)
    --- PASS: TestClearAuthContext/Success (0.00s)
    --- PASS: TestClearAuthContext/SessionError (0.00s)
    --- PASS: TestClearAuthContext/SaveError (0.00s)
=== RUN   TestInternalServerError
2025/11/25 13:03:59 ERROR test error
github.com/leodip/goiabada/core/handlerhelpers.TestInternalServerError.func2
	/workspaces/goiabada/src/core/handlerhelpers/http_helper_test.go:42
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/core/handlerhelpers.TestInternalServerError.func1.1
	/workspaces/goiabada/src/core/handlerhelpers/http_helper_test.go:38
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
github.com/leodip/goiabada/core/handlerhelpers.TestInternalServerError
	/workspaces/goiabada/src/core/handlerhelpers/http_helper_test.go:47
testing.tRunner
	/usr/local/go/src/testing/testing.go:1934
runtime.goexit
	/usr/local/go/src/runtime/asm_amd64.s:1693
request-id: a357f2e3b56e/3ck6dlb7VO-000001
--- PASS: TestInternalServerError (0.00s)
=== RUN   TestRenderTemplate
=== RUN   TestRenderTemplate/Without__httpStatus
=== RUN   TestRenderTemplate/With__httpStatus
--- PASS: TestRenderTemplate (0.00s)
    --- PASS: TestRenderTemplate/Without__httpStatus (0.00s)
    --- PASS: TestRenderTemplate/With__httpStatus (0.00s)
=== RUN   TestRenderTemplateToBuffer
=== RUN   TestRenderTemplateToBuffer/Without_ID_Token
=== RUN   TestRenderTemplateToBuffer/With_ID_Token
--- PASS: TestRenderTemplateToBuffer (0.00s)
    --- PASS: TestRenderTemplateToBuffer/Without_ID_Token (0.00s)
    --- PASS: TestRenderTemplateToBuffer/With_ID_Token (0.00s)
=== RUN   TestJsonError
--- PASS: TestJsonError (0.00s)
=== RUN   TestEncodeJson
--- PASS: TestEncodeJson (0.00s)
=== RUN   TestGetFromUrlQueryOrFormPost
=== RUN   TestGetFromUrlQueryOrFormPost/Get_from_URL_query
=== RUN   TestGetFromUrlQueryOrFormPost/Get_from_form_post
--- PASS: TestGetFromUrlQueryOrFormPost (0.00s)
    --- PASS: TestGetFromUrlQueryOrFormPost/Get_from_URL_query (0.00s)
    --- PASS: TestGetFromUrlQueryOrFormPost/Get_from_form_post (0.00s)
=== RUN   TestArgsFuncMap
=== RUN   TestArgsFuncMap/Empty_input
=== RUN   TestArgsFuncMap/Single_argument
=== RUN   TestArgsFuncMap/Multiple_arguments
--- PASS: TestArgsFuncMap (0.00s)
    --- PASS: TestArgsFuncMap/Empty_input (0.00s)
    --- PASS: TestArgsFuncMap/Single_argument (0.00s)
    --- PASS: TestArgsFuncMap/Multiple_arguments (0.00s)
=== RUN   TestVersionCommentFuncMap
--- PASS: TestVersionCommentFuncMap (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/handlerhelpers	(cached)
?   	github.com/leodip/goiabada/core/handlerhelpers/mocks	[no test files]
=== RUN   TestHashString
=== RUN   TestHashString/Empty_string
=== RUN   TestHashString/Normal_string
=== RUN   TestHashString/Long_string
--- PASS: TestHashString (0.00s)
    --- PASS: TestHashString/Empty_string (0.00s)
    --- PASS: TestHashString/Normal_string (0.00s)
    --- PASS: TestHashString/Long_string (0.00s)
=== RUN   TestVerifyStringHash
=== RUN   TestVerifyStringHash/Correct_hash
=== RUN   TestVerifyStringHash/Incorrect_hash
=== RUN   TestVerifyStringHash/Empty_string
--- PASS: TestVerifyStringHash (0.00s)
    --- PASS: TestVerifyStringHash/Correct_hash (0.00s)
    --- PASS: TestVerifyStringHash/Incorrect_hash (0.00s)
    --- PASS: TestVerifyStringHash/Empty_string (0.00s)
=== RUN   TestHashPassword
=== RUN   TestHashPassword/Normal_password
=== RUN   TestHashPassword/Empty_password
=== RUN   TestHashPassword/Max_length_password
=== RUN   TestHashPassword/Exceeds_max_length
--- PASS: TestHashPassword (0.11s)
    --- PASS: TestHashPassword/Normal_password (0.04s)
    --- PASS: TestHashPassword/Empty_password (0.04s)
    --- PASS: TestHashPassword/Max_length_password (0.04s)
    --- PASS: TestHashPassword/Exceeds_max_length (0.00s)
=== RUN   TestVerifyPasswordHash
=== RUN   TestVerifyPasswordHash/Correct_password
=== RUN   TestVerifyPasswordHash/Incorrect_password
=== RUN   TestVerifyPasswordHash/Empty_password
--- PASS: TestVerifyPasswordHash (0.15s)
    --- PASS: TestVerifyPasswordHash/Correct_password (0.04s)
    --- PASS: TestVerifyPasswordHash/Incorrect_password (0.04s)
    --- PASS: TestVerifyPasswordHash/Empty_password (0.04s)
PASS
ok  	github.com/leodip/goiabada/core/hashutil	(cached)
=== RUN   TestInputSanitizer_Sanitize
=== RUN   TestInputSanitizer_Sanitize/Querystring_with_script
=== RUN   TestInputSanitizer_Sanitize/URL_with_script
=== RUN   TestInputSanitizer_Sanitize/Normal_paragraph
=== RUN   TestInputSanitizer_Sanitize/Bold_text
=== RUN   TestInputSanitizer_Sanitize/Italic_text
=== RUN   TestInputSanitizer_Sanitize/Underline_text
=== RUN   TestInputSanitizer_Sanitize/Strong_text
=== RUN   TestInputSanitizer_Sanitize/Emphasis_text
=== RUN   TestInputSanitizer_Sanitize/Normal_link
=== RUN   TestInputSanitizer_Sanitize/Image_with_alt_text
=== RUN   TestInputSanitizer_Sanitize/Nested_tags
=== RUN   TestInputSanitizer_Sanitize/Line_break
=== RUN   TestInputSanitizer_Sanitize/Line_break2
=== RUN   TestInputSanitizer_Sanitize/Normal_links_should_be_accepted
=== RUN   TestInputSanitizer_Sanitize/Unordered_list
=== RUN   TestInputSanitizer_Sanitize/Basic_XSS_Test
=== RUN   TestInputSanitizer_Sanitize/XSS_Locator_(Polyglot)
=== RUN   TestInputSanitizer_Sanitize/Malformed_A_Tags
=== RUN   TestInputSanitizer_Sanitize/Malformed_IMG_Tags
=== RUN   TestInputSanitizer_Sanitize/fromCharCode
=== RUN   TestInputSanitizer_Sanitize/Default_SRC_Tag
=== RUN   TestInputSanitizer_Sanitize/On_Error_Alert
=== RUN   TestInputSanitizer_Sanitize/IMG_onerror_and_JavaScript_Alert_Encode
=== RUN   TestInputSanitizer_Sanitize/Decimal_HTML_Character_References
=== RUN   TestInputSanitizer_Sanitize/Embedded_Tab
=== RUN   TestInputSanitizer_Sanitize/Embedded_Encoded_Tab
=== RUN   TestInputSanitizer_Sanitize/Embedded_Newline
=== RUN   TestInputSanitizer_Sanitize/Embedded_Carriage_Return
=== RUN   TestInputSanitizer_Sanitize/Null_Chars
=== RUN   TestInputSanitizer_Sanitize/Spaces_and_Meta_Chars
=== RUN   TestInputSanitizer_Sanitize/Half_Open_HTML/JavaScript_XSS_Vector
=== RUN   TestInputSanitizer_Sanitize/Double_Open_Angle_Bracket
=== RUN   TestInputSanitizer_Sanitize/Extraneous_Open_Brackets
=== RUN   TestInputSanitizer_Sanitize/No_Closing_Script_Tags
=== RUN   TestInputSanitizer_Sanitize/Protocol_Resolution_in_Script_Tags
=== RUN   TestInputSanitizer_Sanitize/ECMAScript_6
=== RUN   TestInputSanitizer_Sanitize/BODY_Tag
=== RUN   TestInputSanitizer_Sanitize/SVG_Object_Tag
=== RUN   TestInputSanitizer_Sanitize/Base64_Encoded
=== RUN   TestInputSanitizer_Sanitize/WAF_Bypass_String
--- PASS: TestInputSanitizer_Sanitize (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Querystring_with_script (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/URL_with_script (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Normal_paragraph (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Bold_text (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Italic_text (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Underline_text (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Strong_text (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Emphasis_text (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Normal_link (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Image_with_alt_text (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Nested_tags (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Line_break (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Line_break2 (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Normal_links_should_be_accepted (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Unordered_list (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Basic_XSS_Test (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/XSS_Locator_(Polyglot) (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Malformed_A_Tags (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Malformed_IMG_Tags (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/fromCharCode (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Default_SRC_Tag (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/On_Error_Alert (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/IMG_onerror_and_JavaScript_Alert_Encode (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Decimal_HTML_Character_References (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Embedded_Tab (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Embedded_Encoded_Tab (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Embedded_Newline (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Embedded_Carriage_Return (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Null_Chars (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Spaces_and_Meta_Chars (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Half_Open_HTML/JavaScript_XSS_Vector (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Double_Open_Angle_Bracket (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Extraneous_Open_Brackets (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/No_Closing_Script_Tags (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Protocol_Resolution_in_Script_Tags (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/ECMAScript_6 (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/BODY_Tag (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/SVG_Object_Tag (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/Base64_Encoded (0.00s)
    --- PASS: TestInputSanitizer_Sanitize/WAF_Bypass_String (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/inputsanitizer	(cached)
?   	github.com/leodip/goiabada/core/inputsanitizer/mocks	[no test files]
=== RUN   TestGet
--- PASS: TestGet (0.00s)
=== RUN   TestUniqueIds
--- PASS: TestUniqueIds (0.00s)
=== RUN   TestNonEmptyFields
--- PASS: TestNonEmptyFields (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/locales	(cached)
=== RUN   TestMiddlewareCookieReset
=== RUN   TestMiddlewareCookieReset/No_error
=== RUN   TestMiddlewareCookieReset/Decode_error
=== RUN   TestMiddlewareCookieReset/Non-decode_error
--- PASS: TestMiddlewareCookieReset (0.00s)
    --- PASS: TestMiddlewareCookieReset/No_error (0.00s)
    --- PASS: TestMiddlewareCookieReset/Decode_error (0.00s)
    --- PASS: TestMiddlewareCookieReset/Non-decode_error (0.00s)
=== RUN   TestMiddlewareCors
=== RUN   TestMiddlewareCors/Allow_CORS_for_openid-configuration
=== RUN   TestMiddlewareCors/Allow_CORS_for_certs
=== RUN   TestMiddlewareCors/Allow_CORS_for_auth/token_with_valid_origin
=== RUN   TestMiddlewareCors/Allow_CORS_for_auth/logout_with_valid_origin
=== RUN   TestMiddlewareCors/Allow_CORS_for_userinfo_with_valid_origin
=== RUN   TestMiddlewareCors/Disallow_CORS_for_auth/token_with_invalid_origin
=== RUN   TestMiddlewareCors/Disallow_CORS_for_auth/logout_with_invalid_origin
=== RUN   TestMiddlewareCors/Disallow_CORS_for_userinfo_with_invalid_origin
=== RUN   TestMiddlewareCors/Disallow_CORS_for_unknown_path
--- PASS: TestMiddlewareCors (0.00s)
    --- PASS: TestMiddlewareCors/Allow_CORS_for_openid-configuration (0.00s)
    --- PASS: TestMiddlewareCors/Allow_CORS_for_certs (0.00s)
    --- PASS: TestMiddlewareCors/Allow_CORS_for_auth/token_with_valid_origin (0.00s)
    --- PASS: TestMiddlewareCors/Allow_CORS_for_auth/logout_with_valid_origin (0.00s)
    --- PASS: TestMiddlewareCors/Allow_CORS_for_userinfo_with_valid_origin (0.00s)
    --- PASS: TestMiddlewareCors/Disallow_CORS_for_auth/token_with_invalid_origin (0.00s)
    --- PASS: TestMiddlewareCors/Disallow_CORS_for_auth/logout_with_invalid_origin (0.00s)
    --- PASS: TestMiddlewareCors/Disallow_CORS_for_userinfo_with_invalid_origin (0.00s)
    --- PASS: TestMiddlewareCors/Disallow_CORS_for_unknown_path (0.00s)
=== RUN   TestMiddlewareSkipCsrf
=== RUN   TestMiddlewareSkipCsrf/Static_path
=== RUN   TestMiddlewareSkipCsrf/Userinfo_path
=== RUN   TestMiddlewareSkipCsrf/Token_path
=== RUN   TestMiddlewareSkipCsrf/Callback_path
=== RUN   TestMiddlewareSkipCsrf/Other_path
--- PASS: TestMiddlewareSkipCsrf (0.00s)
    --- PASS: TestMiddlewareSkipCsrf/Static_path (0.00s)
    --- PASS: TestMiddlewareSkipCsrf/Userinfo_path (0.00s)
    --- PASS: TestMiddlewareSkipCsrf/Token_path (0.00s)
    --- PASS: TestMiddlewareSkipCsrf/Callback_path (0.00s)
    --- PASS: TestMiddlewareSkipCsrf/Other_path (0.00s)
=== RUN   TestMiddlewareCsrf
2025/11/25 13:04:00 INFO CSRF middleware configured trustedOrigins="[localhost:9091 localhost:9090]" secure=false
=== RUN   TestMiddlewareCsrf/CSRF_middleware_applied
--- PASS: TestMiddlewareCsrf (0.00s)
    --- PASS: TestMiddlewareCsrf/CSRF_middleware_applied (0.00s)
=== RUN   TestJwtAuthorizationHeaderToContext_ValidBearerToken
--- PASS: TestJwtAuthorizationHeaderToContext_ValidBearerToken (0.00s)
=== RUN   TestJwtAuthorizationHeaderToContext_InvalidBearerToken
--- PASS: TestJwtAuthorizationHeaderToContext_InvalidBearerToken (0.00s)
=== RUN   TestJwtAuthorizationHeaderToContext_NoBearerToken
--- PASS: TestJwtAuthorizationHeaderToContext_NoBearerToken (0.00s)
=== RUN   TestJwtAuthorizationHeaderToContext_InvalidAuthorizationHeader
--- PASS: TestJwtAuthorizationHeaderToContext_InvalidAuthorizationHeader (0.00s)
=== RUN   TestJwtSessionHandler_ValidSession
--- PASS: TestJwtSessionHandler_ValidSession (0.00s)
=== RUN   TestJwtSessionHandler_InvalidSession
--- PASS: TestJwtSessionHandler_InvalidSession (0.00s)
=== RUN   TestJwtSessionHandler_NoJwtInSession
--- PASS: TestJwtSessionHandler_NoJwtInSession (0.00s)
=== RUN   TestJwtSessionHandler_InvalidTokenInSession
--- PASS: TestJwtSessionHandler_InvalidTokenInSession (0.00s)
=== RUN   TestJwtSessionHandler_InvalidIssuer
2025/11/25 13:04:00 ERROR Invalid issuer in JWT token. Will clear the session and redirect to root
--- PASS: TestJwtSessionHandler_InvalidIssuer (0.00s)
=== RUN   TestJwtSessionHandler_ValidRefreshToken
--- PASS: TestJwtSessionHandler_ValidRefreshToken (0.00s)
=== RUN   TestRefreshToken_Success
--- PASS: TestRefreshToken_Success (0.00s)
=== RUN   TestRefreshToken_NoRefreshToken
--- PASS: TestRefreshToken_NoRefreshToken (0.00s)
=== RUN   TestRefreshToken_InvalidResponse
--- PASS: TestRefreshToken_InvalidResponse (0.00s)
=== RUN   TestRequiresScope_Authorized
--- PASS: TestRequiresScope_Authorized (0.00s)
=== RUN   TestRequiresScope_Unauthorized
--- PASS: TestRequiresScope_Unauthorized (0.00s)
=== RUN   TestRequiresScope_Unauthenticated
--- PASS: TestRequiresScope_Unauthenticated (0.00s)
=== RUN   TestRequiresScope_NoJwtInfo
--- PASS: TestRequiresScope_NoJwtInfo (0.00s)
=== RUN   TestRequiresScope_RedirectError
--- PASS: TestRequiresScope_RedirectError (0.00s)
=== RUN   TestBuildScopeString
=== RUN   TestBuildScopeString/Empty_input
=== RUN   TestBuildScopeString/Single_scope
=== RUN   TestBuildScopeString/Multiple_scopes
=== RUN   TestBuildScopeString/With_required_scopes_already_included
=== RUN   TestBuildScopeString/Mixed_case_scopes
=== RUN   TestBuildScopeString/Scopes_with_spaces
=== RUN   TestBuildScopeString/Duplicate_scopes
--- PASS: TestBuildScopeString (0.00s)
    --- PASS: TestBuildScopeString/Empty_input (0.00s)
    --- PASS: TestBuildScopeString/Single_scope (0.00s)
    --- PASS: TestBuildScopeString/Multiple_scopes (0.00s)
    --- PASS: TestBuildScopeString/With_required_scopes_already_included (0.00s)
    --- PASS: TestBuildScopeString/Mixed_case_scopes (0.00s)
    --- PASS: TestBuildScopeString/Scopes_with_spaces (0.00s)
    --- PASS: TestBuildScopeString/Duplicate_scopes (0.00s)
=== RUN   TestBuildScopeString_Consistency
--- PASS: TestBuildScopeString_Consistency (0.00s)
=== RUN   TestBuildScopeString_LargeInput
--- PASS: TestBuildScopeString_LargeInput (0.02s)
=== RUN   TestBuildScopeString_SpecialCharacters
--- PASS: TestBuildScopeString_SpecialCharacters (0.00s)
=== RUN   TestMiddlewareSettings
=== RUN   TestMiddlewareSettings/Successful_retrieval_of_settings
=== RUN   TestMiddlewareSettings/Database_error
2025/11/25 13:04:00 ERROR database error
request-id: 
--- PASS: TestMiddlewareSettings (0.00s)
    --- PASS: TestMiddlewareSettings/Successful_retrieval_of_settings (0.00s)
    --- PASS: TestMiddlewareSettings/Database_error (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/middleware	(cached)
?   	github.com/leodip/goiabada/core/mocks	[no test files]
=== RUN   TestIsSystemLevelClient
=== RUN   TestIsSystemLevelClient/AdminConsoleClient
=== RUN   TestIsSystemLevelClient/NonSystemClient
=== RUN   TestIsSystemLevelClient/EmptyIdentifier
--- PASS: TestIsSystemLevelClient (0.00s)
    --- PASS: TestIsSystemLevelClient/AdminConsoleClient (0.00s)
    --- PASS: TestIsSystemLevelClient/NonSystemClient (0.00s)
    --- PASS: TestIsSystemLevelClient/EmptyIdentifier (0.00s)
=== RUN   TestIsSystemLevelResource
=== RUN   TestIsSystemLevelResource/AuthServer
=== RUN   TestIsSystemLevelResource/AdminConsole
=== RUN   TestIsSystemLevelResource/CustomResource
=== RUN   TestIsSystemLevelResource/EmptyIdentifier
--- PASS: TestIsSystemLevelResource (0.00s)
    --- PASS: TestIsSystemLevelResource/AuthServer (0.00s)
    --- PASS: TestIsSystemLevelResource/AdminConsole (0.00s)
    --- PASS: TestIsSystemLevelResource/CustomResource (0.00s)
    --- PASS: TestIsSystemLevelResource/EmptyIdentifier (0.00s)
=== RUN   TestUserConsent_HasScope
=== RUN   TestUserConsent_HasScope/Empty_scope
=== RUN   TestUserConsent_HasScope/Single_scope_match
=== RUN   TestUserConsent_HasScope/Single_scope_no_match
=== RUN   TestUserConsent_HasScope/Multiple_scopes_with_match
=== RUN   TestUserConsent_HasScope/Multiple_scopes_without_match
=== RUN   TestUserConsent_HasScope/Partial_scope_match
--- PASS: TestUserConsent_HasScope (0.00s)
    --- PASS: TestUserConsent_HasScope/Empty_scope (0.00s)
    --- PASS: TestUserConsent_HasScope/Single_scope_match (0.00s)
    --- PASS: TestUserConsent_HasScope/Single_scope_no_match (0.00s)
    --- PASS: TestUserConsent_HasScope/Multiple_scopes_with_match (0.00s)
    --- PASS: TestUserConsent_HasScope/Multiple_scopes_without_match (0.00s)
    --- PASS: TestUserConsent_HasScope/Partial_scope_match (0.00s)
=== RUN   TestUser_HasAddress
=== RUN   TestUser_HasAddress/Empty_address
=== RUN   TestUser_HasAddress/Only_AddressLine1
=== RUN   TestUser_HasAddress/Only_AddressLine2
=== RUN   TestUser_HasAddress/Only_AddressLocality
=== RUN   TestUser_HasAddress/Only_AddressRegion
=== RUN   TestUser_HasAddress/Only_AddressPostalCode
=== RUN   TestUser_HasAddress/Only_AddressCountry
=== RUN   TestUser_HasAddress/Full_address
--- PASS: TestUser_HasAddress (0.00s)
    --- PASS: TestUser_HasAddress/Empty_address (0.00s)
    --- PASS: TestUser_HasAddress/Only_AddressLine1 (0.00s)
    --- PASS: TestUser_HasAddress/Only_AddressLine2 (0.00s)
    --- PASS: TestUser_HasAddress/Only_AddressLocality (0.00s)
    --- PASS: TestUser_HasAddress/Only_AddressRegion (0.00s)
    --- PASS: TestUser_HasAddress/Only_AddressPostalCode (0.00s)
    --- PASS: TestUser_HasAddress/Only_AddressCountry (0.00s)
    --- PASS: TestUser_HasAddress/Full_address (0.00s)
=== RUN   TestUser_GetAddressClaim
=== RUN   TestUser_GetAddressClaim/Empty_address
=== RUN   TestUser_GetAddressClaim/Full_address
=== RUN   TestUser_GetAddressClaim/Partial_address
--- PASS: TestUser_GetAddressClaim (0.00s)
    --- PASS: TestUser_GetAddressClaim/Empty_address (0.00s)
    --- PASS: TestUser_GetAddressClaim/Full_address (0.00s)
    --- PASS: TestUser_GetAddressClaim/Partial_address (0.00s)
=== RUN   TestUser_GetDateOfBirthFormatted
=== RUN   TestUser_GetDateOfBirthFormatted/Nil_user
=== RUN   TestUser_GetDateOfBirthFormatted/Invalid_BirthDate
=== RUN   TestUser_GetDateOfBirthFormatted/Valid_BirthDate
--- PASS: TestUser_GetDateOfBirthFormatted (0.00s)
    --- PASS: TestUser_GetDateOfBirthFormatted/Nil_user (0.00s)
    --- PASS: TestUser_GetDateOfBirthFormatted/Invalid_BirthDate (0.00s)
    --- PASS: TestUser_GetDateOfBirthFormatted/Valid_BirthDate (0.00s)
=== RUN   TestUser_GetFullName
=== RUN   TestUser_GetFullName/Nil_user
=== RUN   TestUser_GetFullName/Empty_names
=== RUN   TestUser_GetFullName/Only_GivenName
=== RUN   TestUser_GetFullName/Only_MiddleName
=== RUN   TestUser_GetFullName/Only_FamilyName
=== RUN   TestUser_GetFullName/GivenName_and_FamilyName
=== RUN   TestUser_GetFullName/Full_name
--- PASS: TestUser_GetFullName (0.00s)
    --- PASS: TestUser_GetFullName/Nil_user (0.00s)
    --- PASS: TestUser_GetFullName/Empty_names (0.00s)
    --- PASS: TestUser_GetFullName/Only_GivenName (0.00s)
    --- PASS: TestUser_GetFullName/Only_MiddleName (0.00s)
    --- PASS: TestUser_GetFullName/Only_FamilyName (0.00s)
    --- PASS: TestUser_GetFullName/GivenName_and_FamilyName (0.00s)
    --- PASS: TestUser_GetFullName/Full_name (0.00s)
=== RUN   TestUserSession_IsValid
=== RUN   TestUserSession_IsValid/Valid_session
=== RUN   TestUserSession_IsValid/Expired_idle_timeout
=== RUN   TestUserSession_IsValid/Expired_max_lifetime
=== RUN   TestUserSession_IsValid/Valid_with_requested_max_age
=== RUN   TestUserSession_IsValid/Invalid_due_to_requested_max_age
--- PASS: TestUserSession_IsValid (0.00s)
    --- PASS: TestUserSession_IsValid/Valid_session (0.00s)
    --- PASS: TestUserSession_IsValid/Expired_idle_timeout (0.00s)
    --- PASS: TestUserSession_IsValid/Expired_max_lifetime (0.00s)
    --- PASS: TestUserSession_IsValid/Valid_with_requested_max_age (0.00s)
    --- PASS: TestUserSession_IsValid/Invalid_due_to_requested_max_age (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/models	(cached)
=== RUN   TestCreateAuthCode
--- PASS: TestCreateAuthCode (0.00s)
=== RUN   TestCreateAuthCode_DefaultResponseMode
--- PASS: TestCreateAuthCode_DefaultResponseMode (0.00s)
=== RUN   TestCreateAuthCode_ScopeHandling
=== RUN   TestCreateAuthCode_ScopeHandling/ConsentedScope_is_used_when_present
=== RUN   TestCreateAuthCode_ScopeHandling/Scope_is_used_when_ConsentedScope_is_empty
=== RUN   TestCreateAuthCode_ScopeHandling/Extra_whitespace_is_removed
--- PASS: TestCreateAuthCode_ScopeHandling (0.00s)
    --- PASS: TestCreateAuthCode_ScopeHandling/ConsentedScope_is_used_when_present (0.00s)
    --- PASS: TestCreateAuthCode_ScopeHandling/Scope_is_used_when_ConsentedScope_is_empty (0.00s)
    --- PASS: TestCreateAuthCode_ScopeHandling/Extra_whitespace_is_removed (0.00s)
=== RUN   TestCreateAuthCode_DatabaseError
--- PASS: TestCreateAuthCode_DatabaseError (0.00s)
=== RUN   TestGetAudience
=== RUN   TestGetAudience/No_audience
=== RUN   TestGetAudience/Single_audience_string
=== RUN   TestGetAudience/Multiple_audience_array
--- PASS: TestGetAudience (0.00s)
    --- PASS: TestGetAudience/No_audience (0.00s)
    --- PASS: TestGetAudience/Single_audience_string (0.00s)
    --- PASS: TestGetAudience/Multiple_audience_array (0.00s)
=== RUN   TestGetStringClaim
--- PASS: TestGetStringClaim (0.00s)
=== RUN   TestGetTimeClaim
--- PASS: TestGetTimeClaim (0.00s)
=== RUN   TestGetBoolClaim
--- PASS: TestGetBoolClaim (0.00s)
=== RUN   TestGetAddressClaim
--- PASS: TestGetAddressClaim (0.00s)
=== RUN   TestHasScope
--- PASS: TestHasScope (0.00s)
=== RUN   TestIsNonceValid
=== RUN   TestIsNonceValid/Valid_nonce
=== RUN   TestIsNonceValid/Invalid_nonce
=== RUN   TestIsNonceValid/Empty_provided_nonce
=== RUN   TestIsNonceValid/Empty_stored_nonce
--- PASS: TestIsNonceValid (0.00s)
    --- PASS: TestIsNonceValid/Valid_nonce (0.00s)
    --- PASS: TestIsNonceValid/Invalid_nonce (0.00s)
    --- PASS: TestIsNonceValid/Empty_provided_nonce (0.00s)
    --- PASS: TestIsNonceValid/Empty_stored_nonce (0.00s)
=== RUN   TestIsIssuerValid
--- PASS: TestIsIssuerValid (0.00s)
=== RUN   TestGeneratePKCECodeChallenge
=== RUN   TestGeneratePKCECodeChallenge/Basic_test_case
=== RUN   TestGeneratePKCECodeChallenge/Empty_string
=== RUN   TestGeneratePKCECodeChallenge/Alphanumeric_string
--- PASS: TestGeneratePKCECodeChallenge (0.00s)
    --- PASS: TestGeneratePKCECodeChallenge/Basic_test_case (0.00s)
    --- PASS: TestGeneratePKCECodeChallenge/Empty_string (0.00s)
    --- PASS: TestGeneratePKCECodeChallenge/Alphanumeric_string (0.00s)
=== RUN   TestGenerateTokenResponseForAuthCode_FullOpenIDConnect
--- PASS: TestGenerateTokenResponseForAuthCode_FullOpenIDConnect (0.01s)
=== RUN   TestGenerateTokenResponseForAuthCode_MinimalScope
--- PASS: TestGenerateTokenResponseForAuthCode_MinimalScope (0.01s)
=== RUN   TestGenerateTokenResponseForAuthCode_ClientOverrideAndMixedScopes
--- PASS: TestGenerateTokenResponseForAuthCode_ClientOverrideAndMixedScopes (0.01s)
=== RUN   TestGenerateTokenResponseForAuthCode_ClientOverrideAndCustomScope
--- PASS: TestGenerateTokenResponseForAuthCode_ClientOverrideAndCustomScope (0.01s)
=== RUN   TestGenerateTokenResponseForAuthCode_CustomScope
--- PASS: TestGenerateTokenResponseForAuthCode_CustomScope (0.01s)
=== RUN   TestGenerateAccessToken
--- PASS: TestGenerateAccessToken (0.00s)
=== RUN   TestGenerateAccessToken_CustomScope
--- PASS: TestGenerateAccessToken_CustomScope (0.00s)
=== RUN   TestGenerateAccessToken_WithGroupsAndAttributes
--- PASS: TestGenerateAccessToken_WithGroupsAndAttributes (0.00s)
=== RUN   TestGenerateAccessToken_InvalidScope
--- PASS: TestGenerateAccessToken_InvalidScope (0.00s)
=== RUN   TestGenerateIdToken_FullScope
--- PASS: TestGenerateIdToken_FullScope (0.00s)
=== RUN   TestGenerateIdToken_MinimalScope
--- PASS: TestGenerateIdToken_MinimalScope (0.00s)
=== RUN   TestGenerateIdToken_ClientOverride
--- PASS: TestGenerateIdToken_ClientOverride (0.00s)
=== RUN   TestGenerateRefreshToken_Offline
--- PASS: TestGenerateRefreshToken_Offline (0.00s)
=== RUN   TestGenerateRefreshToken_Refresh
--- PASS: TestGenerateRefreshToken_Refresh (0.00s)
=== RUN   TestGenerateRefreshToken_WithExistingRefreshToken
--- PASS: TestGenerateRefreshToken_WithExistingRefreshToken (0.00s)
=== RUN   TestGenerateRefreshToken_OfflineMaxLifetimeLimit
--- PASS: TestGenerateRefreshToken_OfflineMaxLifetimeLimit (0.00s)
=== RUN   TestGetRefreshTokenExpiration
=== RUN   TestGetRefreshTokenExpiration/Offline_token_with_client_override
=== RUN   TestGetRefreshTokenExpiration/Offline_token_without_client_override
=== RUN   TestGetRefreshTokenExpiration/Refresh_token
=== RUN   TestGetRefreshTokenExpiration/Invalid_token_type
--- PASS: TestGetRefreshTokenExpiration (0.00s)
    --- PASS: TestGetRefreshTokenExpiration/Offline_token_with_client_override (0.00s)
    --- PASS: TestGetRefreshTokenExpiration/Offline_token_without_client_override (0.00s)
    --- PASS: TestGetRefreshTokenExpiration/Refresh_token (0.00s)
    --- PASS: TestGetRefreshTokenExpiration/Invalid_token_type (0.00s)
=== RUN   TestGetRefreshTokenMaxLifetime
=== RUN   TestGetRefreshTokenMaxLifetime/Offline_token_with_client_override
=== RUN   TestGetRefreshTokenMaxLifetime/Offline_token_without_client_override
=== RUN   TestGetRefreshTokenMaxLifetime/Refresh_token
=== RUN   TestGetRefreshTokenMaxLifetime/Invalid_token_type
--- PASS: TestGetRefreshTokenMaxLifetime (0.00s)
    --- PASS: TestGetRefreshTokenMaxLifetime/Offline_token_with_client_override (0.00s)
    --- PASS: TestGetRefreshTokenMaxLifetime/Offline_token_without_client_override (0.00s)
    --- PASS: TestGetRefreshTokenMaxLifetime/Refresh_token (0.00s)
    --- PASS: TestGetRefreshTokenMaxLifetime/Invalid_token_type (0.00s)
=== RUN   TestGenerateTokenResponseForClientCred
=== RUN   TestGenerateTokenResponseForClientCred/Single_custom_scope
=== RUN   TestGenerateTokenResponseForClientCred/Multiple_custom_scopes
=== RUN   TestGenerateTokenResponseForClientCred/Custom_scopes_with_OIDC_scopes_(should_be_ignored)
--- PASS: TestGenerateTokenResponseForClientCred (0.01s)
    --- PASS: TestGenerateTokenResponseForClientCred/Single_custom_scope (0.00s)
    --- PASS: TestGenerateTokenResponseForClientCred/Multiple_custom_scopes (0.00s)
    --- PASS: TestGenerateTokenResponseForClientCred/Custom_scopes_with_OIDC_scopes_(should_be_ignored) (0.00s)
=== RUN   TestGenerateTokenResponseForClientCred_InvalidScope
--- PASS: TestGenerateTokenResponseForClientCred_InvalidScope (0.00s)
=== RUN   TestGenerateTokenResponseForRefresh
--- PASS: TestGenerateTokenResponseForRefresh (0.01s)
=== RUN   TestGenerateTokenResponseForRefresh_Offline_NoIdToken
--- PASS: TestGenerateTokenResponseForRefresh_Offline_NoIdToken (0.01s)
=== RUN   TestAddOpenIdConnectClaims
=== RUN   TestAddOpenIdConnectClaims/Full_scope
=== RUN   TestAddOpenIdConnectClaims/Minimal_scope
=== RUN   TestAddOpenIdConnectClaims/Profile_scope_only
=== RUN   TestAddOpenIdConnectClaims/Email_scope_only
=== RUN   TestAddOpenIdConnectClaims/Address_scope_only
=== RUN   TestAddOpenIdConnectClaims/Phone_scope_only
--- PASS: TestAddOpenIdConnectClaims (0.00s)
    --- PASS: TestAddOpenIdConnectClaims/Full_scope (0.00s)
    --- PASS: TestAddOpenIdConnectClaims/Minimal_scope (0.00s)
    --- PASS: TestAddOpenIdConnectClaims/Profile_scope_only (0.00s)
    --- PASS: TestAddOpenIdConnectClaims/Email_scope_only (0.00s)
    --- PASS: TestAddOpenIdConnectClaims/Address_scope_only (0.00s)
    --- PASS: TestAddOpenIdConnectClaims/Phone_scope_only (0.00s)
=== RUN   TestAddClaimIfNotEmpty
=== RUN   TestAddClaimIfNotEmpty/Non-empty_claim
=== RUN   TestAddClaimIfNotEmpty/Empty_claim
=== RUN   TestAddClaimIfNotEmpty/Whitespace-only_claim
=== RUN   TestAddClaimIfNotEmpty/Claim_with_leading/trailing_whitespace
=== RUN   TestAddClaimIfNotEmpty/Adding_to_existing_claims
=== RUN   TestAddClaimIfNotEmpty/Overwriting_existing_claim
=== RUN   TestAddClaimIfNotEmpty/Unicode_claim_value
--- PASS: TestAddClaimIfNotEmpty (0.00s)
    --- PASS: TestAddClaimIfNotEmpty/Non-empty_claim (0.00s)
    --- PASS: TestAddClaimIfNotEmpty/Empty_claim (0.00s)
    --- PASS: TestAddClaimIfNotEmpty/Whitespace-only_claim (0.00s)
    --- PASS: TestAddClaimIfNotEmpty/Claim_with_leading/trailing_whitespace (0.00s)
    --- PASS: TestAddClaimIfNotEmpty/Adding_to_existing_claims (0.00s)
    --- PASS: TestAddClaimIfNotEmpty/Overwriting_existing_claim (0.00s)
    --- PASS: TestAddClaimIfNotEmpty/Unicode_claim_value (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/oauth	(cached)
?   	github.com/leodip/goiabada/core/oauth/mocks	[no test files]
=== RUN   TestDecodeAndValidateTokenResponse_ValidTokens
--- PASS: TestDecodeAndValidateTokenResponse_ValidTokens (0.03s)
=== RUN   TestDecodeAndValidateTokenResponse_ExpiredAccessToken
--- PASS: TestDecodeAndValidateTokenResponse_ExpiredAccessToken (0.02s)
=== RUN   TestDecodeAndValidateTokenResponse_EmptyTokens
--- PASS: TestDecodeAndValidateTokenResponse_EmptyTokens (0.03s)
=== RUN   TestDecodeAndValidateTokenString
=== RUN   TestDecodeAndValidateTokenString/Valid_token
=== RUN   TestDecodeAndValidateTokenString/Expired_token
=== RUN   TestDecodeAndValidateTokenString/Missing_expiration
--- PASS: TestDecodeAndValidateTokenString (0.02s)
    --- PASS: TestDecodeAndValidateTokenString/Valid_token (0.00s)
    --- PASS: TestDecodeAndValidateTokenString/Expired_token (0.00s)
    --- PASS: TestDecodeAndValidateTokenString/Missing_expiration (0.00s)
=== RUN   TestDecodeAndValidateTokenString_InvalidSignature
--- PASS: TestDecodeAndValidateTokenString_InvalidSignature (0.06s)
=== RUN   TestDecodeAndValidateTokenString_EmptyToken
--- PASS: TestDecodeAndValidateTokenString_EmptyToken (0.02s)
PASS
ok  	github.com/leodip/goiabada/core/oauthdb	(cached)
=== RUN   TestIsIdTokenScope
=== RUN   TestIsIdTokenScope/OpenID_scope
=== RUN   TestIsIdTokenScope/Profile_scope
=== RUN   TestIsIdTokenScope/Email_scope
=== RUN   TestIsIdTokenScope/Address_scope
=== RUN   TestIsIdTokenScope/Phone_scope
=== RUN   TestIsIdTokenScope/Groups_scope
=== RUN   TestIsIdTokenScope/Attributes_scope
=== RUN   TestIsIdTokenScope/Non-OIDC_scope
=== RUN   TestIsIdTokenScope/Empty_scope
--- PASS: TestIsIdTokenScope (0.00s)
    --- PASS: TestIsIdTokenScope/OpenID_scope (0.00s)
    --- PASS: TestIsIdTokenScope/Profile_scope (0.00s)
    --- PASS: TestIsIdTokenScope/Email_scope (0.00s)
    --- PASS: TestIsIdTokenScope/Address_scope (0.00s)
    --- PASS: TestIsIdTokenScope/Phone_scope (0.00s)
    --- PASS: TestIsIdTokenScope/Groups_scope (0.00s)
    --- PASS: TestIsIdTokenScope/Attributes_scope (0.00s)
    --- PASS: TestIsIdTokenScope/Non-OIDC_scope (0.00s)
    --- PASS: TestIsIdTokenScope/Empty_scope (0.00s)
=== RUN   TestIsOfflineAccessScope
=== RUN   TestIsOfflineAccessScope/Exact_match
=== RUN   TestIsOfflineAccessScope/Case_insensitive
=== RUN   TestIsOfflineAccessScope/With_spaces
=== RUN   TestIsOfflineAccessScope/Different_scope
=== RUN   TestIsOfflineAccessScope/Empty_string
--- PASS: TestIsOfflineAccessScope (0.00s)
    --- PASS: TestIsOfflineAccessScope/Exact_match (0.00s)
    --- PASS: TestIsOfflineAccessScope/Case_insensitive (0.00s)
    --- PASS: TestIsOfflineAccessScope/With_spaces (0.00s)
    --- PASS: TestIsOfflineAccessScope/Different_scope (0.00s)
    --- PASS: TestIsOfflineAccessScope/Empty_string (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/oidc	(cached)
=== RUN   TestNewOTPSecretGenerator
--- PASS: TestNewOTPSecretGenerator (0.00s)
=== RUN   TestGenerateOTPSecret
=== RUN   TestGenerateOTPSecret/Valid_input
=== RUN   TestGenerateOTPSecret/Empty_email
=== RUN   TestGenerateOTPSecret/Whitespace_email
=== RUN   TestGenerateOTPSecret/Empty_app_name
=== RUN   TestGenerateOTPSecret/Whitespace_app_name
=== RUN   TestGenerateOTPSecret/Different_output_for_different_inputs
=== RUN   TestGenerateOTPSecret/Input_length_restrictions
=== RUN   TestGenerateOTPSecret/Input_length_restrictions/Valid_lengths
=== RUN   TestGenerateOTPSecret/Input_length_restrictions/Email_too_long
=== RUN   TestGenerateOTPSecret/Input_length_restrictions/App_name_too_long
=== RUN   TestGenerateOTPSecret/QR_code_size
--- PASS: TestGenerateOTPSecret (0.02s)
    --- PASS: TestGenerateOTPSecret/Valid_input (0.00s)
    --- PASS: TestGenerateOTPSecret/Empty_email (0.00s)
    --- PASS: TestGenerateOTPSecret/Whitespace_email (0.00s)
    --- PASS: TestGenerateOTPSecret/Empty_app_name (0.00s)
    --- PASS: TestGenerateOTPSecret/Whitespace_app_name (0.00s)
    --- PASS: TestGenerateOTPSecret/Different_output_for_different_inputs (0.01s)
    --- PASS: TestGenerateOTPSecret/Input_length_restrictions (0.01s)
        --- PASS: TestGenerateOTPSecret/Input_length_restrictions/Valid_lengths (0.01s)
        --- PASS: TestGenerateOTPSecret/Input_length_restrictions/Email_too_long (0.00s)
        --- PASS: TestGenerateOTPSecret/Input_length_restrictions/App_name_too_long (0.00s)
    --- PASS: TestGenerateOTPSecret/QR_code_size (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/otp	(cached)
?   	github.com/leodip/goiabada/core/otp/mocks	[no test files]
=== RUN   TestGet
--- PASS: TestGet (0.07s)
=== RUN   TestGetSpecificCountries
--- PASS: TestGetSpecificCountries (0.07s)
PASS
ok  	github.com/leodip/goiabada/core/phonecountries	(cached)
=== RUN   TestGeneratePrivateKey
=== RUN   TestGeneratePrivateKey/Valid_2048-bit_key
=== RUN   TestGeneratePrivateKey/Valid_4096-bit_key
=== RUN   TestGeneratePrivateKey/Valid_1024-bit_key
=== RUN   TestGeneratePrivateKey/Invalid_bit_size
--- PASS: TestGeneratePrivateKey (0.22s)
    --- PASS: TestGeneratePrivateKey/Valid_2048-bit_key (0.07s)
    --- PASS: TestGeneratePrivateKey/Valid_4096-bit_key (0.15s)
    --- PASS: TestGeneratePrivateKey/Valid_1024-bit_key (0.01s)
    --- PASS: TestGeneratePrivateKey/Invalid_bit_size (0.00s)
=== RUN   TestEncodePrivateKeyToPEM
--- PASS: TestEncodePrivateKeyToPEM (0.00s)
=== RUN   TestEncodePublicKeyToPEM
--- PASS: TestEncodePublicKeyToPEM (0.03s)
=== RUN   TestMarshalRSAPublicKeyToJWK
--- PASS: TestMarshalRSAPublicKeyToJWK (0.07s)
PASS
ok  	github.com/leodip/goiabada/core/rsautil	(cached)
=== RUN   TestChunkedStore_SmallSession
--- PASS: TestChunkedStore_SmallSession (0.00s)
=== RUN   TestChunkedStore_LargeSession
--- PASS: TestChunkedStore_LargeSession (0.00s)
=== RUN   TestChunkedStore_HugeSession
--- PASS: TestChunkedStore_HugeSession (0.00s)
=== RUN   TestChunkedStore_EmptySession
--- PASS: TestChunkedStore_EmptySession (0.00s)
=== RUN   TestChunkedStore_SessionDeletion
--- PASS: TestChunkedStore_SessionDeletion (0.00s)
=== RUN   TestChunkedStore_MissingChunk
2025/11/25 13:04:00 WARN Failed to load existing session, creating new one error="http: named cookie not present\nmissing chunk cookie: test-session-chunk-1 (chunk 1 of 5)\ngithub.com/leodip/goiabada/core/sessionstore.(*ChunkedCookieStore).load\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store.go:205\ngithub.com/leodip/goiabada/core/sessionstore.(*ChunkedCookieStore).New\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store.go:93\ngithub.com/leodip/goiabada/core/sessionstore_test.TestChunkedStore_MissingChunk\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store_test.go:232\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1934\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1693" sessionName=test-session
--- PASS: TestChunkedStore_MissingChunk (0.00s)
=== RUN   TestChunkedStore_TamperedChunk
2025/11/25 13:04:00 WARN Failed to load existing session, creating new one error="session data integrity check failed - chunks may be corrupted or tampered with\ngithub.com/leodip/goiabada/core/sessionstore.(*ChunkedCookieStore).load\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store.go:214\ngithub.com/leodip/goiabada/core/sessionstore.(*ChunkedCookieStore).New\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store.go:93\ngithub.com/leodip/goiabada/core/sessionstore_test.TestChunkedStore_TamperedChunk\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store_test.go:264\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1934\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1693" sessionName=test-session
--- PASS: TestChunkedStore_TamperedChunk (0.00s)
=== RUN   TestChunkedStore_MaxSizeExceeded
--- PASS: TestChunkedStore_MaxSizeExceeded (0.00s)
=== RUN   TestChunkedStore_UpdateSession
--- PASS: TestChunkedStore_UpdateSession (0.00s)
=== RUN   TestChunkedStore_ImplementsStoreInterface
--- PASS: TestChunkedStore_ImplementsStoreInterface (0.00s)
=== RUN   TestChunkedStore_MultipleSessionsIndependent
--- PASS: TestChunkedStore_MultipleSessionsIndependent (0.00s)
=== RUN   TestChunkedStore_MetadataValidation
--- PASS: TestChunkedStore_MetadataValidation (0.00s)
=== RUN   TestChunkedStore_CorruptedMetadata
2025/11/25 13:04:00 WARN Failed to load existing session, creating new one error="securecookie: base64 decode failed - caused by: illegal base64 data at input byte 234\nfailed to decode metadata cookie\ngithub.com/leodip/goiabada/core/sessionstore.(*ChunkedCookieStore).load\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store.go:180\ngithub.com/leodip/goiabada/core/sessionstore.(*ChunkedCookieStore).New\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store.go:93\ngithub.com/leodip/goiabada/core/sessionstore_test.TestChunkedStore_CorruptedMetadata\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store_test.go:445\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1934\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1693" sessionName=test-session
--- PASS: TestChunkedStore_CorruptedMetadata (0.00s)
=== RUN   TestChunkedStore_MismatchedChunkCount
2025/11/25 13:04:00 WARN Failed to load existing session, creating new one error="http: named cookie not present\nmissing chunk cookie: test-session-chunk-7 (chunk 7 of 8)\ngithub.com/leodip/goiabada/core/sessionstore.(*ChunkedCookieStore).load\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store.go:205\ngithub.com/leodip/goiabada/core/sessionstore.(*ChunkedCookieStore).New\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store.go:93\ngithub.com/leodip/goiabada/core/sessionstore_test.TestChunkedStore_MismatchedChunkCount\n\t/workspaces/goiabada/src/core/sessionstore/chunked_cookie_store_test.go:483\ntesting.tRunner\n\t/usr/local/go/src/testing/testing.go:1934\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1693" sessionName=test-session
--- PASS: TestChunkedStore_MismatchedChunkCount (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/sessionstore	(cached)
?   	github.com/leodip/goiabada/core/sessionstore/mocks	[no test files]
?   	github.com/leodip/goiabada/core/stringutil	[no test files]
?   	github.com/leodip/goiabada/core/testutil	[no test files]
?   	github.com/leodip/goiabada/core/timezones	[no test files]
?   	github.com/leodip/goiabada/core/uithemes	[no test files]
?   	github.com/leodip/goiabada/core/user	[no test files]
?   	github.com/leodip/goiabada/core/user/mocks	[no test files]
?   	github.com/leodip/goiabada/core/useragent	[no test files]
=== RUN   TestValidateAddress
=== RUN   TestValidateAddress/Valid_address
=== RUN   TestValidateAddress/Address_line_1_too_long
=== RUN   TestValidateAddress/Address_line_2_too_long
=== RUN   TestValidateAddress/Locality_too_long
=== RUN   TestValidateAddress/Region_too_long
=== RUN   TestValidateAddress/Postal_code_too_long
=== RUN   TestValidateAddress/Invalid_country
--- PASS: TestValidateAddress (0.00s)
    --- PASS: TestValidateAddress/Valid_address (0.00s)
    --- PASS: TestValidateAddress/Address_line_1_too_long (0.00s)
    --- PASS: TestValidateAddress/Address_line_2_too_long (0.00s)
    --- PASS: TestValidateAddress/Locality_too_long (0.00s)
    --- PASS: TestValidateAddress/Region_too_long (0.00s)
    --- PASS: TestValidateAddress/Postal_code_too_long (0.00s)
    --- PASS: TestValidateAddress/Invalid_country (0.00s)
=== RUN   TestValidateScopes
=== RUN   TestValidateScopes/Empty_scope
=== RUN   TestValidateScopes/Valid_OpenID_Connect_scope
=== RUN   TestValidateScopes/Valid_offline_access_scope
=== RUN   TestValidateScopes/Invalid_userinfo_scope
=== RUN   TestValidateScopes/Invalid_scope_format
=== RUN   TestValidateScopes/Valid_resource:permission_scope
=== RUN   TestValidateScopes/Invalid_resource
=== RUN   TestValidateScopes/Invalid_permission
--- PASS: TestValidateScopes (0.00s)
    --- PASS: TestValidateScopes/Empty_scope (0.00s)
    --- PASS: TestValidateScopes/Valid_OpenID_Connect_scope (0.00s)
    --- PASS: TestValidateScopes/Valid_offline_access_scope (0.00s)
    --- PASS: TestValidateScopes/Invalid_userinfo_scope (0.00s)
    --- PASS: TestValidateScopes/Invalid_scope_format (0.00s)
    --- PASS: TestValidateScopes/Valid_resource:permission_scope (0.00s)
    --- PASS: TestValidateScopes/Invalid_resource (0.00s)
    --- PASS: TestValidateScopes/Invalid_permission (0.00s)
=== RUN   TestValidateClientAndRedirectURI_MissingClientId
--- PASS: TestValidateClientAndRedirectURI_MissingClientId (0.00s)
=== RUN   TestValidateClientAndRedirectURI_NonExistentClient
--- PASS: TestValidateClientAndRedirectURI_NonExistentClient (0.00s)
=== RUN   TestValidateClientAndRedirectURI_DisabledClient
--- PASS: TestValidateClientAndRedirectURI_DisabledClient (0.00s)
=== RUN   TestValidateClientAndRedirectURI_ClientWithoutAuthorizationCodeFlow
--- PASS: TestValidateClientAndRedirectURI_ClientWithoutAuthorizationCodeFlow (0.00s)
=== RUN   TestValidateClientAndRedirectURI_MissingRedirectURI
--- PASS: TestValidateClientAndRedirectURI_MissingRedirectURI (0.00s)
=== RUN   TestValidateClientAndRedirectURI_ValidClientAndRedirectURI
--- PASS: TestValidateClientAndRedirectURI_ValidClientAndRedirectURI (0.00s)
=== RUN   TestValidateClientAndRedirectURI_InvalidRedirectURI
--- PASS: TestValidateClientAndRedirectURI_InvalidRedirectURI (0.00s)
=== RUN   TestValidateRequest_InvalidResponseType
--- PASS: TestValidateRequest_InvalidResponseType (0.00s)
=== RUN   TestValidateRequest_InvalidCodeChallengeMethod
--- PASS: TestValidateRequest_InvalidCodeChallengeMethod (0.00s)
=== RUN   TestValidateRequest_InvalidCodeChallengeMethod_PKCERequired
--- PASS: TestValidateRequest_InvalidCodeChallengeMethod_PKCERequired (0.00s)
=== RUN   TestValidateRequest_CodeChallengeTooShort
--- PASS: TestValidateRequest_CodeChallengeTooShort (0.00s)
=== RUN   TestValidateRequest_CodeChallengeTooShort_PKCERequired
--- PASS: TestValidateRequest_CodeChallengeTooShort_PKCERequired (0.00s)
=== RUN   TestValidateRequest_CodeChallengeTooLong
--- PASS: TestValidateRequest_CodeChallengeTooLong (0.00s)
=== RUN   TestValidateRequest_CodeChallengeTooLong_PKCERequired
--- PASS: TestValidateRequest_CodeChallengeTooLong_PKCERequired (0.00s)
=== RUN   TestValidateRequest_InvalidResponseMode
--- PASS: TestValidateRequest_InvalidResponseMode (0.00s)
=== RUN   TestValidateRequest_ValidInput
--- PASS: TestValidateRequest_ValidInput (0.00s)
=== RUN   TestValidateScopes_MultipleScopesInSingleRequest
--- PASS: TestValidateScopes_MultipleScopesInSingleRequest (0.00s)
=== RUN   TestValidateScopes_WithLeadingAndTrailingSpaces
--- PASS: TestValidateScopes_WithLeadingAndTrailingSpaces (0.00s)
=== RUN   TestValidateClientAndRedirectURI_ExtremelyLongClientId
--- PASS: TestValidateClientAndRedirectURI_ExtremelyLongClientId (0.00s)
=== RUN   TestValidateClientAndRedirectURI_ExtremelyLongRedirectURI
--- PASS: TestValidateClientAndRedirectURI_ExtremelyLongRedirectURI (0.00s)
=== RUN   TestValidateRequest_EmptyResponseMode
--- PASS: TestValidateRequest_EmptyResponseMode (0.00s)
=== RUN   TestValidateScopes_MaximumNumberOfScopes
--- PASS: TestValidateScopes_MaximumNumberOfScopes (0.01s)
=== RUN   TestValidateEmailAddress
=== RUN   TestValidateEmailAddress/Valid_email
=== RUN   TestValidateEmailAddress/Invalid_email_-_no_@
=== RUN   TestValidateEmailAddress/Invalid_email_-_no_domain
=== RUN   TestValidateEmailAddress/Invalid_email_-_double_dots
=== RUN   TestValidateEmailAddress/Invalid_email_-_starting_with_dot
=== RUN   TestValidateEmailAddress/Invalid_email_-_ending_with_dot
=== RUN   TestValidateEmailAddress/Valid_email_with_subdomains
--- PASS: TestValidateEmailAddress (0.00s)
    --- PASS: TestValidateEmailAddress/Valid_email (0.00s)
    --- PASS: TestValidateEmailAddress/Invalid_email_-_no_@ (0.00s)
    --- PASS: TestValidateEmailAddress/Invalid_email_-_no_domain (0.00s)
    --- PASS: TestValidateEmailAddress/Invalid_email_-_double_dots (0.00s)
    --- PASS: TestValidateEmailAddress/Invalid_email_-_starting_with_dot (0.00s)
    --- PASS: TestValidateEmailAddress/Invalid_email_-_ending_with_dot (0.00s)
    --- PASS: TestValidateEmailAddress/Valid_email_with_subdomains (0.00s)
=== RUN   TestValidateEmailUpdate
=== RUN   TestValidateEmailUpdate/Valid_email_update
=== RUN   TestValidateEmailUpdate/Empty_email
=== RUN   TestValidateEmailUpdate/Email_too_long
=== RUN   TestValidateEmailUpdate/Email_mismatch
=== RUN   TestValidateEmailUpdate/Email_already_registered
--- PASS: TestValidateEmailUpdate (0.00s)
    --- PASS: TestValidateEmailUpdate/Valid_email_update (0.00s)
    --- PASS: TestValidateEmailUpdate/Empty_email (0.00s)
    --- PASS: TestValidateEmailUpdate/Email_too_long (0.00s)
    --- PASS: TestValidateEmailUpdate/Email_mismatch (0.00s)
    --- PASS: TestValidateEmailUpdate/Email_already_registered (0.00s)
=== RUN   TestValidateIdentifier
=== RUN   TestValidateIdentifier/Valid_identifier
=== RUN   TestValidateIdentifier/Valid_identifier_with_underscore
=== RUN   TestValidateIdentifier/Valid_identifier_minimum_length
=== RUN   TestValidateIdentifier/Valid_identifier_not_enforcing_min_length
=== RUN   TestValidateIdentifier/Too_long_identifier
=== RUN   TestValidateIdentifier/Too_short_identifier
=== RUN   TestValidateIdentifier/Invalid_start_character
=== RUN   TestValidateIdentifier/Invalid_end_character
=== RUN   TestValidateIdentifier/Invalid_end_character_underscore
=== RUN   TestValidateIdentifier/Consecutive_dashes
=== RUN   TestValidateIdentifier/Consecutive_underscores
=== RUN   TestValidateIdentifier/Invalid_characters
--- PASS: TestValidateIdentifier (0.00s)
    --- PASS: TestValidateIdentifier/Valid_identifier (0.00s)
    --- PASS: TestValidateIdentifier/Valid_identifier_with_underscore (0.00s)
    --- PASS: TestValidateIdentifier/Valid_identifier_minimum_length (0.00s)
    --- PASS: TestValidateIdentifier/Valid_identifier_not_enforcing_min_length (0.00s)
    --- PASS: TestValidateIdentifier/Too_long_identifier (0.00s)
    --- PASS: TestValidateIdentifier/Too_short_identifier (0.00s)
    --- PASS: TestValidateIdentifier/Invalid_start_character (0.00s)
    --- PASS: TestValidateIdentifier/Invalid_end_character (0.00s)
    --- PASS: TestValidateIdentifier/Invalid_end_character_underscore (0.00s)
    --- PASS: TestValidateIdentifier/Consecutive_dashes (0.00s)
    --- PASS: TestValidateIdentifier/Consecutive_underscores (0.00s)
    --- PASS: TestValidateIdentifier/Invalid_characters (0.00s)
=== RUN   TestValidateIdentifierEdgeCases
=== RUN   TestValidateIdentifierEdgeCases/Empty_identifier_enforcing_min_length
=== RUN   TestValidateIdentifierEdgeCases/Empty_identifier_not_enforcing_min_length
=== RUN   TestValidateIdentifierEdgeCases/Max_length_identifier
=== RUN   TestValidateIdentifierEdgeCases/Just_over_max_length_identifier
=== RUN   TestValidateIdentifierEdgeCases/Single_character_identifier_not_enforcing_min_length
=== RUN   TestValidateIdentifierEdgeCases/Single_character_identifier_enforcing_min_length
--- PASS: TestValidateIdentifierEdgeCases (0.00s)
    --- PASS: TestValidateIdentifierEdgeCases/Empty_identifier_enforcing_min_length (0.00s)
    --- PASS: TestValidateIdentifierEdgeCases/Empty_identifier_not_enforcing_min_length (0.00s)
    --- PASS: TestValidateIdentifierEdgeCases/Max_length_identifier (0.00s)
    --- PASS: TestValidateIdentifierEdgeCases/Just_over_max_length_identifier (0.00s)
    --- PASS: TestValidateIdentifierEdgeCases/Single_character_identifier_not_enforcing_min_length (0.00s)
    --- PASS: TestValidateIdentifierEdgeCases/Single_character_identifier_enforcing_min_length (0.00s)
=== RUN   TestPasswordValidator_ValidatePassword
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyLow
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyLow/ValidPassword
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyLow/TooShort
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyLow/TooLong
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyMedium
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyMedium/ValidPassword
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyMedium/MissingUppercase
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyMedium/MissingLowercase
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyMedium/MissingNumber
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyHigh
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyHigh/ValidPassword
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyHigh/MissingSpecialChar
=== RUN   TestPasswordValidator_ValidatePassword/PasswordPolicyHigh/TooShort
--- PASS: TestPasswordValidator_ValidatePassword (0.00s)
    --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyLow (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyLow/ValidPassword (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyLow/TooShort (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyLow/TooLong (0.00s)
    --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyMedium (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyMedium/ValidPassword (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyMedium/MissingUppercase (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyMedium/MissingLowercase (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyMedium/MissingNumber (0.00s)
    --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyHigh (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyHigh/ValidPassword (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyHigh/MissingSpecialChar (0.00s)
        --- PASS: TestPasswordValidator_ValidatePassword/PasswordPolicyHigh/TooShort (0.00s)
=== RUN   TestPasswordValidator_ContainsLowerCase
--- PASS: TestPasswordValidator_ContainsLowerCase (0.00s)
=== RUN   TestPasswordValidator_ContainsUpperCase
--- PASS: TestPasswordValidator_ContainsUpperCase (0.00s)
=== RUN   TestPasswordValidator_ContainsNumber
--- PASS: TestPasswordValidator_ContainsNumber (0.00s)
=== RUN   TestPasswordValidator_ContainsSpecialChar
--- PASS: TestPasswordValidator_ContainsSpecialChar (0.00s)
=== RUN   TestValidatePhone
=== RUN   TestValidatePhone/Valid_phone_number
=== RUN   TestValidatePhone/Invalid_phone_country
=== RUN   TestValidatePhone/Missing_phone_number
=== RUN   TestValidatePhone/Phone_number_too_short
=== RUN   TestValidatePhone/Simple_pattern_phone_number
=== RUN   TestValidatePhone/Invalid_characters_in_phone_number
=== RUN   TestValidatePhone/Phone_number_too_long
=== RUN   TestValidatePhone/Missing_country_for_phone_number
--- PASS: TestValidatePhone (0.43s)
    --- PASS: TestValidatePhone/Valid_phone_number (0.07s)
    --- PASS: TestValidatePhone/Invalid_phone_country (0.06s)
    --- PASS: TestValidatePhone/Missing_phone_number (0.06s)
    --- PASS: TestValidatePhone/Phone_number_too_short (0.06s)
    --- PASS: TestValidatePhone/Simple_pattern_phone_number (0.06s)
    --- PASS: TestValidatePhone/Invalid_characters_in_phone_number (0.06s)
    --- PASS: TestValidatePhone/Phone_number_too_long (0.06s)
    --- PASS: TestValidatePhone/Missing_country_for_phone_number (0.00s)
=== RUN   TestIsSimplePattern
=== RUN   TestIsSimplePattern/Repeating_digit
=== RUN   TestIsSimplePattern/Ascending_sequence
=== RUN   TestIsSimplePattern/Descending_sequence
=== RUN   TestIsSimplePattern/Non-simple_pattern
=== RUN   TestIsSimplePattern/Mixed_pattern
--- PASS: TestIsSimplePattern (0.00s)
    --- PASS: TestIsSimplePattern/Repeating_digit (0.00s)
    --- PASS: TestIsSimplePattern/Ascending_sequence (0.00s)
    --- PASS: TestIsSimplePattern/Descending_sequence (0.00s)
    --- PASS: TestIsSimplePattern/Non-simple_pattern (0.00s)
    --- PASS: TestIsSimplePattern/Mixed_pattern (0.00s)
=== RUN   TestValidateTokenRequest
=== RUN   TestValidateTokenRequest/Missing_required_client_id
=== RUN   TestValidateTokenRequest/Client_does_not_exist
=== RUN   TestValidateTokenRequest/Client_is_disabled
--- PASS: TestValidateTokenRequest (0.00s)
    --- PASS: TestValidateTokenRequest/Missing_required_client_id (0.00s)
    --- PASS: TestValidateTokenRequest/Client_does_not_exist (0.00s)
    --- PASS: TestValidateTokenRequest/Client_is_disabled (0.00s)
=== RUN   TestValidateTokenRequest_AuthorizationCode
=== RUN   TestValidateTokenRequest_AuthorizationCode/Authorization_code_flow_not_enabled
=== RUN   TestValidateTokenRequest_AuthorizationCode/Missing_code_parameter
=== RUN   TestValidateTokenRequest_AuthorizationCode/Missing_redirect_uri_parameter
=== RUN   TestValidateTokenRequest_AuthorizationCode/Missing_code_verifier_parameter_when_PKCE_was_used
=== RUN   TestValidateTokenRequest_AuthorizationCode/Invalid_code
=== RUN   TestValidateTokenRequest_AuthorizationCode/Mismatched_redirect_URI
=== RUN   TestValidateTokenRequest_AuthorizationCode/Mismatched_client_id
=== RUN   TestValidateTokenRequest_AuthorizationCode/Disabled_user
=== RUN   TestValidateTokenRequest_AuthorizationCode/Expired_code
=== RUN   TestValidateTokenRequest_AuthorizationCode/Invalid_PKCE_code_verifier
=== RUN   TestValidateTokenRequest_AuthorizationCode/Missing_client_secret_for_non-public_client
=== RUN   TestValidateTokenRequest_AuthorizationCode/Client_authentication_failed_for_non-public_client
=== RUN   TestValidateTokenRequest_AuthorizationCode/Public_client_with_unnecessary_client_secret
=== RUN   TestValidateTokenRequest_AuthorizationCode/Valid_non-expired_code
=== RUN   TestValidateTokenRequest_AuthorizationCode/Public_client_with_valid_code_verifier
--- PASS: TestValidateTokenRequest_AuthorizationCode (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Authorization_code_flow_not_enabled (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Missing_code_parameter (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Missing_redirect_uri_parameter (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Missing_code_verifier_parameter_when_PKCE_was_used (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Invalid_code (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Mismatched_redirect_URI (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Mismatched_client_id (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Disabled_user (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Expired_code (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Invalid_PKCE_code_verifier (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Missing_client_secret_for_non-public_client (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Client_authentication_failed_for_non-public_client (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Public_client_with_unnecessary_client_secret (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Valid_non-expired_code (0.00s)
    --- PASS: TestValidateTokenRequest_AuthorizationCode/Public_client_with_valid_code_verifier (0.00s)
=== RUN   TestValidateTokenRequest_ClientCredentials
=== RUN   TestValidateTokenRequest_ClientCredentials/Client_credentials_flow_not_enabled
=== RUN   TestValidateTokenRequest_ClientCredentials/Public_client_not_eligible_for_client_credentials
=== RUN   TestValidateTokenRequest_ClientCredentials/Missing_client_secret
=== RUN   TestValidateTokenRequest_ClientCredentials/Valid_client_credentials_request
=== RUN   TestValidateTokenRequest_ClientCredentials/Invalid_client_secret
=== RUN   TestValidateTokenRequest_ClientCredentials/Valid_scope
=== RUN   TestValidateTokenRequest_ClientCredentials/Invalid_scope_format
=== RUN   TestValidateTokenRequest_ClientCredentials/Scope_not_granted_to_client
=== RUN   TestValidateTokenRequest_ClientCredentials/ID_token_scope_in_client_credentials
=== RUN   TestValidateTokenRequest_ClientCredentials/Non-existent_resource_in_scope
=== RUN   TestValidateTokenRequest_ClientCredentials/Non-existent_permission_in_scope
=== RUN   TestValidateTokenRequest_ClientCredentials/Multiple_valid_scopes
--- PASS: TestValidateTokenRequest_ClientCredentials (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Client_credentials_flow_not_enabled (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Public_client_not_eligible_for_client_credentials (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Missing_client_secret (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Valid_client_credentials_request (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Invalid_client_secret (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Valid_scope (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Invalid_scope_format (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Scope_not_granted_to_client (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/ID_token_scope_in_client_credentials (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Non-existent_resource_in_scope (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Non-existent_permission_in_scope (0.00s)
    --- PASS: TestValidateTokenRequest_ClientCredentials/Multiple_valid_scopes (0.00s)
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Client_with_authorization_code_flow_disabled
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Missing_client_secret_for_confidential_client
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Incorrect_client_secret_for_confidential_client
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Missing_refresh_token
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Invalid_refresh_token
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_without_JTI_claim
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_not_found_in_database
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_mismatched_client
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_for_disabled_user
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_nil_session
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_invalid_session
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Expired_offline_refresh_token
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Offline_refresh_token_without_max_lifetime_claim
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_invalid_typ_claim
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_scope_not_in_original_grant
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Valid_offline_refresh_token
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Valid_refresh_token_with_reduced_scope
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_revoked_consent
=== RUN   TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_revoked_user_permission
--- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Client_with_authorization_code_flow_disabled (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Missing_client_secret_for_confidential_client (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Incorrect_client_secret_for_confidential_client (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Missing_refresh_token (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Invalid_refresh_token (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_without_JTI_claim (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_not_found_in_database (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_mismatched_client (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_for_disabled_user (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_nil_session (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_invalid_session (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Expired_offline_refresh_token (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Offline_refresh_token_without_max_lifetime_claim (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_invalid_typ_claim (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_scope_not_in_original_grant (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Valid_offline_refresh_token (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Valid_refresh_token_with_reduced_scope (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_revoked_consent (0.00s)
    --- PASS: TestValidateTokenRequest_RefreshToken_AuthCodeDisabled/Refresh_token_with_revoked_user_permission (0.00s)
PASS
ok  	github.com/leodip/goiabada/core/validators	(cached)
?   	github.com/leodip/goiabada/core/validators/mocks	[no test files]
Running tests for admin console module...
?   	github.com/leodip/goiabada/adminconsole/cmd/goiabada-adminconsole	[no test files]
?   	github.com/leodip/goiabada/adminconsole/internal/apiclient	[no test files]
?   	github.com/leodip/goiabada/adminconsole/internal/cache	[no test files]
?   	github.com/leodip/goiabada/adminconsole/internal/dtos	[no test files]
testing: warning: no tests to run
PASS
ok  	github.com/leodip/goiabada/adminconsole/internal/handlers	(cached) [no tests to run]
testing: warning: no tests to run
PASS
ok  	github.com/leodip/goiabada/adminconsole/internal/handlers/accounthandlers	(cached) [no tests to run]
testing: warning: no tests to run
PASS
ok  	github.com/leodip/goiabada/adminconsole/internal/handlers/adminclienthandlers	(cached) [no tests to run]
testing: warning: no tests to run
PASS
ok  	github.com/leodip/goiabada/adminconsole/internal/handlers/admingrouphandlers	(cached) [no tests to run]
testing: warning: no tests to run
PASS
ok  	github.com/leodip/goiabada/adminconsole/internal/handlers/adminresourcehandlers	(cached) [no tests to run]
testing: warning: no tests to run
PASS
ok  	github.com/leodip/goiabada/adminconsole/internal/handlers/adminsettingshandlers	(cached) [no tests to run]
testing: warning: no tests to run
PASS
ok  	github.com/leodip/goiabada/adminconsole/internal/handlers/adminuserhandlers	(cached) [no tests to run]
?   	github.com/leodip/goiabada/adminconsole/internal/middleware	[no test files]
?   	github.com/leodip/goiabada/adminconsole/internal/server	[no test files]
?   	github.com/leodip/goiabada/adminconsole/internal/tcputils	[no test files]
?   	github.com/leodip/goiabada/adminconsole/internal/tcputils/mocks	[no test files]
?   	github.com/leodip/goiabada/adminconsole/web	[no test files]
Checking for processes on port 19090...
No processes found on port 19090
Checking for processes on port 19091...
No processes found on port 19091
Port 19090 is now free
Port 19091 is now free
=== Running data tests with mysql ===
Configuring for database: mysql
Running data tests...
2025/11/25 13:24:10 INFO running TestMain
2025/11/25 13:24:10 INFO running data tests for mysql
2025/11/25 13:24:10 INFO config.DBUsername=root
2025/11/25 13:24:10 INFO config.DBPassword=mySqlPass123
2025/11/25 13:24:10 INFO config.DBHost=mysql-server
2025/11/25 13:24:10 INFO config.DBPort=13306
2025/11/25 13:24:10 INFO config.DBName=goiabada_data
2025/11/25 13:24:10 INFO db type is mysql
2025/11/25 13:24:10 INFO creating mysql database
2025/11/25 13:24:10 INFO using database mysql
2025/11/25 13:24:10 INFO db username: root
2025/11/25 13:24:10 INFO db host: mysql-server
2025/11/25 13:24:10 INFO db port: 13306
2025/11/25 13:24:10 INFO db name: goiabada_data
2025/11/25 13:24:10 INFO no need to migrate the database
=== RUN   TestCreateClientPermission
--- PASS: TestCreateClientPermission (0.01s)
=== RUN   TestUpdateClientPermission
--- PASS: TestUpdateClientPermission (0.11s)
=== RUN   TestGetClientPermissionById
--- PASS: TestGetClientPermissionById (0.01s)
=== RUN   TestGetClientPermissionByClientIdAndPermissionId
--- PASS: TestGetClientPermissionByClientIdAndPermissionId (0.01s)
=== RUN   TestGetClientPermissionsByClientId
--- PASS: TestGetClientPermissionsByClientId (0.02s)
=== RUN   TestDeleteClientPermission
--- PASS: TestDeleteClientPermission (0.01s)
=== RUN   TestCreateClient
--- PASS: TestCreateClient (0.00s)
=== RUN   TestUpdateClient
--- PASS: TestUpdateClient (0.11s)
=== RUN   TestGetClientById
--- PASS: TestGetClientById (0.00s)
=== RUN   TestGetClientByClientIdentifier
--- PASS: TestGetClientByClientIdentifier (0.00s)
=== RUN   TestClientLoadRedirectURIs
--- PASS: TestClientLoadRedirectURIs (0.01s)
=== RUN   TestClientLoadWebOrigins
--- PASS: TestClientLoadWebOrigins (0.01s)
=== RUN   TestGetClientsByIds
--- PASS: TestGetClientsByIds (0.01s)
=== RUN   TestClientLoadPermissions
--- PASS: TestClientLoadPermissions (0.02s)
=== RUN   TestGetAllClients
--- PASS: TestGetAllClients (0.14s)
=== RUN   TestDeleteClient
--- PASS: TestDeleteClient (0.01s)
=== RUN   TestCreateCode
--- PASS: TestCreateCode (0.01s)
=== RUN   TestUpdateCode
--- PASS: TestUpdateCode (0.11s)
=== RUN   TestGetCodeById
--- PASS: TestGetCodeById (0.01s)
=== RUN   TestCodeLoadClient
--- PASS: TestCodeLoadClient (0.01s)
=== RUN   TestCodeLoadUser
--- PASS: TestCodeLoadUser (0.01s)
=== RUN   TestGetCodeByCodeHash
--- PASS: TestGetCodeByCodeHash (0.01s)
=== RUN   TestDeleteCode
--- PASS: TestDeleteCode (0.01s)
=== RUN   TestDeleteUsedCodesWithoutRefreshTokens
--- PASS: TestDeleteUsedCodesWithoutRefreshTokens (0.03s)
=== RUN   TestCreateGroupAttribute
--- PASS: TestCreateGroupAttribute (0.00s)
=== RUN   TestUpdateGroupAttribute
--- PASS: TestUpdateGroupAttribute (0.11s)
=== RUN   TestGetGroupAttributeById
--- PASS: TestGetGroupAttributeById (0.00s)
=== RUN   TestGetGroupAttributesByGroupIds
--- PASS: TestGetGroupAttributesByGroupIds (0.01s)
=== RUN   TestGetGroupAttributesByGroupId
--- PASS: TestGetGroupAttributesByGroupId (0.00s)
=== RUN   TestDeleteGroupAttribute
--- PASS: TestDeleteGroupAttribute (0.01s)
=== RUN   TestCreateGroupPermission
--- PASS: TestCreateGroupPermission (0.01s)
=== RUN   TestUpdateGroupPermission
--- PASS: TestUpdateGroupPermission (0.12s)
=== RUN   TestGetGroupPermissionsByGroupId
--- PASS: TestGetGroupPermissionsByGroupId (0.01s)
=== RUN   TestGetGroupPermissionsByGroupIds
--- PASS: TestGetGroupPermissionsByGroupIds (0.01s)
=== RUN   TestGetGroupPermissionById
--- PASS: TestGetGroupPermissionById (0.01s)
=== RUN   TestGetGroupPermissionByGroupIdAndPermissionId
--- PASS: TestGetGroupPermissionByGroupIdAndPermissionId (0.01s)
=== RUN   TestDeleteGroupPermission
--- PASS: TestDeleteGroupPermission (0.01s)
=== RUN   TestCreateGroup
--- PASS: TestCreateGroup (0.00s)
=== RUN   TestUpdateGroup
--- PASS: TestUpdateGroup (0.10s)
=== RUN   TestGetGroupById
--- PASS: TestGetGroupById (0.00s)
=== RUN   TestGetGroupByGroupIdentifier
--- PASS: TestGetGroupByGroupIdentifier (0.00s)
=== RUN   TestGetAllGroups
--- PASS: TestGetAllGroups (0.00s)
=== RUN   TestGetAllGroupsPaginated
--- PASS: TestGetAllGroupsPaginated (0.14s)
=== RUN   TestDeleteGroup
--- PASS: TestDeleteGroup (0.00s)
=== RUN   TestCreateHttpSession
--- PASS: TestCreateHttpSession (0.00s)
=== RUN   TestUpdateHttpSession
--- PASS: TestUpdateHttpSession (0.10s)
=== RUN   TestGetHttpSessionById
--- PASS: TestGetHttpSessionById (0.00s)
=== RUN   TestDeleteHttpSession
--- PASS: TestDeleteHttpSession (0.01s)
=== RUN   TestDeleteHttpSessionExpired
--- PASS: TestDeleteHttpSessionExpired (0.01s)
=== RUN   TestCreateKeyPair
--- PASS: TestCreateKeyPair (0.00s)
=== RUN   TestUpdateKeyPair
--- PASS: TestUpdateKeyPair (0.11s)
=== RUN   TestGetKeyPairById
--- PASS: TestGetKeyPairById (0.00s)
=== RUN   TestGetAllSigningKeys
--- PASS: TestGetAllSigningKeys (0.01s)
=== RUN   TestGetCurrentSigningKey
--- PASS: TestGetCurrentSigningKey (0.01s)
=== RUN   TestDeleteKeyPair
--- PASS: TestDeleteKeyPair (0.00s)
=== RUN   TestCreatePermission
--- PASS: TestCreatePermission (0.00s)
=== RUN   TestUpdatePermission
--- PASS: TestUpdatePermission (0.11s)
=== RUN   TestGetPermissionById
--- PASS: TestGetPermissionById (0.00s)
=== RUN   TestGetPermissionsByResourceId
--- PASS: TestGetPermissionsByResourceId (0.01s)
=== RUN   TestPermissionsLoadResources
--- PASS: TestPermissionsLoadResources (0.01s)
=== RUN   TestGetPermissionsByIds
--- PASS: TestGetPermissionsByIds (0.00s)
=== RUN   TestDeletePermission
--- PASS: TestDeletePermission (0.01s)
=== RUN   TestCreatePreRegistration
--- PASS: TestCreatePreRegistration (0.00s)
=== RUN   TestUpdatePreRegistration
--- PASS: TestUpdatePreRegistration (0.10s)
=== RUN   TestGetPreRegistrationById
--- PASS: TestGetPreRegistrationById (0.00s)
=== RUN   TestGetPreRegistrationByEmail
--- PASS: TestGetPreRegistrationByEmail (0.00s)
=== RUN   TestDeletePreRegistration
--- PASS: TestDeletePreRegistration (0.00s)
=== RUN   TestCreateRedirectURI
--- PASS: TestCreateRedirectURI (0.00s)
=== RUN   TestGetRedirectURIById
--- PASS: TestGetRedirectURIById (0.00s)
=== RUN   TestGetRedirectURIsByClientId
--- PASS: TestGetRedirectURIsByClientId (0.00s)
=== RUN   TestDeleteRedirectURI
--- PASS: TestDeleteRedirectURI (0.01s)
=== RUN   TestCreateRefreshToken
--- PASS: TestCreateRefreshToken (0.01s)
=== RUN   TestUpdateRefreshToken
--- PASS: TestUpdateRefreshToken (0.12s)
=== RUN   TestGetRefreshTokenById
--- PASS: TestGetRefreshTokenById (0.01s)
=== RUN   TestRefreshTokenLoadCode
--- PASS: TestRefreshTokenLoadCode (0.01s)
=== RUN   TestGetRefreshTokenByJti
--- PASS: TestGetRefreshTokenByJti (0.01s)
=== RUN   TestDeleteRefreshToken
--- PASS: TestDeleteRefreshToken (0.01s)
=== RUN   TestDeleteExpiredOrRevokedRefreshTokens
--- PASS: TestDeleteExpiredOrRevokedRefreshTokens (0.04s)
=== RUN   TestCreateResource
--- PASS: TestCreateResource (0.00s)
=== RUN   TestUpdateResource
--- PASS: TestUpdateResource (0.11s)
=== RUN   TestGetResourceById
--- PASS: TestGetResourceById (0.00s)
=== RUN   TestGetResourceByResourceIdentifier
--- PASS: TestGetResourceByResourceIdentifier (0.00s)
=== RUN   TestGetResourcesByIds
--- PASS: TestGetResourcesByIds (0.00s)
=== RUN   TestGetAllResources
--- PASS: TestGetAllResources (0.09s)
=== RUN   TestDeleteResource
--- PASS: TestDeleteResource (0.00s)
=== RUN   TestCreateSettings
--- PASS: TestCreateSettings (0.00s)
=== RUN   TestUpdateSettings
--- PASS: TestUpdateSettings (0.11s)
=== RUN   TestGetSettingsById
--- PASS: TestGetSettingsById (0.00s)
=== RUN   TestCreateUserAttribute
--- PASS: TestCreateUserAttribute (0.00s)
=== RUN   TestUpdateUserAttribute
--- PASS: TestUpdateUserAttribute (0.11s)
=== RUN   TestGetUserAttributeById
--- PASS: TestGetUserAttributeById (0.00s)
=== RUN   TestGetUserAttributesByUserId
--- PASS: TestGetUserAttributesByUserId (0.01s)
=== RUN   TestDeleteUserAttribute
--- PASS: TestDeleteUserAttribute (0.01s)
=== RUN   TestCreateUserConsent
--- PASS: TestCreateUserConsent (0.01s)
=== RUN   TestUpdateUserConsent
--- PASS: TestUpdateUserConsent (0.11s)
=== RUN   TestGetUserConsentById
--- PASS: TestGetUserConsentById (0.01s)
=== RUN   TestGetConsentByUserIdAndClientId
--- PASS: TestGetConsentByUserIdAndClientId (0.01s)
=== RUN   TestUserConsentsLoadClients
--- PASS: TestUserConsentsLoadClients (0.01s)
=== RUN   TestGetConsentsByUserId
--- PASS: TestGetConsentsByUserId (0.01s)
=== RUN   TestDeleteUserConsent
--- PASS: TestDeleteUserConsent (0.01s)
=== RUN   TestCreateUserGroup
--- PASS: TestCreateUserGroup (0.01s)
=== RUN   TestUpdateUserGroup
--- PASS: TestUpdateUserGroup (0.11s)
=== RUN   TestGetUserGroupById
--- PASS: TestGetUserGroupById (0.01s)
=== RUN   TestGetUserGroupsByUserIds
--- PASS: TestGetUserGroupsByUserIds (0.01s)
=== RUN   TestGetUserGroupsByUserId
--- PASS: TestGetUserGroupsByUserId (0.01s)
=== RUN   TestGetUserGroupByUserIdAndGroupId
--- PASS: TestGetUserGroupByUserIdAndGroupId (0.01s)
=== RUN   TestDeleteUserGroup
--- PASS: TestDeleteUserGroup (0.01s)
=== RUN   TestCreateUserPermission
--- PASS: TestCreateUserPermission (0.01s)
=== RUN   TestUpdateUserPermission
--- PASS: TestUpdateUserPermission (0.12s)
=== RUN   TestGetUserPermissionById
--- PASS: TestGetUserPermissionById (0.01s)
=== RUN   TestGetUserPermissionsByUserIds
--- PASS: TestGetUserPermissionsByUserIds (0.01s)
=== RUN   TestGetUserPermissionsByUserId
--- PASS: TestGetUserPermissionsByUserId (0.01s)
=== RUN   TestGetUserPermissionByUserIdAndPermissionId
--- PASS: TestGetUserPermissionByUserIdAndPermissionId (0.01s)
=== RUN   TestGetUsersByPermissionIdPaginated
--- PASS: TestGetUsersByPermissionIdPaginated (0.09s)
=== RUN   TestDeleteUserPermission
--- PASS: TestDeleteUserPermission (0.01s)
=== RUN   TestCreateUserSessionClient
--- PASS: TestCreateUserSessionClient (0.01s)
=== RUN   TestUpdateUserSessionClient
--- PASS: TestUpdateUserSessionClient (0.12s)
=== RUN   TestGetUserSessionClientById
--- PASS: TestGetUserSessionClientById (0.01s)
=== RUN   TestGetUserSessionClientsByUserSessionId
--- PASS: TestGetUserSessionClientsByUserSessionId (0.01s)
=== RUN   TestDeleteUserSessionClient
--- PASS: TestDeleteUserSessionClient (0.01s)
=== RUN   TestCreateUserSession
--- PASS: TestCreateUserSession (0.00s)
=== RUN   TestUpdateUserSession
--- PASS: TestUpdateUserSession (0.11s)
=== RUN   TestGetUserSessionById
--- PASS: TestGetUserSessionById (0.00s)
=== RUN   TestGetUserSessionBySessionIdentifier
--- PASS: TestGetUserSessionBySessionIdentifier (0.00s)
=== RUN   TestGetUserSessionsByClientIdPaginated
--- PASS: TestGetUserSessionsByClientIdPaginated (0.10s)
=== RUN   TestUserSessionsLoadUsers
--- PASS: TestUserSessionsLoadUsers (0.01s)
=== RUN   TestUserSessionsLoadClients
--- PASS: TestUserSessionsLoadClients (0.02s)
=== RUN   TestUserSessionLoadClients
--- PASS: TestUserSessionLoadClients (0.01s)
=== RUN   TestUserSessionLoadUser
--- PASS: TestUserSessionLoadUser (0.00s)
=== RUN   TestGetUserSessionsByUserId
--- PASS: TestGetUserSessionsByUserId (0.01s)
=== RUN   TestDeleteUserSession
--- PASS: TestDeleteUserSession (0.01s)
=== RUN   TestDeleteIdleSessions
--- PASS: TestDeleteIdleSessions (0.02s)
=== RUN   TestDeleteExpiredSessions
--- PASS: TestDeleteExpiredSessions (0.02s)
=== RUN   TestCreateUser
--- PASS: TestCreateUser (0.00s)
=== RUN   TestUpdateUser
--- PASS: TestUpdateUser (0.10s)
=== RUN   TestGetUserById
--- PASS: TestGetUserById (0.00s)
=== RUN   TestGetUserByUsername
--- PASS: TestGetUserByUsername (0.00s)
=== RUN   TestGetUserBySubject
--- PASS: TestGetUserBySubject (0.00s)
=== RUN   TestGetUserByEmail
--- PASS: TestGetUserByEmail (0.00s)
=== RUN   TestSearchUsersPaginated
--- PASS: TestSearchUsersPaginated (0.01s)
=== RUN   TestDeleteUser
--- PASS: TestDeleteUser (0.01s)
=== RUN   TestCreateWebOrigin
--- PASS: TestCreateWebOrigin (0.00s)
=== RUN   TestGetWebOriginById
--- PASS: TestGetWebOriginById (0.00s)
=== RUN   TestGetWebOriginsByClientId
--- PASS: TestGetWebOriginsByClientId (0.01s)
=== RUN   TestGetAllWebOrigins
--- PASS: TestGetAllWebOrigins (0.01s)
=== RUN   TestDeleteWebOrigin
--- PASS: TestDeleteWebOrigin (0.01s)
PASS
ok  	github.com/leodip/goiabada/authserver/tests/data	3.598s
=== Completed data tests with mysql ===

=== Running data tests with postgres ===
Configuring for database: postgres
Running data tests...
2025/11/25 13:24:14 INFO running TestMain
2025/11/25 13:24:14 INFO running data tests for postgres
2025/11/25 13:24:14 INFO config.DBUsername=postgres
2025/11/25 13:24:14 INFO config.DBPassword=myPostgresPass123
2025/11/25 13:24:14 INFO config.DBHost=postgres-server
2025/11/25 13:24:14 INFO config.DBPort=15432
2025/11/25 13:24:14 INFO config.DBName=goiabada_data
2025/11/25 13:24:14 INFO db type is postgres
2025/11/25 13:24:14 INFO creating postgres database
2025/11/25 13:24:14 INFO using database postgres
2025/11/25 13:24:14 INFO db username: postgres
2025/11/25 13:24:14 INFO db host: postgres-server
2025/11/25 13:24:14 INFO db port: 15432
2025/11/25 13:24:14 INFO db name: goiabada_data
2025/11/25 13:24:14 INFO no need to migrate the database
=== RUN   TestCreateClientPermission
--- PASS: TestCreateClientPermission (0.01s)
=== RUN   TestUpdateClientPermission
--- PASS: TestUpdateClientPermission (0.10s)
=== RUN   TestGetClientPermissionById
--- PASS: TestGetClientPermissionById (0.00s)
=== RUN   TestGetClientPermissionByClientIdAndPermissionId
--- PASS: TestGetClientPermissionByClientIdAndPermissionId (0.00s)
=== RUN   TestGetClientPermissionsByClientId
--- PASS: TestGetClientPermissionsByClientId (0.00s)
=== RUN   TestDeleteClientPermission
--- PASS: TestDeleteClientPermission (0.00s)
=== RUN   TestCreateClient
--- PASS: TestCreateClient (0.00s)
=== RUN   TestUpdateClient
--- PASS: TestUpdateClient (0.10s)
=== RUN   TestGetClientById
--- PASS: TestGetClientById (0.00s)
=== RUN   TestGetClientByClientIdentifier
--- PASS: TestGetClientByClientIdentifier (0.00s)
=== RUN   TestClientLoadRedirectURIs
--- PASS: TestClientLoadRedirectURIs (0.00s)
=== RUN   TestClientLoadWebOrigins
--- PASS: TestClientLoadWebOrigins (0.00s)
=== RUN   TestGetClientsByIds
--- PASS: TestGetClientsByIds (0.00s)
=== RUN   TestClientLoadPermissions
--- PASS: TestClientLoadPermissions (0.00s)
=== RUN   TestGetAllClients
--- PASS: TestGetAllClients (0.04s)
=== RUN   TestDeleteClient
--- PASS: TestDeleteClient (0.00s)
=== RUN   TestCreateCode
--- PASS: TestCreateCode (0.00s)
=== RUN   TestUpdateCode
--- PASS: TestUpdateCode (0.10s)
=== RUN   TestGetCodeById
--- PASS: TestGetCodeById (0.00s)
=== RUN   TestCodeLoadClient
--- PASS: TestCodeLoadClient (0.00s)
=== RUN   TestCodeLoadUser
--- PASS: TestCodeLoadUser (0.00s)
=== RUN   TestGetCodeByCodeHash
--- PASS: TestGetCodeByCodeHash (0.00s)
=== RUN   TestDeleteCode
--- PASS: TestDeleteCode (0.00s)
=== RUN   TestDeleteUsedCodesWithoutRefreshTokens
--- PASS: TestDeleteUsedCodesWithoutRefreshTokens (0.01s)
=== RUN   TestCreateGroupAttribute
--- PASS: TestCreateGroupAttribute (0.00s)
=== RUN   TestUpdateGroupAttribute
--- PASS: TestUpdateGroupAttribute (0.10s)
=== RUN   TestGetGroupAttributeById
--- PASS: TestGetGroupAttributeById (0.00s)
=== RUN   TestGetGroupAttributesByGroupIds
--- PASS: TestGetGroupAttributesByGroupIds (0.00s)
=== RUN   TestGetGroupAttributesByGroupId
--- PASS: TestGetGroupAttributesByGroupId (0.00s)
=== RUN   TestDeleteGroupAttribute
--- PASS: TestDeleteGroupAttribute (0.00s)
=== RUN   TestCreateGroupPermission
--- PASS: TestCreateGroupPermission (0.00s)
=== RUN   TestUpdateGroupPermission
--- PASS: TestUpdateGroupPermission (0.11s)
=== RUN   TestGetGroupPermissionsByGroupId
--- PASS: TestGetGroupPermissionsByGroupId (0.01s)
=== RUN   TestGetGroupPermissionsByGroupIds
--- PASS: TestGetGroupPermissionsByGroupIds (0.00s)
=== RUN   TestGetGroupPermissionById
--- PASS: TestGetGroupPermissionById (0.00s)
=== RUN   TestGetGroupPermissionByGroupIdAndPermissionId
--- PASS: TestGetGroupPermissionByGroupIdAndPermissionId (0.00s)
=== RUN   TestDeleteGroupPermission
--- PASS: TestDeleteGroupPermission (0.00s)
=== RUN   TestCreateGroup
--- PASS: TestCreateGroup (0.00s)
=== RUN   TestUpdateGroup
--- PASS: TestUpdateGroup (0.10s)
=== RUN   TestGetGroupById
--- PASS: TestGetGroupById (0.00s)
=== RUN   TestGetGroupByGroupIdentifier
--- PASS: TestGetGroupByGroupIdentifier (0.00s)
=== RUN   TestGetAllGroups
--- PASS: TestGetAllGroups (0.00s)
=== RUN   TestGetAllGroupsPaginated
--- PASS: TestGetAllGroupsPaginated (0.04s)
=== RUN   TestDeleteGroup
--- PASS: TestDeleteGroup (0.00s)
=== RUN   TestCreateHttpSession
--- PASS: TestCreateHttpSession (0.00s)
=== RUN   TestUpdateHttpSession
--- PASS: TestUpdateHttpSession (0.10s)
=== RUN   TestGetHttpSessionById
--- PASS: TestGetHttpSessionById (0.00s)
=== RUN   TestDeleteHttpSession
--- PASS: TestDeleteHttpSession (0.00s)
=== RUN   TestDeleteHttpSessionExpired
--- PASS: TestDeleteHttpSessionExpired (0.00s)
=== RUN   TestCreateKeyPair
--- PASS: TestCreateKeyPair (0.00s)
=== RUN   TestUpdateKeyPair
--- PASS: TestUpdateKeyPair (0.10s)
=== RUN   TestGetKeyPairById
--- PASS: TestGetKeyPairById (0.00s)
=== RUN   TestGetAllSigningKeys
--- PASS: TestGetAllSigningKeys (0.00s)
=== RUN   TestGetCurrentSigningKey
--- PASS: TestGetCurrentSigningKey (0.00s)
=== RUN   TestDeleteKeyPair
--- PASS: TestDeleteKeyPair (0.00s)
=== RUN   TestCreatePermission
--- PASS: TestCreatePermission (0.00s)
=== RUN   TestUpdatePermission
--- PASS: TestUpdatePermission (0.11s)
=== RUN   TestGetPermissionById
--- PASS: TestGetPermissionById (0.00s)
=== RUN   TestGetPermissionsByResourceId
--- PASS: TestGetPermissionsByResourceId (0.00s)
=== RUN   TestPermissionsLoadResources
--- PASS: TestPermissionsLoadResources (0.00s)
=== RUN   TestGetPermissionsByIds
--- PASS: TestGetPermissionsByIds (0.00s)
=== RUN   TestDeletePermission
--- PASS: TestDeletePermission (0.00s)
=== RUN   TestCreatePreRegistration
--- PASS: TestCreatePreRegistration (0.00s)
=== RUN   TestUpdatePreRegistration
--- PASS: TestUpdatePreRegistration (0.10s)
=== RUN   TestGetPreRegistrationById
--- PASS: TestGetPreRegistrationById (0.00s)
=== RUN   TestGetPreRegistrationByEmail
--- PASS: TestGetPreRegistrationByEmail (0.00s)
=== RUN   TestDeletePreRegistration
--- PASS: TestDeletePreRegistration (0.00s)
=== RUN   TestCreateRedirectURI
--- PASS: TestCreateRedirectURI (0.00s)
=== RUN   TestGetRedirectURIById
--- PASS: TestGetRedirectURIById (0.00s)
=== RUN   TestGetRedirectURIsByClientId
--- PASS: TestGetRedirectURIsByClientId (0.00s)
=== RUN   TestDeleteRedirectURI
--- PASS: TestDeleteRedirectURI (0.00s)
=== RUN   TestCreateRefreshToken
--- PASS: TestCreateRefreshToken (0.00s)
=== RUN   TestUpdateRefreshToken
--- PASS: TestUpdateRefreshToken (0.11s)
=== RUN   TestGetRefreshTokenById
--- PASS: TestGetRefreshTokenById (0.00s)
=== RUN   TestRefreshTokenLoadCode
--- PASS: TestRefreshTokenLoadCode (0.00s)
=== RUN   TestGetRefreshTokenByJti
--- PASS: TestGetRefreshTokenByJti (0.00s)
=== RUN   TestDeleteRefreshToken
--- PASS: TestDeleteRefreshToken (0.00s)
=== RUN   TestDeleteExpiredOrRevokedRefreshTokens
--- PASS: TestDeleteExpiredOrRevokedRefreshTokens (0.01s)
=== RUN   TestCreateResource
--- PASS: TestCreateResource (0.00s)
=== RUN   TestUpdateResource
--- PASS: TestUpdateResource (0.10s)
=== RUN   TestGetResourceById
--- PASS: TestGetResourceById (0.00s)
=== RUN   TestGetResourceByResourceIdentifier
--- PASS: TestGetResourceByResourceIdentifier (0.00s)
=== RUN   TestGetResourcesByIds
--- PASS: TestGetResourcesByIds (0.00s)
=== RUN   TestGetAllResources
--- PASS: TestGetAllResources (0.03s)
=== RUN   TestDeleteResource
--- PASS: TestDeleteResource (0.00s)
=== RUN   TestCreateSettings
--- PASS: TestCreateSettings (0.00s)
=== RUN   TestUpdateSettings
--- PASS: TestUpdateSettings (0.10s)
=== RUN   TestGetSettingsById
--- PASS: TestGetSettingsById (0.00s)
=== RUN   TestCreateUserAttribute
--- PASS: TestCreateUserAttribute (0.00s)
=== RUN   TestUpdateUserAttribute
--- PASS: TestUpdateUserAttribute (0.11s)
=== RUN   TestGetUserAttributeById
--- PASS: TestGetUserAttributeById (0.00s)
=== RUN   TestGetUserAttributesByUserId
--- PASS: TestGetUserAttributesByUserId (0.00s)
=== RUN   TestDeleteUserAttribute
--- PASS: TestDeleteUserAttribute (0.00s)
=== RUN   TestCreateUserConsent
--- PASS: TestCreateUserConsent (0.00s)
=== RUN   TestUpdateUserConsent
--- PASS: TestUpdateUserConsent (0.10s)
=== RUN   TestGetUserConsentById
--- PASS: TestGetUserConsentById (0.00s)
=== RUN   TestGetConsentByUserIdAndClientId
--- PASS: TestGetConsentByUserIdAndClientId (0.00s)
=== RUN   TestUserConsentsLoadClients
--- PASS: TestUserConsentsLoadClients (0.00s)
=== RUN   TestGetConsentsByUserId
--- PASS: TestGetConsentsByUserId (0.00s)
=== RUN   TestDeleteUserConsent
--- PASS: TestDeleteUserConsent (0.00s)
=== RUN   TestCreateUserGroup
--- PASS: TestCreateUserGroup (0.00s)
=== RUN   TestUpdateUserGroup
--- PASS: TestUpdateUserGroup (0.11s)
=== RUN   TestGetUserGroupById
--- PASS: TestGetUserGroupById (0.00s)
=== RUN   TestGetUserGroupsByUserIds
--- PASS: TestGetUserGroupsByUserIds (0.00s)
=== RUN   TestGetUserGroupsByUserId
--- PASS: TestGetUserGroupsByUserId (0.00s)
=== RUN   TestGetUserGroupByUserIdAndGroupId
--- PASS: TestGetUserGroupByUserIdAndGroupId (0.00s)
=== RUN   TestDeleteUserGroup
--- PASS: TestDeleteUserGroup (0.00s)
=== RUN   TestCreateUserPermission
--- PASS: TestCreateUserPermission (0.00s)
=== RUN   TestUpdateUserPermission
--- PASS: TestUpdateUserPermission (0.11s)
=== RUN   TestGetUserPermissionById
--- PASS: TestGetUserPermissionById (0.00s)
=== RUN   TestGetUserPermissionsByUserIds
--- PASS: TestGetUserPermissionsByUserIds (0.00s)
=== RUN   TestGetUserPermissionsByUserId
--- PASS: TestGetUserPermissionsByUserId (0.00s)
=== RUN   TestGetUserPermissionByUserIdAndPermissionId
--- PASS: TestGetUserPermissionByUserIdAndPermissionId (0.00s)
=== RUN   TestGetUsersByPermissionIdPaginated
--- PASS: TestGetUsersByPermissionIdPaginated (0.03s)
=== RUN   TestDeleteUserPermission
--- PASS: TestDeleteUserPermission (0.00s)
=== RUN   TestCreateUserSessionClient
--- PASS: TestCreateUserSessionClient (0.00s)
=== RUN   TestUpdateUserSessionClient
--- PASS: TestUpdateUserSessionClient (0.11s)
=== RUN   TestGetUserSessionClientById
--- PASS: TestGetUserSessionClientById (0.00s)
=== RUN   TestGetUserSessionClientsByUserSessionId
--- PASS: TestGetUserSessionClientsByUserSessionId (0.00s)
=== RUN   TestDeleteUserSessionClient
--- PASS: TestDeleteUserSessionClient (0.00s)
=== RUN   TestCreateUserSession
--- PASS: TestCreateUserSession (0.00s)
=== RUN   TestUpdateUserSession
--- PASS: TestUpdateUserSession (0.10s)
=== RUN   TestGetUserSessionById
--- PASS: TestGetUserSessionById (0.00s)
=== RUN   TestGetUserSessionBySessionIdentifier
--- PASS: TestGetUserSessionBySessionIdentifier (0.00s)
=== RUN   TestGetUserSessionsByClientIdPaginated
--- PASS: TestGetUserSessionsByClientIdPaginated (0.03s)
=== RUN   TestUserSessionsLoadUsers
--- PASS: TestUserSessionsLoadUsers (0.00s)
=== RUN   TestUserSessionsLoadClients
--- PASS: TestUserSessionsLoadClients (0.01s)
=== RUN   TestUserSessionLoadClients
--- PASS: TestUserSessionLoadClients (0.00s)
=== RUN   TestUserSessionLoadUser
--- PASS: TestUserSessionLoadUser (0.00s)
=== RUN   TestGetUserSessionsByUserId
--- PASS: TestGetUserSessionsByUserId (0.00s)
=== RUN   TestDeleteUserSession
--- PASS: TestDeleteUserSession (0.00s)
=== RUN   TestDeleteIdleSessions
--- PASS: TestDeleteIdleSessions (0.01s)
=== RUN   TestDeleteExpiredSessions
--- PASS: TestDeleteExpiredSessions (0.00s)
=== RUN   TestCreateUser
--- PASS: TestCreateUser (0.00s)
=== RUN   TestUpdateUser
--- PASS: TestUpdateUser (0.10s)
=== RUN   TestGetUserById
--- PASS: TestGetUserById (0.00s)
=== RUN   TestGetUserByUsername
--- PASS: TestGetUserByUsername (0.00s)
=== RUN   TestGetUserBySubject
--- PASS: TestGetUserBySubject (0.00s)
=== RUN   TestGetUserByEmail
--- PASS: TestGetUserByEmail (0.00s)
=== RUN   TestSearchUsersPaginated
--- PASS: TestSearchUsersPaginated (0.00s)
=== RUN   TestDeleteUser
--- PASS: TestDeleteUser (0.00s)
=== RUN   TestCreateWebOrigin
--- PASS: TestCreateWebOrigin (0.00s)
=== RUN   TestGetWebOriginById
--- PASS: TestGetWebOriginById (0.00s)
=== RUN   TestGetWebOriginsByClientId
--- PASS: TestGetWebOriginsByClientId (0.00s)
=== RUN   TestGetAllWebOrigins
--- PASS: TestGetAllWebOrigins (0.00s)
=== RUN   TestDeleteWebOrigin
--- PASS: TestDeleteWebOrigin (0.00s)
PASS
ok  	github.com/leodip/goiabada/authserver/tests/data	2.552s
=== Completed data tests with postgres ===

=== Running data tests with mssql ===
Configuring for database: mssql
Running data tests...
2025/11/25 13:24:17 INFO running TestMain
2025/11/25 13:24:17 INFO running data tests for mssql
2025/11/25 13:24:17 INFO db type is mssql
2025/11/25 13:24:17 INFO creating mssql database
2025/11/25 13:24:17 INFO using database mssql
2025/11/25 13:24:17 INFO db username: sa
2025/11/25 13:24:17 INFO db host: mssql-server
2025/11/25 13:24:17 INFO db port: 11433
2025/11/25 13:24:17 INFO db name: goiabada_data
2025/11/25 13:24:17 INFO no need to migrate the database
=== RUN   TestCreateClientPermission
--- PASS: TestCreateClientPermission (0.01s)
=== RUN   TestUpdateClientPermission
--- PASS: TestUpdateClientPermission (0.11s)
=== RUN   TestGetClientPermissionById
--- PASS: TestGetClientPermissionById (0.00s)
=== RUN   TestGetClientPermissionByClientIdAndPermissionId
--- PASS: TestGetClientPermissionByClientIdAndPermissionId (0.00s)
=== RUN   TestGetClientPermissionsByClientId
--- PASS: TestGetClientPermissionsByClientId (0.01s)
=== RUN   TestDeleteClientPermission
--- PASS: TestDeleteClientPermission (0.01s)
=== RUN   TestCreateClient
--- PASS: TestCreateClient (0.00s)
=== RUN   TestUpdateClient
--- PASS: TestUpdateClient (0.11s)
=== RUN   TestGetClientById
--- PASS: TestGetClientById (0.00s)
=== RUN   TestGetClientByClientIdentifier
--- PASS: TestGetClientByClientIdentifier (0.00s)
=== RUN   TestClientLoadRedirectURIs
--- PASS: TestClientLoadRedirectURIs (0.01s)
=== RUN   TestClientLoadWebOrigins
--- PASS: TestClientLoadWebOrigins (0.01s)
=== RUN   TestGetClientsByIds
--- PASS: TestGetClientsByIds (0.00s)
=== RUN   TestClientLoadPermissions
--- PASS: TestClientLoadPermissions (0.01s)
=== RUN   TestGetAllClients
--- PASS: TestGetAllClients (0.11s)
=== RUN   TestDeleteClient
--- PASS: TestDeleteClient (0.01s)
=== RUN   TestCreateCode
--- PASS: TestCreateCode (0.01s)
=== RUN   TestUpdateCode
--- PASS: TestUpdateCode (0.11s)
=== RUN   TestGetCodeById
--- PASS: TestGetCodeById (0.01s)
=== RUN   TestCodeLoadClient
--- PASS: TestCodeLoadClient (0.00s)
=== RUN   TestCodeLoadUser
--- PASS: TestCodeLoadUser (0.00s)
=== RUN   TestGetCodeByCodeHash
--- PASS: TestGetCodeByCodeHash (0.01s)
=== RUN   TestDeleteCode
--- PASS: TestDeleteCode (0.01s)
=== RUN   TestDeleteUsedCodesWithoutRefreshTokens
--- PASS: TestDeleteUsedCodesWithoutRefreshTokens (0.02s)
=== RUN   TestCreateGroupAttribute
--- PASS: TestCreateGroupAttribute (0.00s)
=== RUN   TestUpdateGroupAttribute
--- PASS: TestUpdateGroupAttribute (0.11s)
=== RUN   TestGetGroupAttributeById
--- PASS: TestGetGroupAttributeById (0.00s)
=== RUN   TestGetGroupAttributesByGroupIds
--- PASS: TestGetGroupAttributesByGroupIds (0.01s)
=== RUN   TestGetGroupAttributesByGroupId
--- PASS: TestGetGroupAttributesByGroupId (0.00s)
=== RUN   TestDeleteGroupAttribute
--- PASS: TestDeleteGroupAttribute (0.00s)
=== RUN   TestCreateGroupPermission
--- PASS: TestCreateGroupPermission (0.00s)
=== RUN   TestUpdateGroupPermission
--- PASS: TestUpdateGroupPermission (0.11s)
=== RUN   TestGetGroupPermissionsByGroupId
--- PASS: TestGetGroupPermissionsByGroupId (0.01s)
=== RUN   TestGetGroupPermissionsByGroupIds
--- PASS: TestGetGroupPermissionsByGroupIds (0.01s)
=== RUN   TestGetGroupPermissionById
--- PASS: TestGetGroupPermissionById (0.01s)
=== RUN   TestGetGroupPermissionByGroupIdAndPermissionId
--- PASS: TestGetGroupPermissionByGroupIdAndPermissionId (0.00s)
=== RUN   TestDeleteGroupPermission
--- PASS: TestDeleteGroupPermission (0.01s)
=== RUN   TestCreateGroup
--- PASS: TestCreateGroup (0.00s)
=== RUN   TestUpdateGroup
--- PASS: TestUpdateGroup (0.11s)
=== RUN   TestGetGroupById
--- PASS: TestGetGroupById (0.00s)
=== RUN   TestGetGroupByGroupIdentifier
--- PASS: TestGetGroupByGroupIdentifier (0.00s)
=== RUN   TestGetAllGroups
--- PASS: TestGetAllGroups (0.00s)
=== RUN   TestGetAllGroupsPaginated
--- PASS: TestGetAllGroupsPaginated (0.09s)
=== RUN   TestDeleteGroup
--- PASS: TestDeleteGroup (0.00s)
=== RUN   TestCreateHttpSession
--- PASS: TestCreateHttpSession (0.00s)
=== RUN   TestUpdateHttpSession
--- PASS: TestUpdateHttpSession (0.10s)
=== RUN   TestGetHttpSessionById
--- PASS: TestGetHttpSessionById (0.00s)
=== RUN   TestDeleteHttpSession
--- PASS: TestDeleteHttpSession (0.00s)
=== RUN   TestDeleteHttpSessionExpired
--- PASS: TestDeleteHttpSessionExpired (0.00s)
=== RUN   TestCreateKeyPair
--- PASS: TestCreateKeyPair (0.00s)
=== RUN   TestUpdateKeyPair
--- PASS: TestUpdateKeyPair (0.11s)
=== RUN   TestGetKeyPairById
--- PASS: TestGetKeyPairById (0.00s)
=== RUN   TestGetAllSigningKeys
--- PASS: TestGetAllSigningKeys (0.01s)
=== RUN   TestGetCurrentSigningKey
--- PASS: TestGetCurrentSigningKey (0.01s)
=== RUN   TestDeleteKeyPair
--- PASS: TestDeleteKeyPair (0.00s)
=== RUN   TestCreatePermission
--- PASS: TestCreatePermission (0.00s)
=== RUN   TestUpdatePermission
--- PASS: TestUpdatePermission (0.11s)
=== RUN   TestGetPermissionById
--- PASS: TestGetPermissionById (0.00s)
=== RUN   TestGetPermissionsByResourceId
--- PASS: TestGetPermissionsByResourceId (0.00s)
=== RUN   TestPermissionsLoadResources
--- PASS: TestPermissionsLoadResources (0.00s)
=== RUN   TestGetPermissionsByIds
--- PASS: TestGetPermissionsByIds (0.00s)
=== RUN   TestDeletePermission
--- PASS: TestDeletePermission (0.00s)
=== RUN   TestCreatePreRegistration
--- PASS: TestCreatePreRegistration (0.00s)
=== RUN   TestUpdatePreRegistration
--- PASS: TestUpdatePreRegistration (0.11s)
=== RUN   TestGetPreRegistrationById
--- PASS: TestGetPreRegistrationById (0.00s)
=== RUN   TestGetPreRegistrationByEmail
--- PASS: TestGetPreRegistrationByEmail (0.00s)
=== RUN   TestDeletePreRegistration
--- PASS: TestDeletePreRegistration (0.00s)
=== RUN   TestCreateRedirectURI
--- PASS: TestCreateRedirectURI (0.00s)
=== RUN   TestGetRedirectURIById
--- PASS: TestGetRedirectURIById (0.00s)
=== RUN   TestGetRedirectURIsByClientId
--- PASS: TestGetRedirectURIsByClientId (0.00s)
=== RUN   TestDeleteRedirectURI
--- PASS: TestDeleteRedirectURI (0.00s)
=== RUN   TestCreateRefreshToken
--- PASS: TestCreateRefreshToken (0.01s)
=== RUN   TestUpdateRefreshToken
--- PASS: TestUpdateRefreshToken (0.12s)
=== RUN   TestGetRefreshTokenById
--- PASS: TestGetRefreshTokenById (0.01s)
=== RUN   TestRefreshTokenLoadCode
--- PASS: TestRefreshTokenLoadCode (0.01s)
=== RUN   TestGetRefreshTokenByJti
--- PASS: TestGetRefreshTokenByJti (0.01s)
=== RUN   TestDeleteRefreshToken
--- PASS: TestDeleteRefreshToken (0.01s)
=== RUN   TestDeleteExpiredOrRevokedRefreshTokens
--- PASS: TestDeleteExpiredOrRevokedRefreshTokens (0.03s)
=== RUN   TestCreateResource
--- PASS: TestCreateResource (0.00s)
=== RUN   TestUpdateResource
--- PASS: TestUpdateResource (0.10s)
=== RUN   TestGetResourceById
--- PASS: TestGetResourceById (0.00s)
=== RUN   TestGetResourceByResourceIdentifier
--- PASS: TestGetResourceByResourceIdentifier (0.00s)
=== RUN   TestGetResourcesByIds
--- PASS: TestGetResourcesByIds (0.00s)
=== RUN   TestGetAllResources
--- PASS: TestGetAllResources (0.08s)
=== RUN   TestDeleteResource
--- PASS: TestDeleteResource (0.00s)
=== RUN   TestCreateSettings
--- PASS: TestCreateSettings (0.00s)
=== RUN   TestUpdateSettings
--- PASS: TestUpdateSettings (0.10s)
=== RUN   TestGetSettingsById
--- PASS: TestGetSettingsById (0.00s)
=== RUN   TestCreateUserAttribute
--- PASS: TestCreateUserAttribute (0.00s)
=== RUN   TestUpdateUserAttribute
--- PASS: TestUpdateUserAttribute (0.11s)
=== RUN   TestGetUserAttributeById
--- PASS: TestGetUserAttributeById (0.00s)
=== RUN   TestGetUserAttributesByUserId
--- PASS: TestGetUserAttributesByUserId (0.01s)
=== RUN   TestDeleteUserAttribute
--- PASS: TestDeleteUserAttribute (0.01s)
=== RUN   TestCreateUserConsent
--- PASS: TestCreateUserConsent (0.01s)
=== RUN   TestUpdateUserConsent
--- PASS: TestUpdateUserConsent (0.11s)
=== RUN   TestGetUserConsentById
--- PASS: TestGetUserConsentById (0.01s)
=== RUN   TestGetConsentByUserIdAndClientId
--- PASS: TestGetConsentByUserIdAndClientId (0.01s)
=== RUN   TestUserConsentsLoadClients
--- PASS: TestUserConsentsLoadClients (0.01s)
=== RUN   TestGetConsentsByUserId
--- PASS: TestGetConsentsByUserId (0.01s)
=== RUN   TestDeleteUserConsent
--- PASS: TestDeleteUserConsent (0.01s)
=== RUN   TestCreateUserGroup
--- PASS: TestCreateUserGroup (0.01s)
=== RUN   TestUpdateUserGroup
--- PASS: TestUpdateUserGroup (0.11s)
=== RUN   TestGetUserGroupById
--- PASS: TestGetUserGroupById (0.01s)
=== RUN   TestGetUserGroupsByUserIds
--- PASS: TestGetUserGroupsByUserIds (0.01s)
=== RUN   TestGetUserGroupsByUserId
--- PASS: TestGetUserGroupsByUserId (0.01s)
=== RUN   TestGetUserGroupByUserIdAndGroupId
--- PASS: TestGetUserGroupByUserIdAndGroupId (0.01s)
=== RUN   TestDeleteUserGroup
--- PASS: TestDeleteUserGroup (0.01s)
=== RUN   TestCreateUserPermission
--- PASS: TestCreateUserPermission (0.01s)
=== RUN   TestUpdateUserPermission
--- PASS: TestUpdateUserPermission (0.11s)
=== RUN   TestGetUserPermissionById
--- PASS: TestGetUserPermissionById (0.01s)
=== RUN   TestGetUserPermissionsByUserIds
--- PASS: TestGetUserPermissionsByUserIds (0.01s)
=== RUN   TestGetUserPermissionsByUserId
--- PASS: TestGetUserPermissionsByUserId (0.01s)
=== RUN   TestGetUserPermissionByUserIdAndPermissionId
--- PASS: TestGetUserPermissionByUserIdAndPermissionId (0.01s)
=== RUN   TestGetUsersByPermissionIdPaginated
--- PASS: TestGetUsersByPermissionIdPaginated (0.10s)
=== RUN   TestDeleteUserPermission
--- PASS: TestDeleteUserPermission (0.01s)
=== RUN   TestCreateUserSessionClient
--- PASS: TestCreateUserSessionClient (0.01s)
=== RUN   TestUpdateUserSessionClient
--- PASS: TestUpdateUserSessionClient (0.11s)
=== RUN   TestGetUserSessionClientById
--- PASS: TestGetUserSessionClientById (0.01s)
=== RUN   TestGetUserSessionClientsByUserSessionId
--- PASS: TestGetUserSessionClientsByUserSessionId (0.01s)
=== RUN   TestDeleteUserSessionClient
--- PASS: TestDeleteUserSessionClient (0.01s)
=== RUN   TestCreateUserSession
--- PASS: TestCreateUserSession (0.01s)
=== RUN   TestUpdateUserSession
--- PASS: TestUpdateUserSession (0.11s)
=== RUN   TestGetUserSessionById
--- PASS: TestGetUserSessionById (0.00s)
=== RUN   TestGetUserSessionBySessionIdentifier
--- PASS: TestGetUserSessionBySessionIdentifier (0.00s)
=== RUN   TestGetUserSessionsByClientIdPaginated
--- PASS: TestGetUserSessionsByClientIdPaginated (0.07s)
=== RUN   TestUserSessionsLoadUsers
--- PASS: TestUserSessionsLoadUsers (0.01s)
=== RUN   TestUserSessionsLoadClients
--- PASS: TestUserSessionsLoadClients (0.01s)
=== RUN   TestUserSessionLoadClients
--- PASS: TestUserSessionLoadClients (0.01s)
=== RUN   TestUserSessionLoadUser
--- PASS: TestUserSessionLoadUser (0.00s)
=== RUN   TestGetUserSessionsByUserId
--- PASS: TestGetUserSessionsByUserId (0.01s)
=== RUN   TestDeleteUserSession
--- PASS: TestDeleteUserSession (0.01s)
=== RUN   TestDeleteIdleSessions
--- PASS: TestDeleteIdleSessions (0.02s)
=== RUN   TestDeleteExpiredSessions
--- PASS: TestDeleteExpiredSessions (0.02s)
=== RUN   TestCreateUser
--- PASS: TestCreateUser (0.00s)
=== RUN   TestUpdateUser
--- PASS: TestUpdateUser (0.11s)
=== RUN   TestGetUserById
--- PASS: TestGetUserById (0.00s)
=== RUN   TestGetUserByUsername
--- PASS: TestGetUserByUsername (0.00s)
=== RUN   TestGetUserBySubject
--- PASS: TestGetUserBySubject (0.00s)
=== RUN   TestGetUserByEmail
--- PASS: TestGetUserByEmail (0.00s)
=== RUN   TestSearchUsersPaginated
--- PASS: TestSearchUsersPaginated (0.04s)
=== RUN   TestDeleteUser
--- PASS: TestDeleteUser (0.01s)
=== RUN   TestCreateWebOrigin
--- PASS: TestCreateWebOrigin (0.00s)
=== RUN   TestGetWebOriginById
--- PASS: TestGetWebOriginById (0.00s)
=== RUN   TestGetWebOriginsByClientId
--- PASS: TestGetWebOriginsByClientId (0.00s)
=== RUN   TestGetAllWebOrigins
--- PASS: TestGetAllWebOrigins (0.01s)
=== RUN   TestDeleteWebOrigin
--- PASS: TestDeleteWebOrigin (0.00s)
PASS
ok  	github.com/leodip/goiabada/authserver/tests/data	3.384s
=== Completed data tests with mssql ===

=== Running data tests with sqlite ===
Configuring for database: sqlite
Running data tests...
2025/11/25 13:24:21 INFO running TestMain
2025/11/25 13:24:21 INFO running data tests for sqlite
2025/11/25 13:24:21 INFO config.DBDSN=/tmp/goiabada_data.db
2025/11/25 13:24:21 INFO db type is sqlite
2025/11/25 13:24:21 INFO creating sqlite database
2025/11/25 13:24:21 INFO using database sqlite
2025/11/25 13:24:21 INFO db dsn: /tmp/goiabada_data.db
2025/11/25 13:24:21 INFO connected to sqlite database with required PRAGMA settings
=== RUN   TestCreateClientPermission
--- PASS: TestCreateClientPermission (0.00s)
=== RUN   TestUpdateClientPermission
--- PASS: TestUpdateClientPermission (0.10s)
=== RUN   TestGetClientPermissionById
--- PASS: TestGetClientPermissionById (0.00s)
=== RUN   TestGetClientPermissionByClientIdAndPermissionId
--- PASS: TestGetClientPermissionByClientIdAndPermissionId (0.00s)
=== RUN   TestGetClientPermissionsByClientId
--- PASS: TestGetClientPermissionsByClientId (0.00s)
=== RUN   TestDeleteClientPermission
--- PASS: TestDeleteClientPermission (0.00s)
=== RUN   TestCreateClient
--- PASS: TestCreateClient (0.00s)
=== RUN   TestUpdateClient
--- PASS: TestUpdateClient (0.10s)
=== RUN   TestGetClientById
--- PASS: TestGetClientById (0.00s)
=== RUN   TestGetClientByClientIdentifier
--- PASS: TestGetClientByClientIdentifier (0.00s)
=== RUN   TestClientLoadRedirectURIs
--- PASS: TestClientLoadRedirectURIs (0.00s)
=== RUN   TestClientLoadWebOrigins
--- PASS: TestClientLoadWebOrigins (0.00s)
=== RUN   TestGetClientsByIds
--- PASS: TestGetClientsByIds (0.00s)
=== RUN   TestClientLoadPermissions
--- PASS: TestClientLoadPermissions (0.00s)
=== RUN   TestGetAllClients
--- PASS: TestGetAllClients (0.00s)
=== RUN   TestDeleteClient
--- PASS: TestDeleteClient (0.00s)
=== RUN   TestCreateCode
--- PASS: TestCreateCode (0.00s)
=== RUN   TestUpdateCode
--- PASS: TestUpdateCode (0.10s)
=== RUN   TestGetCodeById
--- PASS: TestGetCodeById (0.00s)
=== RUN   TestCodeLoadClient
--- PASS: TestCodeLoadClient (0.00s)
=== RUN   TestCodeLoadUser
--- PASS: TestCodeLoadUser (0.00s)
=== RUN   TestGetCodeByCodeHash
--- PASS: TestGetCodeByCodeHash (0.00s)
=== RUN   TestDeleteCode
--- PASS: TestDeleteCode (0.00s)
=== RUN   TestDeleteUsedCodesWithoutRefreshTokens
--- PASS: TestDeleteUsedCodesWithoutRefreshTokens (0.00s)
=== RUN   TestCreateGroupAttribute
--- PASS: TestCreateGroupAttribute (0.00s)
=== RUN   TestUpdateGroupAttribute
--- PASS: TestUpdateGroupAttribute (0.10s)
=== RUN   TestGetGroupAttributeById
--- PASS: TestGetGroupAttributeById (0.00s)
=== RUN   TestGetGroupAttributesByGroupIds
--- PASS: TestGetGroupAttributesByGroupIds (0.00s)
=== RUN   TestGetGroupAttributesByGroupId
--- PASS: TestGetGroupAttributesByGroupId (0.00s)
=== RUN   TestDeleteGroupAttribute
--- PASS: TestDeleteGroupAttribute (0.00s)
=== RUN   TestCreateGroupPermission
--- PASS: TestCreateGroupPermission (0.00s)
=== RUN   TestUpdateGroupPermission
--- PASS: TestUpdateGroupPermission (0.10s)
=== RUN   TestGetGroupPermissionsByGroupId
--- PASS: TestGetGroupPermissionsByGroupId (0.00s)
=== RUN   TestGetGroupPermissionsByGroupIds
--- PASS: TestGetGroupPermissionsByGroupIds (0.00s)
=== RUN   TestGetGroupPermissionById
--- PASS: TestGetGroupPermissionById (0.00s)
=== RUN   TestGetGroupPermissionByGroupIdAndPermissionId
--- PASS: TestGetGroupPermissionByGroupIdAndPermissionId (0.00s)
=== RUN   TestDeleteGroupPermission
--- PASS: TestDeleteGroupPermission (0.00s)
=== RUN   TestCreateGroup
--- PASS: TestCreateGroup (0.00s)
=== RUN   TestUpdateGroup
--- PASS: TestUpdateGroup (0.10s)
=== RUN   TestGetGroupById
--- PASS: TestGetGroupById (0.00s)
=== RUN   TestGetGroupByGroupIdentifier
--- PASS: TestGetGroupByGroupIdentifier (0.00s)
=== RUN   TestGetAllGroups
--- PASS: TestGetAllGroups (0.00s)
=== RUN   TestGetAllGroupsPaginated
--- PASS: TestGetAllGroupsPaginated (0.00s)
=== RUN   TestDeleteGroup
--- PASS: TestDeleteGroup (0.00s)
=== RUN   TestCreateHttpSession
--- PASS: TestCreateHttpSession (0.00s)
=== RUN   TestUpdateHttpSession
--- PASS: TestUpdateHttpSession (0.10s)
=== RUN   TestGetHttpSessionById
--- PASS: TestGetHttpSessionById (0.00s)
=== RUN   TestDeleteHttpSession
--- PASS: TestDeleteHttpSession (0.00s)
=== RUN   TestDeleteHttpSessionExpired
--- PASS: TestDeleteHttpSessionExpired (0.00s)
=== RUN   TestCreateKeyPair
--- PASS: TestCreateKeyPair (0.00s)
=== RUN   TestUpdateKeyPair
--- PASS: TestUpdateKeyPair (0.10s)
=== RUN   TestGetKeyPairById
--- PASS: TestGetKeyPairById (0.00s)
=== RUN   TestGetAllSigningKeys
--- PASS: TestGetAllSigningKeys (0.00s)
=== RUN   TestGetCurrentSigningKey
--- PASS: TestGetCurrentSigningKey (0.00s)
=== RUN   TestDeleteKeyPair
--- PASS: TestDeleteKeyPair (0.00s)
=== RUN   TestCreatePermission
--- PASS: TestCreatePermission (0.00s)
=== RUN   TestUpdatePermission
--- PASS: TestUpdatePermission (0.10s)
=== RUN   TestGetPermissionById
--- PASS: TestGetPermissionById (0.00s)
=== RUN   TestGetPermissionsByResourceId
--- PASS: TestGetPermissionsByResourceId (0.00s)
=== RUN   TestPermissionsLoadResources
--- PASS: TestPermissionsLoadResources (0.00s)
=== RUN   TestGetPermissionsByIds
--- PASS: TestGetPermissionsByIds (0.00s)
=== RUN   TestDeletePermission
--- PASS: TestDeletePermission (0.00s)
=== RUN   TestCreatePreRegistration
--- PASS: TestCreatePreRegistration (0.00s)
=== RUN   TestUpdatePreRegistration
--- PASS: TestUpdatePreRegistration (0.10s)
=== RUN   TestGetPreRegistrationById
--- PASS: TestGetPreRegistrationById (0.00s)
=== RUN   TestGetPreRegistrationByEmail
--- PASS: TestGetPreRegistrationByEmail (0.00s)
=== RUN   TestDeletePreRegistration
--- PASS: TestDeletePreRegistration (0.00s)
=== RUN   TestCreateRedirectURI
--- PASS: TestCreateRedirectURI (0.00s)
=== RUN   TestGetRedirectURIById
--- PASS: TestGetRedirectURIById (0.00s)
=== RUN   TestGetRedirectURIsByClientId
--- PASS: TestGetRedirectURIsByClientId (0.00s)
=== RUN   TestDeleteRedirectURI
--- PASS: TestDeleteRedirectURI (0.00s)
=== RUN   TestCreateRefreshToken
--- PASS: TestCreateRefreshToken (0.00s)
=== RUN   TestUpdateRefreshToken
--- PASS: TestUpdateRefreshToken (0.10s)
=== RUN   TestGetRefreshTokenById
--- PASS: TestGetRefreshTokenById (0.00s)
=== RUN   TestRefreshTokenLoadCode
--- PASS: TestRefreshTokenLoadCode (0.00s)
=== RUN   TestGetRefreshTokenByJti
--- PASS: TestGetRefreshTokenByJti (0.00s)
=== RUN   TestDeleteRefreshToken
--- PASS: TestDeleteRefreshToken (0.00s)
=== RUN   TestDeleteExpiredOrRevokedRefreshTokens
--- PASS: TestDeleteExpiredOrRevokedRefreshTokens (0.00s)
=== RUN   TestCreateResource
--- PASS: TestCreateResource (0.00s)
=== RUN   TestUpdateResource
--- PASS: TestUpdateResource (0.10s)
=== RUN   TestGetResourceById
--- PASS: TestGetResourceById (0.00s)
=== RUN   TestGetResourceByResourceIdentifier
--- PASS: TestGetResourceByResourceIdentifier (0.00s)
=== RUN   TestGetResourcesByIds
--- PASS: TestGetResourcesByIds (0.00s)
=== RUN   TestGetAllResources
--- PASS: TestGetAllResources (0.00s)
=== RUN   TestDeleteResource
--- PASS: TestDeleteResource (0.00s)
=== RUN   TestCreateSettings
--- PASS: TestCreateSettings (0.00s)
=== RUN   TestUpdateSettings
--- PASS: TestUpdateSettings (0.10s)
=== RUN   TestGetSettingsById
--- PASS: TestGetSettingsById (0.00s)
=== RUN   TestCreateUserAttribute
--- PASS: TestCreateUserAttribute (0.00s)
=== RUN   TestUpdateUserAttribute
--- PASS: TestUpdateUserAttribute (0.10s)
=== RUN   TestGetUserAttributeById
--- PASS: TestGetUserAttributeById (0.00s)
=== RUN   TestGetUserAttributesByUserId
--- PASS: TestGetUserAttributesByUserId (0.00s)
=== RUN   TestDeleteUserAttribute
--- PASS: TestDeleteUserAttribute (0.00s)
=== RUN   TestCreateUserConsent
--- PASS: TestCreateUserConsent (0.00s)
=== RUN   TestUpdateUserConsent
--- PASS: TestUpdateUserConsent (0.10s)
=== RUN   TestGetUserConsentById
--- PASS: TestGetUserConsentById (0.00s)
=== RUN   TestGetConsentByUserIdAndClientId
--- PASS: TestGetConsentByUserIdAndClientId (0.00s)
=== RUN   TestUserConsentsLoadClients
--- PASS: TestUserConsentsLoadClients (0.00s)
=== RUN   TestGetConsentsByUserId
--- PASS: TestGetConsentsByUserId (0.00s)
=== RUN   TestDeleteUserConsent
--- PASS: TestDeleteUserConsent (0.00s)
=== RUN   TestCreateUserGroup
--- PASS: TestCreateUserGroup (0.00s)
=== RUN   TestUpdateUserGroup
--- PASS: TestUpdateUserGroup (0.10s)
=== RUN   TestGetUserGroupById
--- PASS: TestGetUserGroupById (0.00s)
=== RUN   TestGetUserGroupsByUserIds
--- PASS: TestGetUserGroupsByUserIds (0.00s)
=== RUN   TestGetUserGroupsByUserId
--- PASS: TestGetUserGroupsByUserId (0.00s)
=== RUN   TestGetUserGroupByUserIdAndGroupId
--- PASS: TestGetUserGroupByUserIdAndGroupId (0.00s)
=== RUN   TestDeleteUserGroup
--- PASS: TestDeleteUserGroup (0.00s)
=== RUN   TestCreateUserPermission
--- PASS: TestCreateUserPermission (0.00s)
=== RUN   TestUpdateUserPermission
--- PASS: TestUpdateUserPermission (0.10s)
=== RUN   TestGetUserPermissionById
--- PASS: TestGetUserPermissionById (0.00s)
=== RUN   TestGetUserPermissionsByUserIds
--- PASS: TestGetUserPermissionsByUserIds (0.00s)
=== RUN   TestGetUserPermissionsByUserId
--- PASS: TestGetUserPermissionsByUserId (0.00s)
=== RUN   TestGetUserPermissionByUserIdAndPermissionId
--- PASS: TestGetUserPermissionByUserIdAndPermissionId (0.00s)
=== RUN   TestGetUsersByPermissionIdPaginated
--- PASS: TestGetUsersByPermissionIdPaginated (0.00s)
=== RUN   TestDeleteUserPermission
--- PASS: TestDeleteUserPermission (0.00s)
=== RUN   TestCreateUserSessionClient
--- PASS: TestCreateUserSessionClient (0.00s)
=== RUN   TestUpdateUserSessionClient
--- PASS: TestUpdateUserSessionClient (0.10s)
=== RUN   TestGetUserSessionClientById
--- PASS: TestGetUserSessionClientById (0.00s)
=== RUN   TestGetUserSessionClientsByUserSessionId
--- PASS: TestGetUserSessionClientsByUserSessionId (0.00s)
=== RUN   TestDeleteUserSessionClient
--- PASS: TestDeleteUserSessionClient (0.00s)
=== RUN   TestCreateUserSession
--- PASS: TestCreateUserSession (0.00s)
=== RUN   TestUpdateUserSession
--- PASS: TestUpdateUserSession (0.10s)
=== RUN   TestGetUserSessionById
--- PASS: TestGetUserSessionById (0.00s)
=== RUN   TestGetUserSessionBySessionIdentifier
--- PASS: TestGetUserSessionBySessionIdentifier (0.00s)
=== RUN   TestGetUserSessionsByClientIdPaginated
--- PASS: TestGetUserSessionsByClientIdPaginated (0.00s)
=== RUN   TestUserSessionsLoadUsers
--- PASS: TestUserSessionsLoadUsers (0.00s)
=== RUN   TestUserSessionsLoadClients
--- PASS: TestUserSessionsLoadClients (0.00s)
=== RUN   TestUserSessionLoadClients
--- PASS: TestUserSessionLoadClients (0.00s)
=== RUN   TestUserSessionLoadUser
--- PASS: TestUserSessionLoadUser (0.00s)
=== RUN   TestGetUserSessionsByUserId
--- PASS: TestGetUserSessionsByUserId (0.00s)
=== RUN   TestDeleteUserSession
--- PASS: TestDeleteUserSession (0.00s)
=== RUN   TestDeleteIdleSessions
--- PASS: TestDeleteIdleSessions (0.00s)
=== RUN   TestDeleteExpiredSessions
--- PASS: TestDeleteExpiredSessions (0.00s)
=== RUN   TestCreateUser
--- PASS: TestCreateUser (0.00s)
=== RUN   TestUpdateUser
--- PASS: TestUpdateUser (0.10s)
=== RUN   TestGetUserById
--- PASS: TestGetUserById (0.00s)
=== RUN   TestGetUserByUsername
--- PASS: TestGetUserByUsername (0.00s)
=== RUN   TestGetUserBySubject
--- PASS: TestGetUserBySubject (0.00s)
=== RUN   TestGetUserByEmail
--- PASS: TestGetUserByEmail (0.00s)
=== RUN   TestSearchUsersPaginated
--- PASS: TestSearchUsersPaginated (0.00s)
=== RUN   TestDeleteUser
--- PASS: TestDeleteUser (0.00s)
=== RUN   TestCreateWebOrigin
--- PASS: TestCreateWebOrigin (0.00s)
=== RUN   TestGetWebOriginById
--- PASS: TestGetWebOriginById (0.00s)
=== RUN   TestGetWebOriginsByClientId
--- PASS: TestGetWebOriginsByClientId (0.00s)
=== RUN   TestGetAllWebOrigins
--- PASS: TestGetAllWebOrigins (0.00s)
=== RUN   TestDeleteWebOrigin
--- PASS: TestDeleteWebOrigin (0.00s)
PASS
ok  	github.com/leodip/goiabada/authserver/tests/data	2.068s
=== Completed data tests with sqlite ===

=== Running integration tests with mysql ===
Configuring for database: mysql
Started server with PID: 132422
Waiting for the server to start...
BROWSER=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/bin/helpers/browser.sh
COLORTERM=truecolor
DEBIAN_FRONTEND=noninteractive
DISPLAY=:0
DOCKER_BUILDKIT=1
GIT_ASKPASS=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/extensions/git/dist/askpass.sh
GOIABADA_ADMINCONSOLE_BASEURL=http://localhost:19091
GOIABADA_ADMINCONSOLE_CERTFILE=
GOIABADA_ADMINCONSOLE_KEYFILE=
GOIABADA_ADMINCONSOLE_LISTEN_HOST_HTTP=0.0.0.0
GOIABADA_ADMINCONSOLE_LISTEN_HOST_HTTPS=0.0.0.0
GOIABADA_ADMINCONSOLE_LISTEN_PORT_HTTP=19091
GOIABADA_ADMINCONSOLE_LISTEN_PORT_HTTPS=19444
GOIABADA_ADMINCONSOLE_LOG_HTTP_REQUESTS=true
GOIABADA_ADMINCONSOLE_OAUTH_CLIENT_ID=admin-console-client
GOIABADA_ADMINCONSOLE_OAUTH_CLIENT_SECRET=devcontainer-admin-console-secret-0123456789abcdef
GOIABADA_ADMINCONSOLE_SESSION_AUTHENTICATION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210
GOIABADA_ADMINCONSOLE_SESSION_ENCRYPTION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210
GOIABADA_ADMINCONSOLE_STATICDIR=
GOIABADA_ADMINCONSOLE_TEMPLATEDIR=
GOIABADA_ADMINCONSOLE_TRUST_PROXY_HEADERS=false
GOIABADA_ADMIN_EMAIL=admin@example.com
GOIABADA_ADMIN_PASSWORD=changeme
GOIABADA_APPNAME=Goiabada
GOIABADA_AUTHSERVER_AUDIT_LOGS_IN_CONSOLE=true
GOIABADA_AUTHSERVER_BASEURL=http://localhost:19090
GOIABADA_AUTHSERVER_CERTFILE=
GOIABADA_AUTHSERVER_DEBUG_API_REQUESTS=false
GOIABADA_AUTHSERVER_INTERNALBASEURL=
GOIABADA_AUTHSERVER_KEYFILE=
GOIABADA_AUTHSERVER_LISTEN_HOST_HTTP=0.0.0.0
GOIABADA_AUTHSERVER_LISTEN_HOST_HTTPS=0.0.0.0
GOIABADA_AUTHSERVER_LISTEN_PORT_HTTP=19090
GOIABADA_AUTHSERVER_LISTEN_PORT_HTTPS=19443
GOIABADA_AUTHSERVER_LOG_HTTP_REQUESTS=true
GOIABADA_AUTHSERVER_LOG_SQL=false
GOIABADA_AUTHSERVER_RATELIMITER_ENABLED=false
GOIABADA_AUTHSERVER_SESSION_AUTHENTICATION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
GOIABADA_AUTHSERVER_SESSION_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
GOIABADA_AUTHSERVER_STATICDIR=
GOIABADA_AUTHSERVER_TEMPLATEDIR=
GOIABADA_AUTHSERVER_TRUST_PROXY_HEADERS=false
GOIABADA_DB_DSN=
GOIABADA_DB_HOST=mysql-server
GOIABADA_DB_NAME=goiabada_integration
GOIABADA_DB_PASSWORD=mySqlPass123
GOIABADA_DB_PORT=13306
GOIABADA_DB_TYPE=mysql
GOIABADA_DB_USERNAME=root
HOME=/root
HOSTNAME=a357f2e3b56e
LANG=en_US.UTF-8
LESSCLOSE=/usr/bin/lesspipe %s %s
LESSOPEN=| /usr/bin/lesspipe %s
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=00:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.avif=01;35:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:*~=00;90:*#=00;90:*.bak=00;90:*.crdownload=00;90:*.dpkg-dist=00;90:*.dpkg-new=00;90:*.dpkg-old=00;90:*.dpkg-tmp=00;90:*.old=00;90:*.orig=00;90:*.part=00;90:*.rej=00;90:*.rpmnew=00;90:*.rpmorig=00;90:*.rpmsave=00;90:*.swp=00;90:*.tmp=00;90:*.ucf-dist=00;90:*.ucf-new=00;90:*.ucf-old=00;90:
OLDPWD=/workspaces/goiabada/src
PATH=/opt/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/go/bin:/root/go/bin
PWD=/workspaces/goiabada/src/authserver
REMOTE_CONTAINERS=true
REMOTE_CONTAINERS_DISPLAY_SOCK=/tmp/.X11-unix/X0
REMOTE_CONTAINERS_IPC=/tmp/vscode-remote-containers-ipc-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock
REMOTE_CONTAINERS_SOCKETS=["/tmp/vscode-ssh-auth-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock","/tmp/.X11-unix/X0","/root/.gnupg/S.gpg-agent"]
SHELL=/bin/bash
SHLVL=3
SSH_AUTH_SOCK=/tmp/vscode-ssh-auth-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock
TERM=xterm-256color
TERM_PROGRAM=vscode
TERM_PROGRAM_VERSION=1.106.2
TZ=Europe/Lisbon
VSCODE_GIT_ASKPASS_EXTRA_ARGS=
VSCODE_GIT_ASKPASS_MAIN=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/extensions/git/dist/askpass-main.js
VSCODE_GIT_ASKPASS_NODE=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/node
VSCODE_GIT_IPC_HANDLE=/tmp/user/0/vscode-git-27ddbaf538.sock
VSCODE_IPC_HOOK_CLI=/tmp/vscode-ipc-8cdca7a1-b8b6-4c1d-9f11-9fd95bbdc4c8.sock
VSCODE_PYTHON_AUTOACTIVATE_GUARD=1
WAYLAND_DISPLAY=vscode-wayland-7cc23a66-0244-472f-8cfe-838db66f3a44.sock
XDG_RUNTIME_DIR=/tmp/user/0
_=/usr/bin/env
2025/11/25 13:24:23 INFO auth server started
2025/11/25 13:24:23 INFO goiabada version: development
2025/11/25 13:24:23 INFO build date: development
2025/11/25 13:24:23 INFO git commit: development
2025/11/25 13:24:23 INFO config loaded
2025/11/25 13:24:23 INFO auth server base URL: http://localhost:19090
2025/11/25 13:24:23 INFO auth server internal base URL: 
2025/11/25 13:24:23 INFO admin console base URL: http://localhost:19091
2025/11/25 13:24:23 INFO debug API requests: false
2025/11/25 13:24:23 INFO current working directory: /workspaces/goiabada/src/authserver
2025/11/25 13:24:23 INFO timezones loaded
2025/11/25 13:24:23 INFO current time zone is: Europe/Lisbon
2025/11/25 13:24:23 INFO current local time is: 2025-11-25 13:24:23.563895587 +0000 WET m=+0.002465990
2025/11/25 13:24:23 INFO current UTC time is: 2025-11-25 13:24:23.563900527 +0000 UTC
2025/11/25 13:24:23 INFO db type is mysql
2025/11/25 13:24:23 INFO creating mysql database
2025/11/25 13:24:23 INFO using database mysql
2025/11/25 13:24:23 INFO db username: root
2025/11/25 13:24:23 INFO db host: mysql-server
2025/11/25 13:24:23 INFO db port: 13306
2025/11/25 13:24:23 INFO db name: goiabada_integration
Server is not ready yet. Retrying...
2025/11/25 13:24:23 INFO no need to migrate the database
2025/11/25 13:24:23 INFO created database connection
2025/11/25 13:24:23 INFO database already initialized, proceeding with normal startup
2025/11/25 13:24:23 INFO session keys validated
2025/11/25 13:24:23 INFO set cookie secure: false
2025/11/25 13:24:23 INFO initialized chunked cookie session store
2025/11/25 13:24:23 INFO using embedded static files directory
2025/11/25 13:24:23 INFO using embedded template files directory
2025/11/25 13:24:23 INFO background worker service started
2025/11/25 13:24:23 INFO initializing middleware
2025/11/25 13:24:23 INFO not adding real ip middleware
2025/11/25 13:24:23 INFO http request logging enabled
2025/11/25 13:24:23 INFO CSRF middleware configured trustedOrigins="[localhost:19090 localhost:19091]" secure=false
2025/11/25 13:24:23 INFO finished initializing middleware
2025/11/25 13:24:23 INFO listen host https: 0.0.0.0
2025/11/25 13:24:23 INFO listen port https: 19443
2025/11/25 13:24:23 INFO cert file: 
2025/11/25 13:24:23 INFO key file: 
2025/11/25 13:24:23 INFO https enabled: false
2025/11/25 13:24:23 INFO listen host http: 0.0.0.0
2025/11/25 13:24:23 INFO listen port http: 19090
2025/11/25 13:24:23 INFO http enabled: true
2025/11/25 13:24:23 WARN === WARNING ===
2025/11/25 13:24:23 WARN You are running the auth server with HTTP (without TLS/HTTPS).
2025/11/25 13:24:23 WARN This is HIGHLY INSECURE unless you are:
2025/11/25 13:24:23 WARN   1. Only doing development/testing, OR
2025/11/25 13:24:23 WARN   2. Running behind a reverse proxy that handles HTTPS
2025/11/25 13:24:23 WARN 
2025/11/25 13:24:23 WARN In production environments, you should either:
2025/11/25 13:24:23 WARN   - Enable HTTPS configuration, OR
2025/11/25 13:24:23 WARN   - Ensure your reverse proxy handles HTTPS properly
2025/11/25 13:24:23 WARN ===============
2025/11/25 13:24:23 INFO starting HTTP server on 0.0.0.0:19090
Server is up and running
Running integration tests...
2025/11/25 13:24:25 INFO running TestMain
2025/11/25 13:24:25 INFO config.DBUsername=root
2025/11/25 13:24:25 INFO config.DBPassword=mySqlPass123
2025/11/25 13:24:25 INFO config.DBHost=mysql-server
2025/11/25 13:24:25 INFO config.DBPort=13306
2025/11/25 13:24:25 INFO config.DBName=goiabada_integration
2025/11/25 13:24:25 INFO db type is mysql
2025/11/25 13:24:25 INFO creating mysql database
2025/11/25 13:24:25 INFO using database mysql
2025/11/25 13:24:25 INFO db username: root
2025/11/25 13:24:25 INFO db host: mysql-server
2025/11/25 13:24:25 INFO db port: 13306
2025/11/25 13:24:25 INFO db name: goiabada_integration
2025/11/25 13:24:25 INFO no need to migrate the database
=== RUN   TestAPIAccountAddressPut_Success
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000002] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-yNWvLHoi&redirect_uri=https%3A%2F%2Fwww.regionalvisionary.io%2Fplug-and-play%2Fenterprise%2Finteractive&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=KcVmKTRE&nonce=zLocckZT HTTP/1.1" from [::1]:60072 - 302 57B in 820.871Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000003] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60076 - 302 54B in 248.83Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000004] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60086 - 200 2949B in 366.943Âµs
2025/11/25 13:24:25 INFO {"audit_event":"auth_success_pwd","details":{"userId":2276}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000005] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60086 - 302 0B in 36.146328ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000006] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60086 - 302 57B in 569.887Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000007] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60088 - 302 60B in 458.065Âµs
2025/11/25 13:24:25 INFO {"audit_event":"started_new_user_session","details":{"clientId":5369,"userId":2276}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000008] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60100 - 302 56B in 3.065092ms
2025/11/25 13:24:25 INFO {"audit_event":"created_auth_code","details":{"clientId":5369,"codeId":1060,"userId":2276}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000009] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60106 - 302 245B in 3.793858ms
2025/11/25 13:24:25 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1060}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000010] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60122 - 200 4322B in 16.985895ms
2025/11/25 13:24:25 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"6b824f84-cc6b-4731-8830-186b8ab03d58","userId":2276}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000011] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60134 - 200 732B in 3.019205ms
--- PASS: TestAPIAccountAddressPut_Success (0.11s)
=== RUN   TestAPIAccountAddressPut_PartialAddress
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000012] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-gBtErWTS&redirect_uri=http%3A%2F%2Fwww.senioraggregate.org%2Ftarget%2Fsolutions%2Fmaximize%2Funleash&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=tKMSOXfh&nonce=YNlFwgdW HTTP/1.1" from [::1]:60138 - 302 57B in 1.01619ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000013] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60142 - 302 54B in 205.318Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000014] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60158 - 200 2949B in 311.919Âµs
2025/11/25 13:24:25 INFO {"audit_event":"auth_success_pwd","details":{"userId":2277}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000015] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60158 - 302 0B in 35.235728ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000016] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60158 - 302 57B in 446.513Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000017] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60174 - 302 60B in 381.671Âµs
2025/11/25 13:24:25 INFO {"audit_event":"started_new_user_session","details":{"clientId":5370,"userId":2277}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000018] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60184 - 302 56B in 3.653413ms
2025/11/25 13:24:25 INFO {"audit_event":"created_auth_code","details":{"clientId":5370,"codeId":1061,"userId":2277}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000019] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60198 - 302 240B in 2.3713ms
2025/11/25 13:24:25 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1061}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000020] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60210 - 200 4344B in 16.902978ms
2025/11/25 13:24:25 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"a9bd6521-f6da-4f92-9a56-392cd7f0d360","userId":2277}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000021] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60214 - 200 721B in 2.468885ms
--- PASS: TestAPIAccountAddressPut_PartialAddress (0.11s)
=== RUN   TestAPIAccountAddressPut_ClearAllFields
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000022] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-EcoVYnGA&redirect_uri=https%3A%2F%2Fwww.chiefsticky.io%2Fmagnetic%2Farchitect%2Frich&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=gPJctxOC&nonce=GMdTnPMh HTTP/1.1" from [::1]:60222 - 302 57B in 750.138Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000023] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60234 - 302 54B in 210.057Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000024] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60238 - 200 2949B in 527.246Âµs
2025/11/25 13:24:25 INFO {"audit_event":"auth_success_pwd","details":{"userId":2278}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000025] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60238 - 302 0B in 36.066057ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000026] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60238 - 302 57B in 386.32Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000027] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60252 - 302 60B in 405.396Âµs
2025/11/25 13:24:25 INFO {"audit_event":"started_new_user_session","details":{"clientId":5371,"userId":2278}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000028] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60266 - 302 56B in 2.827412ms
2025/11/25 13:24:25 INFO {"audit_event":"created_auth_code","details":{"clientId":5371,"codeId":1062,"userId":2278}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000029] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60272 - 302 226B in 2.269859ms
2025/11/25 13:24:25 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1062}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000030] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60276 - 200 4330B in 15.74496ms
2025/11/25 13:24:25 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"a5eac46c-f7bf-4d47-9056-147e2e02e5cc","userId":2278}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000031] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60282 - 200 695B in 2.473985ms
--- PASS: TestAPIAccountAddressPut_ClearAllFields (0.11s)
=== RUN   TestAPIAccountAddressPut_ValidationErrors
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000032] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-PBGVkRLM&redirect_uri=https%3A%2F%2Fwww.forwardmaximize.net%2Fstreamline%2Fcontent%2Fdynamic%2Fextensible&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=zdJgVeBv&nonce=oldcaqTH HTTP/1.1" from [::1]:60298 - 302 57B in 680.305Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000033] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60306 - 302 54B in 1.045896ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000034] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60314 - 200 2949B in 431.375Âµs
2025/11/25 13:24:25 INFO {"audit_event":"auth_success_pwd","details":{"userId":2279}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000035] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60314 - 302 0B in 36.529322ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000036] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60314 - 302 57B in 788.199Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000037] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60326 - 302 60B in 491.429Âµs
2025/11/25 13:24:25 INFO {"audit_event":"started_new_user_session","details":{"clientId":5372,"userId":2279}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000038] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60328 - 302 56B in 3.790342ms
2025/11/25 13:24:25 INFO {"audit_event":"created_auth_code","details":{"clientId":5372,"codeId":1063,"userId":2279}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000039] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60334 - 302 245B in 2.009147ms
2025/11/25 13:24:25 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1063}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000040] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60348 - 200 4330B in 15.881498ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000041] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60356 - 400 116B in 692.028Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000042] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60372 - 400 116B in 1.024616ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000043] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60384 - 400 110B in 465.379Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000044] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60392 - 400 108B in 634.759Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000045] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60408 - 400 113B in 417.919Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000046] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60418 - 400 67B in 713.959Âµs
--- PASS: TestAPIAccountAddressPut_ValidationErrors (0.11s)
=== RUN   TestAPIAccountAddressPut_UnauthorizedAndScope
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000047] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60424 - 401 22B in 122.782Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000048] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60432 - 401 22B in 240.725Âµs
2025/11/25 13:24:25 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5373}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000049] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60434 - 200 1165B in 4.58834ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000050] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60446 - 403 19B in 593.531Âµs
--- PASS: TestAPIAccountAddressPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountAddressPut_InvalidRequestBody
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000051] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-jcUkUihg&redirect_uri=http%3A%2F%2Fwww.internationalturn-key.io%2Fcustomized&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=BHPKMHAz&nonce=ZWXHshSH HTTP/1.1" from [::1]:60450 - 302 57B in 715.512Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000052] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60454 - 302 54B in 259.02Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000053] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60458 - 200 2949B in 296.861Âµs
2025/11/25 13:24:25 INFO {"audit_event":"auth_success_pwd","details":{"userId":2280}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000054] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60458 - 302 0B in 35.130559ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000055] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60458 - 302 57B in 503.301Âµs
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000056] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60460 - 302 60B in 375.84Âµs
2025/11/25 13:24:25 INFO {"audit_event":"started_new_user_session","details":{"clientId":5374,"userId":2280}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000057] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60474 - 302 56B in 2.932481ms
2025/11/25 13:24:25 INFO {"audit_event":"created_auth_code","details":{"clientId":5374,"codeId":1064,"userId":2280}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000058] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60480 - 302 222B in 1.906031ms
2025/11/25 13:24:25 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1064}}
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000059] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60488 - 200 4330B in 15.259563ms
2025/11/25 13:24:25 [a357f2e3b56e/VGvsVkwcAO-000060] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:60490 - 400 75B in 362.505Âµs
--- PASS: TestAPIAccountAddressPut_InvalidRequestBody (0.10s)
=== RUN   TestAPIAccountConsentsGet_Success
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000061] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-HUiuNEPG&redirect_uri=http%3A%2F%2Fwww.internalimpactful.net%2Fcutting-edge%2Fb2b%2Frich%2Fmetrics&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=OCveLKmd&nonce=wsakMfXW HTTP/1.1" from [::1]:60504 - 302 57B in 1.525983ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000062] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60514 - 302 54B in 268.437Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000063] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60516 - 200 2949B in 392.011Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2281}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000064] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60516 - 302 0B in 35.343572ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000065] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60516 - 302 57B in 543.537Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000066] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60520 - 302 60B in 442.365Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5375,"userId":2281}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000067] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60528 - 302 56B in 2.692077ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5375,"codeId":1065,"userId":2281}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000068] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60530 - 302 238B in 2.155123ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1065}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000069] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60546 - 200 4322B in 15.079733ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000070] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:60558 - 200 315B in 628.597Âµs
--- PASS: TestAPIAccountConsentsGet_Success (0.11s)
=== RUN   TestAPIAccountConsentsGet_UnauthorizedAndScope
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000071] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:60570 - 401 22B in 126.569Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000072] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:60580 - 401 22B in 237.468Âµs
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5377}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000073] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60584 - 200 1165B in 4.254599ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000074] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:60596 - 403 19B in 376.221Âµs
--- PASS: TestAPIAccountConsentsGet_UnauthorizedAndScope (0.02s)
=== RUN   TestAPIAccountConsentDelete_Success
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000075] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-DDSAYmiT&redirect_uri=http%3A%2F%2Fwww.principale-business.info%2Fenhance%2Fapplications&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=FyBvkgmO&nonce=jzDbKazO HTTP/1.1" from [::1]:60608 - 302 57B in 682.64Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000076] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60616 - 302 54B in 268.327Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000077] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60624 - 200 2949B in 348.308Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2282}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000078] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60624 - 302 0B in 36.097086ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000079] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60624 - 302 57B in 537.074Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000080] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60628 - 302 60B in 666.559Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5378,"userId":2282}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000081] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60634 - 302 56B in 2.724208ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5378,"codeId":1066,"userId":2282}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000082] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60648 - 302 232B in 2.837662ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1066}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000083] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60658 - 200 4330B in 15.610747ms
2025/11/25 13:24:26 INFO {"audit_event":"deleted_own_user_consent","details":{"consentId":191,"loggedInUser":"24da50a7-722b-4ff7-a061-807a74170d2b","userId":2282}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000084] "DELETE http://localhost:19090/api/v1/account/consents/191 HTTP/1.1" from [::1]:60666 - 200 17B in 2.215456ms
--- PASS: TestAPIAccountConsentDelete_Success (0.11s)
=== RUN   TestAPIAccountConsentDelete_ForbiddenOnOtherUser
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000085] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-vkEpNDso&redirect_uri=http%3A%2F%2Fwww.investorseamless.org%2Foptimize%2Frich%2Fsexy%2Fbleeding-edge&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=BfqBZQSK&nonce=GxndSRPn HTTP/1.1" from [::1]:60674 - 302 57B in 900.05Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000086] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60680 - 302 54B in 204.326Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000087] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60690 - 200 2949B in 269.8Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2283}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000088] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60690 - 302 0B in 35.244955ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000089] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60690 - 302 57B in 514.001Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000090] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60694 - 302 60B in 381.722Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5380,"userId":2283}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000091] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60708 - 302 56B in 2.919166ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5380,"codeId":1067,"userId":2283}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000092] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60710 - 302 240B in 2.094117ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1067}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000093] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60720 - 200 4326B in 15.397473ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000094] "DELETE http://localhost:19090/api/v1/account/consents/192 HTTP/1.1" from [::1]:60734 - 403 53B in 507.238Âµs
--- PASS: TestAPIAccountConsentDelete_ForbiddenOnOtherUser (0.11s)
=== RUN   TestAPIAccountConsentDelete_NotFoundAndBadId
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000095] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-pcaNSzwb&redirect_uri=http%3A%2F%2Fwww.regionalenvisioneer.org%2Freal-time%2Fdeploy%2Frelationships&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ltFqImrO&nonce=OqqWEkvy HTTP/1.1" from [::1]:60742 - 302 57B in 448.678Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000096] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60750 - 302 54B in 199.967Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000097] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60752 - 200 2949B in 306.409Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2285}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000098] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60752 - 302 0B in 35.397794ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000099] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60752 - 302 57B in 438.108Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000100] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60756 - 302 60B in 372.514Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5382,"userId":2285}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000101] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60760 - 302 56B in 2.742542ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5382,"codeId":1068,"userId":2285}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000102] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60772 - 302 241B in 2.121709ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1068}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000103] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60778 - 200 4344B in 15.059434ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000104] "DELETE http://localhost:19090/api/v1/account/consents/999999999 HTTP/1.1" from [::1]:60792 - 404 61B in 517.858Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000105] "DELETE http://localhost:19090/api/v1/account/consents/abc HTTP/1.1" from [::1]:60804 - 400 76B in 371.702Âµs
--- PASS: TestAPIAccountConsentDelete_NotFoundAndBadId (0.10s)
=== RUN   TestAPIAccountEmailPut_Success
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000106] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-MnzlvxNC&redirect_uri=http%3A%2F%2Fwww.directempower.com%2Fdrive%2Fdrive%2Fproductize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=kSEfsHDL&nonce=AgAwJZEe HTTP/1.1" from [::1]:60806 - 302 57B in 748.354Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000107] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60820 - 302 54B in 246.135Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000108] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60832 - 200 2949B in 277.655Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2286}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000109] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60832 - 302 0B in 35.216521ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000110] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60832 - 302 57B in 350.422Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000111] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60836 - 302 60B in 518.139Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5383,"userId":2286}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000112] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60850 - 302 56B in 2.521345ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5383,"codeId":1069,"userId":2286}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000113] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60860 - 302 227B in 2.338819ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1069}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000114] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60872 - 200 4328B in 14.979433ms
2025/11/25 13:24:26 INFO {"audit_event":"updated_own_email","details":{"loggedInUser":"5fa3df26-be95-4557-8505-a3cf46bd1783","userId":2286}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000115] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:60876 - 200 694B in 3.369336ms
--- PASS: TestAPIAccountEmailPut_Success (0.11s)
=== RUN   TestAPIAccountEmailPut_ValidationErrors
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000116] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-snOUVyXg&redirect_uri=https%3A%2F%2Fwww.humansolutions.org%2Fmission-critical&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ISnTlPoA&nonce=iPJHDQOZ HTTP/1.1" from [::1]:60890 - 302 57B in 903.246Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000117] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60892 - 302 54B in 237.128Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000118] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60898 - 200 2949B in 363.026Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2287}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000119] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60898 - 302 0B in 36.123576ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000120] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60898 - 302 57B in 990.041Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000121] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60906 - 302 60B in 978.288Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5384,"userId":2287}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000122] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60912 - 302 56B in 3.82105ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5384,"codeId":1070,"userId":2287}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000123] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60922 - 302 223B in 2.302961ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1070}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000124] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60926 - 200 4344B in 15.995834ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000125] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:60942 - 400 81B in 726.011Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000126] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:60958 - 400 86B in 415.565Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000127] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:60974 - 400 117B in 763.253Âµs
--- PASS: TestAPIAccountEmailPut_ValidationErrors (0.11s)
=== RUN   TestAPIAccountEmailPut_EmailAlreadyExists
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000128] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-llsPaRoy&redirect_uri=http%3A%2F%2Fwww.futureopen-source.io%2Ffunctionalities%2Fdot-com%2Fdeploy&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ZSjYJciP&nonce=dOHJtUCQ HTTP/1.1" from [::1]:60982 - 302 57B in 687.369Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000129] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60992 - 302 54B in 241.366Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000130] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:32768 - 200 2949B in 291.711Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2288}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000131] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:32768 - 302 0B in 35.459942ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000132] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:32768 - 302 57B in 366.693Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000133] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:32776 - 302 60B in 429.602Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5385,"userId":2288}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000134] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:32792 - 302 56B in 2.723847ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5385,"codeId":1071,"userId":2288}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000135] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:32802 - 302 238B in 1.893418ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1071}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000136] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32814 - 200 4330B in 14.888893ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000137] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:32820 - 400 107B in 625.712Âµs
--- PASS: TestAPIAccountEmailPut_EmailAlreadyExists (0.11s)
=== RUN   TestAPIAccountEmailPut_UnauthorizedAndScope
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000138] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:32822 - 401 22B in 126.69Âµs
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5386}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000139] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32832 - 200 1165B in 4.155101ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000140] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:32842 - 403 19B in 313.723Âµs
--- PASS: TestAPIAccountEmailPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountEmailPut_InvalidRequestBody
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000141] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-DqNBNkqD&redirect_uri=http%3A%2F%2Fwww.chiefsynthesize.com%2Fsupply-chains%2Fcross-media&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=sLjQbSyc&nonce=elVUsyhu HTTP/1.1" from [::1]:32852 - 302 57B in 498.572Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000142] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:32868 - 302 54B in 205.308Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000143] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:32876 - 200 2949B in 260.472Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2290}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000144] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:32876 - 302 0B in 35.068973ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000145] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:32876 - 302 57B in 507.088Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000146] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:32890 - 302 60B in 487.522Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5387,"userId":2290}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000147] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:32898 - 302 56B in 3.284276ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5387,"codeId":1072,"userId":2290}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000148] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:32900 - 302 232B in 2.906712ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1072}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000149] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32916 - 200 4326B in 14.515797ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000150] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:32932 - 400 75B in 413.611Âµs
--- PASS: TestAPIAccountEmailPut_InvalidRequestBody (0.10s)
=== RUN   TestAPIAccountEmailVerificationSend_Success
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000151] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-LBJPyMWi&redirect_uri=https%3A%2F%2Fwww.humanseize.io%2Ftarget&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=YlgZTues&nonce=ogKuZQDT HTTP/1.1" from [::1]:32946 - 302 57B in 480.658Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000152] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:32962 - 302 54B in 331.677Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000153] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:32970 - 200 2949B in 262.506Âµs
2025/11/25 13:24:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":2291}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000154] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:32970 - 302 0B in 35.754338ms
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000155] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:32970 - 302 57B in 497.62Âµs
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000156] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:32984 - 302 60B in 828.906Âµs
2025/11/25 13:24:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":5388,"userId":2291}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000157] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:32994 - 302 56B in 2.571308ms
2025/11/25 13:24:26 INFO {"audit_event":"created_auth_code","details":{"clientId":5388,"codeId":1073,"userId":2291}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000158] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:32996 - 302 208B in 1.824428ms
2025/11/25 13:24:26 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1073}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000159] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33012 - 200 4342B in 15.573006ms
2025/11/25 13:24:26 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"summerpowlowski@klocko.info","loggedInUser":"4822b55e-6837-4b20-8b13-66c98a990fa9","userId":2291}}
2025/11/25 13:24:26 [a357f2e3b56e/VGvsVkwcAO-000160] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:33028 - 200 144B in 2.997764ms
--- PASS: TestAPIAccountEmailVerificationSend_Success (0.11s)
=== RUN   TestAPIAccountEmailVerificationSend_TooManyRequests
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000161] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-wQETSpbO&redirect_uri=http%3A%2F%2Fwww.regionalexperiences.com%2Fwireless&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=dzMjRnou&nonce=qAEQqZCP HTTP/1.1" from [::1]:33038 - 302 57B in 1.215998ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000162] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33044 - 302 54B in 266.374Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000163] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33052 - 200 2949B in 344.571Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2292}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000164] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33052 - 302 0B in 35.552797ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000165] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33052 - 302 57B in 376.2Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000166] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33054 - 302 60B in 333.871Âµs
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5389,"userId":2292}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000167] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33056 - 302 56B in 2.754765ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5389,"codeId":1074,"userId":2292}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000168] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33060 - 302 219B in 2.187594ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1074}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000169] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33074 - 200 4336B in 15.029438ms
2025/11/25 13:24:27 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"juwanprohaska@lockman.com","loggedInUser":"d651c27b-44f9-46a9-83d6-e50b16cecabc","userId":2292}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000170] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:33076 - 200 142B in 3.87961ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000171] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:33092 - 200 118B in 494.054Âµs
--- PASS: TestAPIAccountEmailVerificationSend_TooManyRequests (0.13s)
=== RUN   TestAPIAccountEmailVerificationSend_AlreadyVerified
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000172] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-QuaIcIOQ&redirect_uri=http%3A%2F%2Fwww.legacyrich.name%2Fenable%2Fimpactful&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=QOZuvPRk&nonce=PcjysVoy HTTP/1.1" from [::1]:33100 - 302 57B in 1.509122ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000173] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33104 - 302 54B in 343.188Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000174] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33106 - 200 2949B in 387.281Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2293}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000175] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33106 - 302 0B in 36.480439ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000176] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33106 - 302 57B in 896.885Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000177] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33118 - 302 60B in 787.438Âµs
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5390,"userId":2293}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000178] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33120 - 302 56B in 3.895731ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5390,"codeId":1075,"userId":2293}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000179] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33130 - 302 219B in 2.124544ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1075}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000180] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33134 - 200 4330B in 15.600837ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000181] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:33136 - 200 117B in 634.209Âµs
--- PASS: TestAPIAccountEmailVerificationSend_AlreadyVerified (0.11s)
=== RUN   TestAPIAccountEmailVerificationSend_SMTPDisabled
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000182] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ombnBvIv&redirect_uri=http%3A%2F%2Fwww.seniorend-to-end.biz%2Fgenerate%2Fproductize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=wmrGCdZW&nonce=hnZKqoaB HTTP/1.1" from [::1]:33144 - 302 57B in 542.715Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000183] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33160 - 302 54B in 213.444Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000184] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33174 - 200 2949B in 296.901Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2294}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000185] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33174 - 302 0B in 35.322141ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000186] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33174 - 302 57B in 392.712Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000187] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33190 - 302 60B in 463.916Âµs
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5391,"userId":2294}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000188] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33200 - 302 56B in 2.957679ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5391,"codeId":1076,"userId":2294}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000189] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33206 - 302 227B in 2.060594ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1076}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000190] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33216 - 200 4338B in 14.705987ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000191] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:33218 - 400 70B in 812.415Âµs
--- PASS: TestAPIAccountEmailVerificationSend_SMTPDisabled (0.11s)
=== RUN   TestAPIAccountEmailVerificationSend_Unauthorized
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000192] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:33228 - 401 22B in 185.19Âµs
--- PASS: TestAPIAccountEmailVerificationSend_Unauthorized (0.00s)
=== RUN   TestAPIAccountEmailVerification_VerifySuccess
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000193] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-kQnJalKE&redirect_uri=http%3A%2F%2Fwww.dynamicdistributed.net%2Fnext-generation%2Fworld-class%2Fsynthesize%2Fdistributed&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=zHYQNcsp&nonce=RaTAonpw HTTP/1.1" from [::1]:33230 - 302 57B in 778.02Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000194] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33238 - 302 54B in 226.517Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000195] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33240 - 200 2949B in 300.758Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2295}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000196] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33240 - 302 0B in 35.269662ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000197] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33240 - 302 57B in 312.03Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000198] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33242 - 302 60B in 504.052Âµs
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5392,"userId":2295}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000199] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33248 - 302 56B in 2.632204ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5392,"codeId":1077,"userId":2295}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000200] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33258 - 302 260B in 1.958991ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1077}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000201] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33266 - 200 4330B in 14.666482ms
2025/11/25 13:24:27 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"howardrath@bernhard.biz","loggedInUser":"5ea92267-4e14-455b-9d86-91beae06c85f","userId":2295}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000202] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:33280 - 200 140B in 3.64628ms
2025/11/25 13:24:27 INFO {"audit_event":"verified_email","details":{"loggedInUser":"5ea92267-4e14-455b-9d86-91beae06c85f","userId":2295}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000203] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:33282 - 200 696B in 3.439249ms
--- PASS: TestAPIAccountEmailVerification_VerifySuccess (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifyInvalidCode
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000204] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-CovWodpK&redirect_uri=https%3A%2F%2Fwww.leaddrive.name%2Fvalue-added%2Fmaximize%2Fkiller%2Finitiatives&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=YaNIAnsZ&nonce=QdTLRjZu HTTP/1.1" from [::1]:33284 - 302 57B in 810.452Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000205] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33288 - 302 54B in 236.487Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000206] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33302 - 200 2949B in 309.705Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2296}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000207] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33302 - 302 0B in 35.715504ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000208] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33302 - 302 57B in 413.942Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000209] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33312 - 302 60B in 449.92Âµs
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5393,"userId":2296}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000210] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33314 - 302 56B in 2.708027ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5393,"codeId":1078,"userId":2296}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000211] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33322 - 302 242B in 2.197402ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1078}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000212] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33338 - 200 4334B in 15.019138ms
2025/11/25 13:24:27 INFO {"audit_event":"failed_email_verification_code","details":{"loggedInUser":"e6beca51-b455-49e9-bb7b-2b7ba0823e3f","userId":2296}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000213] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:33346 - 400 107B in 956.738Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyInvalidCode (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifyExpiredCode
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000214] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-yEUhzOpZ&redirect_uri=https%3A%2F%2Fwww.regionalextend.org%2Fviral%2Fstreamline%2Fscale%2Fcross-media&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=agzzsybd&nonce=wtilVbUa HTTP/1.1" from [::1]:33360 - 302 57B in 946.989Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000215] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33362 - 302 54B in 216.399Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000216] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33366 - 200 2949B in 302.281Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2297}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000217] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33366 - 302 0B in 36.074673ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000218] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33366 - 302 57B in 538.998Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000219] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33372 - 302 60B in 529.37Âµs
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5394,"userId":2297}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000220] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33382 - 302 56B in 3.182052ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5394,"codeId":1079,"userId":2297}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000221] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33390 - 302 241B in 2.220546ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1079}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000222] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33404 - 200 4336B in 15.924489ms
2025/11/25 13:24:27 INFO {"audit_event":"failed_email_verification_code","details":{"loggedInUser":"d747b807-9f2e-4faa-9f39-7bd489d6fa60","userId":2297}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000223] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:33410 - 400 107B in 545.25Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyExpiredCode (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifyAlreadyVerified
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000224] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-vzgXQVjY&redirect_uri=https%3A%2F%2Fwww.internaltarget.info%2Fincubate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ClSdaBzs&nonce=YkAAHqpE HTTP/1.1" from [::1]:33424 - 302 57B in 809.89Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000225] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33426 - 302 54B in 221.188Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000226] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33434 - 200 2949B in 753.063Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2298}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000227] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33434 - 302 0B in 35.237811ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000228] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33434 - 302 57B in 370.2Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000229] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33442 - 302 60B in 362.234Âµs
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5395,"userId":2298}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000230] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33454 - 302 56B in 2.769383ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5395,"codeId":1080,"userId":2298}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000231] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33464 - 302 216B in 1.945025ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1080}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000232] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33478 - 200 4334B in 14.932255ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000233] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:33486 - 200 694B in 580.146Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyAlreadyVerified (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifySMTPDisabled
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000234] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-BlaJxiGZ&redirect_uri=http%3A%2F%2Fwww.investor24-7.name%2Fcommunities&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=uqpsjGfi&nonce=mbgEmBkr HTTP/1.1" from [::1]:33490 - 302 57B in 551.873Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000235] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33498 - 302 54B in 229.885Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000236] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33508 - 200 2949B in 431.235Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2299}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000237] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33508 - 302 0B in 35.24211ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000238] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33508 - 302 57B in 362.054Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000239] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33524 - 302 60B in 1.035907ms
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5396,"userId":2299}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000240] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33538 - 302 56B in 3.472581ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5396,"codeId":1081,"userId":2299}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000241] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33550 - 302 216B in 1.952559ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1081}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33564 - 200 4336B in 14.791328ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000243] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:33574 - 400 70B in 403.272Âµs
--- PASS: TestAPIAccountEmailVerification_VerifySMTPDisabled (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifyInvalidRequestBody
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000244] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-inPYWckY&redirect_uri=https%3A%2F%2Fwww.customercross-platform.info%2Ffacilitate%2Fmesh&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ncgMezwk&nonce=WJtqmouK HTTP/1.1" from [::1]:33580 - 302 57B in 516.366Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000245] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33596 - 302 54B in 208.725Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000246] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33598 - 200 2949B in 281.653Âµs
2025/11/25 13:24:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":2300}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000247] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33598 - 302 0B in 35.070085ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000248] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33598 - 302 57B in 468.866Âµs
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000249] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33602 - 302 60B in 337.398Âµs
2025/11/25 13:24:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":5397,"userId":2300}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000250] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33604 - 302 56B in 2.829055ms
2025/11/25 13:24:27 INFO {"audit_event":"created_auth_code","details":{"clientId":5397,"codeId":1082,"userId":2300}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000251] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33618 - 302 231B in 2.284948ms
2025/11/25 13:24:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1082}}
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000252] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33632 - 200 4336B in 14.999371ms
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000253] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:33648 - 400 75B in 414.022Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyInvalidRequestBody (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifyUnauthorized
2025/11/25 13:24:27 [a357f2e3b56e/VGvsVkwcAO-000254] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:33656 - 401 22B in 155.213Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyUnauthorized (0.00s)
=== RUN   TestAPIAccountLogoutRequest_Success_And_LogoutFlow_WithAndWithoutCookie
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000255] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-sBKLRirT&redirect_uri=https%3A%2F%2Fwww.humanfrictionless.com%2Fharness%2Fempower%2Fmission-critical%2Fintegrated&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=tAabQBbw&nonce=yLTBHlEi HTTP/1.1" from [::1]:33658 - 302 57B in 971.676Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000256] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33666 - 302 54B in 215.317Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000257] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33682 - 200 2949B in 334.572Âµs
2025/11/25 13:24:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":2301}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000258] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33682 - 302 0B in 35.085574ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000259] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33682 - 302 57B in 436.585Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000260] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33690 - 302 60B in 535.041Âµs
2025/11/25 13:24:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":5398,"userId":2301}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000261] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33704 - 302 56B in 2.705853ms
2025/11/25 13:24:28 INFO {"audit_event":"created_auth_code","details":{"clientId":5398,"codeId":1083,"userId":2301}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000262] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33718 - 302 253B in 1.946207ms
2025/11/25 13:24:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1083}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000263] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33734 - 200 4342B in 14.764567ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000264] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:33742 - 200 1249B in 181.171452ms
2025/11/25 13:24:28 INFO {"audit_event":"deleted_user_session_client","details":{"clientId":5398,"loggedInUser":"","userId":2301,"userSessionId":2262}}
2025/11/25 13:24:28 INFO {"audit_event":"logout","details":{"loggedInUser":"","sessionIdentifier":"d6aa00a8-d3ce-4d00-ae8d-be564b6a96c8","userId":2301}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000265] "GET http://localhost:19090/auth/logout?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjZiYzFhMzQxLWI5MTMtNGU2OS1hMDQ0LTJhNmQxZGZjNGFlNSIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhY2N0c2NvcGUtY2xpZW50LXNCS0xSaXJUIiwiZXhwIjoxNzY0MDc3MTI4LCJpYXQiOjE3NjQwNzcwNjgsImlzcyI6Imlzc3Vlci1rVkJkQ3MiLCJzaWQiOiJkNmFhMDBhOC1kM2NlLTRkMDAtYWU4ZC1iZTU2NGI2YTk2YzgiLCJzdWIiOiI1ZWFkNTlkMi01MmRmLTRkYjktODQ4ZC0zMWNiYWYzNDNjMzIiLCJ0eXAiOiJJRCJ9.ni7lZxHoZX-eoddg3KVfwIcgqIpaOrpO8Z2OgZWWtmWaEYQzwCgPl2i67IBd4sP-HTFwlHeGIZGegwYBISKMPl8HvBUNoqkASrQvBeuLHjeehDiJvZHtAbxpu0JbRLokx-fS7Al36hvk-FTCjA6fUIG-Bi-AgzxSZktWwYJjtXXFchro06OVlOr5LlC11TwRkg3--huKj8_GOvXiF1hYvi6ckQDl7kzx-MoGdwCeh6bjpHEslOEzr2XDBomZTOQ01dy8y8K25HqDUizxC4Bi7slyfHurrlH10BjyOyAN4v7DOOSvwZf5bMyj7-i2AoXGdyqpfCFHqf_BnBR6fXi_0W35Wo3q3ZoFGmX0FTijhg_H6fgb66f_HCjbwXgMyt70A4VEHXeJrzXKfWGkiRI6NnyeEFOaxH6_ANZ44WYSW5XTwuiq2C2iSGDSjslrSSjt3nmk8ZsI53rxVZ53ba51cdTiaYaNSEwaWdGbTZxY4Jt9Ha5SryC6xsVVowVdE4a6C712vTYom8wzX97tzi-HlmbZh15jSkMJCXhuN5odeb5PwLWJ01MCj2sRNYyvlScwA29iwjcsMJVqr5q56fmZKOcmeg59JDiQZZlJHYPT3OJIs7Pg-xEJALEXH5ii6-nK7WSiXzbdQYFMvQ6DHgxMTheaHd41OUqlN2jEAi9BA0I&post_logout_redirect_uri=https%3A%2F%2Fwww.humanfrictionless.com%2Fharness%2Fempower%2Fmission-critical%2Fintegrated&state=hLyCMkghHQnP HTTP/1.1" from [::1]:33734 - 302 164B in 4.622564ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000266] "GET http://localhost:19090/auth/logout?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjZiYzFhMzQxLWI5MTMtNGU2OS1hMDQ0LTJhNmQxZGZjNGFlNSIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhY2N0c2NvcGUtY2xpZW50LXNCS0xSaXJUIiwiZXhwIjoxNzY0MDc3MTI4LCJpYXQiOjE3NjQwNzcwNjgsImlzcyI6Imlzc3Vlci1rVkJkQ3MiLCJzaWQiOiJkNmFhMDBhOC1kM2NlLTRkMDAtYWU4ZC1iZTU2NGI2YTk2YzgiLCJzdWIiOiI1ZWFkNTlkMi01MmRmLTRkYjktODQ4ZC0zMWNiYWYzNDNjMzIiLCJ0eXAiOiJJRCJ9.ni7lZxHoZX-eoddg3KVfwIcgqIpaOrpO8Z2OgZWWtmWaEYQzwCgPl2i67IBd4sP-HTFwlHeGIZGegwYBISKMPl8HvBUNoqkASrQvBeuLHjeehDiJvZHtAbxpu0JbRLokx-fS7Al36hvk-FTCjA6fUIG-Bi-AgzxSZktWwYJjtXXFchro06OVlOr5LlC11TwRkg3--huKj8_GOvXiF1hYvi6ckQDl7kzx-MoGdwCeh6bjpHEslOEzr2XDBomZTOQ01dy8y8K25HqDUizxC4Bi7slyfHurrlH10BjyOyAN4v7DOOSvwZf5bMyj7-i2AoXGdyqpfCFHqf_BnBR6fXi_0W35Wo3q3ZoFGmX0FTijhg_H6fgb66f_HCjbwXgMyt70A4VEHXeJrzXKfWGkiRI6NnyeEFOaxH6_ANZ44WYSW5XTwuiq2C2iSGDSjslrSSjt3nmk8ZsI53rxVZ53ba51cdTiaYaNSEwaWdGbTZxY4Jt9Ha5SryC6xsVVowVdE4a6C712vTYom8wzX97tzi-HlmbZh15jSkMJCXhuN5odeb5PwLWJ01MCj2sRNYyvlScwA29iwjcsMJVqr5q56fmZKOcmeg59JDiQZZlJHYPT3OJIs7Pg-xEJALEXH5ii6-nK7WSiXzbdQYFMvQ6DHgxMTheaHd41OUqlN2jEAi9BA0I&post_logout_redirect_uri=https%3A%2F%2Fwww.humanfrictionless.com%2Fharness%2Fempower%2Fmission-critical%2Fintegrated&state=hLyCMkghHQnP HTTP/1.1" from [::1]:33758 - 302 164B in 551.532Âµs
--- PASS: TestAPIAccountLogoutRequest_Success_And_LogoutFlow_WithAndWithoutCookie (0.29s)
=== RUN   TestAPIAccountLogoutRequest_ValidationErrors_And_Scope
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000267] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-aLwkxlqW&redirect_uri=http%3A%2F%2Fwww.forwardapplications.biz%2Finterfaces%2Fmarkets%2Frecontextualize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=LPiYFPeQ&nonce=PnxrEtIV HTTP/1.1" from [::1]:33760 - 302 57B in 807.255Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000268] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33762 - 302 54B in 230.055Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000269] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33764 - 200 2949B in 309.375Âµs
2025/11/25 13:24:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":2302}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000270] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33764 - 302 0B in 35.133364ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000271] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33764 - 302 57B in 443.919Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000272] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33778 - 302 60B in 448.928Âµs
2025/11/25 13:24:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":5399,"userId":2302}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000273] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33794 - 302 56B in 3.118322ms
2025/11/25 13:24:28 INFO {"audit_event":"created_auth_code","details":{"clientId":5399,"codeId":1084,"userId":2302}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000274] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33802 - 302 245B in 3.714519ms
2025/11/25 13:24:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1084}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33818 - 200 4328B in 14.949898ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000276] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:33834 - 400 84B in 566.07Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000277] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:33844 - 400 128B in 173.925502ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000278] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:33860 - 401 22B in 269.92Âµs
2025/11/25 13:24:28 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5400}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33870 - 200 1165B in 4.264057ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000280] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:33872 - 403 19B in 331.697Âµs
--- PASS: TestAPIAccountLogoutRequest_ValidationErrors_And_Scope (0.29s)
=== RUN   TestAPIAccountOTPEnrollmentGet_Success
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000281] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-zpRmdFjf&redirect_uri=http%3A%2F%2Fwww.nationalapplications.name%2Frecontextualize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=iEPNNuWS&nonce=PVMdxSEX HTTP/1.1" from [::1]:33878 - 302 57B in 594.854Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000282] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33890 - 302 54B in 228.432Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000283] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33900 - 200 2949B in 294.677Âµs
2025/11/25 13:24:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":2303}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000284] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33900 - 302 0B in 35.270874ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000285] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33900 - 302 57B in 343.759Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000286] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:33910 - 302 60B in 376.762Âµs
2025/11/25 13:24:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":5401,"userId":2303}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000287] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:33912 - 302 56B in 2.81567ms
2025/11/25 13:24:28 INFO {"audit_event":"created_auth_code","details":{"clientId":5401,"codeId":1085,"userId":2303}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000288] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:33926 - 302 228B in 1.964883ms
2025/11/25 13:24:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1085}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000289] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33940 - 200 4344B in 14.730202ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000290] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:33952 - 200 699B in 676.027Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000291] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:33964 - 200 2158B in 4.398631ms
--- PASS: TestAPIAccountOTPEnrollmentGet_Success (0.11s)
=== RUN   TestAPIAccountOTPEnrollmentGet_AlreadyEnabled
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000292] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ZhAOAltg&redirect_uri=http%3A%2F%2Fwww.districtweb-readiness.com%2Finfrastructures%2Fexperiences&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=DupUMaLe&nonce=QVnmVPBj HTTP/1.1" from [::1]:33974 - 302 57B in 817.044Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000293] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:33986 - 302 54B in 234.593Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000294] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33998 - 200 2949B in 351.925Âµs
2025/11/25 13:24:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":2304}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000295] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:33998 - 302 0B in 35.377266ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000296] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:33998 - 302 57B in 347.676Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000297] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34012 - 302 60B in 404.284Âµs
2025/11/25 13:24:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":5402,"userId":2304}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000298] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34020 - 302 56B in 3.527044ms
2025/11/25 13:24:28 INFO {"audit_event":"created_auth_code","details":{"clientId":5402,"codeId":1086,"userId":2304}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000299] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34026 - 302 240B in 2.009717ms
2025/11/25 13:24:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1086}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000300] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34034 - 200 4334B in 15.598413ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000301] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34048 - 200 691B in 519.461Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000302] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:34060 - 400 76B in 453.416Âµs
--- PASS: TestAPIAccountOTPEnrollmentGet_AlreadyEnabled (0.11s)
=== RUN   TestAPIAccountOTPEnrollmentGet_UnauthorizedAndScope
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000303] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:34070 - 401 22B in 127.972Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000304] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:34072 - 401 22B in 238.04Âµs
2025/11/25 13:24:28 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5403}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000305] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34074 - 200 1165B in 4.087784ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000306] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:34088 - 403 19B in 364.559Âµs
--- PASS: TestAPIAccountOTPEnrollmentGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountOTPPut_Enable_Success
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000307] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-OxaadMnq&redirect_uri=http%3A%2F%2Fwww.centralpartnerships.info%2Fsystems&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=DydDJlxk&nonce=TWHyuWMD HTTP/1.1" from [::1]:34096 - 302 57B in 765.156Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000308] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34100 - 302 54B in 200.539Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000309] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34104 - 200 2949B in 314.203Âµs
2025/11/25 13:24:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":2305}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000310] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34104 - 302 0B in 35.838026ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000311] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34104 - 302 57B in 946.889Âµs
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000312] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34108 - 302 60B in 457.514Âµs
2025/11/25 13:24:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":5404,"userId":2305}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000313] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34112 - 302 56B in 2.977496ms
2025/11/25 13:24:28 INFO {"audit_event":"created_auth_code","details":{"clientId":5404,"codeId":1087,"userId":2305}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000314] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34118 - 302 219B in 2.074559ms
2025/11/25 13:24:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1087}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000315] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34126 - 200 4336B in 14.687743ms
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000316] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34142 - 200 696B in 457.635Âµs
2025/11/25 13:24:28 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5405}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000317] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34144 - 200 1156B in 4.578821ms
2025/11/25 13:24:28 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-xxdIVjUm","userId":2305}}
2025/11/25 13:24:28 [a357f2e3b56e/VGvsVkwcAO-000318] "PUT http://localhost:19090/api/v1/admin/users/2305/password HTTP/1.1" from [::1]:34150 - 200 696B in 38.150145ms
2025/11/25 13:24:29 INFO {"audit_event":"enabled_otp","details":{"userId":2305}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000319] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34152 - 200 695B in 40.832543ms
--- PASS: TestAPIAccountOTPPut_Enable_Success (0.23s)
=== RUN   TestAPIAccountOTPPut_Enable_AuthFailed
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000320] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-sOxzoFZF&redirect_uri=http%3A%2F%2Fwww.forwarddeliver.biz%2Fmaximize%2Fweb-enabled&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=lwvWDCqx&nonce=BHEcWykM HTTP/1.1" from [::1]:34154 - 302 57B in 984.51Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000321] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34162 - 302 54B in 255.784Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000322] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34178 - 200 2949B in 307.351Âµs
2025/11/25 13:24:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":2306}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000323] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34178 - 302 0B in 35.370462ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000324] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34178 - 302 57B in 340.543Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000325] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34192 - 302 60B in 734.668Âµs
2025/11/25 13:24:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":5406,"userId":2306}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000326] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34194 - 302 56B in 2.930818ms
2025/11/25 13:24:29 INFO {"audit_event":"created_auth_code","details":{"clientId":5406,"codeId":1088,"userId":2306}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000327] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34198 - 302 226B in 2.018664ms
2025/11/25 13:24:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1088}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000328] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34200 - 200 4322B in 15.117454ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000329] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34208 - 200 691B in 549.548Âµs
2025/11/25 13:24:29 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5407}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34224 - 200 1156B in 4.175118ms
2025/11/25 13:24:29 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-wniWaBzY","userId":2306}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000331] "PUT http://localhost:19090/api/v1/admin/users/2306/password HTTP/1.1" from [::1]:34240 - 200 690B in 37.851891ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000332] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34256 - 400 113B in 35.557636ms
--- PASS: TestAPIAccountOTPPut_Enable_AuthFailed (0.22s)
=== RUN   TestAPIAccountOTPPut_Enable_InvalidFormats
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000333] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-tpZSzMXA&redirect_uri=http%3A%2F%2Fwww.chiefdeploy.org%2Fbrand%2Foptimize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=BhdDvNqH&nonce=BePGQeRE HTTP/1.1" from [::1]:34272 - 302 57B in 633.257Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000334] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34284 - 302 54B in 221.288Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000335] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34300 - 200 2949B in 306.058Âµs
2025/11/25 13:24:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":2307}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000336] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34300 - 302 0B in 35.435725ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000337] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34300 - 302 57B in 409.844Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000338] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34312 - 302 60B in 442.686Âµs
2025/11/25 13:24:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":5408,"userId":2307}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000339] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34328 - 302 56B in 4.209093ms
2025/11/25 13:24:29 INFO {"audit_event":"created_auth_code","details":{"clientId":5408,"codeId":1089,"userId":2307}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000340] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34332 - 302 217B in 2.184417ms
2025/11/25 13:24:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1089}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000341] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34338 - 200 4328B in 16.214277ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000342] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34348 - 200 693B in 578.884Âµs
2025/11/25 13:24:29 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5409}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000343] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34350 - 200 1156B in 5.275578ms
2025/11/25 13:24:29 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-VoIcTfMT","userId":2307}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000344] "PUT http://localhost:19090/api/v1/admin/users/2307/password HTTP/1.1" from [::1]:34354 - 200 693B in 37.876096ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000345] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34364 - 400 68B in 35.783372ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000346] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34380 - 400 79B in 36.039416ms
--- PASS: TestAPIAccountOTPPut_Enable_InvalidFormats (0.26s)
=== RUN   TestAPIAccountOTPPut_Enable_WrongCode
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000347] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-doyTPfKZ&redirect_uri=http%3A%2F%2Fwww.futuretarget.biz%2Fembrace%2Fmonetize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=yrgUQZya&nonce=FwJXqfdv HTTP/1.1" from [::1]:34382 - 302 57B in 747.893Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000348] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34386 - 302 54B in 270.892Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000349] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34396 - 200 2949B in 341.375Âµs
2025/11/25 13:24:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":2308}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000350] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34396 - 302 0B in 35.420317ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000351] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34396 - 302 57B in 460.049Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000352] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34412 - 302 60B in 369.919Âµs
2025/11/25 13:24:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":5410,"userId":2308}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000353] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34420 - 302 56B in 3.489564ms
2025/11/25 13:24:29 INFO {"audit_event":"created_auth_code","details":{"clientId":5410,"codeId":1090,"userId":2308}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000354] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34422 - 302 220B in 2.959362ms
2025/11/25 13:24:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1090}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000355] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34428 - 200 4334B in 15.153883ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000356] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34430 - 200 695B in 891.544Âµs
2025/11/25 13:24:29 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5411}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000357] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34446 - 200 1156B in 4.373343ms
2025/11/25 13:24:29 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-aQPzalXw","userId":2308}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000358] "PUT http://localhost:19090/api/v1/admin/users/2308/password HTTP/1.1" from [::1]:34454 - 200 695B in 38.810732ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000359] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34456 - 400 209B in 35.830391ms
--- PASS: TestAPIAccountOTPPut_Enable_WrongCode (0.23s)
=== RUN   TestAPIAccountOTPPut_Disable_Success
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000360] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-NBEKngsQ&redirect_uri=http%3A%2F%2Fwww.dynamicmesh.biz%2Fbandwidth%2Fniches&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=AjawVqeP&nonce=ILBNtCod HTTP/1.1" from [::1]:34472 - 302 57B in 1.127581ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000361] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34474 - 302 54B in 445.431Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000362] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34486 - 200 2949B in 356.163Âµs
2025/11/25 13:24:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":2309}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000363] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34486 - 302 0B in 35.578084ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000364] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34486 - 302 57B in 556.452Âµs
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000365] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34492 - 302 60B in 427.859Âµs
2025/11/25 13:24:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":5412,"userId":2309}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000366] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34504 - 302 56B in 2.851839ms
2025/11/25 13:24:29 INFO {"audit_event":"created_auth_code","details":{"clientId":5412,"codeId":1091,"userId":2309}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000367] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34512 - 302 219B in 2.022171ms
2025/11/25 13:24:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1091}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000368] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34522 - 200 4330B in 15.943856ms
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000369] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34538 - 200 694B in 548.426Âµs
2025/11/25 13:24:29 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5413}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000370] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34544 - 200 1156B in 4.390055ms
2025/11/25 13:24:29 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-ZWgjvuDI","userId":2309}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000371] "PUT http://localhost:19090/api/v1/admin/users/2309/password HTTP/1.1" from [::1]:34554 - 200 694B in 37.553687ms
2025/11/25 13:24:29 INFO {"audit_event":"disabled_otp","details":{"userId":2309}}
2025/11/25 13:24:29 [a357f2e3b56e/VGvsVkwcAO-000372] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34568 - 200 693B in 39.649858ms
--- PASS: TestAPIAccountOTPPut_Disable_Success (0.23s)
=== RUN   TestAPIAccountOTPPut_Enable_SetsSessionFlag
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000373] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-amCaSDPD&redirect_uri=https%3A%2F%2Fwww.legacynext-generation.net%2Fsticky%2Fintegrate%2Fmagnetic%2Frepurpose&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=dBbpAMwz&nonce=vUvhDTug HTTP/1.1" from [::1]:34580 - 302 57B in 634.97Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000374] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34596 - 302 54B in 218.673Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000375] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34602 - 200 2949B in 285.389Âµs
2025/11/25 13:24:30 INFO {"audit_event":"auth_success_pwd","details":{"userId":2310}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000376] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34602 - 302 0B in 35.711827ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000377] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34602 - 302 57B in 655.96Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000378] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34618 - 302 60B in 465.259Âµs
2025/11/25 13:24:30 INFO {"audit_event":"started_new_user_session","details":{"clientId":5414,"userId":2310}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000379] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34624 - 302 56B in 2.938252ms
2025/11/25 13:24:30 INFO {"audit_event":"created_auth_code","details":{"clientId":5414,"codeId":1092,"userId":2310}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000380] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34640 - 302 249B in 2.002683ms
2025/11/25 13:24:30 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1092}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000381] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34656 - 200 4322B in 14.90343ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000382] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34662 - 200 691B in 524.612Âµs
2025/11/25 13:24:30 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5415}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34666 - 200 1156B in 4.94824ms
2025/11/25 13:24:30 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-dEpcIOyl","userId":2310}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000384] "PUT http://localhost:19090/api/v1/admin/users/2310/password HTTP/1.1" from [::1]:34668 - 200 691B in 47.36695ms
2025/11/25 13:24:30 INFO {"audit_event":"enabled_otp","details":{"userId":2310}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000385] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34672 - 200 690B in 39.817956ms
--- PASS: TestAPIAccountOTPPut_Enable_SetsSessionFlag (0.24s)
=== RUN   TestAPIAccountOTPPut_Disable_SetsSessionFlag
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000386] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-jiQTXFpc&redirect_uri=https%3A%2F%2Fwww.internalorchestrate.io%2Frepurpose%2Finteractive%2Fvalue-added%2Fgrow&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=UepZsdTq&nonce=KDIRHWsS HTTP/1.1" from [::1]:34674 - 302 57B in 822.605Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000387] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34682 - 302 54B in 208.303Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000388] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34686 - 200 2949B in 378.074Âµs
2025/11/25 13:24:30 INFO {"audit_event":"auth_success_pwd","details":{"userId":2311}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000389] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34686 - 302 0B in 35.517911ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000390] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34686 - 302 57B in 643.185Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000391] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34692 - 302 60B in 410.436Âµs
2025/11/25 13:24:30 INFO {"audit_event":"started_new_user_session","details":{"clientId":5416,"userId":2311}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000392] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34706 - 302 56B in 3.005259ms
2025/11/25 13:24:30 INFO {"audit_event":"created_auth_code","details":{"clientId":5416,"codeId":1093,"userId":2311}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000393] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34720 - 302 249B in 2.124274ms
2025/11/25 13:24:30 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1093}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000394] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34734 - 200 4328B in 16.688242ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000395] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34744 - 200 693B in 489.144Âµs
2025/11/25 13:24:30 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5417}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000396] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34752 - 200 1156B in 4.192692ms
2025/11/25 13:24:30 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-BdNHwcdl","userId":2311}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000397] "PUT http://localhost:19090/api/v1/admin/users/2311/password HTTP/1.1" from [::1]:34758 - 200 693B in 38.94721ms
2025/11/25 13:24:30 INFO {"audit_event":"disabled_otp","details":{"userId":2311}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000398] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34760 - 200 693B in 40.731282ms
--- PASS: TestAPIAccountOTPPut_Disable_SetsSessionFlag (0.23s)
=== RUN   TestAPIAccountOTPPut_Disable_NotEnabled
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000399] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-JtCkrwQl&redirect_uri=https%3A%2F%2Fwww.chiefenhance.org%2Fportals%2Fvertical&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=npuJlEqC&nonce=lTcNUyUM HTTP/1.1" from [::1]:34766 - 302 57B in 1.459538ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000400] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34780 - 302 54B in 313.473Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000401] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34782 - 200 2949B in 332.478Âµs
2025/11/25 13:24:30 INFO {"audit_event":"auth_success_pwd","details":{"userId":2312}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000402] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34782 - 302 0B in 36.702859ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000403] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34782 - 302 57B in 499.925Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000404] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34798 - 302 60B in 421.446Âµs
2025/11/25 13:24:30 INFO {"audit_event":"started_new_user_session","details":{"clientId":5418,"userId":2312}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000405] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34804 - 302 56B in 3.359207ms
2025/11/25 13:24:30 INFO {"audit_event":"created_auth_code","details":{"clientId":5418,"codeId":1094,"userId":2312}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000406] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34812 - 302 221B in 3.097092ms
2025/11/25 13:24:30 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1094}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000407] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34816 - 200 4344B in 15.840911ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000408] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:34830 - 200 699B in 573.584Âµs
2025/11/25 13:24:30 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5419}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000409] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34842 - 200 1156B in 4.214092ms
2025/11/25 13:24:30 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-TPppBESy","userId":2312}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000410] "PUT http://localhost:19090/api/v1/admin/users/2312/password HTTP/1.1" from [::1]:34856 - 200 699B in 38.333291ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000411] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34858 - 400 80B in 35.420958ms
--- PASS: TestAPIAccountOTPPut_Disable_NotEnabled (0.23s)
=== RUN   TestAPIAccountOTPPut_UnauthorizedAndScope
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000412] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34866 - 401 22B in 336.425Âµs
2025/11/25 13:24:30 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5420}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000413] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34868 - 200 1165B in 4.171512ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000414] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:34876 - 403 19B in 416.457Âµs
--- PASS: TestAPIAccountOTPPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPasswordPut_Success
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000415] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-EzbkPYKJ&redirect_uri=https%3A%2F%2Fwww.centralevolve.net%2Foptimize%2Fseize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=krXvipeC&nonce=iHdCSvut HTTP/1.1" from [::1]:34892 - 302 57B in 842.242Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000416] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34898 - 302 54B in 252.046Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000417] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34904 - 200 2949B in 664.275Âµs
2025/11/25 13:24:30 INFO {"audit_event":"auth_success_pwd","details":{"userId":2313}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000418] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34904 - 302 0B in 35.684706ms
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000419] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34904 - 302 57B in 378.866Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000420] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34914 - 302 60B in 461.613Âµs
2025/11/25 13:24:30 INFO {"audit_event":"started_new_user_session","details":{"clientId":5421,"userId":2313}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000421] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34918 - 302 56B in 2.998697ms
2025/11/25 13:24:30 INFO {"audit_event":"created_auth_code","details":{"clientId":5421,"codeId":1095,"userId":2313}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000422] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34922 - 302 220B in 2.218532ms
2025/11/25 13:24:30 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1095}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000423] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34930 - 200 4350B in 15.344273ms
2025/11/25 13:24:30 INFO {"audit_event":"changed_password","details":{"loggedInUser":"2e2fde8c-317b-4456-bb54-0f3a450142a6","userId":2313}}
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000424] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:34934 - 200 704B in 72.576653ms
--- PASS: TestAPIAccountPasswordPut_Success (0.25s)
=== RUN   TestAPIAccountPasswordPut_WrongCurrentPassword
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000425] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-XaHNWQKh&redirect_uri=http%3A%2F%2Fwww.centraltransition.io%2Fuser-centric&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=hLMGsNZI&nonce=QTJhhCDo HTTP/1.1" from [::1]:34938 - 302 57B in 832.654Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000426] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:34940 - 302 54B in 256.174Âµs
2025/11/25 13:24:30 [a357f2e3b56e/VGvsVkwcAO-000427] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34952 - 200 2949B in 327.95Âµs
2025/11/25 13:24:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":2314}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000428] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:34952 - 302 0B in 35.425686ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000429] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:34952 - 302 57B in 368.716Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000430] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:34954 - 302 60B in 500.937Âµs
2025/11/25 13:24:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":5422,"userId":2314}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000431] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:34966 - 302 56B in 2.758552ms
2025/11/25 13:24:31 INFO {"audit_event":"created_auth_code","details":{"clientId":5422,"codeId":1096,"userId":2314}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000432] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:34976 - 302 220B in 2.017722ms
2025/11/25 13:24:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1096}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000433] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34978 - 200 4344B in 14.693613ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000434] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:34986 - 400 121B in 35.669267ms
--- PASS: TestAPIAccountPasswordPut_WrongCurrentPassword (0.18s)
=== RUN   TestAPIAccountPasswordPut_ValidationErrors
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000435] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-eOiFJZWB&redirect_uri=https%3A%2F%2Fwww.dynamicrelationships.biz%2Fholistic%2Fvirtual%2Fe-business&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=OuPHECGZ&nonce=OwthkerD HTTP/1.1" from [::1]:34992 - 302 57B in 585.727Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000436] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35008 - 302 54B in 813.637Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000437] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35024 - 200 2949B in 533.538Âµs
2025/11/25 13:24:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":2315}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000438] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35024 - 302 0B in 35.834459ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000439] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35024 - 302 57B in 589.063Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000440] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35036 - 302 60B in 572.001Âµs
2025/11/25 13:24:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":5423,"userId":2315}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000441] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35038 - 302 56B in 2.981273ms
2025/11/25 13:24:31 INFO {"audit_event":"created_auth_code","details":{"clientId":5423,"codeId":1097,"userId":2315}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000442] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35046 - 302 240B in 2.433187ms
2025/11/25 13:24:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1097}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000443] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35050 - 200 4344B in 14.991626ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000444] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:35058 - 400 89B in 754.586Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000445] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:35068 - 400 77B in 412.77Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000446] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:35080 - 400 102B in 35.557876ms
--- PASS: TestAPIAccountPasswordPut_ValidationErrors (0.18s)
=== RUN   TestAPIAccountPasswordPut_UnauthorizedAndScope
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000447] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:35090 - 401 22B in 158.95Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000448] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:35100 - 401 22B in 317.239Âµs
2025/11/25 13:24:31 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5424}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000449] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35102 - 200 1165B in 4.189195ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000450] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:35112 - 403 19B in 305.788Âµs
--- PASS: TestAPIAccountPasswordPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPasswordPut_InvalidRequestBody
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000451] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-sLDIekum&redirect_uri=https%3A%2F%2Fwww.globalworld-class.io%2Fcompelling%2Fiterate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ewxqCgGt&nonce=qtoZlHjv HTTP/1.1" from [::1]:35122 - 302 57B in 766.519Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000452] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35128 - 302 54B in 256.274Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000453] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35136 - 200 2949B in 308.342Âµs
2025/11/25 13:24:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":2316}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000454] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35136 - 302 0B in 35.344223ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000455] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35136 - 302 57B in 354.049Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000456] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35150 - 302 60B in 366.463Âµs
2025/11/25 13:24:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":5425,"userId":2316}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000457] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35158 - 302 56B in 2.718487ms
2025/11/25 13:24:31 INFO {"audit_event":"created_auth_code","details":{"clientId":5425,"codeId":1098,"userId":2316}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000458] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35166 - 302 227B in 1.917744ms
2025/11/25 13:24:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1098}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000459] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35168 - 200 4342B in 16.477985ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000460] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:35172 - 400 75B in 404.985Âµs
--- PASS: TestAPIAccountPasswordPut_InvalidRequestBody (0.10s)
=== RUN   TestAPIAccountPhonePut_Success
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000461] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ARphnzpN&redirect_uri=http%3A%2F%2Fwww.regionalengage.io%2Fnext-generation%2Fmethodologies%2Freintermediate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=LSEBBFrG&nonce=DdqUORVv HTTP/1.1" from [::1]:35182 - 302 57B in 757.993Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000462] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35190 - 302 54B in 219.034Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000463] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35196 - 200 2949B in 289.617Âµs
2025/11/25 13:24:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":2317}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000464] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35196 - 302 0B in 35.77686ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000465] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35196 - 302 57B in 617.216Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000466] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35202 - 302 60B in 457.745Âµs
2025/11/25 13:24:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":5426,"userId":2317}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000467] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35210 - 302 56B in 3.055724ms
2025/11/25 13:24:31 INFO {"audit_event":"created_auth_code","details":{"clientId":5426,"codeId":1099,"userId":2317}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000468] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35216 - 302 249B in 2.216839ms
2025/11/25 13:24:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1099}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000469] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35226 - 200 4328B in 14.600528ms
2025/11/25 13:24:31 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"83970045-874f-4354-813d-341e8e46d55a","userId":2317}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000470] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35242 - 200 715B in 134.7024ms
--- PASS: TestAPIAccountPhonePut_Success (0.24s)
=== RUN   TestAPIAccountPhonePut_ClearPhone
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000471] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-MIkhkRSv&redirect_uri=https%3A%2F%2Fwww.chiefintegrated.info%2Fmorph%2Freinvent&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=RaoqfCdt&nonce=cqdReCMr HTTP/1.1" from [::1]:35244 - 302 57B in 891.224Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000472] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35254 - 302 54B in 244.823Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000473] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35258 - 200 2949B in 348.559Âµs
2025/11/25 13:24:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":2318}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000474] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35258 - 302 0B in 35.657896ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000475] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35258 - 302 57B in 428.36Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000476] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35264 - 302 60B in 431.485Âµs
2025/11/25 13:24:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":5427,"userId":2318}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000477] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35272 - 302 56B in 2.933974ms
2025/11/25 13:24:31 INFO {"audit_event":"created_auth_code","details":{"clientId":5427,"codeId":1100,"userId":2318}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000478] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35276 - 302 223B in 2.23854ms
2025/11/25 13:24:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1100}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000479] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35288 - 200 4322B in 14.928217ms
2025/11/25 13:24:31 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"49ae6323-7261-468b-977e-fcd881f7a602","userId":2318}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000480] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35300 - 200 713B in 124.305123ms
2025/11/25 13:24:31 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"49ae6323-7261-468b-977e-fcd881f7a602","userId":2318}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000481] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35306 - 200 693B in 2.358106ms
--- PASS: TestAPIAccountPhonePut_ClearPhone (0.23s)
=== RUN   TestAPIAccountPhonePut_ValidationErrors
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000482] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-UXtUKzFn&redirect_uri=https%3A%2F%2Fwww.leadusers.org%2Fbenchmark%2Fexpedite%2Fleverage%2Fplug-and-play&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=jiHdjGtS&nonce=cVKqmMZn HTTP/1.1" from [::1]:35314 - 302 57B in 810.431Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000483] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35326 - 302 54B in 284.327Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000484] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35332 - 200 2949B in 365.791Âµs
2025/11/25 13:24:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":2319}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000485] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35332 - 302 0B in 36.364551ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000486] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35332 - 302 57B in 431.215Âµs
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000487] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35336 - 302 60B in 400.858Âµs
2025/11/25 13:24:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":5428,"userId":2319}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000488] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35348 - 302 56B in 3.220675ms
2025/11/25 13:24:31 INFO {"audit_event":"created_auth_code","details":{"clientId":5428,"codeId":1101,"userId":2319}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000489] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35350 - 302 243B in 2.252165ms
2025/11/25 13:24:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1101}}
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000490] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35362 - 200 4342B in 16.164142ms
2025/11/25 13:24:31 [a357f2e3b56e/VGvsVkwcAO-000491] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35374 - 400 99B in 722.756Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000492] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35390 - 400 266B in 57.437287ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000493] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35402 - 400 99B in 56.702149ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000494] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35418 - 400 114B in 57.709702ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000495] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35434 - 400 174B in 62.097663ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000496] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35438 - 400 76B in 64.548995ms
--- PASS: TestAPIAccountPhonePut_ValidationErrors (0.41s)
=== RUN   TestAPIAccountPhonePut_UnauthorizedAndScope
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000497] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35448 - 401 22B in 399.275Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000498] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35456 - 401 22B in 368.105Âµs
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5429}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000499] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35470 - 200 1165B in 5.200686ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000500] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35476 - 403 19B in 457.876Âµs
--- PASS: TestAPIAccountPhonePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPhonePut_InvalidRequestBody
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000501] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-YSDZVcxq&redirect_uri=https%3A%2F%2Fwww.legacyreintermediate.com%2Forchestrate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=rZXQGJaI&nonce=JACvxNEn HTTP/1.1" from [::1]:35492 - 302 57B in 731.522Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000502] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35504 - 302 54B in 206.33Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000503] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35514 - 200 2949B in 365.28Âµs
2025/11/25 13:24:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":2320}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000504] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35514 - 302 0B in 35.773664ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000505] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35514 - 302 57B in 521.024Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000506] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35528 - 302 60B in 433.338Âµs
2025/11/25 13:24:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":5430,"userId":2320}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000507] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35536 - 302 56B in 3.00617ms
2025/11/25 13:24:32 INFO {"audit_event":"created_auth_code","details":{"clientId":5430,"codeId":1102,"userId":2320}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000508] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35540 - 302 224B in 2.508159ms
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1102}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000509] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35552 - 200 4334B in 14.916003ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000510] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:35556 - 400 75B in 1.018695ms
--- PASS: TestAPIAccountPhonePut_InvalidRequestBody (0.10s)
=== RUN   TestAPIAccountProfileGet_Success
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000511] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-YZjOGseg&redirect_uri=http%3A%2F%2Fwww.chiefenvisioneer.com%2Fpartnerships%2Fproactive%2Fenterprise%2Fsupply-chains&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=VZgirYAh&nonce=XXwqLnTu HTTP/1.1" from [::1]:35566 - 302 57B in 913.285Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000512] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35568 - 302 54B in 254.911Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000513] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35572 - 200 2949B in 362.655Âµs
2025/11/25 13:24:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":2321}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000514] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35572 - 302 0B in 35.511689ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000515] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35572 - 302 57B in 669.395Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000516] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35574 - 302 60B in 376.552Âµs
2025/11/25 13:24:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":5431,"userId":2321}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000517] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35580 - 302 56B in 2.624298ms
2025/11/25 13:24:32 INFO {"audit_event":"created_auth_code","details":{"clientId":5431,"codeId":1103,"userId":2321}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000518] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35584 - 302 255B in 2.343328ms
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1103}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000519] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35596 - 200 4328B in 16.29015ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000520] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35606 - 200 693B in 622.927Âµs
--- PASS: TestAPIAccountProfileGet_Success (0.10s)
=== RUN   TestAPIAccountProfileGet_UnauthorizedAndScope
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000521] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35622 - 401 22B in 119.686Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000522] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35630 - 401 22B in 324.994Âµs
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5432}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000523] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35634 - 200 1165B in 4.203913ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000524] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35638 - 403 19B in 409.864Âµs
--- PASS: TestAPIAccountProfileGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountProfilePut_Success
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000525] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-HVSgbvwc&redirect_uri=https%3A%2F%2Fwww.centralcultivate.name%2Fdrive%2Fexperiences&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=oMKFTHNn&nonce=UOaaFybd HTTP/1.1" from [::1]:35642 - 302 57B in 707.667Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000526] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35648 - 302 54B in 213.142Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000527] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35658 - 200 2949B in 304.015Âµs
2025/11/25 13:24:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":2322}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000528] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35658 - 302 0B in 35.786829ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000529] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35658 - 302 57B in 486.99Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000530] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35674 - 302 60B in 449.068Âµs
2025/11/25 13:24:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":5433,"userId":2322}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000531] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35690 - 302 56B in 3.635258ms
2025/11/25 13:24:32 INFO {"audit_event":"created_auth_code","details":{"clientId":5433,"codeId":1104,"userId":2322}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000532] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35692 - 302 227B in 2.151886ms
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1104}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000533] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35696 - 200 4336B in 17.270492ms
2025/11/25 13:24:32 INFO {"audit_event":"updated_own_profile","details":{"loggedInUser":"df908e69-7091-41dc-ab9a-8a5951fecb57","userId":2322}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000534] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35700 - 200 801B in 4.04362ms
--- PASS: TestAPIAccountProfilePut_Success (0.11s)
=== RUN   TestAPIAccountProfilePut_ValidationErrors
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000535] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-JqwdTZYr&redirect_uri=https%3A%2F%2Fwww.nationalsystems.biz%2Fempower%2Fplatforms%2Fmodels&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=RnCeoCsb&nonce=NAPVofQc HTTP/1.1" from [::1]:35716 - 302 57B in 824.357Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000536] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35724 - 302 54B in 246.165Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000537] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35728 - 200 2949B in 325.966Âµs
2025/11/25 13:24:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":2323}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000538] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35728 - 302 0B in 36.569347ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000539] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35728 - 302 57B in 344.08Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000540] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35730 - 302 60B in 368.046Âµs
2025/11/25 13:24:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":5434,"userId":2323}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000541] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35734 - 302 56B in 3.014305ms
2025/11/25 13:24:32 INFO {"audit_event":"created_auth_code","details":{"clientId":5434,"codeId":1105,"userId":2323}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000542] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35742 - 302 232B in 2.405796ms
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1105}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000543] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35746 - 200 4342B in 15.60753ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000544] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35754 - 400 69B in 1.947019ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000545] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35756 - 400 114B in 1.131348ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000546] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35766 - 400 76B in 1.593601ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000547] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35772 - 400 73B in 1.71443ms
--- PASS: TestAPIAccountProfilePut_ValidationErrors (0.11s)
=== RUN   TestAPIAccountProfilePut_UnauthorizedAndScope
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000548] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35786 - 401 22B in 153.611Âµs
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5435}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000549] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35792 - 200 1165B in 4.127539ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000550] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:35802 - 403 19B in 376.942Âµs
--- PASS: TestAPIAccountProfilePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountSessionsGet_Success_IncludesIsCurrent
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000551] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-WFfPDOsL&redirect_uri=http%3A%2F%2Fwww.productclicks-and-mortar.com%2Fdot-com&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=aRNQQvTx&nonce=pQmZWmPi HTTP/1.1" from [::1]:35808 - 302 57B in 606.446Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000552] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35820 - 302 54B in 204.045Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000553] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35836 - 200 2949B in 473.565Âµs
2025/11/25 13:24:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":2324}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000554] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35836 - 302 0B in 35.646874ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000555] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35836 - 302 57B in 402.22Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000556] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35842 - 302 60B in 353.939Âµs
2025/11/25 13:24:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":5436,"userId":2324}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000557] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35852 - 302 56B in 2.983838ms
2025/11/25 13:24:32 INFO {"audit_event":"created_auth_code","details":{"clientId":5436,"codeId":1106,"userId":2324}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000558] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35854 - 302 223B in 2.004618ms
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1106}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000559] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35856 - 200 4322B in 16.704042ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000560] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:35872 - 200 2167B in 1.086854ms
--- PASS: TestAPIAccountSessionsGet_Success_IncludesIsCurrent (0.12s)
=== RUN   TestAPIAccountSessionsGet_OnlyValidSessions
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000561] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ccskfOSp&redirect_uri=http%3A%2F%2Fwww.dynamicsynergistic.org%2Fsynergistic&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=YRplKdci&nonce=GzdHXmEP HTTP/1.1" from [::1]:35888 - 302 57B in 913.115Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000562] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35896 - 302 54B in 396.74Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000563] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35900 - 200 2949B in 310.897Âµs
2025/11/25 13:24:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":2325}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000564] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35900 - 302 0B in 36.056178ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000565] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35900 - 302 57B in 574.896Âµs
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000566] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35908 - 302 60B in 715.642Âµs
2025/11/25 13:24:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":5438,"userId":2325}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000567] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35920 - 302 56B in 2.719799ms
2025/11/25 13:24:32 INFO {"audit_event":"created_auth_code","details":{"clientId":5438,"codeId":1107,"userId":2325}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000568] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35922 - 302 221B in 1.976204ms
2025/11/25 13:24:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1107}}
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000569] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35928 - 200 4328B in 14.527089ms
2025/11/25 13:24:32 [a357f2e3b56e/VGvsVkwcAO-000570] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:35930 - 200 1436B in 811.824Âµs
--- PASS: TestAPIAccountSessionsGet_OnlyValidSessions (0.11s)
=== RUN   TestAPIAccountSessionDelete_Success
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000571] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-wPicbckd&redirect_uri=http%3A%2F%2Fwww.internationalwireless.info%2Fmagnetic&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=cNVNgRSN&nonce=JrhxSUBj HTTP/1.1" from [::1]:35942 - 302 57B in 806.634Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000572] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:35944 - 302 54B in 215.778Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000573] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35952 - 200 2949B in 372.504Âµs
2025/11/25 13:24:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":2326}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000574] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:35952 - 302 0B in 35.301221ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000575] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:35952 - 302 57B in 415.886Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000576] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:35966 - 302 60B in 423.961Âµs
2025/11/25 13:24:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":5439,"userId":2326}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000577] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:35980 - 302 56B in 2.781746ms
2025/11/25 13:24:33 INFO {"audit_event":"created_auth_code","details":{"clientId":5439,"codeId":1108,"userId":2326}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000578] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:35982 - 302 222B in 2.044142ms
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1108}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000579] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35996 - 200 4334B in 15.229365ms
2025/11/25 13:24:33 INFO {"audit_event":"deleted_user_session","details":{"loggedInUser":"","userSessionId":2292}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000580] "DELETE http://localhost:19090/api/v1/account/sessions/2292 HTTP/1.1" from [::1]:36006 - 200 17B in 2.447895ms
--- PASS: TestAPIAccountSessionDelete_Success (0.11s)
=== RUN   TestAPIAccountSessionDelete_ForbiddenOnOtherUsersSession
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000581] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-alPUUCDX&redirect_uri=https%3A%2F%2Fwww.leadexpedite.net%2Fempower%2Fcross-media&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=VCEQYGuY&nonce=GcAYrdkb HTTP/1.1" from [::1]:36022 - 302 57B in 1.282404ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000582] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36034 - 302 54B in 279.368Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000583] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36042 - 200 2949B in 330.805Âµs
2025/11/25 13:24:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":2327}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000584] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36042 - 302 0B in 35.352148ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000585] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36042 - 302 57B in 422.027Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000586] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36044 - 302 60B in 360.681Âµs
2025/11/25 13:24:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":5440,"userId":2327}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000587] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36050 - 302 56B in 2.685694ms
2025/11/25 13:24:33 INFO {"audit_event":"created_auth_code","details":{"clientId":5440,"codeId":1109,"userId":2327}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000588] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36056 - 302 224B in 1.919788ms
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1109}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000589] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36068 - 200 4336B in 14.905163ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000590] "DELETE http://localhost:19090/api/v1/account/sessions/2294 HTTP/1.1" from [::1]:36080 - 403 53B in 587.911Âµs
--- PASS: TestAPIAccountSessionDelete_ForbiddenOnOtherUsersSession (0.11s)
=== RUN   TestAPIAccountSessions_UnauthorizedAndScope
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000591] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:36096 - 401 22B in 184.899Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000592] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:36108 - 401 22B in 409.384Âµs
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5441}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000593] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36114 - 200 1165B in 4.213902ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000594] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:36122 - 403 19B in 367.925Âµs
--- PASS: TestAPIAccountSessions_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountSessionDelete_UnauthorizedAndInvalidId
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000595] "DELETE http://localhost:19090/api/v1/account/sessions/123 HTTP/1.1" from [::1]:36128 - 401 22B in 158.971Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000596] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-loCInPun&redirect_uri=https%3A%2F%2Fwww.internationalempower.biz%2Fevolve&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=yQCKqyNm&nonce=YHJIHUMK HTTP/1.1" from [::1]:36130 - 302 57B in 500.836Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000597] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36134 - 302 54B in 207.812Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000598] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36142 - 200 2949B in 329.462Âµs
2025/11/25 13:24:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":2329}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000599] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36142 - 302 0B in 35.229646ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000600] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36142 - 302 57B in 301.289Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000601] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36152 - 302 60B in 356.814Âµs
2025/11/25 13:24:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":5442,"userId":2329}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000602] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36162 - 302 56B in 3.780713ms
2025/11/25 13:24:33 INFO {"audit_event":"created_auth_code","details":{"clientId":5442,"codeId":1110,"userId":2329}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000603] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36166 - 302 219B in 2.200678ms
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1110}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000604] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36182 - 200 4342B in 14.816997ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000605] "DELETE http://localhost:19090/api/v1/account/sessions/abc HTTP/1.1" from [::1]:36192 - 400 86B in 385.078Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000606] "DELETE http://localhost:19090/api/v1/account/sessions/-1 HTTP/1.1" from [::1]:36198 - 400 86B in 364.378Âµs
--- PASS: TestAPIAccountSessionDelete_UnauthorizedAndInvalidId (0.10s)
=== RUN   TestAPIAccountSessionDelete_NotFound
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000607] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-dAEAwoPP&redirect_uri=http%3A%2F%2Fwww.futurevirtual.biz%2Fmorph%2Fscale%2Fe-services%2Ffunctionalities&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=jyZfizeY&nonce=dJLXRZjj HTTP/1.1" from [::1]:36204 - 302 57B in 612.257Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000608] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36210 - 302 54B in 249.341Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000609] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36224 - 200 2949B in 326.267Âµs
2025/11/25 13:24:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":2330}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000610] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36224 - 302 0B in 35.62844ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000611] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36224 - 302 57B in 703.439Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000612] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36238 - 302 60B in 500.425Âµs
2025/11/25 13:24:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":5443,"userId":2330}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000613] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36244 - 302 56B in 2.912634ms
2025/11/25 13:24:33 INFO {"audit_event":"created_auth_code","details":{"clientId":5443,"codeId":1111,"userId":2330}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000614] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36252 - 302 243B in 2.213082ms
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1111}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000615] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36266 - 200 4334B in 15.1308ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000616] "DELETE http://localhost:19090/api/v1/account/sessions/99999999 HTTP/1.1" from [::1]:36268 - 404 79B in 553.225Âµs
--- PASS: TestAPIAccountSessionDelete_NotFound (0.10s)
=== RUN   TestAPIClientPermissions_Get_Success
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5444}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000617] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36270 - 200 1156B in 4.158988ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000618] "GET http://localhost:19090/api/v1/admin/clients/5445/permissions HTTP/1.1" from [::1]:36282 - 200 730B in 1.40216ms
--- PASS: TestAPIClientPermissions_Get_Success (0.02s)
=== RUN   TestAPIClientPermissions_Get_Errors
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5446}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000619] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36284 - 200 1156B in 4.202691ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000620] "GET http://localhost:19090/api/v1/admin/clients/abc/permissions HTTP/1.1" from [::1]:36294 - 400 75B in 399.875Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000621] "GET http://localhost:19090/api/v1/admin/clients/9999999/permissions HTTP/1.1" from [::1]:36298 - 404 60B in 416.086Âµs
--- PASS: TestAPIClientPermissions_Get_Errors (0.01s)
=== RUN   TestAPIClientPermissions_Put_AddRemove
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5447}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000622] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36306 - 200 1156B in 4.135924ms
2025/11/25 13:24:33 INFO {"audit_event":"updated_client_permissions","details":{"clientId":5448,"loggedInUser":""}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000623] "PUT http://localhost:19090/api/v1/admin/clients/5448/permissions HTTP/1.1" from [::1]:36322 - 200 17B in 6.857858ms
2025/11/25 13:24:33 INFO {"audit_event":"updated_client_permissions","details":{"clientId":5448,"loggedInUser":""}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000624] "PUT http://localhost:19090/api/v1/admin/clients/5448/permissions HTTP/1.1" from [::1]:36338 - 200 17B in 3.824556ms
--- PASS: TestAPIClientPermissions_Put_AddRemove (0.03s)
=== RUN   TestAPIClientPermissions_Put_Idempotent
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5449}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000625] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36354 - 200 1156B in 4.134532ms
2025/11/25 13:24:33 INFO {"audit_event":"updated_client_permissions","details":{"clientId":5450,"loggedInUser":""}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000626] "PUT http://localhost:19090/api/v1/admin/clients/5450/permissions HTTP/1.1" from [::1]:36358 - 200 17B in 2.451833ms
2025/11/25 13:24:33 INFO {"audit_event":"updated_client_permissions","details":{"clientId":5450,"loggedInUser":""}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000627] "PUT http://localhost:19090/api/v1/admin/clients/5450/permissions HTTP/1.1" from [::1]:36366 - 200 17B in 619.019Âµs
--- PASS: TestAPIClientPermissions_Put_Idempotent (0.02s)
=== RUN   TestAPIClientPermissions_Unauthorized
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000628] "GET http://localhost:19090/api/v1/admin/clients/5451/permissions HTTP/1.1" from [::1]:36382 - 401 22B in 138.422Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000629] "PUT http://localhost:19090/api/v1/admin/clients/5451/permissions HTTP/1.1" from [::1]:36382 - 401 22B in 87.896Âµs
--- PASS: TestAPIClientPermissions_Unauthorized (0.00s)
=== RUN   TestAPIClientPermissions_Put_ClientCredentialsDisabled
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5452}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000630] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36390 - 200 1156B in 4.100388ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000631] "PUT http://localhost:19090/api/v1/admin/clients/5453/permissions HTTP/1.1" from [::1]:36400 - 400 132B in 398.954Âµs
--- PASS: TestAPIClientPermissions_Put_ClientCredentialsDisabled (0.02s)
=== RUN   TestAPIClientPermissions_Put_SystemLevelRejected
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5454}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000632] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36414 - 200 1156B in 4.241965ms
2025/11/25 13:24:33 INFO worker task started
2025/11/25 13:24:33 INFO deleted expired or revoked refresh tokens
2025/11/25 13:24:33 INFO deleted used codes without refresh tokens
2025/11/25 13:24:33 INFO deleted idle sessions (idle timeout: 3600 seconds)
2025/11/25 13:24:33 INFO deleted expired sessions (max lifetime: 7200 seconds)
2025/11/25 13:24:33 INFO worker task completed
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000633] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:36420 - 200 2898151B in 346.687233ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000634] "PUT http://localhost:19090/api/v1/admin/clients/1/permissions HTTP/1.1" from [::1]:36422 - 400 87B in 639.618Âµs
--- PASS: TestAPIClientPermissions_Put_SystemLevelRejected (0.37s)
=== RUN   TestAPIClientPermissions_Put_PermissionNotFound
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5455}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000635] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36426 - 200 1156B in 4.304032ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000636] "PUT http://localhost:19090/api/v1/admin/clients/5456/permissions HTTP/1.1" from [::1]:36434 - 404 64B in 503.241Âµs
--- PASS: TestAPIClientPermissions_Put_PermissionNotFound (0.02s)
=== RUN   TestAPIClientPermissions_Put_InsufficientScope
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5457}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000637] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36450 - 200 1160B in 4.412878ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000638] "PUT http://localhost:19090/api/v1/admin/clients/5458/permissions HTTP/1.1" from [::1]:36462 - 403 19B in 410.776Âµs
--- PASS: TestAPIClientPermissions_Put_InsufficientScope (0.01s)
=== RUN   TestAPIClientAuthenticationPut_ConfidentialToPublic_Success
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5459}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000639] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36468 - 200 1156B in 4.14953ms
2025/11/25 13:24:33 INFO {"audit_event":"updated_client_authentication","details":{"clientId":5460,"loggedInUser":""}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000640] "PUT http://localhost:19090/api/v1/admin/clients/5460/authentication HTTP/1.1" from [::1]:36474 - 200 559B in 2.565438ms
--- PASS: TestAPIClientAuthenticationPut_ConfidentialToPublic_Success (0.01s)
=== RUN   TestAPIClientAuthenticationPut_PublicToConfidential_Success
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5461}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000641] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36476 - 200 1156B in 4.156654ms
2025/11/25 13:24:33 INFO {"audit_event":"updated_client_authentication","details":{"clientId":5462,"loggedInUser":""}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000642] "PUT http://localhost:19090/api/v1/admin/clients/5462/authentication HTTP/1.1" from [::1]:36478 - 200 558B in 2.554767ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000643] "GET http://localhost:19090/api/v1/admin/clients/5462 HTTP/1.1" from [::1]:36492 - 200 633B in 499.364Âµs
--- PASS: TestAPIClientAuthenticationPut_PublicToConfidential_Success (0.02s)
=== RUN   TestAPIClientAuthenticationPut_InvalidSecret_TooShort
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5463}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000644] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36508 - 200 1156B in 4.22848ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000645] "PUT http://localhost:19090/api/v1/admin/clients/5464/authentication HTTP/1.1" from [::1]:36512 - 400 100B in 476.109Âµs
--- PASS: TestAPIClientAuthenticationPut_InvalidSecret_TooShort (0.01s)
=== RUN   TestAPIClientAuthenticationPut_InvalidSecret_BadChars
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5465}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000646] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36526 - 200 1156B in 4.209715ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000647] "PUT http://localhost:19090/api/v1/admin/clients/5466/authentication HTTP/1.1" from [::1]:36528 - 400 100B in 457.655Âµs
--- PASS: TestAPIClientAuthenticationPut_InvalidSecret_BadChars (0.01s)
=== RUN   TestAPIClientAuthenticationPut_NotFoundAndInvalidId
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5467}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000648] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36538 - 200 1156B in 4.121177ms
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000649] "PUT http://localhost:19090/api/v1/admin/clients/999999/authentication HTTP/1.1" from [::1]:36554 - 404 60B in 545.861Âµs
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000650] "PUT http://localhost:19090/api/v1/admin/clients/abc/authentication HTTP/1.1" from [::1]:36566 - 400 68B in 287.393Âµs
--- PASS: TestAPIClientAuthenticationPut_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientAuthenticationPut_SystemLevelClientRejected
2025/11/25 13:24:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5468}}
2025/11/25 13:24:33 [a357f2e3b56e/VGvsVkwcAO-000651] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36574 - 200 1156B in 4.146685ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000652] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:36586 - 200 2901990B in 348.615947ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000653] "PUT http://localhost:19090/api/v1/admin/clients/1/authentication HTTP/1.1" from [::1]:36598 - 400 87B in 1.179178ms
--- PASS: TestAPIClientAuthenticationPut_SystemLevelClientRejected (0.37s)
=== RUN   TestAPIClientAuthenticationPut_InsufficientScope
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5469}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000654] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43660 - 200 1154B in 4.497118ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000655] "PUT http://localhost:19090/api/v1/admin/clients/5470/authentication HTTP/1.1" from [::1]:43666 - 403 19B in 434.141Âµs
--- PASS: TestAPIClientAuthenticationPut_InsufficientScope (0.02s)
=== RUN   TestAPIClientCreate_Success
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5471}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000656] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43682 - 200 1156B in 4.416435ms
2025/11/25 13:24:34 INFO {"audit_event":"created_client","details":{"clientId":5472,"clientIdentifier":"client-rvkjfzhp","loggedInUser":""}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000657] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43688 - 201 601B in 2.275369ms
--- PASS: TestAPIClientCreate_Success (0.01s)
=== RUN   TestAPIClientCreate_Validation
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5473}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000658] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43696 - 200 1156B in 4.174568ms
=== RUN   TestAPIClientCreate_Validation/Empty_client_identifier
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000659] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43704 - 400 81B in 373.386Âµs
=== RUN   TestAPIClientCreate_Validation/Client_identifier_too_short
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000660] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43708 - 400 101B in 442.516Âµs
=== RUN   TestAPIClientCreate_Validation/Client_identifier_too_long
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000661] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43718 - 400 114B in 372.174Âµs
=== RUN   TestAPIClientCreate_Validation/Invalid_client_identifier_characters
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000662] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43722 - 400 250B in 420.905Âµs
=== RUN   TestAPIClientCreate_Validation/Description_too_long
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000663] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43726 - 400 116B in 342.467Âµs
--- PASS: TestAPIClientCreate_Validation (0.01s)
    --- PASS: TestAPIClientCreate_Validation/Empty_client_identifier (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Client_identifier_too_short (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Client_identifier_too_long (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Invalid_client_identifier_characters (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Description_too_long (0.00s)
=== RUN   TestAPIClientCreate_Duplicate
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5474}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000664] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43732 - 200 1156B in 4.11719ms
2025/11/25 13:24:34 INFO {"audit_event":"created_client","details":{"clientId":5475,"clientIdentifier":"client-nzebnwiu","loggedInUser":""}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000665] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43742 - 201 596B in 2.692357ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000666] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43754 - 400 91B in 389.386Âµs
--- PASS: TestAPIClientCreate_Duplicate (0.01s)
=== RUN   TestAPIClientCreate_Unauthorized
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000667] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43766 - 401 22B in 111.901Âµs
--- PASS: TestAPIClientCreate_Unauthorized (0.00s)
=== RUN   TestAPIClientCreate_InsufficientScope
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5476}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000668] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43768 - 200 1157B in 4.211758ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000669] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43774 - 403 19B in 880.785Âµs
--- PASS: TestAPIClientCreate_InsufficientScope (0.01s)
=== RUN   TestAPIClientDelete_Success
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5477}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000670] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43780 - 200 1156B in 4.315864ms
2025/11/25 13:24:34 INFO {"audit_event":"deleted_client","details":{"clientId":5478,"clientIdentifier":"del-client-TaAIUKOa","loggedInUser":""}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000671] "DELETE http://localhost:19090/api/v1/admin/clients/5478 HTTP/1.1" from [::1]:43788 - 200 17B in 2.557793ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000672] "GET http://localhost:19090/api/v1/admin/clients/5478 HTTP/1.1" from [::1]:43798 - 404 60B in 416.076Âµs
--- PASS: TestAPIClientDelete_Success (0.01s)
=== RUN   TestAPIClientDelete_SystemLevelRejected
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5479}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000673] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43800 - 200 1156B in 4.19717ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000674] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43814 - 200 2906444B in 351.089631ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000675] "DELETE http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:43822 - 400 89B in 993.868Âµs
--- PASS: TestAPIClientDelete_SystemLevelRejected (0.37s)
=== RUN   TestAPIClientDelete_NotFoundAndInvalidId
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5480}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000676] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43828 - 200 1156B in 4.629157ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000677] "DELETE http://localhost:19090/api/v1/admin/clients/9999999 HTTP/1.1" from [::1]:43830 - 404 60B in 508.19Âµs
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000678] "DELETE http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:43834 - 400 68B in 364.018Âµs
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000679] "DELETE http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:43836 - 401 22B in 97.404Âµs
--- PASS: TestAPIClientDelete_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientGetPermissions_IncludesPermissions
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5481}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000680] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43852 - 200 1156B in 4.401486ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000681] "GET http://localhost:19090/api/v1/admin/clients/5482/permissions HTTP/1.1" from [::1]:43856 - 200 731B in 708.529Âµs
--- PASS: TestAPIClientGetPermissions_IncludesPermissions (0.02s)
=== RUN   TestAPIClientDelete_InsufficientScope
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5483}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000682] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43858 - 200 1157B in 4.163427ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000683] "DELETE http://localhost:19090/api/v1/admin/clients/5484 HTTP/1.1" from [::1]:43864 - 403 19B in 473.204Âµs
--- PASS: TestAPIClientDelete_InsufficientScope (0.01s)
=== RUN   TestAPIClientDelete_CascadesLinkedData
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5485}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000684] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43878 - 200 1156B in 4.355049ms
2025/11/25 13:24:34 INFO {"audit_event":"deleted_client","details":{"clientId":5486,"clientIdentifier":"cascade-client-vYBXmu","loggedInUser":""}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000685] "DELETE http://localhost:19090/api/v1/admin/clients/5486 HTTP/1.1" from [::1]:43894 - 200 17B in 2.820009ms
--- PASS: TestAPIClientDelete_CascadesLinkedData (0.02s)
=== RUN   TestAPIClientGet_ConfidentialIncludesSecretInDetailButNotList
2025/11/25 13:24:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5487}}
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000686] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43906 - 200 1156B in 4.224642ms
2025/11/25 13:24:34 [a357f2e3b56e/VGvsVkwcAO-000687] "GET http://localhost:19090/api/v1/admin/clients/5488 HTTP/1.1" from [::1]:43912 - 200 611B in 610.263Âµs
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000688] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43926 - 200 2909181B in 349.025982ms
--- PASS: TestAPIClientGet_ConfidentialIncludesSecretInDetailButNotList (0.38s)
=== RUN   TestAPIClientOAuth2FlowsPut_Success_PublicClient_ForcesNoClientCredentials
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5489}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000689] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43928 - 200 1156B in 4.427716ms
2025/11/25 13:24:35 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":5490,"loggedInUser":""}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000690] "PUT http://localhost:19090/api/v1/admin/clients/5490/oauth2-flows HTTP/1.1" from [::1]:43932 - 200 557B in 2.624299ms
--- PASS: TestAPIClientOAuth2FlowsPut_Success_PublicClient_ForcesNoClientCredentials (0.02s)
=== RUN   TestAPIClientOAuth2FlowsPut_Success_ConfidentialClient_ToggleBoth
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5491}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000691] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43936 - 200 1156B in 4.35042ms
2025/11/25 13:24:35 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":5492,"loggedInUser":""}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000692] "PUT http://localhost:19090/api/v1/admin/clients/5492/oauth2-flows HTTP/1.1" from [::1]:43950 - 200 556B in 2.631922ms
--- PASS: TestAPIClientOAuth2FlowsPut_Success_ConfidentialClient_ToggleBoth (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_SystemLevelClientRejected
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5493}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000693] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43954 - 200 1156B in 4.22359ms
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000694] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43964 - 200 2910283B in 369.090222ms
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000695] "PUT http://localhost:19090/api/v1/admin/clients/1/oauth2-flows HTTP/1.1" from [::1]:43976 - 400 87B in 683.051Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_SystemLevelClientRejected (0.39s)
=== RUN   TestAPIClientOAuth2FlowsPut_NotFoundAndInvalidId
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5494}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000696] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43984 - 200 1156B in 4.759123ms
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000697] "PUT http://localhost:19090/api/v1/admin/clients/999999/oauth2-flows HTTP/1.1" from [::1]:44000 - 404 60B in 453.778Âµs
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000698] "PUT http://localhost:19090/api/v1/admin/clients/abc/oauth2-flows HTTP/1.1" from [::1]:44002 - 400 68B in 442.997Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_NotFoundAndInvalidId (0.03s)
=== RUN   TestAPIClientOAuth2FlowsPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5495}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000699] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44016 - 200 1156B in 4.342365ms
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000700] "PUT http://localhost:19090/api/v1/admin/clients/5496/oauth2-flows HTTP/1.1" from [::1]:44020 - 400 70B in 724.79Âµs
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000701] "PUT http://localhost:19090/api/v1/admin/clients/5496/oauth2-flows HTTP/1.1" from [::1]:44020 - 401 22B in 109.127Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_InvalidRequestBodyAndUnauthorized (0.03s)
=== RUN   TestAPIClientOAuth2FlowsPut_InsufficientScope
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5497}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000702] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44022 - 200 1156B in 4.260811ms
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000703] "PUT http://localhost:19090/api/v1/admin/clients/5498/oauth2-flows HTTP/1.1" from [::1]:44038 - 403 19B in 417.609Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_BothDisabledAllowed
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5499}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000704] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44040 - 200 1156B in 4.180318ms
2025/11/25 13:24:35 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":5500,"loggedInUser":""}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000705] "PUT http://localhost:19090/api/v1/admin/clients/5500/oauth2-flows HTTP/1.1" from [::1]:44044 - 200 560B in 2.460268ms
--- PASS: TestAPIClientOAuth2FlowsPut_BothDisabledAllowed (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_Success_AddRemoveAndTrim
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5501}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000706] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44052 - 200 1156B in 4.280167ms
2025/11/25 13:24:35 INFO {"audit_event":"updated_redirect_uris","details":{"clientId":5502,"loggedInUser":""}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000707] "PUT http://localhost:19090/api/v1/admin/clients/5502/redirect-uris HTTP/1.1" from [::1]:44066 - 200 811B in 3.81611ms
--- PASS: TestAPIClientRedirectURIsPut_Success_AddRemoveAndTrim (0.02s)
=== RUN   TestAPIClientRedirectURIsPut_AuthCodeDisabledRejected
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5503}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000708] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44082 - 200 1156B in 4.194846ms
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000709] "PUT http://localhost:19090/api/v1/admin/clients/5504/redirect-uris HTTP/1.1" from [::1]:44090 - 400 103B in 447.455Âµs
--- PASS: TestAPIClientRedirectURIsPut_AuthCodeDisabledRejected (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_SystemLevelClientRejected
2025/11/25 13:24:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5505}}
2025/11/25 13:24:35 [a357f2e3b56e/VGvsVkwcAO-000710] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44098 - 200 1156B in 4.29221ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000711] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44104 - 200 2913577B in 346.161178ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000712] "PUT http://localhost:19090/api/v1/admin/clients/1/redirect-uris HTTP/1.1" from [::1]:44110 - 400 87B in 1.00559ms
--- PASS: TestAPIClientRedirectURIsPut_SystemLevelClientRejected (0.37s)
=== RUN   TestAPIClientRedirectURIsPut_DuplicateAndInvalidURLs
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5506}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000713] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44122 - 200 1156B in 4.661949ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000714] "PUT http://localhost:19090/api/v1/admin/clients/5507/redirect-uris HTTP/1.1" from [::1]:44138 - 400 90B in 489.705Âµs
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000715] "PUT http://localhost:19090/api/v1/admin/clients/5507/redirect-uris HTTP/1.1" from [::1]:44144 - 400 82B in 424.252Âµs
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000716] "PUT http://localhost:19090/api/v1/admin/clients/5507/redirect-uris HTTP/1.1" from [::1]:44146 - 400 79B in 361.843Âµs
--- PASS: TestAPIClientRedirectURIsPut_DuplicateAndInvalidURLs (0.02s)
=== RUN   TestAPIClientRedirectURIsPut_NotFound_InvalidId_InvalidBody_Unauthorized
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5508}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000717] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44148 - 200 1156B in 4.533617ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000718] "PUT http://localhost:19090/api/v1/admin/clients/999999/redirect-uris HTTP/1.1" from [::1]:44162 - 404 60B in 409.734Âµs
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000719] "PUT http://localhost:19090/api/v1/admin/clients/abc/redirect-uris HTTP/1.1" from [::1]:44170 - 400 68B in 347.617Âµs
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000720] "PUT http://localhost:19090/api/v1/admin/clients/5509/redirect-uris HTTP/1.1" from [::1]:44174 - 400 70B in 972.788Âµs
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000721] "PUT http://localhost:19090/api/v1/admin/clients/5509/redirect-uris HTTP/1.1" from [::1]:44174 - 401 22B in 139.864Âµs
--- PASS: TestAPIClientRedirectURIsPut_NotFound_InvalidId_InvalidBody_Unauthorized (0.02s)
=== RUN   TestAPIClientRedirectURIsPut_InsufficientScope
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5510}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000722] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44176 - 200 1156B in 4.507677ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000723] "PUT http://localhost:19090/api/v1/admin/clients/5511/redirect-uris HTTP/1.1" from [::1]:44182 - 403 19B in 379.147Âµs
--- PASS: TestAPIClientRedirectURIsPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientSessionsGet_Success
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5512}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000724] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44186 - 200 1156B in 4.436242ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000725] "GET http://localhost:19090/api/v1/admin/clients/5513/sessions HTTP/1.1" from [::1]:44198 - 200 1467B in 1.723467ms
--- PASS: TestAPIClientSessionsGet_Success (0.03s)
=== RUN   TestAPIClientSessionsGet_EmptySessions
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5514}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000726] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44202 - 200 1156B in 4.799849ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000727] "GET http://localhost:19090/api/v1/admin/clients/5515/sessions HTTP/1.1" from [::1]:44212 - 200 16B in 1.093055ms
--- PASS: TestAPIClientSessionsGet_EmptySessions (0.02s)
=== RUN   TestAPIClientSessionsGet_ClientNotFound
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5516}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000728] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44226 - 200 1156B in 4.520872ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000729] "GET http://localhost:19090/api/v1/admin/clients/999999/sessions HTTP/1.1" from [::1]:44242 - 404 67B in 394.866Âµs
--- PASS: TestAPIClientSessionsGet_ClientNotFound (0.01s)
=== RUN   TestAPIClientSessionsGet_InvalidId
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5517}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000730] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44246 - 200 1156B in 4.142336ms
=== RUN   TestAPIClientSessionsGet_InvalidId/non-numeric
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000731] "GET http://localhost:19090/api/v1/admin/clients/abc/sessions HTTP/1.1" from [::1]:44258 - 400 76B in 356.463Âµs
=== RUN   TestAPIClientSessionsGet_InvalidId/negative
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000732] "GET http://localhost:19090/api/v1/admin/clients/-1/sessions HTTP/1.1" from [::1]:44268 - 404 67B in 452.295Âµs
--- PASS: TestAPIClientSessionsGet_InvalidId (0.01s)
    --- PASS: TestAPIClientSessionsGet_InvalidId/non-numeric (0.00s)
    --- PASS: TestAPIClientSessionsGet_InvalidId/negative (0.00s)
=== RUN   TestAPIClientSessionsGet_Unauthorized
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000733] "GET http://localhost:19090/api/v1/admin/clients/5518/sessions HTTP/1.1" from [::1]:44272 - 401 22B in 139.062Âµs
--- PASS: TestAPIClientSessionsGet_Unauthorized (0.00s)
=== RUN   TestAPIClientSessionsGet_OnlyValidSessions
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5519}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000734] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44284 - 200 1156B in 4.285177ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000735] "GET http://localhost:19090/api/v1/admin/clients/5520/sessions HTTP/1.1" from [::1]:44294 - 200 745B in 1.012984ms
--- PASS: TestAPIClientSessionsGet_OnlyValidSessions (0.03s)
=== RUN   TestAPIClientSessionsGet_PaginationDefaultAndCap
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5521}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000736] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44304 - 200 1156B in 4.305385ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000737] "GET http://localhost:19090/api/v1/admin/clients/5522/sessions HTTP/1.1" from [::1]:44320 - 200 36055B in 4.57839ms
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000738] "GET http://localhost:19090/api/v1/admin/clients/5522/sessions?size=200 HTTP/1.1" from [::1]:44336 - 200 72097B in 7.735727ms
--- PASS: TestAPIClientSessionsGet_PaginationDefaultAndCap (0.64s)
=== RUN   TestAPIClientsGet_Success
2025/11/25 13:24:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5523}}
2025/11/25 13:24:36 [a357f2e3b56e/VGvsVkwcAO-000739] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44352 - 200 1156B in 4.714378ms
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000740] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44358 - 200 2918518B in 359.072083ms
--- PASS: TestAPIClientsGet_Success (0.38s)
=== RUN   TestAPIClientsGet_Unauthorized
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000741] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44370 - 401 22B in 499.684Âµs
--- PASS: TestAPIClientsGet_Unauthorized (0.00s)
=== RUN   TestAPIClientGet_Success
2025/11/25 13:24:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5524}}
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000742] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44372 - 200 1156B in 4.378463ms
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000743] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44376 - 200 2919067B in 343.837888ms
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000744] "GET http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44388 - 200 935B in 916.111Âµs
--- PASS: TestAPIClientGet_Success (0.37s)
=== RUN   TestAPIClientGet_NotFound
2025/11/25 13:24:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5525}}
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000745] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44400 - 200 1156B in 4.785953ms
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000746] "GET http://localhost:19090/api/v1/admin/clients/99999 HTTP/1.1" from [::1]:44410 - 404 60B in 584.425Âµs
--- PASS: TestAPIClientGet_NotFound (0.01s)
=== RUN   TestAPIClientGet_InvalidId
2025/11/25 13:24:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5526}}
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000747] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44412 - 200 1156B in 4.205957ms
=== RUN   TestAPIClientGet_InvalidId/non-numeric_ID
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000748] "GET http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:44428 - 400 68B in 482.142Âµs
=== RUN   TestAPIClientGet_InvalidId/negative_ID
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000749] "GET http://localhost:19090/api/v1/admin/clients/-1 HTTP/1.1" from [::1]:44432 - 404 60B in 442.376Âµs
--- PASS: TestAPIClientGet_InvalidId (0.01s)
    --- PASS: TestAPIClientGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIClientGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIClientGet_EmptyId
2025/11/25 13:24:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5527}}
2025/11/25 13:24:37 [a357f2e3b56e/VGvsVkwcAO-000750] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44434 - 200 1156B in 4.243188ms
--- PASS: TestAPIClientGet_EmptyId (0.35s)
=== RUN   TestAPIClientGet_Unauthorized
2025/11/25 13:24:38 ERROR write tcp [::1]:19090->[::1]:44442: write: connection reset by peer
request-id: a357f2e3b56e/VGvsVkwcAO-000751
2025/11/25 13:24:38 ERROR write tcp [::1]:19090->[::1]:44442: write: connection reset by peer
request-id: a357f2e3b56e/VGvsVkwcAO-000751
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000751] "GET http://localhost:19090/api/v1/admin/clients/ HTTP/1.1" from [::1]:44442 - 200 1642358B in 345.690008ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000752] "GET http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44458 - 401 22B in 185.44Âµs
--- PASS: TestAPIClientGet_Unauthorized (0.00s)
=== RUN   TestAPIClientTokensPut_Success
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5528}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000753] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44468 - 200 1156B in 4.218741ms
2025/11/25 13:24:38 INFO {"audit_event":"updated_client_tokens","details":{"clientId":5529,"loggedInUser":""}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000754] "PUT http://localhost:19090/api/v1/admin/clients/5529/tokens HTTP/1.1" from [::1]:44480 - 200 608B in 2.738404ms
--- PASS: TestAPIClientTokensPut_Success (0.02s)
=== RUN   TestAPIClientTokensPut_ValidationErrors
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5530}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000755] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44482 - 200 1156B in 4.221607ms
=== RUN   TestAPIClientTokensPut_ValidationErrors/token_exp_too_large
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000756] "PUT http://localhost:19090/api/v1/admin/clients/5531/tokens HTTP/1.1" from [::1]:44494 - 400 111B in 769.213Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/idle_too_large
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000757] "PUT http://localhost:19090/api/v1/admin/clients/5531/tokens HTTP/1.1" from [::1]:44498 - 400 131B in 536.143Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/maxlife_too_large
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000758] "PUT http://localhost:19090/api/v1/admin/clients/5531/tokens HTTP/1.1" from [::1]:44514 - 400 131B in 406.518Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/idle_gt_maxlife
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000759] "PUT http://localhost:19090/api/v1/admin/clients/5531/tokens HTTP/1.1" from [::1]:44526 - 400 124B in 375.429Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/invalid_three_state
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000760] "PUT http://localhost:19090/api/v1/admin/clients/5531/tokens HTTP/1.1" from [::1]:44534 - 400 109B in 506.337Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/negatives_rejected
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000761] "PUT http://localhost:19090/api/v1/admin/clients/5531/tokens HTTP/1.1" from [::1]:44542 - 400 111B in 505.415Âµs
--- PASS: TestAPIClientTokensPut_ValidationErrors (0.02s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/token_exp_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/idle_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/maxlife_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/idle_gt_maxlife (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/invalid_three_state (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/negatives_rejected (0.00s)
=== RUN   TestAPIClientTokensPut_NotFoundAndInvalidId
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5532}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000762] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44546 - 200 1156B in 4.250892ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000763] "PUT http://localhost:19090/api/v1/admin/clients/999999/tokens HTTP/1.1" from [::1]:44558 - 404 60B in 390.157Âµs
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000764] "PUT http://localhost:19090/api/v1/admin/clients/abc/tokens HTTP/1.1" from [::1]:44568 - 400 68B in 321.017Âµs
--- PASS: TestAPIClientTokensPut_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientTokensPut_SystemLevelClientRejected
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5533}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000765] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44578 - 200 1156B in 4.449097ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000766] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44592 - 200 2922908B in 347.786219ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000767] "PUT http://localhost:19090/api/v1/admin/clients/1/tokens HTTP/1.1" from [::1]:44608 - 400 87B in 750.057Âµs
--- PASS: TestAPIClientTokensPut_SystemLevelClientRejected (0.37s)
=== RUN   TestAPIClientTokensPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5534}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000768] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44618 - 200 1156B in 4.41342ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000769] "PUT http://localhost:19090/api/v1/admin/clients/5535/tokens HTTP/1.1" from [::1]:44628 - 400 70B in 466.892Âµs
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000770] "PUT http://localhost:19090/api/v1/admin/clients/5535/tokens HTTP/1.1" from [::1]:44628 - 401 22B in 106.992Âµs
--- PASS: TestAPIClientTokensPut_InvalidRequestBodyAndUnauthorized (0.02s)
=== RUN   TestAPIClientTokensPut_InsufficientScope
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5536}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000771] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44634 - 200 1157B in 4.156955ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000772] "PUT http://localhost:19090/api/v1/admin/clients/5537/tokens HTTP/1.1" from [::1]:44638 - 403 19B in 403.612Âµs
--- PASS: TestAPIClientTokensPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientUpdatePut_Success
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5538}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000773] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44654 - 200 1156B in 4.379755ms
2025/11/25 13:24:38 INFO {"audit_event":"updated_client_settings","details":{"clientId":5539,"loggedInUser":""}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000774] "PUT http://localhost:19090/api/v1/admin/clients/5539 HTTP/1.1" from [::1]:44666 - 200 600B in 2.5875ms
--- PASS: TestAPIClientUpdatePut_Success (0.01s)
=== RUN   TestAPIClientUpdatePut_ValidationErrors
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5540}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000775] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44678 - 200 1156B in 4.141987ms
=== RUN   TestAPIClientUpdatePut_ValidationErrors/empty_identifier
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000776] "PUT http://localhost:19090/api/v1/admin/clients/5541 HTTP/1.1" from [::1]:44680 - 400 81B in 485.337Âµs
=== RUN   TestAPIClientUpdatePut_ValidationErrors/desc_too_long
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000777] "PUT http://localhost:19090/api/v1/admin/clients/5541 HTTP/1.1" from [::1]:44688 - 400 116B in 451.423Âµs
=== RUN   TestAPIClientUpdatePut_ValidationErrors/invalid_identifier_format
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000778] "PUT http://localhost:19090/api/v1/admin/clients/5541 HTTP/1.1" from [::1]:44694 - 400 250B in 478.925Âµs
--- PASS: TestAPIClientUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/empty_identifier (0.00s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/desc_too_long (0.00s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIClientUpdatePut_DuplicateIdentifier
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5542}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000779] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44698 - 200 1156B in 4.185118ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000780] "PUT http://localhost:19090/api/v1/admin/clients/5544 HTTP/1.1" from [::1]:44702 - 400 91B in 531.635Âµs
--- PASS: TestAPIClientUpdatePut_DuplicateIdentifier (0.02s)
=== RUN   TestAPIClientUpdatePut_SameIdentifierAllowed
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5545}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000781] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44708 - 200 1156B in 4.121688ms
2025/11/25 13:24:38 INFO {"audit_event":"updated_client_settings","details":{"clientId":5546,"loggedInUser":""}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000782] "PUT http://localhost:19090/api/v1/admin/clients/5546 HTTP/1.1" from [::1]:44716 - 200 593B in 2.178797ms
--- PASS: TestAPIClientUpdatePut_SameIdentifierAllowed (0.01s)
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5547}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000783] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44728 - 200 1156B in 4.14931ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000784] "PUT http://localhost:19090/api/v1/admin/clients/99999 HTTP/1.1" from [::1]:44732 - 404 60B in 463.967Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/non-numeric
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000785] "PUT http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:44736 - 400 68B in 374.207Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/empty
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000786] "PUT http://localhost:19090/api/v1/admin/clients/ HTTP/1.1" from [::1]:44740 - 405 0B in 324.273Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/negative
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000787] "PUT http://localhost:19090/api/v1/admin/clients/-1 HTTP/1.1" from [::1]:44746 - 404 60B in 327.018Âµs
--- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId (0.01s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/non-numeric (0.00s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/empty (0.00s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/negative (0.00s)
=== RUN   TestAPIClientUpdatePut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5548}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000788] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44758 - 200 1156B in 4.182543ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000789] "PUT http://localhost:19090/api/v1/admin/clients/5549 HTTP/1.1" from [::1]:44764 - 400 70B in 495.416Âµs
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000790] "PUT http://localhost:19090/api/v1/admin/clients/5549 HTTP/1.1" from [::1]:44764 - 401 22B in 94.218Âµs
--- PASS: TestAPIClientUpdatePut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPIClientUpdatePut_ACRRuleEnforcement
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5550}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000791] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44772 - 200 1156B in 4.071773ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000792] "PUT http://localhost:19090/api/v1/admin/clients/5551 HTTP/1.1" from [::1]:44788 - 400 128B in 581.118Âµs
--- PASS: TestAPIClientUpdatePut_ACRRuleEnforcement (0.01s)
=== RUN   TestAPIClientUpdatePut_WhitespaceHandling
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5552}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000793] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44802 - 200 1156B in 4.185508ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000794] "PUT http://localhost:19090/api/v1/admin/clients/5553 HTTP/1.1" from [::1]:44806 - 400 250B in 434.962Âµs
2025/11/25 13:24:38 INFO {"audit_event":"updated_client_settings","details":{"clientId":5553,"loggedInUser":""}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000795] "PUT http://localhost:19090/api/v1/admin/clients/5553 HTTP/1.1" from [::1]:44820 - 200 597B in 2.24386ms
--- PASS: TestAPIClientUpdatePut_WhitespaceHandling (0.01s)
=== RUN   TestAPIClientUpdatePut_SystemLevelClientRejected
2025/11/25 13:24:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5554}}
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000796] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44824 - 200 1156B in 4.092523ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000797] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44836 - 200 2928394B in 360.434126ms
2025/11/25 13:24:38 [a357f2e3b56e/VGvsVkwcAO-000798] "PUT http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44846 - 400 87B in 1.038743ms
--- PASS: TestAPIClientUpdatePut_SystemLevelClientRejected (0.38s)
=== RUN   TestAPIClientUpdatePut_InvalidDefaultAcrLevelValue
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5555}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000799] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44854 - 200 1156B in 4.833253ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000800] "PUT http://localhost:19090/api/v1/admin/clients/5556 HTTP/1.1" from [::1]:44860 - 400 76B in 802.467Âµs
--- PASS: TestAPIClientUpdatePut_InvalidDefaultAcrLevelValue (0.01s)
=== RUN   TestAPIClientUpdatePut_InsufficientScope
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5557}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000801] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44868 - 200 1157B in 4.642262ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000802] "PUT http://localhost:19090/api/v1/admin/clients/5558 HTTP/1.1" from [::1]:44882 - 403 19B in 524.942Âµs
--- PASS: TestAPIClientUpdatePut_InsufficientScope (0.01s)
=== RUN   TestAPIClientWebOriginsPut_Success_AddRemoveAndNormalize
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5559}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000803] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44890 - 200 1156B in 4.35076ms
2025/11/25 13:24:39 INFO {"audit_event":"updated_web_origins","details":{"clientId":5560,"loggedInUser":""}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000804] "PUT http://localhost:19090/api/v1/admin/clients/5560/web-origins HTTP/1.1" from [::1]:44892 - 200 798B in 3.860545ms
--- PASS: TestAPIClientWebOriginsPut_Success_AddRemoveAndNormalize (0.02s)
=== RUN   TestAPIClientWebOriginsPut_AuthCodeDisabledRejected
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5561}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000805] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44896 - 200 1156B in 4.58328ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000806] "PUT http://localhost:19090/api/v1/admin/clients/5562/web-origins HTTP/1.1" from [::1]:44910 - 400 103B in 563.986Âµs
--- PASS: TestAPIClientWebOriginsPut_AuthCodeDisabledRejected (0.01s)
=== RUN   TestAPIClientWebOriginsPut_SystemLevelClientRejected
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5563}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000807] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44912 - 200 1156B in 4.556119ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000808] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44922 - 200 2930588B in 367.330988ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000809] "PUT http://localhost:19090/api/v1/admin/clients/1/web-origins HTTP/1.1" from [::1]:44930 - 400 87B in 1.395738ms
--- PASS: TestAPIClientWebOriginsPut_SystemLevelClientRejected (0.39s)
=== RUN   TestAPIClientWebOriginsPut_DuplicateInvalidWrongSchemeAndEmpty
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5564}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000810] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44934 - 200 1156B in 6.20815ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000811] "PUT http://localhost:19090/api/v1/admin/clients/5565/web-origins HTTP/1.1" from [::1]:44936 - 400 88B in 644.007Âµs
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000812] "PUT http://localhost:19090/api/v1/admin/clients/5565/web-origins HTTP/1.1" from [::1]:44944 - 400 80B in 517.598Âµs
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000813] "PUT http://localhost:19090/api/v1/admin/clients/5565/web-origins HTTP/1.1" from [::1]:44960 - 400 91B in 400.516Âµs
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000814] "PUT http://localhost:19090/api/v1/admin/clients/5565/web-origins HTTP/1.1" from [::1]:44974 - 400 77B in 1.309905ms
--- PASS: TestAPIClientWebOriginsPut_DuplicateInvalidWrongSchemeAndEmpty (0.03s)
=== RUN   TestAPIClientWebOriginsPut_NotFound_InvalidId_InvalidBody_Unauthorized
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5566}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000815] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44978 - 200 1156B in 4.528106ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000816] "PUT http://localhost:19090/api/v1/admin/clients/999999/web-origins HTTP/1.1" from [::1]:44982 - 404 60B in 477.683Âµs
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000817] "PUT http://localhost:19090/api/v1/admin/clients/abc/web-origins HTTP/1.1" from [::1]:44986 - 400 68B in 609.972Âµs
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000818] "PUT http://localhost:19090/api/v1/admin/clients/5567/web-origins HTTP/1.1" from [::1]:44998 - 400 70B in 405.937Âµs
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000819] "PUT http://localhost:19090/api/v1/admin/clients/5567/web-origins HTTP/1.1" from [::1]:44998 - 401 22B in 160.333Âµs
--- PASS: TestAPIClientWebOriginsPut_NotFound_InvalidId_InvalidBody_Unauthorized (0.02s)
=== RUN   TestAPIClientWebOriginsPut_InsufficientScope
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5568}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000820] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45002 - 200 1158B in 4.624348ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000821] "PUT http://localhost:19090/api/v1/admin/clients/5569/web-origins HTTP/1.1" from [::1]:45004 - 403 19B in 421.296Âµs
--- PASS: TestAPIClientWebOriginsPut_InsufficientScope (0.01s)
=== RUN   TestAPIGroupMembersGet_Success
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5570}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000822] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45012 - 200 1156B in 4.226727ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000823] "GET http://localhost:19090/api/v1/admin/groups/676/members HTTP/1.1" from [::1]:45024 - 200 1419B in 1.096522ms
--- PASS: TestAPIGroupMembersGet_Success (0.03s)
=== RUN   TestAPIGroupMembersGet_EmptyGroup
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5571}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000824] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45038 - 200 1156B in 4.369747ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000825] "GET http://localhost:19090/api/v1/admin/groups/677/members HTTP/1.1" from [::1]:45050 - 200 46B in 931.009Âµs
--- PASS: TestAPIGroupMembersGet_EmptyGroup (0.01s)
=== RUN   TestAPIGroupMembersGet_Pagination
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5572}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000826] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45060 - 200 1156B in 4.252605ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000827] "GET http://localhost:19090/api/v1/admin/groups/678/members?page=1&size=2 HTTP/1.1" from [::1]:45074 - 200 1422B in 820.931Âµs
--- PASS: TestAPIGroupMembersGet_Pagination (0.03s)
=== RUN   TestAPIGroupMembersGet_GroupNotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5573}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000828] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45080 - 200 1156B in 4.422416ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000829] "GET http://localhost:19090/api/v1/admin/groups/99999/members HTTP/1.1" from [::1]:45086 - 404 59B in 469.347Âµs
--- PASS: TestAPIGroupMembersGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMembersGet_InvalidGroupId
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5574}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000830] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45102 - 200 1156B in 4.274287ms
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/non-numeric_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000831] "GET http://localhost:19090/api/v1/admin/groups/abc/members HTTP/1.1" from [::1]:45114 - 400 67B in 411.087Âµs
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/empty_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000832] "GET http://localhost:19090/api/v1/admin/groups//members HTTP/1.1" from [::1]:45118 - 400 71B in 328.721Âµs
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/negative_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000833] "GET http://localhost:19090/api/v1/admin/groups/-1/members HTTP/1.1" from [::1]:45122 - 404 59B in 337.137Âµs
--- PASS: TestAPIGroupMembersGet_InvalidGroupId (0.01s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/empty_ID (0.00s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/negative_ID (0.00s)
=== RUN   TestAPIGroupMemberAdd_Success
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5575}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000834] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45130 - 200 1156B in 4.298281ms
2025/11/25 13:24:39 INFO {"audit_event":"user_added_to_group","details":{"groupId":679,"loggedInUser":"","userId":2340}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000835] "POST http://localhost:19090/api/v1/admin/groups/679/members HTTP/1.1" from [::1]:45132 - 201 17B in 2.993747ms
--- PASS: TestAPIGroupMemberAdd_Success (0.02s)
=== RUN   TestAPIGroupMemberAdd_UserAlreadyInGroup
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5576}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000836] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45134 - 200 1156B in 4.201479ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000837] "POST http://localhost:19090/api/v1/admin/groups/680/members HTTP/1.1" from [::1]:45148 - 400 89B in 628.989Âµs
--- PASS: TestAPIGroupMemberAdd_UserAlreadyInGroup (0.02s)
=== RUN   TestAPIGroupMemberAdd_UserNotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5577}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000838] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45154 - 200 1156B in 4.336745ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000839] "POST http://localhost:19090/api/v1/admin/groups/681/members HTTP/1.1" from [::1]:45162 - 404 63B in 558.074Âµs
--- PASS: TestAPIGroupMemberAdd_UserNotFound (0.01s)
=== RUN   TestAPIGroupMemberAdd_GroupNotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5578}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000840] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45176 - 200 1156B in 4.31321ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000841] "POST http://localhost:19090/api/v1/admin/groups/99999/members HTTP/1.1" from [::1]:45188 - 404 59B in 641.903Âµs
--- PASS: TestAPIGroupMemberAdd_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMemberAdd_InvalidRequestBody
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5579}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000842] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45202 - 200 1156B in 4.152366ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000843] "POST http://localhost:19090/api/v1/admin/groups/682/members HTTP/1.1" from [::1]:45210 - 400 70B in 349.611Âµs
--- PASS: TestAPIGroupMemberAdd_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupMemberRemove_Success
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5580}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000844] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45220 - 200 1156B in 4.241043ms
2025/11/25 13:24:39 INFO {"audit_event":"user_removed_from_group","details":{"groupId":683,"loggedInUser":"","userId":2342}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000845] "DELETE http://localhost:19090/api/v1/admin/groups/683/members/2342 HTTP/1.1" from [::1]:45222 - 200 17B in 2.251544ms
--- PASS: TestAPIGroupMemberRemove_Success (0.02s)
=== RUN   TestAPIGroupMemberRemove_UserNotInGroup
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5581}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000846] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45238 - 200 1156B in 4.284154ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000847] "DELETE http://localhost:19090/api/v1/admin/groups/684/members/2343 HTTP/1.1" from [::1]:45242 - 400 85B in 548.536Âµs
--- PASS: TestAPIGroupMemberRemove_UserNotInGroup (0.02s)
=== RUN   TestAPIGroupMemberRemove_UserNotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5582}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000848] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45246 - 200 1156B in 4.426303ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000849] "DELETE http://localhost:19090/api/v1/admin/groups/685/members/99999 HTTP/1.1" from [::1]:45258 - 404 63B in 573.985Âµs
--- PASS: TestAPIGroupMemberRemove_UserNotFound (0.01s)
=== RUN   TestAPIGroupMemberRemove_GroupNotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5583}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000850] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45268 - 200 1156B in 4.193273ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000851] "DELETE http://localhost:19090/api/v1/admin/groups/99999/members/1 HTTP/1.1" from [::1]:45270 - 404 59B in 390.538Âµs
--- PASS: TestAPIGroupMemberRemove_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMemberRemove_InvalidIds
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5584}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000852] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45286 - 200 1156B in 4.256503ms
=== RUN   TestAPIGroupMemberRemove_InvalidIds/non-numeric_group_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000853] "DELETE http://localhost:19090/api/v1/admin/groups/abc/members/1 HTTP/1.1" from [::1]:45300 - 400 67B in 363.967Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/non-numeric_user_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000854] "DELETE http://localhost:19090/api/v1/admin/groups/1/members/abc HTTP/1.1" from [::1]:45304 - 400 66B in 337.618Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/negative_group_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000855] "DELETE http://localhost:19090/api/v1/admin/groups/-1/members/1 HTTP/1.1" from [::1]:45318 - 404 59B in 353.578Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/negative_user_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000856] "DELETE http://localhost:19090/api/v1/admin/groups/1/members/-1 HTTP/1.1" from [::1]:45332 - 404 59B in 366.192Âµs
--- PASS: TestAPIGroupMemberRemove_InvalidIds (0.01s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/non-numeric_group_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/non-numeric_user_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/negative_group_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/negative_user_ID (0.00s)
=== RUN   TestAPIGroupMembers_Unauthorized
=== RUN   TestAPIGroupMembers_Unauthorized/GET_members
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000857] "GET http://localhost:19090/api/v1/admin/groups/686/members HTTP/1.1" from [::1]:45342 - 401 22B in 107.823Âµs
=== RUN   TestAPIGroupMembers_Unauthorized/POST_add_member
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000858] "POST http://localhost:19090/api/v1/admin/groups/686/members HTTP/1.1" from [::1]:45348 - 401 22B in 108.545Âµs
=== RUN   TestAPIGroupMembers_Unauthorized/DELETE_remove_member
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000859] "DELETE http://localhost:19090/api/v1/admin/groups/686/members/1 HTTP/1.1" from [::1]:45350 - 401 22B in 96.001Âµs
--- PASS: TestAPIGroupMembers_Unauthorized (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/GET_members (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/POST_add_member (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/DELETE_remove_member (0.00s)
=== RUN   TestAPIGroupAttributesGet_Success
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5585}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000860] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45360 - 200 1156B in 4.32384ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000861] "GET http://localhost:19090/api/v1/admin/groups/687/attributes HTTP/1.1" from [::1]:45364 - 200 413B in 524.07Âµs
--- PASS: TestAPIGroupAttributesGet_Success (0.02s)
=== RUN   TestAPIGroupAttributesGet_EmptyAttributes
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5586}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000862] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45376 - 200 1156B in 5.483682ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000863] "GET http://localhost:19090/api/v1/admin/groups/688/attributes HTTP/1.1" from [::1]:45384 - 200 18B in 594.143Âµs
--- PASS: TestAPIGroupAttributesGet_EmptyAttributes (0.01s)
=== RUN   TestAPIGroupAttributesGet_GroupNotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5587}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000864] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45398 - 200 1156B in 4.222198ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000865] "GET http://localhost:19090/api/v1/admin/groups/99999/attributes HTTP/1.1" from [::1]:45412 - 404 59B in 440.453Âµs
--- PASS: TestAPIGroupAttributesGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupAttributesGet_InvalidId
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5588}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000866] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45414 - 200 1156B in 4.174248ms
=== RUN   TestAPIGroupAttributesGet_InvalidId/non-numeric_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000867] "GET http://localhost:19090/api/v1/admin/groups/abc/attributes HTTP/1.1" from [::1]:45428 - 400 67B in 353.137Âµs
=== RUN   TestAPIGroupAttributesGet_InvalidId/empty_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000868] "GET http://localhost:19090/api/v1/admin/groups//attributes HTTP/1.1" from [::1]:45434 - 400 71B in 332.589Âµs
=== RUN   TestAPIGroupAttributesGet_InvalidId/negative_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000869] "GET http://localhost:19090/api/v1/admin/groups/-1/attributes HTTP/1.1" from [::1]:45444 - 404 59B in 360.211Âµs
--- PASS: TestAPIGroupAttributesGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributesGet_Unauthorized
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000870] "GET http://localhost:19090/api/v1/admin/groups/689/attributes HTTP/1.1" from [::1]:45446 - 401 22B in 119.385Âµs
--- PASS: TestAPIGroupAttributesGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeGet_Success
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5589}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000871] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45460 - 200 1156B in 4.203352ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000872] "GET http://localhost:19090/api/v1/admin/group-attributes/102 HTTP/1.1" from [::1]:45464 - 200 207B in 521.486Âµs
--- PASS: TestAPIGroupAttributeGet_Success (0.02s)
=== RUN   TestAPIGroupAttributeGet_NotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5590}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000873] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45466 - 200 1156B in 4.18131ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000874] "GET http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:45482 - 404 69B in 451.834Âµs
--- PASS: TestAPIGroupAttributeGet_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeGet_InvalidId
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5591}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000875] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45484 - 200 1156B in 4.197912ms
=== RUN   TestAPIGroupAttributeGet_InvalidId/non-numeric_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000876] "GET http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:45488 - 400 77B in 774.593Âµs
=== RUN   TestAPIGroupAttributeGet_InvalidId/empty_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000877] "GET http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:45490 - 405 0B in 480.107Âµs
=== RUN   TestAPIGroupAttributeGet_InvalidId/negative_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000878] "GET http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:45494 - 404 69B in 329.783Âµs
--- PASS: TestAPIGroupAttributeGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeGet_Unauthorized
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000879] "GET http://localhost:19090/api/v1/admin/group-attributes/103 HTTP/1.1" from [::1]:45498 - 401 22B in 144.152Âµs
--- PASS: TestAPIGroupAttributeGet_Unauthorized (0.01s)
=== RUN   TestAPIGroupAttributeCreatePost_Success
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5592}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000880] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45510 - 200 1156B in 4.287641ms
2025/11/25 13:24:39 INFO {"audit_event":"added_group_attribute","details":{"groupAttributeId":104,"groupId":692,"groupIdentifier":"test-group-7904221d","loggedInUser":""}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000881] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45514 - 201 222B in 2.24417ms
--- PASS: TestAPIGroupAttributeCreatePost_Success (0.02s)
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5593}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000882] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45528 - 200 1156B in 4.259268ms
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/missing_key
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000883] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45530 - 400 76B in 426.335Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/empty_key
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000884] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45540 - 400 76B in 351.695Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/value_too_long
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000885] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45544 - 400 119B in 422.027Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/invalid_key_format
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000886] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45552 - 400 250B in 396.389Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/group_not_found
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000887] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45566 - 404 59B in 450.17Âµs
--- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/invalid_key_format (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/group_not_found (0.00s)
=== RUN   TestAPIGroupAttributeCreatePost_InvalidRequestBody
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5594}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000888] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45582 - 200 1156B in 4.242757ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000889] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45596 - 400 70B in 382.613Âµs
--- PASS: TestAPIGroupAttributeCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupAttributeCreatePost_Unauthorized
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000890] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45610 - 401 22B in 167.516Âµs
--- PASS: TestAPIGroupAttributeCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_Success
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5595}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000891] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45620 - 200 1156B in 4.375347ms
2025/11/25 13:24:39 INFO {"audit_event":"updated_group_attribute","details":{"groupAttributeId":105,"groupId":694,"groupIdentifier":"test-group-15d09405","loggedInUser":""}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000892] "PUT http://localhost:19090/api/v1/admin/group-attributes/105 HTTP/1.1" from [::1]:45636 - 200 213B in 2.47129ms
--- PASS: TestAPIGroupAttributeUpdatePut_Success (0.02s)
=== RUN   TestAPIGroupAttributeUpdatePut_NotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5596}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000893] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45644 - 200 1156B in 4.303181ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000894] "PUT http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:45648 - 404 69B in 400.908Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5597}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000895] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45658 - 200 1156B in 4.09145ms
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/missing_key
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000896] "PUT http://localhost:19090/api/v1/admin/group-attributes/106 HTTP/1.1" from [::1]:45664 - 400 76B in 392.712Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/empty_key
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000897] "PUT http://localhost:19090/api/v1/admin/group-attributes/106 HTTP/1.1" from [::1]:45666 - 400 76B in 500.847Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/value_too_long
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000898] "PUT http://localhost:19090/api/v1/admin/group-attributes/106 HTTP/1.1" from [::1]:45670 - 400 119B in 408.371Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/invalid_key_format
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000899] "PUT http://localhost:19090/api/v1/admin/group-attributes/106 HTTP/1.1" from [::1]:45680 - 400 250B in 393.784Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors (0.02s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/invalid_key_format (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5598}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000900] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45694 - 200 1156B in 4.197631ms
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000901] "PUT http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:45710 - 400 77B in 352.997Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/empty_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000902] "PUT http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:45726 - 405 0B in 307.371Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/negative_ID
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000903] "PUT http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:45740 - 404 69B in 281.562Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidRequestBody
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5599}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000904] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45748 - 200 1156B in 4.268415ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000905] "PUT http://localhost:19090/api/v1/admin/group-attributes/107 HTTP/1.1" from [::1]:45764 - 400 70B in 447.135Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_InvalidRequestBody (0.02s)
=== RUN   TestAPIGroupAttributeUpdatePut_Unauthorized
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000906] "PUT http://localhost:19090/api/v1/admin/group-attributes/108 HTTP/1.1" from [::1]:45778 - 401 22B in 241.957Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_Unauthorized (0.01s)
=== RUN   TestAPIGroupAttributeDelete_Success
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5600}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000907] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45786 - 200 1156B in 4.225594ms
2025/11/25 13:24:39 INFO {"audit_event":"deleted_group_attribute","details":{"groupAttributeId":109,"groupId":698,"groupIdentifier":"test-group-91c80d2d","loggedInUser":""}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000908] "DELETE http://localhost:19090/api/v1/admin/group-attributes/109 HTTP/1.1" from [::1]:45790 - 200 17B in 2.247948ms
--- PASS: TestAPIGroupAttributeDelete_Success (0.02s)
=== RUN   TestAPIGroupAttributeDelete_NotFound
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5601}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000909] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45800 - 200 1156B in 4.395365ms
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000910] "DELETE http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:45808 - 404 69B in 389.016Âµs
--- PASS: TestAPIGroupAttributeDelete_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeDelete_InvalidId
2025/11/25 13:24:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5602}}
2025/11/25 13:24:39 [a357f2e3b56e/VGvsVkwcAO-000911] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45824 - 200 1156B in 4.148288ms
=== RUN   TestAPIGroupAttributeDelete_InvalidId/non-numeric_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000912] "DELETE http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:45838 - 400 77B in 397.15Âµs
=== RUN   TestAPIGroupAttributeDelete_InvalidId/empty_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000913] "DELETE http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:45840 - 405 0B in 290.289Âµs
=== RUN   TestAPIGroupAttributeDelete_InvalidId/negative_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000914] "DELETE http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:45842 - 404 69B in 289.306Âµs
--- PASS: TestAPIGroupAttributeDelete_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeDelete_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000915] "DELETE http://localhost:19090/api/v1/admin/group-attributes/110 HTTP/1.1" from [::1]:45848 - 401 22B in 135.045Âµs
--- PASS: TestAPIGroupAttributeDelete_Unauthorized (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5603}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000916] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45852 - 200 1156B in 4.246484ms
2025/11/25 13:24:40 INFO {"audit_event":"created_group","details":{"groupId":700,"groupIdentifier":"test-group-NuOuHI","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000917] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45858 - 201 257B in 2.019386ms
--- PASS: TestHandleAPIGroupCreatePost_Success (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5604}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000918] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45872 - 200 1156B in 4.151505ms
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Empty_group_identifier
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000919] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45878 - 400 79B in 474.827Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_short
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000920] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45880 - 400 101B in 386.11Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_long
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000921] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45894 - 400 114B in 307.942Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Invalid_group_identifier_characters
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000922] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45908 - 400 250B in 312.2Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Description_too_long
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000923] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45910 - 400 115B in 299.916Âµs
--- PASS: TestHandleAPIGroupCreatePost_ValidationErrors (0.01s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Empty_group_identifier (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_short (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_long (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Invalid_group_identifier_characters (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Description_too_long (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_DuplicateGroupIdentifier
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5605}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000924] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45916 - 200 1156B in 4.321095ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000925] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45930 - 400 89B in 383.405Âµs
--- PASS: TestHandleAPIGroupCreatePost_DuplicateGroupIdentifier (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_InputSanitization
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5606}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000926] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45936 - 200 1156B in 4.743803ms
2025/11/25 13:24:40 INFO {"audit_event":"created_group","details":{"groupId":702,"groupIdentifier":"test-group-rTeuYN","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000927] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45950 - 201 251B in 2.334842ms
--- PASS: TestHandleAPIGroupCreatePost_InputSanitization (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000928] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45954 - 401 22B in 166.164Âµs
--- PASS: TestHandleAPIGroupCreatePost_Unauthorized (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_InvalidJSON
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5607}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000929] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45964 - 200 1156B in 4.283394ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000930] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:45966 - 400 70B in 701.435Âµs
--- PASS: TestHandleAPIGroupCreatePost_InvalidJSON (0.01s)
=== RUN   TestAPIGroupDelete_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5608}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000931] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45970 - 200 1156B in 4.270008ms
2025/11/25 13:24:40 INFO {"audit_event":"deleted_group","details":{"groupId":703,"groupIdentifier":"test-group-6269c986","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000932] "DELETE http://localhost:19090/api/v1/admin/groups/703 HTTP/1.1" from [::1]:45986 - 200 17B in 2.378845ms
--- PASS: TestAPIGroupDelete_Success (0.01s)
=== RUN   TestAPIGroupDelete_SuccessWithMembers
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5609}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000933] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45998 - 200 1156B in 4.308982ms
2025/11/25 13:24:40 INFO {"audit_event":"deleted_group","details":{"groupId":704,"groupIdentifier":"test-group-3363141b","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000934] "DELETE http://localhost:19090/api/v1/admin/groups/704 HTTP/1.1" from [::1]:46000 - 200 17B in 2.274678ms
--- PASS: TestAPIGroupDelete_SuccessWithMembers (0.02s)
=== RUN   TestAPIGroupDelete_NotFound
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5610}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000935] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46012 - 200 1156B in 4.342515ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000936] "DELETE http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:46016 - 404 59B in 497.66Âµs
--- PASS: TestAPIGroupDelete_NotFound (0.01s)
=== RUN   TestAPIGroupDelete_InvalidId
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5611}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000937] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46018 - 200 1156B in 4.202881ms
=== RUN   TestAPIGroupDelete_InvalidId/non-numeric_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000938] "DELETE http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:46026 - 400 67B in 363.747Âµs
=== RUN   TestAPIGroupDelete_InvalidId/empty_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000939] "DELETE http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:46032 - 405 0B in 293.405Âµs
=== RUN   TestAPIGroupDelete_InvalidId/negative_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000940] "DELETE http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:46044 - 404 59B in 422.408Âµs
--- PASS: TestAPIGroupDelete_InvalidId (0.01s)
    --- PASS: TestAPIGroupDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupDelete_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000941] "DELETE http://localhost:19090/api/v1/admin/groups/705 HTTP/1.1" from [::1]:46056 - 401 22B in 111.511Âµs
--- PASS: TestAPIGroupDelete_Unauthorized (0.00s)
=== RUN   TestAPIGroupDelete_InvalidToken
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000942] "DELETE http://localhost:19090/api/v1/admin/groups/706 HTTP/1.1" from [::1]:46070 - 401 22B in 321.567Âµs
--- PASS: TestAPIGroupDelete_InvalidToken (0.01s)
=== RUN   TestAPIGroupDelete_WithGroupPermissions
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5612}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000943] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46086 - 200 1156B in 4.160111ms
2025/11/25 13:24:40 INFO {"audit_event":"deleted_group","details":{"groupId":707,"groupIdentifier":"test-group-0e7e315f","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000944] "DELETE http://localhost:19090/api/v1/admin/groups/707 HTTP/1.1" from [::1]:46102 - 200 17B in 2.574644ms
--- PASS: TestAPIGroupDelete_WithGroupPermissions (0.02s)
=== RUN   TestAPIGroupDelete_ResponseStructure
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5613}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000945] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46114 - 200 1156B in 4.433367ms
2025/11/25 13:24:40 INFO {"audit_event":"deleted_group","details":{"groupId":708,"groupIdentifier":"test-group-6b865de5","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000946] "DELETE http://localhost:19090/api/v1/admin/groups/708 HTTP/1.1" from [::1]:46122 - 200 17B in 2.444189ms
--- PASS: TestAPIGroupDelete_ResponseStructure (0.01s)
=== RUN   TestAPIGroupsGet_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5614}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000947] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46138 - 200 1156B in 4.264908ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000948] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46140 - 200 465B in 489.525Âµs
--- PASS: TestAPIGroupsGet_Success (0.02s)
=== RUN   TestAPIGroupsGet_EmptyGroups
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5615}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000949] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46154 - 200 1156B in 4.40313ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000950] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46170 - 200 14B in 439.36Âµs
    api_groups_get_test.go:113: Raw response body: {"groups":[]}
    api_groups_get_test.go:121: Response Groups: []
    api_groups_get_test.go:122: Groups is nil: false
    api_groups_get_test.go:123: Groups length: 0
    api_groups_get_test.go:129: Raw map parsing - groups value: []
    api_groups_get_test.go:130: Raw map parsing - groups type: []interface {}
--- PASS: TestAPIGroupsGet_EmptyGroups (0.01s)
=== RUN   TestAPIGroupsGet_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000951] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46182 - 401 22B in 145.465Âµs
--- PASS: TestAPIGroupsGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupsGet_InvalidToken
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000952] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46198 - 401 22B in 254.861Âµs
--- PASS: TestAPIGroupsGet_InvalidToken (0.00s)
=== RUN   TestAPIGroupsGet_EnhancedResponseStructure
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5616}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000953] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46202 - 200 1156B in 4.85307ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000954] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46218 - 200 252B in 656.02Âµs
--- PASS: TestAPIGroupsGet_EnhancedResponseStructure (0.01s)
=== RUN   TestAPIGroupsGet_MixedTokenInclusion
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5617}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000955] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46234 - 200 1156B in 4.581917ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000956] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46246 - 200 985B in 741.931Âµs
--- PASS: TestAPIGroupsGet_MixedTokenInclusion (0.02s)
=== RUN   TestAPIGroupsGet_MemberCountAccuracy
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5618}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000957] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46256 - 200 1156B in 4.452893ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000958] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46262 - 200 244B in 814.229Âµs
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000959] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46266 - 200 244B in 600.244Âµs
--- PASS: TestAPIGroupsGet_MemberCountAccuracy (0.03s)
=== RUN   TestAPIGroupPermissionsGet_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5619}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000960] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46276 - 200 1156B in 4.433297ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000961] "GET http://localhost:19090/api/v1/admin/groups/717/permissions HTTP/1.1" from [::1]:46280 - 200 641B in 914.217Âµs
--- PASS: TestAPIGroupPermissionsGet_Success (0.03s)
=== RUN   TestAPIGroupPermissionsGet_GroupNotFound
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5620}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000962] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46294 - 200 1156B in 4.293653ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000963] "GET http://localhost:19090/api/v1/admin/groups/99999/permissions HTTP/1.1" from [::1]:46302 - 404 59B in 480.418Âµs
--- PASS: TestAPIGroupPermissionsGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsGet_InvalidGroupId
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5621}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000964] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46316 - 200 1156B in 4.429369ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000965] "GET http://localhost:19090/api/v1/admin/groups/invalid/permissions HTTP/1.1" from [::1]:46318 - 400 74B in 514.643Âµs
--- PASS: TestAPIGroupPermissionsGet_InvalidGroupId (0.01s)
=== RUN   TestAPIGroupPermissionsGet_NoPermissions
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5622}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000966] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46328 - 200 1156B in 4.350871ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000967] "GET http://localhost:19090/api/v1/admin/groups/718/permissions HTTP/1.1" from [::1]:46336 - 200 258B in 631.182Âµs
--- PASS: TestAPIGroupPermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIGroupPermissionsGet_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000968] "GET http://localhost:19090/api/v1/admin/groups/719/permissions HTTP/1.1" from [::1]:46346 - 401 22B in 221.368Âµs
--- PASS: TestAPIGroupPermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupPermissionsPut_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5623}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000969] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46350 - 200 1156B in 4.428888ms
2025/11/25 13:24:40 INFO {"audit_event":"added_group_permission","details":{"groupId":720,"loggedInUser":"","permissionId":864}}
2025/11/25 13:24:40 INFO {"audit_event":"added_group_permission","details":{"groupId":720,"loggedInUser":"","permissionId":865}}
2025/11/25 13:24:40 INFO {"audit_event":"deleted_group_permission","details":{"groupId":720,"loggedInUser":"","permissionId":863}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000970] "PUT http://localhost:19090/api/v1/admin/groups/720/permissions HTTP/1.1" from [::1]:46358 - 200 17B in 6.252394ms
--- PASS: TestAPIGroupPermissionsPut_Success (0.03s)
=== RUN   TestAPIGroupPermissionsPut_RemoveAllPermissions
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5624}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000971] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46368 - 200 1156B in 4.213732ms
2025/11/25 13:24:40 INFO {"audit_event":"deleted_group_permission","details":{"groupId":721,"loggedInUser":"","permissionId":866}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000972] "PUT http://localhost:19090/api/v1/admin/groups/721/permissions HTTP/1.1" from [::1]:46370 - 200 17B in 2.477912ms
--- PASS: TestAPIGroupPermissionsPut_RemoveAllPermissions (0.02s)
=== RUN   TestAPIGroupPermissionsPut_AddPermissionsToEmptyGroup
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5625}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000973] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46378 - 200 1156B in 4.434769ms
2025/11/25 13:24:40 INFO {"audit_event":"added_group_permission","details":{"groupId":722,"loggedInUser":"","permissionId":867}}
2025/11/25 13:24:40 INFO {"audit_event":"added_group_permission","details":{"groupId":722,"loggedInUser":"","permissionId":868}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000974] "PUT http://localhost:19090/api/v1/admin/groups/722/permissions HTTP/1.1" from [::1]:46392 - 200 17B in 4.054862ms
--- PASS: TestAPIGroupPermissionsPut_AddPermissionsToEmptyGroup (0.03s)
=== RUN   TestAPIGroupPermissionsPut_GroupNotFound
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5626}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000975] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46404 - 200 1156B in 5.346682ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000976] "PUT http://localhost:19090/api/v1/admin/groups/99999/permissions HTTP/1.1" from [::1]:46410 - 404 59B in 552.273Âµs
--- PASS: TestAPIGroupPermissionsPut_GroupNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsPut_PermissionNotFound
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5627}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000977] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46412 - 200 1156B in 4.218311ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000978] "PUT http://localhost:19090/api/v1/admin/groups/723/permissions HTTP/1.1" from [::1]:46424 - 404 64B in 526.866Âµs
--- PASS: TestAPIGroupPermissionsPut_PermissionNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsPut_InvalidRequestBody
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5628}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000979] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46438 - 200 1156B in 4.174097ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000980] "PUT http://localhost:19090/api/v1/admin/groups/724/permissions HTTP/1.1" from [::1]:46454 - 400 71B in 419.793Âµs
--- PASS: TestAPIGroupPermissionsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5629}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000981] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46464 - 200 1156B in 4.304714ms
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/non-numeric_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000982] "PUT http://localhost:19090/api/v1/admin/groups/abc/permissions HTTP/1.1" from [::1]:46468 - 400 74B in 390.127Âµs
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/negative_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000983] "PUT http://localhost:19090/api/v1/admin/groups/-1/permissions HTTP/1.1" from [::1]:46484 - 404 59B in 387.863Âµs
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/zero_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000984] "PUT http://localhost:19090/api/v1/admin/groups/0/permissions HTTP/1.1" from [::1]:46498 - 404 59B in 336.206Âµs
--- PASS: TestAPIGroupPermissionsPut_InvalidGroupId (0.01s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/negative_ID (0.00s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/zero_ID (0.00s)
=== RUN   TestAPIGroupPermissionsPut_DuplicatePermissionIds
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5630}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000985] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46502 - 200 1156B in 4.069259ms
2025/11/25 13:24:40 INFO {"audit_event":"added_group_permission","details":{"groupId":725,"loggedInUser":"","permissionId":869}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000986] "PUT http://localhost:19090/api/v1/admin/groups/725/permissions HTTP/1.1" from [::1]:46506 - 200 17B in 2.168156ms
--- PASS: TestAPIGroupPermissionsPut_DuplicatePermissionIds (0.02s)
=== RUN   TestAPIGroupPermissionsPut_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000987] "PUT http://localhost:19090/api/v1/admin/groups/726/permissions HTTP/1.1" from [::1]:46522 - 401 22B in 165.784Âµs
--- PASS: TestAPIGroupPermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIGroupPermissionsPut_ComplexScenario
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5631}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000988] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46526 - 200 1156B in 4.571567ms
2025/11/25 13:24:40 INFO {"audit_event":"added_group_permission","details":{"groupId":727,"loggedInUser":"","permissionId":873}}
2025/11/25 13:24:40 INFO {"audit_event":"deleted_group_permission","details":{"groupId":727,"loggedInUser":"","permissionId":870}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000989] "PUT http://localhost:19090/api/v1/admin/groups/727/permissions HTTP/1.1" from [::1]:46532 - 200 17B in 4.391739ms
--- PASS: TestAPIGroupPermissionsPut_ComplexScenario (0.04s)
=== RUN   TestAPIGroupsSearch_Annotated_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5632}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000990] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46536 - 200 1156B in 4.532725ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000991] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=874&page=1&size=200 HTTP/1.1" from [::1]:46552 - 200 800B in 667.01Âµs
--- PASS: TestAPIGroupsSearch_Annotated_Success (0.03s)
=== RUN   TestAPIGroupsSearch_MissingAnnotateParam
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5633}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000992] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46554 - 200 1156B in 4.194716ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000993] "GET http://localhost:19090/api/v1/admin/groups/search?page=1&size=10 HTTP/1.1" from [::1]:46566 - 400 83B in 397.511Âµs
--- PASS: TestAPIGroupsSearch_MissingAnnotateParam (0.01s)
=== RUN   TestAPIGroupsSearch_InvalidAnnotateParam
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5634}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000994] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46578 - 200 1156B in 4.190016ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000995] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=abc&page=1&size=10 HTTP/1.1" from [::1]:46580 - 400 79B in 333.65Âµs
--- PASS: TestAPIGroupsSearch_InvalidAnnotateParam (0.01s)
=== RUN   TestAPIGroupsSearch_PermissionNotFound
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5635}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000996] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46586 - 200 1156B in 4.201388ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000997] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=9901818 HTTP/1.1" from [::1]:46590 - 404 64B in 447.336Âµs
--- PASS: TestAPIGroupsSearch_PermissionNotFound (0.01s)
=== RUN   TestAPIGroupsSearch_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000998] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=875 HTTP/1.1" from [::1]:46602 - 401 22B in 153.389Âµs
--- PASS: TestAPIGroupsSearch_Unauthorized (0.00s)
=== RUN   TestAPIGroupGet_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5636}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-000999] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46614 - 200 1156B in 4.130294ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001000] "GET http://localhost:19090/api/v1/admin/groups/731 HTTP/1.1" from [::1]:46626 - 200 241B in 529.39Âµs
--- PASS: TestAPIGroupGet_Success (0.01s)
=== RUN   TestAPIGroupGet_NotFound
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5637}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001001] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46628 - 200 1156B in 4.182974ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001002] "GET http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:46632 - 404 59B in 429.031Âµs
--- PASS: TestAPIGroupGet_NotFound (0.01s)
=== RUN   TestAPIGroupGet_InvalidId
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5638}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001003] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46648 - 200 1156B in 4.161534ms
=== RUN   TestAPIGroupGet_InvalidId/non-numeric_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001004] "GET http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:46650 - 400 67B in 357.876Âµs
=== RUN   TestAPIGroupGet_InvalidId/empty_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001005] "GET http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:46652 - 200 14B in 335.284Âµs
=== RUN   TestAPIGroupGet_InvalidId/negative_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001006] "GET http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:46664 - 404 59B in 323.411Âµs
--- PASS: TestAPIGroupGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupGet_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001007] "GET http://localhost:19090/api/v1/admin/groups/732 HTTP/1.1" from [::1]:46678 - 401 22B in 104.808Âµs
--- PASS: TestAPIGroupGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupGet_MemberCountAccuracy
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5639}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001008] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46684 - 200 1156B in 4.104385ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001009] "GET http://localhost:19090/api/v1/admin/groups/733 HTTP/1.1" from [::1]:46696 - 200 239B in 428.801Âµs
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001010] "GET http://localhost:19090/api/v1/admin/groups/733 HTTP/1.1" from [::1]:46702 - 200 239B in 390.057Âµs
--- PASS: TestAPIGroupGet_MemberCountAccuracy (0.02s)
=== RUN   TestAPIGroupUpdatePut_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5640}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001011] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46718 - 200 1156B in 4.048319ms
2025/11/25 13:24:40 INFO {"audit_event":"updated_group","details":{"groupId":734,"groupIdentifier":"updated-group-FjLHWb","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001012] "PUT http://localhost:19090/api/v1/admin/groups/734 HTTP/1.1" from [::1]:46730 - 200 260B in 2.626363ms
--- PASS: TestAPIGroupUpdatePut_Success (0.01s)
=== RUN   TestAPIGroupUpdatePut_ValidationErrors
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5641}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001013] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46744 - 200 1156B in 4.558153ms
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/empty_group_identifier
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001014] "PUT http://localhost:19090/api/v1/admin/groups/735 HTTP/1.1" from [::1]:46748 - 400 79B in 406.688Âµs
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/description_too_long
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001015] "PUT http://localhost:19090/api/v1/admin/groups/735 HTTP/1.1" from [::1]:46756 - 400 115B in 390.819Âµs
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/invalid_identifier_format
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001016] "PUT http://localhost:19090/api/v1/admin/groups/735 HTTP/1.1" from [::1]:46764 - 400 250B in 356.894Âµs
--- PASS: TestAPIGroupUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/empty_group_identifier (0.00s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/description_too_long (0.00s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIGroupUpdatePut_DuplicateIdentifier
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5642}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001017] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46778 - 200 1156B in 4.097683ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001018] "PUT http://localhost:19090/api/v1/admin/groups/737 HTTP/1.1" from [::1]:46788 - 400 89B in 602.097Âµs
--- PASS: TestAPIGroupUpdatePut_DuplicateIdentifier (0.02s)
=== RUN   TestAPIGroupUpdatePut_SameIdentifier
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5643}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001019] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46804 - 200 1156B in 4.136916ms
2025/11/25 13:24:40 INFO {"audit_event":"updated_group","details":{"groupId":738,"groupIdentifier":"test-group-77a31266","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001020] "PUT http://localhost:19090/api/v1/admin/groups/738 HTTP/1.1" from [::1]:46814 - 200 253B in 2.073228ms
--- PASS: TestAPIGroupUpdatePut_SameIdentifier (0.01s)
=== RUN   TestAPIGroupUpdatePut_NotFound
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5644}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001021] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46818 - 200 1156B in 4.230834ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001022] "PUT http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:46824 - 404 59B in 441.705Âµs
--- PASS: TestAPIGroupUpdatePut_NotFound (0.01s)
=== RUN   TestAPIGroupUpdatePut_InvalidId
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5645}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001023] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46838 - 200 1156B in 5.360999ms
=== RUN   TestAPIGroupUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001024] "PUT http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:46854 - 400 67B in 457.855Âµs
=== RUN   TestAPIGroupUpdatePut_InvalidId/empty_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001025] "PUT http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:46860 - 405 0B in 328.641Âµs
=== RUN   TestAPIGroupUpdatePut_InvalidId/negative_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001026] "PUT http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:46864 - 404 59B in 348.639Âµs
--- PASS: TestAPIGroupUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupUpdatePut_InvalidRequestBody
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5646}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001027] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46874 - 200 1156B in 4.133951ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001028] "PUT http://localhost:19090/api/v1/admin/groups/739 HTTP/1.1" from [::1]:46876 - 400 70B in 403.803Âµs
--- PASS: TestAPIGroupUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupUpdatePut_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001029] "PUT http://localhost:19090/api/v1/admin/groups/740 HTTP/1.1" from [::1]:46890 - 401 22B in 143.992Âµs
--- PASS: TestAPIGroupUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIGroupUpdatePut_WhitespaceHandling
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5647}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001030] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46896 - 200 1156B in 4.1226ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001031] "PUT http://localhost:19090/api/v1/admin/groups/741 HTTP/1.1" from [::1]:46912 - 400 250B in 682.139Âµs
2025/11/25 13:24:40 INFO {"audit_event":"updated_group","details":{"groupId":741,"groupIdentifier":"whitespace-identifier-cEba","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001032] "PUT http://localhost:19090/api/v1/admin/groups/741 HTTP/1.1" from [::1]:46922 - 200 263B in 2.248819ms
--- PASS: TestAPIGroupUpdatePut_WhitespaceHandling (0.02s)
=== RUN   TestAPIGroupUpdatePut_BooleanFlags
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5648}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001033] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46938 - 200 1156B in 4.410885ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/both_false
2025/11/25 13:24:40 INFO {"audit_event":"updated_group","details":{"groupId":742,"groupIdentifier":"test-bool-group-wdhsvipQ","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001034] "PUT http://localhost:19090/api/v1/admin/groups/742 HTTP/1.1" from [::1]:46952 - 200 261B in 2.416647ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/id_token_only
2025/11/25 13:24:40 INFO {"audit_event":"updated_group","details":{"groupId":742,"groupIdentifier":"test-bool-group-wdhsvipQ","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001035] "PUT http://localhost:19090/api/v1/admin/groups/742 HTTP/1.1" from [::1]:46962 - 200 264B in 2.759514ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/access_token_only
2025/11/25 13:24:40 INFO {"audit_event":"updated_group","details":{"groupId":742,"groupIdentifier":"test-bool-group-wdhsvipQ","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001036] "PUT http://localhost:19090/api/v1/admin/groups/742 HTTP/1.1" from [::1]:46964 - 200 268B in 2.766988ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/both_true
2025/11/25 13:24:40 INFO {"audit_event":"updated_group","details":{"groupId":742,"groupIdentifier":"test-bool-group-wdhsvipQ","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001037] "PUT http://localhost:19090/api/v1/admin/groups/742 HTTP/1.1" from [::1]:46974 - 200 259B in 2.569665ms
--- PASS: TestAPIGroupUpdatePut_BooleanFlags (0.02s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/both_false (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/id_token_only (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/access_token_only (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/both_true (0.00s)
=== RUN   TestAPIGroupUpdatePut_MemberCountInResponse
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5649}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001038] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46984 - 200 1156B in 4.447814ms
2025/11/25 13:24:40 INFO {"audit_event":"updated_group","details":{"groupId":743,"groupIdentifier":"test-group-34266b00-updated","loggedInUser":""}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001039] "PUT http://localhost:19090/api/v1/admin/groups/743 HTTP/1.1" from [::1]:46986 - 200 261B in 2.527115ms
--- PASS: TestAPIGroupUpdatePut_MemberCountInResponse (0.02s)
=== RUN   TestAPIPermissionUsersGet_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5650}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001040] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47002 - 200 1156B in 4.805069ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001041] "GET http://localhost:19090/api/v1/admin/permissions/876/users?page=1&size=200 HTTP/1.1" from [::1]:47010 - 200 1454B in 1.215626ms
--- PASS: TestAPIPermissionUsersGet_Success (0.03s)
=== RUN   TestAPIPermissionUsersGet_InvalidPermissionId
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5651}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001042] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47014 - 200 1156B in 4.329591ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001043] "GET http://localhost:19090/api/v1/admin/permissions/invalid/users HTTP/1.1" from [::1]:47016 - 400 79B in 348.007Âµs
--- PASS: TestAPIPermissionUsersGet_InvalidPermissionId (0.01s)
=== RUN   TestAPIPermissionUsersGet_PermissionNotFound
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5652}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001044] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47032 - 200 1156B in 4.159199ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001045] "GET http://localhost:19090/api/v1/admin/permissions/7709418/users HTTP/1.1" from [::1]:47044 - 404 64B in 425.484Âµs
--- PASS: TestAPIPermissionUsersGet_PermissionNotFound (0.01s)
=== RUN   TestAPIPermissionUsersGet_UserinfoForbidden
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5653}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001046] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47048 - 200 1156B in 4.155312ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001047] "GET http://localhost:19090/api/v1/admin/permissions/1/users HTTP/1.1" from [::1]:47064 - 400 96B in 472.924Âµs
--- PASS: TestAPIPermissionUsersGet_UserinfoForbidden (0.01s)
=== RUN   TestAPIPermissionUsersGet_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001048] "GET http://localhost:19090/api/v1/admin/permissions/877/users HTTP/1.1" from [::1]:47080 - 401 22B in 121.82Âµs
--- PASS: TestAPIPermissionUsersGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcePermissionsGet_Success
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5654}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001049] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47090 - 200 1156B in 4.114083ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001050] "GET http://localhost:19090/api/v1/admin/resources/795/permissions HTTP/1.1" from [::1]:47102 - 200 652B in 478.003Âµs
--- PASS: TestAPIResourcePermissionsGet_Success (0.02s)
=== RUN   TestAPIResourcePermissionsGet_NoPermissions
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5655}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001051] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47116 - 200 1156B in 4.203272ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001052] "GET http://localhost:19090/api/v1/admin/resources/796/permissions HTTP/1.1" from [::1]:47120 - 200 19B in 386.641Âµs
--- PASS: TestAPIResourcePermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NonExistentResource
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5656}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001053] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47130 - 200 1156B in 4.113142ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001054] "GET http://localhost:19090/api/v1/admin/resources/99999/permissions HTTP/1.1" from [::1]:47146 - 200 19B in 651.371Âµs
--- PASS: TestAPIResourcePermissionsGet_NonExistentResource (0.01s)
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5657}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001055] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47160 - 200 1156B in 4.071303ms
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/non-numeric_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001056] "GET http://localhost:19090/api/v1/admin/resources/abc/permissions HTTP/1.1" from [::1]:47170 - 400 77B in 337.968Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/empty_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001057] "GET http://localhost:19090/api/v1/admin/resources//permissions HTTP/1.1" from [::1]:47178 - 400 74B in 329.572Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/negative_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001058] "GET http://localhost:19090/api/v1/admin/resources/-1/permissions HTTP/1.1" from [::1]:47192 - 200 19B in 336.486Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/zero_ID
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001059] "GET http://localhost:19090/api/v1/admin/resources/0/permissions HTTP/1.1" from [::1]:47200 - 200 19B in 330.384Âµs
--- PASS: TestAPIResourcePermissionsGet_InvalidResourceId (0.01s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/non-numeric_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/empty_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/negative_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/zero_ID (0.00s)
=== RUN   TestAPIResourcePermissionsGet_AuthServerResourceFiltersUserinfo
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5658}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001060] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47202 - 200 1156B in 4.356562ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001061] "GET http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:47210 - 200 491B in 532.667Âµs
--- PASS: TestAPIResourcePermissionsGet_AuthServerResourceFiltersUserinfo (0.01s)
=== RUN   TestAPIResourcePermissionsGet_AuthServerResourceIncludesOtherPermissions
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5659}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001062] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47214 - 200 1156B in 4.323349ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001063] "GET http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:47224 - 200 700B in 473.925Âµs
--- PASS: TestAPIResourcePermissionsGet_AuthServerResourceIncludesOtherPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NonAuthServerResourceIncludesAllPermissions
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5660}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001064] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47236 - 200 1156B in 4.090609ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001065] "GET http://localhost:19090/api/v1/admin/resources/797/permissions HTTP/1.1" from [::1]:47240 - 200 460B in 425.203Âµs
--- PASS: TestAPIResourcePermissionsGet_NonAuthServerResourceIncludesAllPermissions (0.02s)
=== RUN   TestAPIResourcePermissionsGet_Unauthorized
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001066] "GET http://localhost:19090/api/v1/admin/resources/798/permissions HTTP/1.1" from [::1]:47250 - 401 22B in 310.837Âµs
--- PASS: TestAPIResourcePermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcePermissionsGet_InvalidAccessToken
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001067] "GET http://localhost:19090/api/v1/admin/resources/799/permissions HTTP/1.1" from [::1]:47264 - 401 22B in 384.046Âµs
--- PASS: TestAPIResourcePermissionsGet_InvalidAccessToken (0.00s)
=== RUN   TestAPIResourcePermissionsGet_LargeNumberOfPermissions
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5661}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001068] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47266 - 200 1156B in 4.459336ms
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001069] "GET http://localhost:19090/api/v1/admin/resources/800/permissions HTTP/1.1" from [::1]:47268 - 200 2348B in 580.487Âµs
--- PASS: TestAPIResourcePermissionsGet_LargeNumberOfPermissions (0.05s)
=== RUN   TestAPIResourcePermissionsPut_Success_CreateUpdateDelete
2025/11/25 13:24:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5662}}
2025/11/25 13:24:40 [a357f2e3b56e/VGvsVkwcAO-001070] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47284 - 200 1156B in 5.317778ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_resource_permissions","details":{"loggedInUser":"","resourceId":801}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001071] "PUT http://localhost:19090/api/v1/admin/resources/801/permissions HTTP/1.1" from [::1]:47294 - 200 17B in 7.914074ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001072] "GET http://localhost:19090/api/v1/admin/resources/801/permissions HTTP/1.1" from [::1]:47306 - 200 548B in 792.277Âµs
--- PASS: TestAPIResourcePermissionsPut_Success_CreateUpdateDelete (0.03s)
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5663}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001073] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47310 - 200 1156B in 4.202159ms
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/empty_identifier
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001074] "PUT http://localhost:19090/api/v1/admin/resources/802/permissions HTTP/1.1" from [::1]:47312 - 400 84B in 420.354Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/invalid_format
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001075] "PUT http://localhost:19090/api/v1/admin/resources/802/permissions HTTP/1.1" from [::1]:47316 - 400 250B in 342.477Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/html_in_description
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001076] "PUT http://localhost:19090/api/v1/admin/resources/802/permissions HTTP/1.1" from [::1]:47324 - 400 151B in 358.267Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/too_long_description
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001077] "PUT http://localhost:19090/api/v1/admin/resources/802/permissions HTTP/1.1" from [::1]:47340 - 400 116B in 334.362Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/duplicate_identifiers
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001078] "PUT http://localhost:19090/api/v1/admin/resources/802/permissions HTTP/1.1" from [::1]:47354 - 400 80B in 342.978Âµs
--- PASS: TestAPIResourcePermissionsPut_ValidationErrors (0.02s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/empty_identifier (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/invalid_format (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/html_in_description (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/too_long_description (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/duplicate_identifiers (0.00s)
=== RUN   TestAPIResourcePermissionsPut_UpdateConflict
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5664}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001079] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47358 - 200 1156B in 4.298121ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001080] "PUT http://localhost:19090/api/v1/admin/resources/803/permissions HTTP/1.1" from [::1]:47374 - 400 95B in 546.753Âµs
--- PASS: TestAPIResourcePermissionsPut_UpdateConflict (0.02s)
=== RUN   TestAPIResourcePermissionsPut_SystemResourceDenied
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5665}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001081] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47382 - 200 1156B in 4.632172ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001082] "PUT http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:47386 - 400 92B in 413.442Âµs
--- PASS: TestAPIResourcePermissionsPut_SystemResourceDenied (0.01s)
=== RUN   TestAPIResourcePermissionsPut_Unauthorized
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001083] "PUT http://localhost:19090/api/v1/admin/resources/804/permissions HTTP/1.1" from [::1]:47388 - 401 22B in 138.823Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001084] "PUT http://localhost:19090/api/v1/admin/resources/804/permissions HTTP/1.1" from [::1]:47404 - 401 22B in 327.729Âµs
--- PASS: TestAPIResourcePermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIResourcesCreate_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5666}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001085] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47418 - 200 1156B in 4.135113ms
2025/11/25 13:24:41 INFO {"audit_event":"created_resource","details":{"loggedInUser":"","resourceId":805,"resourceIdentifier":"api-test-create-resource-aLLAIDdD"}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001086] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47426 - 201 113B in 2.023703ms
--- PASS: TestAPIResourcesCreate_Success (0.01s)
=== RUN   TestAPIResourcesCreate_ValidationErrors
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5667}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001087] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47442 - 200 1156B in 4.099005ms
=== RUN   TestAPIResourcesCreate_ValidationErrors/missing_identifier
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001088] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47456 - 400 82B in 389.246Âµs
=== RUN   TestAPIResourcesCreate_ValidationErrors/too_long_description
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001089] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47472 - 400 115B in 374.407Âµs
=== RUN   TestAPIResourcesCreate_ValidationErrors/invalid_identifier_format
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001090] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47478 - 400 250B in 352.506Âµs
--- PASS: TestAPIResourcesCreate_ValidationErrors (0.01s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/missing_identifier (0.00s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/too_long_description (0.00s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIResourcesCreate_DuplicateIdentifier
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5668}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001091] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47482 - 200 1156B in 4.088204ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001092] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47490 - 400 92B in 407.75Âµs
--- PASS: TestAPIResourcesCreate_DuplicateIdentifier (0.01s)
=== RUN   TestAPIResourcesCreate_InvalidRequestBody
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5669}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001093] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47498 - 200 1156B in 4.142438ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001094] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47514 - 400 70B in 383.635Âµs
--- PASS: TestAPIResourcesCreate_InvalidRequestBody (0.01s)
=== RUN   TestAPIResourcesCreate_UnauthorizedAndScope
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001095] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47526 - 401 22B in 131.488Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001096] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47536 - 401 22B in 282.774Âµs
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5670}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001097] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47540 - 200 1165B in 4.172985ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001098] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47546 - 403 19B in 588.111Âµs
--- PASS: TestAPIResourcesCreate_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceDelete_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5671}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001099] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47552 - 200 1156B in 4.556249ms
2025/11/25 13:24:41 INFO {"audit_event":"deleted_resource","details":{"loggedInUser":"","resourceId":807,"resourceIdentifier":"api-test-del-resource-KvZMSf"}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001100] "DELETE http://localhost:19090/api/v1/admin/resources/807 HTTP/1.1" from [::1]:47566 - 200 17B in 3.242797ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001101] "GET http://localhost:19090/api/v1/admin/resources/807 HTTP/1.1" from [::1]:47576 - 404 62B in 411.728Âµs
--- PASS: TestAPIResourceDelete_Success (0.02s)
=== RUN   TestAPIResourceDelete_NotFoundAndInvalidId
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5672}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001102] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47588 - 200 1156B in 4.138549ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001103] "DELETE http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:47592 - 404 62B in 416.206Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001104] "DELETE http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:47600 - 400 70B in 330.234Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001105] "DELETE http://localhost:19090/api/v1/admin/resources/-1 HTTP/1.1" from [::1]:47614 - 404 62B in 346.835Âµs
--- PASS: TestAPIResourceDelete_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIResourceDelete_SystemLevelResource
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5673}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001106] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47628 - 200 1156B in 4.147848ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001107] "DELETE http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:47642 - 400 91B in 450.171Âµs
--- PASS: TestAPIResourceDelete_SystemLevelResource (0.01s)
=== RUN   TestAPIResourceDelete_UnauthorizedAndScope
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001108] "DELETE http://localhost:19090/api/v1/admin/resources/808 HTTP/1.1" from [::1]:47644 - 401 22B in 165.272Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001109] "DELETE http://localhost:19090/api/v1/admin/resources/808 HTTP/1.1" from [::1]:47646 - 401 22B in 212.942Âµs
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5674}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001110] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47656 - 200 1165B in 4.065572ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001111] "DELETE http://localhost:19090/api/v1/admin/resources/808 HTTP/1.1" from [::1]:47664 - 403 19B in 308.723Âµs
--- PASS: TestAPIResourceDelete_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceGet_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5675}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001112] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47666 - 200 1156B in 4.114675ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001113] "GET http://localhost:19090/api/v1/admin/resources/809 HTTP/1.1" from [::1]:47680 - 200 105B in 505.515Âµs
--- PASS: TestAPIResourceGet_Success (0.01s)
=== RUN   TestAPIResourceGet_NotFoundAndInvalidId
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5676}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001114] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47690 - 200 1156B in 4.030145ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001115] "GET http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:47706 - 404 62B in 398.823Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001116] "GET http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:47714 - 400 70B in 305.317Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001117] "GET http://localhost:19090/api/v1/admin/resources/-1 HTTP/1.1" from [::1]:47724 - 404 62B in 383.946Âµs
--- PASS: TestAPIResourceGet_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIResourceGet_UnauthorizedAndScope
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001118] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:47734 - 401 22B in 160.543Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001119] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:47740 - 401 22B in 245.043Âµs
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5677}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001120] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47750 - 200 1165B in 4.046256ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001121] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:47756 - 403 19B in 272.856Âµs
--- PASS: TestAPIResourceGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceUpdatePut_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5678}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001122] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47764 - 200 1156B in 4.168376ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_resource","details":{"loggedInUser":"","resourceId":810,"resourceIdentifier":"updated-resource-uSdQGA"}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001123] "PUT http://localhost:19090/api/v1/admin/resources/810 HTTP/1.1" from [::1]:47766 - 200 100B in 2.47677ms
--- PASS: TestAPIResourceUpdatePut_Success (0.01s)
=== RUN   TestAPIResourceUpdatePut_ValidationErrors
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5679}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001124] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47770 - 200 1156B in 4.173305ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001125] "PUT http://localhost:19090/api/v1/admin/resources/811 HTTP/1.1" from [::1]:47772 - 400 82B in 429.722Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001126] "PUT http://localhost:19090/api/v1/admin/resources/811 HTTP/1.1" from [::1]:47788 - 400 115B in 344.191Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001127] "PUT http://localhost:19090/api/v1/admin/resources/811 HTTP/1.1" from [::1]:47792 - 400 250B in 1.157176ms
--- PASS: TestAPIResourceUpdatePut_ValidationErrors (0.01s)
=== RUN   TestAPIResourceUpdatePut_DuplicateIdentifier
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5680}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001128] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47802 - 200 1156B in 4.171181ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001129] "PUT http://localhost:19090/api/v1/admin/resources/813 HTTP/1.1" from [::1]:47808 - 400 92B in 589.614Âµs
--- PASS: TestAPIResourceUpdatePut_DuplicateIdentifier (0.02s)
=== RUN   TestAPIResourceUpdatePut_SystemLevelResource
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5681}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001130] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47820 - 200 1156B in 4.59421ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001131] "PUT http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:47822 - 400 101B in 500.276Âµs
--- PASS: TestAPIResourceUpdatePut_SystemLevelResource (0.01s)
=== RUN   TestAPIResourceUpdatePut_InvalidIdAndBody
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5682}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001132] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47838 - 200 1156B in 4.358505ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001133] "PUT http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:47842 - 400 70B in 510.244Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001134] "PUT http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:47856 - 404 62B in 426.285Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001135] "PUT http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:47860 - 400 101B in 435.634Âµs
--- PASS: TestAPIResourceUpdatePut_InvalidIdAndBody (0.01s)
=== RUN   TestAPIResourceUpdatePut_UnauthorizedAndScope
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001136] "PUT http://localhost:19090/api/v1/admin/resources/814 HTTP/1.1" from [::1]:47876 - 401 22B in 150.735Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001137] "PUT http://localhost:19090/api/v1/admin/resources/814 HTTP/1.1" from [::1]:47886 - 401 22B in 322.098Âµs
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5683}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001138] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47896 - 200 1165B in 4.582499ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001139] "PUT http://localhost:19090/api/v1/admin/resources/814 HTTP/1.1" from [::1]:47902 - 403 19B in 408.592Âµs
--- PASS: TestAPIResourceUpdatePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourcesGet_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5684}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001140] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47918 - 200 1156B in 4.237677ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001141] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47930 - 200 31791B in 754.425Âµs
--- PASS: TestAPIResourcesGet_Success (0.02s)
=== RUN   TestAPIResourcesGet_EmptyDatabase
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5685}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001142] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47938 - 200 1156B in 4.418229ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001143] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47942 - 200 31611B in 846.109Âµs
--- PASS: TestAPIResourcesGet_EmptyDatabase (0.01s)
=== RUN   TestAPIResourcesGet_Unauthorized
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001144] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47952 - 401 22B in 265.702Âµs
--- PASS: TestAPIResourcesGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcesGet_InvalidToken
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001145] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47968 - 401 22B in 339.581Âµs
--- PASS: TestAPIResourcesGet_InvalidToken (0.00s)
=== RUN   TestAPIResourcesGet_InsufficientScope
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5686}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001146] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47984 - 200 1165B in 4.782877ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001147] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47996 - 403 19B in 414.453Âµs
--- PASS: TestAPIResourcesGet_InsufficientScope (0.01s)
=== RUN   TestAPIResourcesGet_ManyResources
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5687}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001148] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48008 - 200 1156B in 4.130574ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001149] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48018 - 200 31897B in 817.715Âµs
--- PASS: TestAPIResourcesGet_ManyResources (0.02s)
=== RUN   TestAPISettingsEmailGet_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5688}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001150] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48028 - 200 1156B in 4.470456ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001151] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48040 - 200 190B in 340.954Âµs
--- PASS: TestAPISettingsEmailGet_Success (0.01s)
=== RUN   TestAPISettingsEmailPut_EnableSuccess
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5689}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001152] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48052 - 200 1156B in 4.383773ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001153] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48062 - 200 190B in 3.642853ms
--- PASS: TestAPISettingsEmailPut_EnableSuccess (0.01s)
=== RUN   TestAPISettingsEmailPut_DisableResetsFields
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5690}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001154] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48074 - 200 1156B in 4.19685ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001155] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48080 - 200 192B in 2.532235ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001156] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48082 - 200 152B in 1.95313ms
--- PASS: TestAPISettingsEmailPut_DisableResetsFields (0.01s)
=== RUN   TestAPISettingsEmailPut_ValidationErrors
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5691}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001157] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48090 - 200 1156B in 4.172734ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001158] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48096 - 400 73B in 443.157Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001159] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48104 - 400 73B in 434.551Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001160] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48118 - 400 89B in 317.009Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001161] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48128 - 400 94B in 317.209Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001162] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48136 - 400 75B in 473.725Âµs
--- PASS: TestAPISettingsEmailPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsEmailPut_TCPConnectionFailure
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5692}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001163] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48146 - 200 1156B in 4.284286ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001164] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48154 - 400 142B in 503.131Âµs
--- PASS: TestAPISettingsEmailPut_TCPConnectionFailure (0.01s)
=== RUN   TestAPISettingsEmailPut_PasswordLifecycle
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5693}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001165] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48170 - 200 1156B in 4.272954ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001166] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48180 - 200 180B in 3.158338ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001167] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48192 - 200 180B in 405.176Âµs
2025/11/25 13:24:41 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001168] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48198 - 200 181B in 2.612075ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001169] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48202 - 200 181B in 331.998Âµs
--- PASS: TestAPISettingsEmailPut_PasswordLifecycle (0.02s)
=== RUN   TestAPISettingsEmailSendTest_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5694}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001170] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48214 - 200 1156B in 4.19667ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001171] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48226 - 200 181B in 2.110017ms
2025/11/25 13:24:41 INFO {"audit_event":"sent_test_email","details":{"loggedInUser":"","to":"someone@example.com"}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001172] "POST http://localhost:19090/api/v1/admin/settings/email/send-test HTTP/1.1" from [::1]:48232 - 200 17B in 1.145273ms
--- PASS: TestAPISettingsEmailSendTest_Success (0.01s)
=== RUN   TestAPISettingsEmailSendTest_SMTPDisabled
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5695}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001173] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48248 - 200 1156B in 4.209664ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001174] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48264 - 200 152B in 2.564936ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001175] "POST http://localhost:19090/api/v1/admin/settings/email/send-test HTTP/1.1" from [::1]:48272 - 400 70B in 458.487Âµs
--- PASS: TestAPISettingsEmailSendTest_SMTPDisabled (0.01s)
=== RUN   TestAPISettingsEmail_Unauthorized
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001176] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48280 - 401 22B in 108.565Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001177] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48280 - 401 22B in 76.415Âµs
--- PASS: TestAPISettingsEmail_Unauthorized (0.00s)
=== RUN   TestAPISettingsGeneralGet_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5696}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001178] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48296 - 200 1156B in 4.18603ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001179] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48312 - 200 212B in 406.508Âµs
--- PASS: TestAPISettingsGeneralGet_Success (0.01s)
=== RUN   TestAPISettingsGeneralPut_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5697}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001180] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48314 - 200 1156B in 4.26029ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001181] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48330 - 200 221B in 3.169449ms
--- PASS: TestAPISettingsGeneralPut_Success (0.01s)
=== RUN   TestAPISettingsGeneralPut_DisableSelfRegForcesVerificationFalse
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5698}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001182] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48346 - 200 1164B in 4.232016ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001183] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48350 - 200 210B in 2.061095ms
2025/11/25 13:24:41 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001184] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48358 - 200 212B in 2.496037ms
--- PASS: TestAPISettingsGeneralPut_DisableSelfRegForcesVerificationFalse (0.01s)
=== RUN   TestAPISettingsGeneralPut_ValidationErrors
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5699}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001185] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48368 - 200 1156B in 4.198864ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001186] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48372 - 400 109B in 315.336Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001187] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48384 - 400 92B in 284.919Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001188] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48394 - 400 239B in 397.11Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001189] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48398 - 400 239B in 370.741Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001190] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48412 - 400 107B in 385.94Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001191] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48418 - 400 107B in 392.501Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001192] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48428 - 400 74B in 368.116Âµs
--- PASS: TestAPISettingsGeneralPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsGeneral_UnauthorizedAndScope
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001193] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48438 - 401 22B in 114.176Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001194] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48452 - 401 22B in 271.322Âµs
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5700}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001195] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48454 - 200 1165B in 4.124423ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001196] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48460 - 403 19B in 337.277Âµs
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001197] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48438 - 401 22B in 109.817Âµs
--- PASS: TestAPISettingsGeneral_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsKeysGet_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5701}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001198] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48472 - 200 1156B in 4.252976ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001199] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48478 - 200 5238B in 489.304Âµs
--- PASS: TestAPISettingsKeysGet_Success (0.01s)
=== RUN   TestAPISettingsKeysRotatePost_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5702}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001200] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48486 - 200 1156B in 4.195287ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001201] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48494 - 200 5238B in 360.11Âµs
2025/11/25 13:24:41 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001202] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48496 - 200 17B in 74.783532ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001203] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48500 - 200 7854B in 750.909Âµs
--- PASS: TestAPISettingsKeysRotatePost_Success (0.09s)
=== RUN   TestAPISettingsKeysRotatePost_DeletesPrevious
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5703}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001204] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48508 - 200 1156B in 4.25485ms
2025/11/25 13:24:41 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001205] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48522 - 200 17B in 162.44579ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001206] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48532 - 200 7854B in 995.061Âµs
2025/11/25 13:24:41 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001207] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48546 - 200 17B in 185.702002ms
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5704}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001208] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48560 - 200 1156B in 5.079628ms
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001209] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48576 - 200 7854B in 749.496Âµs
--- PASS: TestAPISettingsKeysRotatePost_DeletesPrevious (0.37s)
=== RUN   TestAPISettingsKeyDelete_Success
2025/11/25 13:24:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5705}}
2025/11/25 13:24:41 [a357f2e3b56e/VGvsVkwcAO-001210] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48592 - 200 1156B in 4.447314ms
2025/11/25 13:24:42 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001211] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48602 - 200 17B in 717.525065ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001212] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48606 - 200 7854B in 887.707Âµs
2025/11/25 13:24:42 INFO {"audit_event":"revoked_key","details":{"keyId":"8ab05738-96f7-4396-a326-4c39cd41a35d","loggedInUser":""}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001213] "DELETE http://localhost:19090/api/v1/admin/settings/keys/40 HTTP/1.1" from [::1]:48618 - 200 17B in 2.341093ms
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5706}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001214] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48632 - 200 1156B in 4.283023ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001215] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48646 - 200 5238B in 464.097Âµs
--- PASS: TestAPISettingsKeyDelete_Success (0.74s)
=== RUN   TestAPISettingsKeyDelete_ValidationAndUnauthorized
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5707}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001216] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48662 - 200 1156B in 4.235162ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001217] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48674 - 200 5238B in 462.253Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001218] "DELETE http://localhost:19090/api/v1/admin/settings/keys/41 HTTP/1.1" from [::1]:48684 - 400 85B in 529.5Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001219] "DELETE http://localhost:19090/api/v1/admin/settings/keys/99999999 HTTP/1.1" from [::1]:48686 - 400 64B in 432.447Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001220] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48688 - 401 22B in 109.607Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001221] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48688 - 401 22B in 84.2Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001222] "DELETE http://localhost:19090/api/v1/admin/settings/keys/1 HTTP/1.1" from [::1]:48690 - 401 22B in 156.165Âµs
--- PASS: TestAPISettingsKeyDelete_ValidationAndUnauthorized (0.01s)
=== RUN   TestAPISettingsSessionsGet_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5708}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001223] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48696 - 200 1156B in 4.312278ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001224] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48712 - 200 80B in 324.563Âµs
--- PASS: TestAPISettingsSessionsGet_Success (0.01s)
=== RUN   TestAPISettingsSessionsPut_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5709}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001225] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48720 - 200 1156B in 4.354357ms
2025/11/25 13:24:42 INFO {"audit_event":"updated_sessions_settings","details":{"loggedInUser":""}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001226] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48724 - 200 80B in 2.064431ms
--- PASS: TestAPISettingsSessionsPut_Success (0.01s)
=== RUN   TestAPISettingsSessionsPut_ValidationErrors
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5710}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001227] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48730 - 200 1156B in 4.093274ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001228] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48734 - 400 116B in 343.98Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001229] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48742 - 400 116B in 301.71Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001230] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48750 - 400 123B in 303.734Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001231] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48766 - 400 123B in 284.528Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001232] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48774 - 400 123B in 274.138Âµs
--- PASS: TestAPISettingsSessionsPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsSessionsPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5711}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001233] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48776 - 200 1156B in 4.070942ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001234] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48792 - 400 70B in 476.551Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001235] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48792 - 401 22B in 122.471Âµs
--- PASS: TestAPISettingsSessionsPut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsSessions_UnauthorizedAndScope
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001236] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48794 - 401 22B in 173.909Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001237] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48810 - 401 22B in 209.777Âµs
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5712}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001238] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48820 - 200 1165B in 4.041075ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001239] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:48828 - 403 19B in 372.494Âµs
--- PASS: TestAPISettingsSessions_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsTokensGet_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5713}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001240] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48838 - 200 1156B in 4.090729ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001241] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48850 - 200 174B in 337.237Âµs
--- PASS: TestAPISettingsTokensGet_Success (0.01s)
=== RUN   TestAPISettingsTokensPut_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5714}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48860 - 200 1156B in 4.250822ms
2025/11/25 13:24:42 INFO {"audit_event":"updated_tokens_settings","details":{"loggedInUser":"","new":{"includeOpenIDConnectClaimsInAccessToken":true,"refreshTokenOfflineIdleTimeoutInSeconds":3600,"refreshTokenOfflineMaxLifetimeInSeconds":7200,"tokenExpirationInSeconds":600},"old":{"includeOpenIDConnectClaimsInAccessToken":true,"refreshTokenOfflineIdleTimeoutInSeconds":3600,"refreshTokenOfflineMaxLifetimeInSeconds":7200,"tokenExpirationInSeconds":600}}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001243] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48872 - 200 174B in 2.116499ms
--- PASS: TestAPISettingsTokensPut_Success (0.01s)
=== RUN   TestAPISettingsTokensPut_ValidationErrors
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5715}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001244] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48876 - 200 1156B in 4.296799ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001245] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48878 - 400 105B in 391.519Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001246] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48894 - 400 112B in 287.764Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001247] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48906 - 400 125B in 361.534Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001248] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48914 - 400 132B in 671.589Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001249] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48928 - 400 125B in 985.092Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001250] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48936 - 400 132B in 467.023Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001251] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48948 - 400 124B in 440.362Âµs
--- PASS: TestAPISettingsTokensPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsTokens_InvalidRequestBodyAndUnauthorized
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5716}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001252] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48962 - 200 1156B in 4.427837ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001253] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48976 - 400 70B in 377.684Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001254] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48976 - 401 22B in 91.263Âµs
--- PASS: TestAPISettingsTokens_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsTokens_UnauthorizedAndScope
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001255] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48986 - 401 22B in 120.397Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001256] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:48990 - 401 22B in 258.218Âµs
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5717}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001257] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49002 - 200 1165B in 4.082053ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001258] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49014 - 403 19B in 429.672Âµs
--- PASS: TestAPISettingsTokens_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsUIThemeGet_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5718}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001259] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49028 - 200 1156B in 4.166542ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001260] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49042 - 200 333B in 359.299Âµs
--- PASS: TestAPISettingsUIThemeGet_Success (0.01s)
=== RUN   TestAPISettingsUIThemePut_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5719}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001261] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49056 - 200 1156B in 4.098905ms
2025/11/25 13:24:42 INFO {"audit_event":"updated_ui_theme_settings","details":{"loggedInUser":"","newUITheme":"light","oldUITheme":""}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001262] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49060 - 200 338B in 2.280519ms
2025/11/25 13:24:42 INFO {"audit_event":"updated_ui_theme_settings","details":{"loggedInUser":"","newUITheme":"","oldUITheme":"light"}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001263] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49066 - 200 333B in 2.125897ms
--- PASS: TestAPISettingsUIThemePut_Success (0.01s)
=== RUN   TestAPISettingsUIThemePut_ValidationErrors
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5720}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001264] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49072 - 200 1156B in 4.124393ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001265] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49082 - 400 65B in 359.97Âµs
--- PASS: TestAPISettingsUIThemePut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsUITheme_InvalidRequestBodyAndUnauthorized
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5721}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001266] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49084 - 200 1156B in 4.28127ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001267] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49086 - 400 70B in 345.322Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001268] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49086 - 401 22B in 94.729Âµs
--- PASS: TestAPISettingsUITheme_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsUITheme_UnauthorizedAndScope
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001269] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49098 - 401 22B in 122.21Âµs
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001270] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49110 - 401 22B in 216.359Âµs
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5722}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001271] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49116 - 200 1165B in 4.302259ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001272] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49132 - 403 19B in 386.159Âµs
--- PASS: TestAPISettingsUITheme_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIUserGroupsGet_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5723}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001273] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49138 - 200 1156B in 4.124794ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001274] "GET http://localhost:19090/api/v1/admin/users/2352/groups HTTP/1.1" from [::1]:49150 - 200 1244B in 585.437Âµs
--- PASS: TestAPIUserGroupsGet_Success (0.02s)
=== RUN   TestAPIUserGroupsGet_NoGroups
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5724}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49158 - 200 1156B in 4.230013ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001276] "GET http://localhost:19090/api/v1/admin/users/2353/groups HTTP/1.1" from [::1]:49170 - 200 714B in 535.121Âµs
--- PASS: TestAPIUserGroupsGet_NoGroups (0.01s)
=== RUN   TestAPIUserGroupsGet_UserNotFound
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5725}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001277] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49180 - 200 1156B in 4.072905ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001278] "GET http://localhost:19090/api/v1/admin/users/99999/groups HTTP/1.1" from [::1]:49184 - 404 63B in 430.744Âµs
--- PASS: TestAPIUserGroupsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserGroupsGet_InvalidId
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5726}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49200 - 200 1156B in 4.146165ms
=== RUN   TestAPIUserGroupsGet_InvalidId/non-numeric_ID
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001280] "GET http://localhost:19090/api/v1/admin/users/abc/groups HTTP/1.1" from [::1]:49208 - 400 65B in 397.501Âµs
=== RUN   TestAPIUserGroupsGet_InvalidId/empty_ID
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001281] "GET http://localhost:19090/api/v1/admin/users//groups HTTP/1.1" from [::1]:49222 - 400 69B in 303.453Âµs
=== RUN   TestAPIUserGroupsGet_InvalidId/negative_ID
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001282] "GET http://localhost:19090/api/v1/admin/users/-1/groups HTTP/1.1" from [::1]:49226 - 404 63B in 391.24Âµs
--- PASS: TestAPIUserGroupsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGroupsGet_Unauthorized
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001283] "GET http://localhost:19090/api/v1/admin/users/2354/groups HTTP/1.1" from [::1]:49238 - 401 22B in 125.548Âµs
--- PASS: TestAPIUserGroupsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserGroupsPut_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5727}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001284] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49240 - 200 1156B in 4.219011ms
2025/11/25 13:24:42 INFO {"audit_event":"user_added_to_group","details":{"groupId":748,"loggedInUser":"","userId":2355}}
2025/11/25 13:24:42 INFO {"audit_event":"user_removed_from_group","details":{"groupId":746,"loggedInUser":"","userId":2355}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001285] "PUT http://localhost:19090/api/v1/admin/users/2355/groups HTTP/1.1" from [::1]:49246 - 200 1797B in 4.269847ms
--- PASS: TestAPIUserGroupsPut_Success (0.03s)
=== RUN   TestAPIUserGroupsPut_EmptyGroups
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5728}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001286] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49254 - 200 1156B in 4.085018ms
2025/11/25 13:24:42 INFO {"audit_event":"user_removed_from_group","details":{"groupId":749,"loggedInUser":"","userId":2356}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001287] "PUT http://localhost:19090/api/v1/admin/users/2356/groups HTTP/1.1" from [::1]:49260 - 200 717B in 2.571048ms
--- PASS: TestAPIUserGroupsPut_EmptyGroups (0.02s)
=== RUN   TestAPIUserGroupsPut_NonExistentGroup
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5729}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001288] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49276 - 200 1156B in 4.185729ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001289] "PUT http://localhost:19090/api/v1/admin/users/2357/groups HTTP/1.1" from [::1]:49292 - 400 79B in 760.697Âµs
--- PASS: TestAPIUserGroupsPut_NonExistentGroup (0.01s)
=== RUN   TestAPIUserGroupsPut_UserNotFound
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5730}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001290] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49296 - 200 1156B in 4.262163ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001291] "PUT http://localhost:19090/api/v1/admin/users/99999/groups HTTP/1.1" from [::1]:49302 - 404 63B in 396.479Âµs
--- PASS: TestAPIUserGroupsPut_UserNotFound (0.01s)
=== RUN   TestAPIUserGroupsPut_InvalidId
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5731}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001292] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49310 - 200 1156B in 4.036517ms
=== RUN   TestAPIUserGroupsPut_InvalidId/non-numeric_ID
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001293] "PUT http://localhost:19090/api/v1/admin/users/abc/groups HTTP/1.1" from [::1]:49322 - 400 65B in 308.143Âµs
=== RUN   TestAPIUserGroupsPut_InvalidId/empty_ID
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001294] "PUT http://localhost:19090/api/v1/admin/users//groups HTTP/1.1" from [::1]:49324 - 400 69B in 415.645Âµs
=== RUN   TestAPIUserGroupsPut_InvalidId/negative_ID
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001295] "PUT http://localhost:19090/api/v1/admin/users/-1/groups HTTP/1.1" from [::1]:49332 - 404 63B in 386.871Âµs
--- PASS: TestAPIUserGroupsPut_InvalidId (0.01s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGroupsPut_InvalidRequestBody
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5732}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001296] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49346 - 200 1156B in 4.051686ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001297] "PUT http://localhost:19090/api/v1/admin/users/2358/groups HTTP/1.1" from [::1]:49358 - 400 70B in 298.404Âµs
--- PASS: TestAPIUserGroupsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserGroupsPut_Unauthorized
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001298] "PUT http://localhost:19090/api/v1/admin/users/2359/groups HTTP/1.1" from [::1]:49372 - 401 22B in 111.711Âµs
--- PASS: TestAPIUserGroupsPut_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributesGet_Success
2025/11/25 13:24:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5733}}
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001299] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49378 - 200 1156B in 4.046836ms
2025/11/25 13:24:42 [a357f2e3b56e/VGvsVkwcAO-001300] "GET http://localhost:19090/api/v1/admin/users/2360/attributes HTTP/1.1" from [::1]:49392 - 200 415B in 469.637Âµs
--- PASS: TestAPIUserAttributesGet_Success (0.02s)
=== RUN   TestAPIUserAttributesGet_EmptyAttributes
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5734}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001301] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49404 - 200 1156B in 4.132217ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001302] "GET http://localhost:19090/api/v1/admin/users/2361/attributes HTTP/1.1" from [::1]:49406 - 200 20B in 464.718Âµs
--- PASS: TestAPIUserAttributesGet_EmptyAttributes (0.01s)
=== RUN   TestAPIUserAttributesGet_UserNotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5735}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001303] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49412 - 200 1156B in 4.146445ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001304] "GET http://localhost:19090/api/v1/admin/users/99999/attributes HTTP/1.1" from [::1]:49414 - 404 63B in 423.43Âµs
--- PASS: TestAPIUserAttributesGet_UserNotFound (0.01s)
=== RUN   TestAPIUserAttributesGet_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5736}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001305] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49420 - 200 1156B in 4.048981ms
=== RUN   TestAPIUserAttributesGet_InvalidId/non-numeric_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001306] "GET http://localhost:19090/api/v1/admin/users/abc/attributes HTTP/1.1" from [::1]:49422 - 400 65B in 335.815Âµs
=== RUN   TestAPIUserAttributesGet_InvalidId/empty_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001307] "GET http://localhost:19090/api/v1/admin/users//attributes HTTP/1.1" from [::1]:49438 - 400 70B in 291.221Âµs
=== RUN   TestAPIUserAttributesGet_InvalidId/negative_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001308] "GET http://localhost:19090/api/v1/admin/users/-1/attributes HTTP/1.1" from [::1]:49444 - 404 63B in 379.788Âµs
--- PASS: TestAPIUserAttributesGet_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributesGet_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001309] "GET http://localhost:19090/api/v1/admin/users/2362/attributes HTTP/1.1" from [::1]:49450 - 401 22B in 132.29Âµs
--- PASS: TestAPIUserAttributesGet_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeGet_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5737}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001310] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49456 - 200 1156B in 4.066013ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001311] "GET http://localhost:19090/api/v1/admin/user-attributes/102 HTTP/1.1" from [::1]:49472 - 200 207B in 1.37089ms
--- PASS: TestAPIUserAttributeGet_Success (0.02s)
=== RUN   TestAPIUserAttributeGet_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5738}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001312] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49478 - 200 1156B in 4.109374ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001313] "GET http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:49480 - 404 73B in 406.789Âµs
--- PASS: TestAPIUserAttributeGet_NotFound (0.01s)
=== RUN   TestAPIUserAttributeGet_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5739}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001314] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49494 - 200 1156B in 4.055734ms
=== RUN   TestAPIUserAttributeGet_InvalidId/non-numeric_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001315] "GET http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:49496 - 400 75B in 294.085Âµs
=== RUN   TestAPIUserAttributeGet_InvalidId/empty_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001316] "GET http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:49500 - 405 0B in 283.005Âµs
=== RUN   TestAPIUserAttributeGet_InvalidId/negative_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001317] "GET http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:49516 - 404 73B in 310.938Âµs
--- PASS: TestAPIUserAttributeGet_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeGet_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001318] "GET http://localhost:19090/api/v1/admin/user-attributes/103 HTTP/1.1" from [::1]:49518 - 401 22B in 144.383Âµs
--- PASS: TestAPIUserAttributeGet_Unauthorized (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5740}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001319] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49524 - 200 1156B in 4.185769ms
2025/11/25 13:24:43 INFO {"audit_event":"added_user_attribute","details":{"loggedInUser":"admin-test-client-QtsbBJle","userAttributeId":104,"userId":2365}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001320] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49534 - 201 222B in 2.419191ms
--- PASS: TestAPIUserAttributeCreatePost_Success (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5741}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001321] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49548 - 200 1156B in 4.314843ms
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/missing_key
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001322] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49550 - 400 72B in 366.042Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/empty_key
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001323] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49556 - 400 72B in 529.07Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/value_too_long
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001324] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49558 - 400 117B in 413.712Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/invalid_key_format
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001325] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49562 - 400 250B in 362.825Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/user_not_found
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001326] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49570 - 404 63B in 363.567Âµs
--- PASS: TestAPIUserAttributeCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/invalid_key_format (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/user_not_found (0.00s)
=== RUN   TestAPIUserAttributeCreatePost_InvalidRequestBody
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5742}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001327] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49580 - 200 1156B in 4.005558ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001328] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49594 - 400 75B in 284.277Âµs
--- PASS: TestAPIUserAttributeCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001329] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49600 - 401 22B in 99.849Âµs
--- PASS: TestAPIUserAttributeCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5743}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49604 - 200 1156B in 4.111158ms
2025/11/25 13:24:43 INFO {"audit_event":"updated_user_attribute","details":{"loggedInUser":"admin-test-client-EYVRMkEv","userAttributeId":105,"userId":2367}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001331] "PUT http://localhost:19090/api/v1/admin/user-attributes/105 HTTP/1.1" from [::1]:49616 - 200 213B in 2.410435ms
--- PASS: TestAPIUserAttributeUpdatePut_Success (0.03s)
=== RUN   TestAPIUserAttributeUpdatePut_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5744}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001332] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49620 - 200 1156B in 4.262444ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001333] "PUT http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:49630 - 404 73B in 569.386Âµs
--- PASS: TestAPIUserAttributeUpdatePut_NotFound (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5745}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001334] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49634 - 200 1156B in 4.049933ms
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/missing_key
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001335] "PUT http://localhost:19090/api/v1/admin/user-attributes/106 HTTP/1.1" from [::1]:49650 - 400 72B in 608.299Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/empty_key
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001336] "PUT http://localhost:19090/api/v1/admin/user-attributes/106 HTTP/1.1" from [::1]:49658 - 400 72B in 634.849Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/value_too_long
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001337] "PUT http://localhost:19090/api/v1/admin/user-attributes/106 HTTP/1.1" from [::1]:49664 - 400 117B in 335.393Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/invalid_key_format
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001338] "PUT http://localhost:19090/api/v1/admin/user-attributes/106 HTTP/1.1" from [::1]:49672 - 400 250B in 330.305Âµs
--- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors (0.02s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/invalid_key_format (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5746}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001339] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49684 - 200 1156B in 4.090258ms
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001340] "PUT http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:49686 - 400 75B in 308.663Âµs
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/empty_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001341] "PUT http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:49696 - 405 0B in 298.754Âµs
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/negative_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001342] "PUT http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:49708 - 404 73B in 338.59Âµs
--- PASS: TestAPIUserAttributeUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_InvalidRequestBody
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5747}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001343] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49724 - 200 1156B in 4.122449ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001344] "PUT http://localhost:19090/api/v1/admin/user-attributes/107 HTTP/1.1" from [::1]:49732 - 400 75B in 318.962Âµs
--- PASS: TestAPIUserAttributeUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001345] "PUT http://localhost:19090/api/v1/admin/user-attributes/108 HTTP/1.1" from [::1]:49746 - 401 22B in 203.414Âµs
--- PASS: TestAPIUserAttributeUpdatePut_Unauthorized (0.01s)
=== RUN   TestAPIUserAttributeDelete_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5748}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001346] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49756 - 200 1156B in 4.116388ms
2025/11/25 13:24:43 INFO {"audit_event":"deleted_user_attribute","details":{"loggedInUser":"admin-test-client-RNSrYWez","userAttributeId":109,"userId":2371}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001347] "DELETE http://localhost:19090/api/v1/admin/user-attributes/109 HTTP/1.1" from [::1]:49772 - 200 17B in 2.318641ms
--- PASS: TestAPIUserAttributeDelete_Success (0.02s)
=== RUN   TestAPIUserAttributeDelete_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5749}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001348] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49788 - 200 1156B in 4.3026ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001349] "DELETE http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:49804 - 404 73B in 417.168Âµs
--- PASS: TestAPIUserAttributeDelete_NotFound (0.01s)
=== RUN   TestAPIUserAttributeDelete_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5750}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001350] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49820 - 200 1156B in 4.043731ms
=== RUN   TestAPIUserAttributeDelete_InvalidId/non-numeric_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001351] "DELETE http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:49828 - 400 75B in 322.229Âµs
=== RUN   TestAPIUserAttributeDelete_InvalidId/empty_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001352] "DELETE http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:49842 - 405 0B in 306.629Âµs
=== RUN   TestAPIUserAttributeDelete_InvalidId/negative_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001353] "DELETE http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:49854 - 404 73B in 327.258Âµs
--- PASS: TestAPIUserAttributeDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeDelete_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001354] "DELETE http://localhost:19090/api/v1/admin/user-attributes/110 HTTP/1.1" from [::1]:49856 - 401 22B in 217.431Âµs
--- PASS: TestAPIUserAttributeDelete_Unauthorized (0.01s)
=== RUN   TestAPIUserPasswordPut_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5751}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001355] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49860 - 200 1156B in 4.522335ms
2025/11/25 13:24:43 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-hJanSSKO","userId":2373}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001356] "PUT http://localhost:19090/api/v1/admin/users/2373/password HTTP/1.1" from [::1]:49862 - 200 700B in 38.323562ms
--- PASS: TestAPIUserPasswordPut_Success (0.09s)
=== RUN   TestAPIUserPasswordPut_ValidationError
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5752}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001357] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49874 - 200 1156B in 4.346172ms
=== RUN   TestAPIUserPasswordPut_ValidationError/empty_password
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001358] "PUT http://localhost:19090/api/v1/admin/users/2374/password HTTP/1.1" from [::1]:49890 - 400 76B in 349.38Âµs
=== RUN   TestAPIUserPasswordPut_ValidationError/too_short_password
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001359] "PUT http://localhost:19090/api/v1/admin/users/2374/password HTTP/1.1" from [::1]:49892 - 400 102B in 564.717Âµs
=== RUN   TestAPIUserPasswordPut_ValidationError/too_long_password
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001360] "PUT http://localhost:19090/api/v1/admin/users/2374/password HTTP/1.1" from [::1]:49896 - 400 103B in 576.439Âµs
--- PASS: TestAPIUserPasswordPut_ValidationError (0.01s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/empty_password (0.00s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/too_short_password (0.00s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/too_long_password (0.00s)
=== RUN   TestAPIUserPasswordPut_UserNotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5753}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001361] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49912 - 200 1156B in 4.171292ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001362] "PUT http://localhost:19090/api/v1/admin/users/99999/password HTTP/1.1" from [::1]:49920 - 404 63B in 411.748Âµs
--- PASS: TestAPIUserPasswordPut_UserNotFound (0.01s)
=== RUN   TestAPIUserPasswordPut_InvalidUserId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5754}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001363] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49932 - 200 1156B in 4.031558ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001364] "PUT http://localhost:19090/api/v1/admin/users/invalid/password HTTP/1.1" from [::1]:49946 - 400 65B in 321.206Âµs
--- PASS: TestAPIUserPasswordPut_InvalidUserId (0.01s)
=== RUN   TestAPIUserOTPPut_DisableSuccess
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5755}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001365] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49958 - 200 1156B in 4.044923ms
2025/11/25 13:24:43 INFO {"audit_event":"disabled_otp","details":{"userId":2375}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001366] "PUT http://localhost:19090/api/v1/admin/users/2375/otp HTTP/1.1" from [::1]:49968 - 200 695B in 2.675285ms
--- PASS: TestAPIUserOTPPut_DisableSuccess (0.01s)
=== RUN   TestAPIUserOTPPut_EnableNotSupported
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5756}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001367] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49974 - 200 1156B in 4.194435ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001368] "PUT http://localhost:19090/api/v1/admin/users/2376/otp HTTP/1.1" from [::1]:49990 - 400 110B in 459.849Âµs
--- PASS: TestAPIUserOTPPut_EnableNotSupported (0.01s)
=== RUN   TestAPIUserOTPPut_UserNotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5757}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001369] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49994 - 200 1156B in 4.215765ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001370] "PUT http://localhost:19090/api/v1/admin/users/99999/otp HTTP/1.1" from [::1]:50006 - 404 63B in 590.516Âµs
--- PASS: TestAPIUserOTPPut_UserNotFound (0.01s)
=== RUN   TestAPIUserOTPPut_OTPNotEnabled
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5758}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001371] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50012 - 200 1156B in 4.207991ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001372] "PUT http://localhost:19090/api/v1/admin/users/2377/otp HTTP/1.1" from [::1]:50028 - 400 80B in 700.965Âµs
--- PASS: TestAPIUserOTPPut_OTPNotEnabled (0.01s)
=== RUN   TestAPIUserSessionGet_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5759}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001373] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50044 - 200 1156B in 4.448456ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001374] "GET http://localhost:19090/api/v1/admin/user-sessions/bf5062fa-8568-40e3-bf0d-c339b51b0980 HTTP/1.1" from [::1]:50046 - 200 488B in 1.527366ms
--- PASS: TestAPIUserSessionGet_Success (0.02s)
=== RUN   TestAPIUserSessionGet_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5760}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001375] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50056 - 200 1156B in 4.528376ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001376] "GET http://localhost:19090/api/v1/admin/user-sessions/nonexistent-session HTTP/1.1" from [::1]:50070 - 404 79B in 507.609Âµs
--- PASS: TestAPIUserSessionGet_NotFound (0.01s)
=== RUN   TestAPIUserSessionPut_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5761}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001377] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50084 - 200 1156B in 4.859983ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001378] "PUT http://localhost:19090/api/v1/admin/user-sessions/df2a8916-2cf2-4186-b5c6-3c7369d6e6b1 HTTP/1.1" from [::1]:50092 - 200 486B in 2.894059ms
--- PASS: TestAPIUserSessionPut_Success (0.02s)
=== RUN   TestAPIUserSessionPut_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5762}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001379] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50102 - 200 1156B in 4.64136ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001380] "PUT http://localhost:19090/api/v1/admin/user-sessions/nonexistent-session HTTP/1.1" from [::1]:50114 - 404 79B in 454.249Âµs
--- PASS: TestAPIUserSessionPut_NotFound (0.01s)
=== RUN   TestAPIUserSessionPut_NilUpdate
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5763}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001381] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50116 - 200 1156B in 4.784691ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001382] "PUT http://localhost:19090/api/v1/admin/user-sessions/f91b0c10-99b5-4587-89f1-43ff4dd85e3f HTTP/1.1" from [::1]:50120 - 200 488B in 2.497289ms
--- PASS: TestAPIUserSessionPut_NilUpdate (0.02s)
=== RUN   TestAPIUserConsentsGet_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5764}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50126 - 200 1156B in 4.18632ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001384] "GET http://localhost:19090/api/v1/admin/users/2381/consents HTTP/1.1" from [::1]:50142 - 200 575B in 672.4Âµs
--- PASS: TestAPIUserConsentsGet_Success (0.03s)
=== RUN   TestAPIUserConsentsGet_EmptyConsents
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5767}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001385] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50158 - 200 1156B in 4.403852ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001386] "GET http://localhost:19090/api/v1/admin/users/2382/consents HTTP/1.1" from [::1]:50164 - 200 18B in 505.455Âµs
--- PASS: TestAPIUserConsentsGet_EmptyConsents (0.01s)
=== RUN   TestAPIUserConsentsGet_UserNotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5768}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001387] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50178 - 200 1156B in 4.479855ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001388] "GET http://localhost:19090/api/v1/admin/users/99999/consents HTTP/1.1" from [::1]:50194 - 404 58B in 495.115Âµs
--- PASS: TestAPIUserConsentsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserConsentsGet_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5769}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001389] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50204 - 200 1156B in 4.126006ms
=== RUN   TestAPIUserConsentsGet_InvalidId/non-numeric_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001390] "GET http://localhost:19090/api/v1/admin/users/abc/consents HTTP/1.1" from [::1]:50212 - 400 73B in 457.935Âµs
=== RUN   TestAPIUserConsentsGet_InvalidId/empty_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001391] "GET http://localhost:19090/api/v1/admin/users//consents HTTP/1.1" from [::1]:50216 - 400 70B in 373.756Âµs
=== RUN   TestAPIUserConsentsGet_InvalidId/negative_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001392] "GET http://localhost:19090/api/v1/admin/users/-1/consents HTTP/1.1" from [::1]:50220 - 404 58B in 459.318Âµs
--- PASS: TestAPIUserConsentsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserConsentsGet_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001393] "GET http://localhost:19090/api/v1/admin/users/2383/consents HTTP/1.1" from [::1]:50228 - 401 22B in 177.586Âµs
--- PASS: TestAPIUserConsentsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserConsentDelete_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5770}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001394] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50238 - 200 1156B in 4.162465ms
2025/11/25 13:24:43 INFO {"audit_event":"deleted_user_consent","details":{"consentId":196,"loggedInUser":null,"userId":2384}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001395] "DELETE http://localhost:19090/api/v1/admin/user-consents/196 HTTP/1.1" from [::1]:50252 - 200 17B in 2.106801ms
--- PASS: TestAPIUserConsentDelete_Success (0.02s)
=== RUN   TestAPIUserConsentDelete_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5772}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001396] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50268 - 200 1156B in 4.666998ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001397] "DELETE http://localhost:19090/api/v1/admin/user-consents/99999 HTTP/1.1" from [::1]:50276 - 404 61B in 497.58Âµs
--- PASS: TestAPIUserConsentDelete_NotFound (0.01s)
=== RUN   TestAPIUserConsentDelete_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5773}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001398] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50280 - 200 1156B in 4.465988ms
=== RUN   TestAPIUserConsentDelete_InvalidId/non-numeric_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001399] "DELETE http://localhost:19090/api/v1/admin/user-consents/abc HTTP/1.1" from [::1]:50290 - 400 76B in 472.473Âµs
=== RUN   TestAPIUserConsentDelete_InvalidId/empty_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001400] "DELETE http://localhost:19090/api/v1/admin/user-consents/ HTTP/1.1" from [::1]:50292 - 404 2447B in 542.055Âµs
=== RUN   TestAPIUserConsentDelete_InvalidId/negative_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001401] "DELETE http://localhost:19090/api/v1/admin/user-consents/-1 HTTP/1.1" from [::1]:50300 - 404 61B in 417.338Âµs
--- PASS: TestAPIUserConsentDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserConsentDelete_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001402] "DELETE http://localhost:19090/api/v1/admin/user-consents/197 HTTP/1.1" from [::1]:50308 - 401 22B in 145.725Âµs
--- PASS: TestAPIUserConsentDelete_Unauthorized (0.01s)
=== RUN   TestAPIUserConsentDelete_WithClientDetails
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5775}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001403] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50322 - 200 1156B in 4.306317ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001404] "GET http://localhost:19090/api/v1/admin/users/2386/consents HTTP/1.1" from [::1]:50326 - 200 333B in 773.722Âµs
2025/11/25 13:24:43 INFO {"audit_event":"deleted_user_consent","details":{"consentId":198,"loggedInUser":null,"userId":2386}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001405] "DELETE http://localhost:19090/api/v1/admin/user-consents/198 HTTP/1.1" from [::1]:50342 - 200 17B in 1.950976ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001406] "GET http://localhost:19090/api/v1/admin/users/2386/consents HTTP/1.1" from [::1]:50346 - 200 18B in 492.751Âµs
--- PASS: TestAPIUserConsentDelete_WithClientDetails (0.02s)
=== RUN   TestAPIUserGet_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5777}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001407] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50348 - 200 1156B in 4.11248ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001408] "GET http://localhost:19090/api/v1/admin/users/2387 HTTP/1.1" from [::1]:50362 - 200 695B in 544.438Âµs
--- PASS: TestAPIUserGet_Success (0.01s)
=== RUN   TestAPIUserGet_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5778}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001409] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50370 - 200 1156B in 4.216858ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001410] "GET http://localhost:19090/api/v1/admin/users/99999 HTTP/1.1" from [::1]:50386 - 404 63B in 449.379Âµs
--- PASS: TestAPIUserGet_NotFound (0.01s)
=== RUN   TestAPIUserGet_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5779}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001411] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50396 - 200 1156B in 4.265349ms
=== RUN   TestAPIUserGet_InvalidId/non-numeric_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001412] "GET http://localhost:19090/api/v1/admin/users/abc HTTP/1.1" from [::1]:50398 - 400 65B in 361.483Âµs
=== RUN   TestAPIUserGet_InvalidId/empty_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001413] "GET http://localhost:19090/api/v1/admin/users/ HTTP/1.1" from [::1]:50412 - 404 2447B in 950.876Âµs
=== RUN   TestAPIUserGet_InvalidId/negative_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001414] "GET http://localhost:19090/api/v1/admin/users/-1 HTTP/1.1" from [::1]:50418 - 404 63B in 415.505Âµs
--- PASS: TestAPIUserGet_InvalidId (0.01s)
    --- PASS: TestAPIUserGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGet_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001415] "GET http://localhost:19090/api/v1/admin/users/2388 HTTP/1.1" from [::1]:50426 - 401 22B in 261.484Âµs
--- PASS: TestAPIUserGet_Unauthorized (0.00s)
=== RUN   TestAPIUserCreatePost_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5780}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001416] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50438 - 200 1156B in 4.577368ms
2025/11/25 13:24:43 INFO {"audit_event":"created_user","details":{"email":"newuser@create.test","loggedInUser":"admin-test-client-KZUdJDdG"}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001417] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50452 - 201 1139B in 39.822664ms
--- PASS: TestAPIUserCreatePost_Success (0.05s)
=== RUN   TestAPIUserCreatePost_DuplicateEmail
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5781}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001418] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50468 - 200 1156B in 4.484143ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001419] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50484 - 409 95B in 580.507Âµs
--- PASS: TestAPIUserCreatePost_DuplicateEmail (0.01s)
=== RUN   TestAPIUserCreatePost_ValidationErrors
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5782}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001420] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50486 - 200 1156B in 4.404643ms
=== RUN   TestAPIUserCreatePost_ValidationErrors/missing_email
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001421] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50494 - 400 66B in 404.995Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/invalid_email_format
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001422] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50502 - 400 86B in 330.705Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/email_too_long
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001423] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50506 - 400 114B in 336.836Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/missing_password_when_required
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001424] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50518 - 400 72B in 1.034735ms
--- PASS: TestAPIUserCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/missing_email (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/invalid_email_format (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/email_too_long (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/missing_password_when_required (0.00s)
=== RUN   TestAPIUserCreatePost_InvalidRequestBody
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5783}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001425] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50528 - 200 1156B in 4.528837ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001426] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50534 - 400 75B in 500.124Âµs
--- PASS: TestAPIUserCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserCreatePost_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001427] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50544 - 401 22B in 162.186Âµs
--- PASS: TestAPIUserCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIUserEnabledPut_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5784}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001428] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50552 - 200 1156B in 4.471329ms
2025/11/25 13:24:43 INFO {"audit_event":"updated_user_details","details":{"loggedInUser":"admin-test-client-OSuzscby","userId":2391}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001429] "PUT http://localhost:19090/api/v1/admin/users/2391/enabled HTTP/1.1" from [::1]:50562 - 200 700B in 2.729317ms
--- PASS: TestAPIUserEnabledPut_Success (0.02s)
=== RUN   TestAPIUserEnabledPut_EnableUser
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5785}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001430] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50572 - 200 1156B in 4.258918ms
2025/11/25 13:24:43 INFO {"audit_event":"updated_user_details","details":{"loggedInUser":"admin-test-client-vEBBvJdb","userId":2392}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001431] "PUT http://localhost:19090/api/v1/admin/users/2392/enabled HTTP/1.1" from [::1]:50586 - 200 703B in 2.344891ms
--- PASS: TestAPIUserEnabledPut_EnableUser (0.01s)
=== RUN   TestAPIUserEnabledPut_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5786}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001432] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50592 - 200 1156B in 4.443546ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001433] "PUT http://localhost:19090/api/v1/admin/users/99999/enabled HTTP/1.1" from [::1]:50602 - 404 63B in 923.776Âµs
--- PASS: TestAPIUserEnabledPut_NotFound (0.01s)
=== RUN   TestAPIUserEnabledPut_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5787}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001434] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50616 - 200 1156B in 4.293252ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001435] "PUT http://localhost:19090/api/v1/admin/users/invalid/enabled HTTP/1.1" from [::1]:50626 - 400 65B in 352.666Âµs
--- PASS: TestAPIUserEnabledPut_InvalidId (0.01s)
=== RUN   TestAPIUserEnabledPut_InvalidRequestBody
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5788}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001436] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50628 - 200 1156B in 4.447693ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001437] "PUT http://localhost:19090/api/v1/admin/users/2393/enabled HTTP/1.1" from [::1]:50636 - 400 75B in 464.358Âµs
--- PASS: TestAPIUserEnabledPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserDelete_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5789}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001438] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50650 - 200 1156B in 4.098194ms
2025/11/25 13:24:43 INFO {"audit_event":"deleted_user","details":{"loggedInUser":"admin-test-client-TSMLwVse","userId":2394}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001439] "DELETE http://localhost:19090/api/v1/admin/users/2394 HTTP/1.1" from [::1]:50662 - 200 17B in 2.476118ms
--- PASS: TestAPIUserDelete_Success (0.01s)
=== RUN   TestAPIUserDelete_NotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5790}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001440] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50670 - 200 1156B in 4.336915ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001441] "DELETE http://localhost:19090/api/v1/admin/users/99999 HTTP/1.1" from [::1]:50684 - 404 63B in 411.518Âµs
--- PASS: TestAPIUserDelete_NotFound (0.01s)
=== RUN   TestAPIUserDelete_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5791}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001442] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50698 - 200 1156B in 4.070351ms
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_invalid
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001443] "DELETE http://localhost:19090/api/v1/admin/users/invalid HTTP/1.1" from [::1]:50700 - 400 65B in 337.889Âµs
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_abc
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001444] "DELETE http://localhost:19090/api/v1/admin/users/abc HTTP/1.1" from [::1]:50702 - 400 65B in 341.014Âµs
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_-1
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001445] "DELETE http://localhost:19090/api/v1/admin/users/-1 HTTP/1.1" from [::1]:50716 - 404 63B in 407.5Âµs
--- PASS: TestAPIUserDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_invalid (0.00s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_abc (0.00s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_-1 (0.00s)
=== RUN   TestAPIUserDelete_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001446] "DELETE http://localhost:19090/api/v1/admin/users/2395 HTTP/1.1" from [::1]:50726 - 401 22B in 119.246Âµs
--- PASS: TestAPIUserDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserEmailPut_Success
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5792}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001447] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50736 - 200 1156B in 4.383723ms
2025/11/25 13:24:43 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-lxegYJDc","userId":2396}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001448] "PUT http://localhost:19090/api/v1/admin/users/2396/email HTTP/1.1" from [::1]:50750 - 200 699B in 3.430191ms
--- PASS: TestAPIUserEmailPut_Success (0.02s)
=== RUN   TestAPIUserEmailPut_EmailNormalization
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5793}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001449] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50760 - 200 1156B in 4.218581ms
2025/11/25 13:24:43 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-cOJZABHc","userId":2397}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001450] "PUT http://localhost:19090/api/v1/admin/users/2397/email HTTP/1.1" from [::1]:50770 - 200 703B in 2.500725ms
--- PASS: TestAPIUserEmailPut_EmailNormalization (0.01s)
=== RUN   TestAPIUserEmailPut_DuplicateEmail
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5794}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001451] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50774 - 200 1156B in 4.109725ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001452] "PUT http://localhost:19090/api/v1/admin/users/2399/email HTTP/1.1" from [::1]:50786 - 400 107B in 861.458Âµs
--- PASS: TestAPIUserEmailPut_DuplicateEmail (0.02s)
=== RUN   TestAPIUserEmailPut_InvalidEmail
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5795}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001453] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50802 - 200 1156B in 4.185829ms
=== RUN   TestAPIUserEmailPut_InvalidEmail/empty_email
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001454] "PUT http://localhost:19090/api/v1/admin/users/2400/email HTTP/1.1" from [::1]:50818 - 400 81B in 529.069Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/invalid_format
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001455] "PUT http://localhost:19090/api/v1/admin/users/2400/email HTTP/1.1" from [::1]:50824 - 400 86B in 1.463716ms
=== RUN   TestAPIUserEmailPut_InvalidEmail/missing_domain
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001456] "PUT http://localhost:19090/api/v1/admin/users/2400/email HTTP/1.1" from [::1]:50828 - 400 86B in 525.754Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/missing_username
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001457] "PUT http://localhost:19090/api/v1/admin/users/2400/email HTTP/1.1" from [::1]:50836 - 400 86B in 424.171Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/multiple_@
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001458] "PUT http://localhost:19090/api/v1/admin/users/2400/email HTTP/1.1" from [::1]:50840 - 400 86B in 374.748Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/spaces_in_middle
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001459] "PUT http://localhost:19090/api/v1/admin/users/2400/email HTTP/1.1" from [::1]:50850 - 400 86B in 389.877Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/special_chars
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001460] "PUT http://localhost:19090/api/v1/admin/users/2400/email HTTP/1.1" from [::1]:50860 - 400 86B in 807.385Âµs
--- PASS: TestAPIUserEmailPut_InvalidEmail (0.02s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/empty_email (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/invalid_format (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/missing_domain (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/missing_username (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/multiple_@ (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/spaces_in_middle (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/special_chars (0.00s)
=== RUN   TestAPIUserEmailPut_SetEmailVerified
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5796}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001461] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50872 - 200 1156B in 4.36619ms
2025/11/25 13:24:43 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-fjfwCrCX","userId":2401}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001462] "PUT http://localhost:19090/api/v1/admin/users/2401/email HTTP/1.1" from [::1]:50884 - 200 703B in 2.517547ms
--- PASS: TestAPIUserEmailPut_SetEmailVerified (0.01s)
=== RUN   TestAPIUserEmailPut_UnsetEmailVerified
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5797}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001463] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50886 - 200 1156B in 4.271701ms
2025/11/25 13:24:43 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-ENGCTvEr","userId":2402}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001464] "PUT http://localhost:19090/api/v1/admin/users/2402/email HTTP/1.1" from [::1]:50894 - 200 706B in 2.443297ms
--- PASS: TestAPIUserEmailPut_UnsetEmailVerified (0.02s)
=== RUN   TestAPIUserEmailPut_UserNotFound
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5798}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001465] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50900 - 200 1156B in 4.519771ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001466] "PUT http://localhost:19090/api/v1/admin/users/99999/email HTTP/1.1" from [::1]:50914 - 404 63B in 579.696Âµs
--- PASS: TestAPIUserEmailPut_UserNotFound (0.03s)
=== RUN   TestAPIUserEmailPut_InvalidId
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5799}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001467] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50930 - 200 1156B in 4.203102ms
=== RUN   TestAPIUserEmailPut_InvalidId/non-numeric_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001468] "PUT http://localhost:19090/api/v1/admin/users/abc/email HTTP/1.1" from [::1]:50932 - 400 65B in 318.752Âµs
=== RUN   TestAPIUserEmailPut_InvalidId/empty_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001469] "PUT http://localhost:19090/api/v1/admin/users//email HTTP/1.1" from [::1]:50938 - 400 70B in 402.471Âµs
=== RUN   TestAPIUserEmailPut_InvalidId/negative_ID
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001470] "PUT http://localhost:19090/api/v1/admin/users/-1/email HTTP/1.1" from [::1]:50946 - 404 63B in 489.485Âµs
--- PASS: TestAPIUserEmailPut_InvalidId (0.01s)
    --- PASS: TestAPIUserEmailPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserEmailPut_InvalidRequestBody
2025/11/25 13:24:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5800}}
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001471] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50952 - 200 1156B in 4.304844ms
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001472] "PUT http://localhost:19090/api/v1/admin/users/2403/email HTTP/1.1" from [::1]:50966 - 400 75B in 324.503Âµs
--- PASS: TestAPIUserEmailPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserEmailPut_Unauthorized
2025/11/25 13:24:43 [a357f2e3b56e/VGvsVkwcAO-001473] "PUT http://localhost:19090/api/v1/admin/users/2404/email HTTP/1.1" from [::1]:50972 - 401 22B in 128.242Âµs
--- PASS: TestAPIUserEmailPut_Unauthorized (0.00s)
=== RUN   TestAPIUserEmailPut_PartialUpdate
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5801}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001474] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50976 - 200 1156B in 4.196459ms
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-HijBFBTy","userId":2405}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001475] "PUT http://localhost:19090/api/v1/admin/users/2405/email HTTP/1.1" from [::1]:50980 - 200 700B in 2.465799ms
--- PASS: TestAPIUserEmailPut_PartialUpdate (0.02s)
=== RUN   TestAPIUserPermissionsGet_Success
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5802}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001476] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50992 - 200 1156B in 4.12817ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001477] "GET http://localhost:19090/api/v1/admin/users/2406/permissions HTTP/1.1" from [::1]:50998 - 200 1944B in 755.628Âµs
--- PASS: TestAPIUserPermissionsGet_Success (0.03s)
=== RUN   TestAPIUserPermissionsGet_UserNotFound
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5803}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001478] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51000 - 200 1156B in 4.174929ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001479] "GET http://localhost:19090/api/v1/admin/users/99999/permissions HTTP/1.1" from [::1]:51014 - 404 58B in 678.723Âµs
--- PASS: TestAPIUserPermissionsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserPermissionsGet_InvalidUserId
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5804}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001480] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51016 - 200 1156B in 4.300235ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001481] "GET http://localhost:19090/api/v1/admin/users/invalid/permissions HTTP/1.1" from [::1]:51030 - 400 73B in 316.568Âµs
--- PASS: TestAPIUserPermissionsGet_InvalidUserId (0.01s)
=== RUN   TestAPIUserPermissionsGet_NoPermissions
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5805}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001482] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51044 - 200 1156B in 4.123351ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001483] "GET http://localhost:19090/api/v1/admin/users/2407/permissions HTTP/1.1" from [::1]:51052 - 200 726B in 588.381Âµs
--- PASS: TestAPIUserPermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIUserPermissionsGet_Unauthorized
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001484] "GET http://localhost:19090/api/v1/admin/users/2408/permissions HTTP/1.1" from [::1]:51064 - 401 22B in 159.401Âµs
--- PASS: TestAPIUserPermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserPermissionsPut_Success
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5806}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001485] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51078 - 200 1156B in 4.100197ms
2025/11/25 13:24:44 INFO {"audit_event":"added_user_permission","details":{"loggedInUser":"","permissionId":903,"userId":2409}}
2025/11/25 13:24:44 INFO {"audit_event":"added_user_permission","details":{"loggedInUser":"","permissionId":904,"userId":2409}}
2025/11/25 13:24:44 INFO {"audit_event":"deleted_user_permission","details":{"loggedInUser":"","permissionId":902,"userId":2409}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001486] "PUT http://localhost:19090/api/v1/admin/users/2409/permissions HTTP/1.1" from [::1]:51090 - 200 17B in 5.76895ms
--- PASS: TestAPIUserPermissionsPut_Success (0.03s)
=== RUN   TestAPIUserPermissionsPut_RemoveAllPermissions
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5807}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001487] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51092 - 200 1156B in 4.129142ms
2025/11/25 13:24:44 INFO {"audit_event":"deleted_user_permission","details":{"loggedInUser":"","permissionId":905,"userId":2410}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001488] "PUT http://localhost:19090/api/v1/admin/users/2410/permissions HTTP/1.1" from [::1]:51098 - 200 17B in 2.538486ms
--- PASS: TestAPIUserPermissionsPut_RemoveAllPermissions (0.03s)
=== RUN   TestAPIUserPermissionsPut_UserNotFound
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5808}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001489] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51102 - 200 1156B in 4.345881ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001490] "PUT http://localhost:19090/api/v1/admin/users/99999/permissions HTTP/1.1" from [::1]:51110 - 404 58B in 495.556Âµs
--- PASS: TestAPIUserPermissionsPut_UserNotFound (0.01s)
=== RUN   TestAPIUserPermissionsPut_PermissionNotFound
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5809}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001491] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51124 - 200 1156B in 4.127539ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001492] "PUT http://localhost:19090/api/v1/admin/users/2411/permissions HTTP/1.1" from [::1]:51134 - 404 64B in 546.743Âµs
--- PASS: TestAPIUserPermissionsPut_PermissionNotFound (0.01s)
=== RUN   TestAPIUserPermissionsPut_InvalidRequestBody
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5810}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001493] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51146 - 200 1156B in 4.317487ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001494] "PUT http://localhost:19090/api/v1/admin/users/2412/permissions HTTP/1.1" from [::1]:51160 - 400 71B in 487.561Âµs
--- PASS: TestAPIUserPermissionsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserPermissionsPut_Unauthorized
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001495] "PUT http://localhost:19090/api/v1/admin/users/2413/permissions HTTP/1.1" from [::1]:51166 - 401 22B in 112.012Âµs
--- PASS: TestAPIUserPermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIPhoneCountriesGet_Success
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5811}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001496] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51176 - 200 1156B in 4.827792ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001497] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:51180 - 200 21243B in 60.888789ms
--- PASS: TestAPIPhoneCountriesGet_Success (0.07s)
=== RUN   TestAPIPhoneCountriesGet_Unauthorized
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001498] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:51182 - 401 22B in 594.734Âµs
--- PASS: TestAPIPhoneCountriesGet_Unauthorized (0.00s)
=== RUN   TestAPIPhoneCountriesGet_InvalidToken
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001499] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:51188 - 401 22B in 458.948Âµs
--- PASS: TestAPIPhoneCountriesGet_InvalidToken (0.00s)
=== RUN   TestAPIUserPhonePut_Success
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5812}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001500] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51194 - 200 1156B in 4.509591ms
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-fDHEzlJe","userId":2414}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001501] "PUT http://localhost:19090/api/v1/admin/users/2414/phone HTTP/1.1" from [::1]:51200 - 200 718B in 125.263003ms
--- PASS: TestAPIUserPhonePut_Success (0.14s)
=== RUN   TestAPIUserPhonePut_ClearPhoneNumber
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5813}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001502] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55674 - 200 1156B in 5.744875ms
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-XnMHVRmZ","userId":2415}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001503] "PUT http://localhost:19090/api/v1/admin/users/2415/phone HTTP/1.1" from [::1]:55684 - 200 706B in 61.669544ms
--- PASS: TestAPIUserPhonePut_ClearPhoneNumber (0.08s)
=== RUN   TestAPIUserPhonePut_ValidationErrors
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5814}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001504] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55688 - 200 1156B in 4.372922ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_without_country
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001505] "PUT http://localhost:19090/api/v1/admin/users/2416/phone HTTP/1.1" from [::1]:55704 - 400 99B in 592.089Âµs
=== RUN   TestAPIUserPhonePut_ValidationErrors/country_without_phone_number
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001506] "PUT http://localhost:19090/api/v1/admin/users/2416/phone HTTP/1.1" from [::1]:55706 - 400 266B in 60.207041ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_too_short
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001507] "PUT http://localhost:19090/api/v1/admin/users/2416/phone HTTP/1.1" from [::1]:55714 - 400 99B in 66.205335ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_too_long
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001508] "PUT http://localhost:19090/api/v1/admin/users/2416/phone HTTP/1.1" from [::1]:55716 - 400 114B in 63.600151ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/invalid_phone_number_characters
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001509] "PUT http://localhost:19090/api/v1/admin/users/2416/phone HTTP/1.1" from [::1]:55724 - 400 174B in 62.492549ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/invalid_country_id
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001510] "PUT http://localhost:19090/api/v1/admin/users/2416/phone HTTP/1.1" from [::1]:55732 - 400 76B in 62.354548ms
--- PASS: TestAPIUserPhonePut_ValidationErrors (0.33s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_without_country (0.00s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/country_without_phone_number (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_too_short (0.07s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_too_long (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/invalid_phone_number_characters (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/invalid_country_id (0.06s)
=== RUN   TestAPIUserPhonePut_UserNotFound
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5815}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001511] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55734 - 200 1156B in 4.732512ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001512] "PUT http://localhost:19090/api/v1/admin/users/99999/phone HTTP/1.1" from [::1]:55736 - 404 63B in 461.472Âµs
--- PASS: TestAPIUserPhonePut_UserNotFound (0.01s)
=== RUN   TestAPIUserPhonePut_InvalidUserId
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5816}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001513] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55750 - 200 1156B in 4.537784ms
=== RUN   TestAPIUserPhonePut_InvalidUserId/non-numeric_ID
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001514] "PUT http://localhost:19090/api/v1/admin/users/abc/phone HTTP/1.1" from [::1]:55752 - 400 65B in 425.433Âµs
=== RUN   TestAPIUserPhonePut_InvalidUserId/empty_ID
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001515] "PUT http://localhost:19090/api/v1/admin/users//phone HTTP/1.1" from [::1]:55764 - 400 70B in 495.967Âµs
=== RUN   TestAPIUserPhonePut_InvalidUserId/negative_ID
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001516] "PUT http://localhost:19090/api/v1/admin/users/-1/phone HTTP/1.1" from [::1]:55778 - 404 63B in 398.032Âµs
--- PASS: TestAPIUserPhonePut_InvalidUserId (0.01s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/empty_ID (0.00s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/negative_ID (0.00s)
=== RUN   TestAPIUserPhonePut_InvalidRequestBody
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5817}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001517] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55792 - 200 1156B in 4.910949ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001518] "PUT http://localhost:19090/api/v1/admin/users/2417/phone HTTP/1.1" from [::1]:55794 - 400 75B in 470.689Âµs
--- PASS: TestAPIUserPhonePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserPhonePut_Unauthorized
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001519] "PUT http://localhost:19090/api/v1/admin/users/2418/phone HTTP/1.1" from [::1]:55796 - 401 22B in 148.05Âµs
--- PASS: TestAPIUserPhonePut_Unauthorized (0.00s)
=== RUN   TestAPIUserPhonePut_PhoneNumberVerifiedAutoCleared
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5818}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001520] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55798 - 200 1156B in 5.366861ms
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-jfiTeice","userId":2419}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001521] "PUT http://localhost:19090/api/v1/admin/users/2419/phone HTTP/1.1" from [::1]:55804 - 200 708B in 61.384745ms
--- PASS: TestAPIUserPhonePut_PhoneNumberVerifiedAutoCleared (0.07s)
=== RUN   TestAPIUserProfilePut_Success
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5819}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001522] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55818 - 200 1156B in 4.331244ms
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-nMDBpDHL","userId":2420}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001523] "PUT http://localhost:19090/api/v1/admin/users/2420/profile HTTP/1.1" from [::1]:55832 - 200 825B in 3.502398ms
--- PASS: TestAPIUserProfilePut_Success (0.02s)
=== RUN   TestAPIUserProfilePut_PartialUpdate
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5820}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001524] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55834 - 200 1156B in 4.349328ms
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-vzpFKYPP","userId":2421}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001525] "PUT http://localhost:19090/api/v1/admin/users/2421/profile HTTP/1.1" from [::1]:55840 - 200 710B in 4.207861ms
--- PASS: TestAPIUserProfilePut_PartialUpdate (0.02s)
=== RUN   TestAPIUserProfilePut_InvalidGender
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5821}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001526] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55846 - 200 1156B in 4.454497ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001527] "PUT http://localhost:19090/api/v1/admin/users/2422/profile HTTP/1.1" from [::1]:55854 - 400 69B in 1.473704ms
--- PASS: TestAPIUserProfilePut_InvalidGender (0.01s)
=== RUN   TestAPIUserProfilePut_ValidGender
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5822}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001528] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55866 - 200 1156B in 4.307109ms
=== RUN   TestAPIUserProfilePut_ValidGender/female
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-BXfvKTRi","userId":2423}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001529] "PUT http://localhost:19090/api/v1/admin/users/2423/profile HTTP/1.1" from [::1]:55876 - 200 714B in 2.8683ms
=== RUN   TestAPIUserProfilePut_ValidGender/male
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-BXfvKTRi","userId":2423}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001530] "PUT http://localhost:19090/api/v1/admin/users/2423/profile HTTP/1.1" from [::1]:55886 - 200 712B in 4.19199ms
=== RUN   TestAPIUserProfilePut_ValidGender/other
2025/11/25 13:24:44 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-BXfvKTRi","userId":2423}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001531] "PUT http://localhost:19090/api/v1/admin/users/2423/profile HTTP/1.1" from [::1]:55890 - 200 713B in 2.998296ms
--- PASS: TestAPIUserProfilePut_ValidGender (0.02s)
    --- PASS: TestAPIUserProfilePut_ValidGender/female (0.00s)
    --- PASS: TestAPIUserProfilePut_ValidGender/male (0.00s)
    --- PASS: TestAPIUserProfilePut_ValidGender/other (0.00s)
=== RUN   TestAPIUserProfilePut_InvalidDateOfBirth
2025/11/25 13:24:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5823}}
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001532] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55900 - 200 1156B in 4.458384ms
2025/11/25 13:24:44 [a357f2e3b56e/VGvsVkwcAO-001533] "PUT http://localhost:19090/api/v1/admin/users/2424/profile HTTP/1.1" from [::1]:55906 - 400 114B in 1.687488ms
--- PASS: TestAPIUserProfilePut_InvalidDateOfBirth (0.01s)
=== RUN   TestAPIUserProfilePut_UserNotFound
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5824}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001534] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55914 - 200 1156B in 4.29199ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001535] "PUT http://localhost:19090/api/v1/admin/users/99999/profile HTTP/1.1" from [::1]:55928 - 404 63B in 434.491Âµs
--- PASS: TestAPIUserProfilePut_UserNotFound (0.01s)
=== RUN   TestAPIUserProfilePut_InvalidId
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5825}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001536] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55944 - 200 1156B in 4.255791ms
=== RUN   TestAPIUserProfilePut_InvalidId/non-numeric_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001537] "PUT http://localhost:19090/api/v1/admin/users/abc/profile HTTP/1.1" from [::1]:55946 - 400 65B in 1.009687ms
=== RUN   TestAPIUserProfilePut_InvalidId/empty_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001538] "PUT http://localhost:19090/api/v1/admin/users//profile HTTP/1.1" from [::1]:55952 - 400 70B in 453.597Âµs
=== RUN   TestAPIUserProfilePut_InvalidId/negative_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001539] "PUT http://localhost:19090/api/v1/admin/users/-1/profile HTTP/1.1" from [::1]:55966 - 404 63B in 446.404Âµs
--- PASS: TestAPIUserProfilePut_InvalidId (0.01s)
    --- PASS: TestAPIUserProfilePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserProfilePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserProfilePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserProfilePut_InvalidRequestBody
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5826}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001540] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:55974 - 200 1156B in 4.295246ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001541] "PUT http://localhost:19090/api/v1/admin/users/2425/profile HTTP/1.1" from [::1]:55986 - 400 75B in 423.41Âµs
--- PASS: TestAPIUserProfilePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserProfilePut_Unauthorized
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001542] "PUT http://localhost:19090/api/v1/admin/users/2426/profile HTTP/1.1" from [::1]:55988 - 401 22B in 188.877Âµs
--- PASS: TestAPIUserProfilePut_Unauthorized (0.00s)
=== RUN   TestAPIUserAddressPut_Success
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5827}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001543] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56002 - 200 1156B in 4.20706ms
2025/11/25 13:24:45 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-fSvGEthB","userId":2427}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001544] "PUT http://localhost:19090/api/v1/admin/users/2427/address HTTP/1.1" from [::1]:56012 - 200 740B in 3.376169ms
--- PASS: TestAPIUserAddressPut_Success (0.02s)
=== RUN   TestAPIUserAddressPut_PartialAddress
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5828}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001545] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56022 - 200 1156B in 4.351271ms
2025/11/25 13:24:45 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-bJmGTWen","userId":2428}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001546] "PUT http://localhost:19090/api/v1/admin/users/2428/address HTTP/1.1" from [::1]:56024 - 200 727B in 2.284276ms
--- PASS: TestAPIUserAddressPut_PartialAddress (0.01s)
=== RUN   TestAPIUserAddressPut_ClearAllFields
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5829}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001547] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56038 - 200 1156B in 4.094697ms
2025/11/25 13:24:45 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-JmsXVZrP","userId":2429}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001548] "PUT http://localhost:19090/api/v1/admin/users/2429/address HTTP/1.1" from [::1]:56044 - 200 706B in 2.23327ms
--- PASS: TestAPIUserAddressPut_ClearAllFields (0.01s)
=== RUN   TestAPIUserAddressPut_UserNotFound
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5830}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001549] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56050 - 200 1156B in 4.475016ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001550] "PUT http://localhost:19090/api/v1/admin/users/99999/address HTTP/1.1" from [::1]:56054 - 404 63B in 392.712Âµs
--- PASS: TestAPIUserAddressPut_UserNotFound (0.01s)
=== RUN   TestAPIUserAddressPut_InvalidId
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5831}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001551] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56070 - 200 1156B in 4.066003ms
=== RUN   TestAPIUserAddressPut_InvalidId/non-numeric_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001552] "PUT http://localhost:19090/api/v1/admin/users/abc/address HTTP/1.1" from [::1]:56084 - 400 65B in 329.002Âµs
=== RUN   TestAPIUserAddressPut_InvalidId/empty_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001553] "PUT http://localhost:19090/api/v1/admin/users//address HTTP/1.1" from [::1]:56096 - 400 70B in 297.792Âµs
=== RUN   TestAPIUserAddressPut_InvalidId/negative_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001554] "PUT http://localhost:19090/api/v1/admin/users/-1/address HTTP/1.1" from [::1]:56100 - 404 63B in 355.501Âµs
--- PASS: TestAPIUserAddressPut_InvalidId (0.01s)
    --- PASS: TestAPIUserAddressPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAddressPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAddressPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAddressPut_InvalidRequestBody
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5832}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001555] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56114 - 200 1156B in 4.063828ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001556] "PUT http://localhost:19090/api/v1/admin/users/2430/address HTTP/1.1" from [::1]:56116 - 400 75B in 304.124Âµs
--- PASS: TestAPIUserAddressPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAddressPut_Unauthorized
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001557] "PUT http://localhost:19090/api/v1/admin/users/2431/address HTTP/1.1" from [::1]:56130 - 401 22B in 103.365Âµs
--- PASS: TestAPIUserAddressPut_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_Success
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5833}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001558] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56146 - 200 1156B in 4.080249ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001559] "GET http://localhost:19090/api/v1/admin/users/search?query=annperm&annotatePermissionId=906&page=1&size=200 HTTP/1.1" from [::1]:56154 - 200 3008B in 2.679152ms
--- PASS: TestAPIUsersSearch_AnnotatePermission_Success (0.03s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_InvalidParam
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5834}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001560] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56162 - 200 1156B in 4.215265ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001561] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=abc HTTP/1.1" from [::1]:56178 - 400 85B in 540.591Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_InvalidParam (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_PermissionNotFound
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5835}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001562] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56182 - 200 1156B in 4.166573ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001563] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=8785155 HTTP/1.1" from [::1]:56184 - 404 64B in 674.946Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_PermissionNotFound (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_Unauthorized
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001564] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=907 HTTP/1.1" from [::1]:56200 - 401 22B in 126.879Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_ConflictWithGroupAnnotation
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5836}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001565] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56202 - 200 1156B in 4.132148ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001566] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=908&annotateGroupMembership=750 HTTP/1.1" from [::1]:56216 - 400 123B in 688.44Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_ConflictWithGroupAnnotation (0.02s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_UserinfoForbidden
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5837}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001567] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56218 - 200 1156B in 4.198273ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001568] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=1 HTTP/1.1" from [::1]:56224 - 400 96B in 974.081Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_UserinfoForbidden (0.01s)
=== RUN   TestAPIUsersSearch_Success
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5838}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001569] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56240 - 200 1156B in 4.128751ms
    api_users_search_test.go:31: Created 3 test users:
    api_users_search_test.go:33:   - john.doe@test.com 'AAA John' (ID: 2435, Enabled: true)
    api_users_search_test.go:33:   - jane.smith@test.com 'AAA Jane' (ID: 2436, Enabled: true)
    api_users_search_test.go:33:   - disabled@test.com 'AAA Disabled' (ID: 2437, Enabled: false)
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001570] "GET http://localhost:19090/api/v1/admin/users/search?page=1&size=50 HTTP/1.1" from [::1]:56242 - 200 34331B in 915.38Âµs
    api_users_search_test.go:64: Total users in database: 1062
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001571] "GET http://localhost:19090/api/v1/admin/users/search?page=2&size=50 HTTP/1.1" from [::1]:56246 - 200 34285B in 880.474Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001572] "GET http://localhost:19090/api/v1/admin/users/search?page=3&size=50 HTTP/1.1" from [::1]:56260 - 200 34359B in 871.707Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001573] "GET http://localhost:19090/api/v1/admin/users/search?page=4&size=50 HTTP/1.1" from [::1]:56274 - 200 34266B in 845.157Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001574] "GET http://localhost:19090/api/v1/admin/users/search?page=5&size=50 HTTP/1.1" from [::1]:56282 - 200 34329B in 880.524Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001575] "GET http://localhost:19090/api/v1/admin/users/search?page=6&size=50 HTTP/1.1" from [::1]:56298 - 200 34309B in 987.957Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001576] "GET http://localhost:19090/api/v1/admin/users/search?page=7&size=50 HTTP/1.1" from [::1]:56314 - 200 34335B in 1.04814ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001577] "GET http://localhost:19090/api/v1/admin/users/search?page=8&size=50 HTTP/1.1" from [::1]:56328 - 200 34346B in 2.107813ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001578] "GET http://localhost:19090/api/v1/admin/users/search?page=9&size=50 HTTP/1.1" from [::1]:56344 - 200 34367B in 1.219584ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001579] "GET http://localhost:19090/api/v1/admin/users/search?page=10&size=50 HTTP/1.1" from [::1]:56346 - 200 34406B in 1.156124ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001580] "GET http://localhost:19090/api/v1/admin/users/search?page=11&size=50 HTTP/1.1" from [::1]:56352 - 200 34381B in 1.866207ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001581] "GET http://localhost:19090/api/v1/admin/users/search?page=12&size=50 HTTP/1.1" from [::1]:56358 - 200 34299B in 1.876535ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001582] "GET http://localhost:19090/api/v1/admin/users/search?page=13&size=50 HTTP/1.1" from [::1]:56372 - 200 34369B in 1.832993ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001583] "GET http://localhost:19090/api/v1/admin/users/search?page=14&size=50 HTTP/1.1" from [::1]:56384 - 200 34281B in 1.887026ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001584] "GET http://localhost:19090/api/v1/admin/users/search?page=15&size=50 HTTP/1.1" from [::1]:56398 - 200 34341B in 1.916862ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001585] "GET http://localhost:19090/api/v1/admin/users/search?page=16&size=50 HTTP/1.1" from [::1]:56410 - 200 34296B in 2.038642ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001586] "GET http://localhost:19090/api/v1/admin/users/search?page=17&size=50 HTTP/1.1" from [::1]:56424 - 200 34373B in 2.134533ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001587] "GET http://localhost:19090/api/v1/admin/users/search?page=18&size=50 HTTP/1.1" from [::1]:56426 - 200 34299B in 2.035175ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001588] "GET http://localhost:19090/api/v1/admin/users/search?page=19&size=50 HTTP/1.1" from [::1]:56440 - 200 34354B in 2.258057ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001589] "GET http://localhost:19090/api/v1/admin/users/search?page=20&size=50 HTTP/1.1" from [::1]:56456 - 200 34332B in 2.204034ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001590] "GET http://localhost:19090/api/v1/admin/users/search?page=21&size=50 HTTP/1.1" from [::1]:56468 - 200 34360B in 2.839986ms
    api_users_search_test.go:72: Found test user: disabled@test.com 'AAA Disabled' (ID: 2437, Enabled: false)
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001591] "GET http://localhost:19090/api/v1/admin/users/search?page=22&size=50 HTTP/1.1" from [::1]:56474 - 200 9321B in 2.574444ms
    api_users_search_test.go:72: Found test user: jane.smith@test.com 'AAA Jane' (ID: 2436, Enabled: true)
    api_users_search_test.go:72: Found test user: john.doe@test.com 'AAA John' (ID: 2435, Enabled: true)
--- PASS: TestAPIUsersSearch_Success (0.06s)
=== RUN   TestAPIUsersSearch_WithQuery
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5839}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001592] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56482 - 200 1156B in 4.20178ms
    api_users_search_test.go:126: Created test user: uniquejohnhqZquqnR@searchtest.com 'UniqueJohn TestUser' (ID: 2438, Enabled: true)
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001593] "GET http://localhost:19090/api/v1/admin/users/search?query=uniquejohnhqZquqnR HTTP/1.1" from [::1]:56498 - 200 782B in 2.440511ms
    api_users_search_test.go:148: Search query: 'uniquejohnhqZquqnR'
    api_users_search_test.go:149: Total results: 1
    api_users_search_test.go:150: Number of users returned: 1
    api_users_search_test.go:151: Search results:
    api_users_search_test.go:153:   [0] ID: 2438, Email: uniquejohnhqZquqnR@searchtest.com, GivenName: UniqueJohn, FamilyName: TestUser, Enabled: true
--- PASS: TestAPIUsersSearch_WithQuery (0.01s)
=== RUN   TestAPIUsersSearch_WithPagination
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5840}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001594] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56514 - 200 1156B in 4.182143ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001595] "GET http://localhost:19090/api/v1/admin/users/search?page=1&size=2 HTTP/1.1" from [::1]:56526 - 200 1452B in 537.406Âµs
--- PASS: TestAPIUsersSearch_WithPagination (0.02s)
=== RUN   TestAPIUsersSearch_Unauthorized
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001596] "GET http://localhost:19090/api/v1/admin/users/search HTTP/1.1" from [::1]:56540 - 401 22B in 134.454Âµs
--- PASS: TestAPIUsersSearch_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_InvalidToken
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001597] "GET http://localhost:19090/api/v1/admin/users/search HTTP/1.1" from [::1]:56544 - 401 22B in 250.243Âµs
--- PASS: TestAPIUsersSearch_InvalidToken (0.00s)
=== RUN   TestAPIUsersSearch_InvalidParameters
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5841}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001598] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56560 - 200 1156B in 4.176091ms
=== RUN   TestAPIUsersSearch_InvalidParameters/negative_page
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001599] "GET http://localhost:19090/api/v1/admin/users/search?page=-1 HTTP/1.1" from [::1]:56562 - 200 6944B in 835.889Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/zero_page
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001600] "GET http://localhost:19090/api/v1/admin/users/search?page=0 HTTP/1.1" from [::1]:56576 - 200 6944B in 551.643Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/non-numeric_page
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001601] "GET http://localhost:19090/api/v1/admin/users/search?page=abc HTTP/1.1" from [::1]:56588 - 200 6944B in 572.982Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/negative_size
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001602] "GET http://localhost:19090/api/v1/admin/users/search?size=-1 HTTP/1.1" from [::1]:56600 - 200 6944B in 540.611Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/zero_size
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001603] "GET http://localhost:19090/api/v1/admin/users/search?size=0 HTTP/1.1" from [::1]:56604 - 200 6944B in 527.176Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/over-limit_size
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001604] "GET http://localhost:19090/api/v1/admin/users/search?size=300 HTTP/1.1" from [::1]:56616 - 200 6944B in 1.68827ms
=== RUN   TestAPIUsersSearch_InvalidParameters/non-numeric_size
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001605] "GET http://localhost:19090/api/v1/admin/users/search?size=xyz HTTP/1.1" from [::1]:56628 - 200 6944B in 742.864Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/both_invalid
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001606] "GET http://localhost:19090/api/v1/admin/users/search?page=abc&size=xyz HTTP/1.1" from [::1]:56634 - 200 6944B in 559.187Âµs
--- PASS: TestAPIUsersSearch_InvalidParameters (0.03s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/negative_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/zero_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/non-numeric_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/negative_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/zero_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/over-limit_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/non-numeric_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/both_invalid (0.00s)
=== RUN   TestAPIUsersSearch_SizeLimit
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5842}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001607] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56642 - 200 1156B in 4.398621ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001608] "GET http://localhost:19090/api/v1/admin/users/search?size=200 HTTP/1.1" from [::1]:56648 - 200 137077B in 1.580446ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001609] "GET http://localhost:19090/api/v1/admin/users/search?size=201 HTTP/1.1" from [::1]:56650 - 200 6944B in 608.72Âµs
--- PASS: TestAPIUsersSearch_SizeLimit (0.02s)
=== RUN   TestAPIUsersSearch_NoResults
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5843}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001610] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56658 - 200 1156B in 4.404723ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001611] "GET http://localhost:19090/api/v1/admin/users/search?query=nonexistent-user-12345 HTTP/1.1" from [::1]:56670 - 200 77B in 2.345612ms
--- PASS: TestAPIUsersSearch_NoResults (0.02s)
=== RUN   TestAPIUsersSearch_SpecialCharacters
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5844}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001612] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56672 - 200 1156B in 4.147958ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/empty_query
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001613] "GET http://localhost:19090/api/v1/admin/users/search?query= HTTP/1.1" from [::1]:56676 - 200 6944B in 838.294Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/space_query
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001614] "GET http://localhost:19090/api/v1/admin/users/search?query=%20 HTTP/1.1" from [::1]:56684 - 200 2129B in 2.129133ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/at_symbol
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001615] "GET http://localhost:19090/api/v1/admin/users/search?query=john%40doe HTTP/1.1" from [::1]:56700 - 200 63B in 2.097734ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/plus_symbol
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001616] "GET http://localhost:19090/api/v1/admin/users/search?query=john%2Bdoe HTTP/1.1" from [::1]:56710 - 200 63B in 2.097343ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/special_chars
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001617] "GET http://localhost:19090/api/v1/admin/users/search?query=%21%40%23%24 HTTP/1.1" from [::1]:56720 - 200 59B in 2.07973ms
--- PASS: TestAPIUsersSearch_SpecialCharacters (0.03s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/empty_query (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/space_query (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/at_symbol (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/plus_symbol (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/special_chars (0.00s)
=== RUN   TestAPIUsersSearch_MultiplePages
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5845}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001618] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56730 - 200 1156B in 4.062356ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001619] "GET http://localhost:19090/api/v1/admin/users/search?size=5&page=1 HTTP/1.1" from [::1]:56740 - 200 3525B in 798.739Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001620] "GET http://localhost:19090/api/v1/admin/users/search?size=5&page=2 HTTP/1.1" from [::1]:56748 - 200 3472B in 472.663Âµs
--- PASS: TestAPIUsersSearch_MultiplePages (0.04s)
=== RUN   TestAPIUserSessionsGet_Success
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5846}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001621] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56762 - 200 1156B in 4.073758ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001622] "GET http://localhost:19090/api/v1/admin/users/2462/sessions HTTP/1.1" from [::1]:56772 - 200 1462B in 896.073Âµs
--- PASS: TestAPIUserSessionsGet_Success (0.03s)
=== RUN   TestAPIUserSessionsGet_EmptySessions
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5848}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001623] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56778 - 200 1156B in 4.272744ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001624] "GET http://localhost:19090/api/v1/admin/users/2463/sessions HTTP/1.1" from [::1]:56782 - 200 16B in 509.673Âµs
--- PASS: TestAPIUserSessionsGet_EmptySessions (0.01s)
=== RUN   TestAPIUserSessionsGet_UserNotFound
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5849}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001625] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56784 - 200 1156B in 4.558423ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001626] "GET http://localhost:19090/api/v1/admin/users/99999/sessions HTTP/1.1" from [::1]:56796 - 404 63B in 417.038Âµs
--- PASS: TestAPIUserSessionsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserSessionsGet_InvalidId
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5850}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001627] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56812 - 200 1156B in 4.055563ms
=== RUN   TestAPIUserSessionsGet_InvalidId/non-numeric_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001628] "GET http://localhost:19090/api/v1/admin/users/abc/sessions HTTP/1.1" from [::1]:56824 - 400 72B in 320.796Âµs
=== RUN   TestAPIUserSessionsGet_InvalidId/empty_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001629] "GET http://localhost:19090/api/v1/admin/users//sessions HTTP/1.1" from [::1]:56828 - 400 70B in 380.76Âµs
=== RUN   TestAPIUserSessionsGet_InvalidId/negative_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001630] "GET http://localhost:19090/api/v1/admin/users/-1/sessions HTTP/1.1" from [::1]:56834 - 404 63B in 390.027Âµs
--- PASS: TestAPIUserSessionsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserSessionsGet_Unauthorized
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001631] "GET http://localhost:19090/api/v1/admin/users/2464/sessions HTTP/1.1" from [::1]:56846 - 401 22B in 171.294Âµs
--- PASS: TestAPIUserSessionsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserSessionsGet_SessionsWithNoClients
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5851}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001632] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56856 - 200 1156B in 4.275749ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001633] "GET http://localhost:19090/api/v1/admin/users/2465/sessions HTTP/1.1" from [::1]:56866 - 200 710B in 717.175Âµs
--- PASS: TestAPIUserSessionsGet_SessionsWithNoClients (0.02s)
=== RUN   TestAPIUserSessionDelete_Success
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5852}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001634] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56870 - 200 1156B in 5.220054ms
2025/11/25 13:24:45 INFO {"audit_event":"deleted_user_session","details":{"loggedInUser":"","userSessionId":2427}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001635] "DELETE http://localhost:19090/api/v1/admin/user-sessions/2427 HTTP/1.1" from [::1]:56878 - 200 17B in 2.903596ms
--- PASS: TestAPIUserSessionDelete_Success (0.02s)
=== RUN   TestAPIUserSessionDelete_NotFound
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5853}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001636] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56894 - 200 1156B in 4.809066ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001637] "DELETE http://localhost:19090/api/v1/admin/user-sessions/99999 HTTP/1.1" from [::1]:56904 - 404 79B in 502.971Âµs
--- PASS: TestAPIUserSessionDelete_NotFound (0.01s)
=== RUN   TestAPIUserSessionDelete_InvalidId
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5854}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001638] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56912 - 200 1156B in 4.140353ms
=== RUN   TestAPIUserSessionDelete_InvalidId/non-numeric_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001639] "DELETE http://localhost:19090/api/v1/admin/user-sessions/abc HTTP/1.1" from [::1]:56926 - 400 88B in 337.849Âµs
=== RUN   TestAPIUserSessionDelete_InvalidId/empty_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001640] "DELETE http://localhost:19090/api/v1/admin/user-sessions/ HTTP/1.1" from [::1]:56930 - 404 2447B in 429.622Âµs
=== RUN   TestAPIUserSessionDelete_InvalidId/negative_ID
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001641] "DELETE http://localhost:19090/api/v1/admin/user-sessions/-1 HTTP/1.1" from [::1]:56932 - 404 79B in 332.679Âµs
--- PASS: TestAPIUserSessionDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserSessionDelete_Unauthorized
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001642] "DELETE http://localhost:19090/api/v1/admin/user-sessions/2428 HTTP/1.1" from [::1]:56944 - 401 22B in 124.545Âµs
--- PASS: TestAPIUserSessionDelete_Unauthorized (0.01s)
=== RUN   TestAPIUserSessionDelete_InvalidToken
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001643] "DELETE http://localhost:19090/api/v1/admin/user-sessions/2429 HTTP/1.1" from [::1]:56946 - 401 22B in 307.501Âµs
--- PASS: TestAPIUserSessionDelete_InvalidToken (0.01s)
=== RUN   TestAPIUserSessionsGet_OnlyValidSessions
2025/11/25 13:24:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5855}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001644] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56952 - 200 1156B in 4.116508ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001645] "GET http://localhost:19090/api/v1/admin/users/2469/sessions HTTP/1.1" from [::1]:56960 - 200 714B in 672.671Âµs
--- PASS: TestAPIUserSessionsGet_OnlyValidSessions (0.02s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientIdIsMissing
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001646] "GET http://localhost:19090/auth/authorize/ HTTP/1.1" from [::1]:56970 - 200 2129B in 580.196Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientIdIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotExist
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001647] "GET http://localhost:19090/auth/authorize/?client_id=does_not_exist HTTP/1.1" from [::1]:56972 - 200 2149B in 500.054Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotExist (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientIsDisabled
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001648] "GET http://localhost:19090/auth/authorize/?client_id=test-client-OiBdNyMS HTTP/1.1" from [::1]:56978 - 200 2146B in 400.296Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientIsDisabled (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotSupportTheAuthorizationCodeFlow
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001649] "GET http://localhost:19090/auth/authorize/?client_id=test-client-NyjRrzFx HTTP/1.1" from [::1]:56988 - 200 2179B in 492.14Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotSupportTheAuthorizationCodeFlow (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_RedirectURIIsMissing
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001650] "GET http://localhost:19090/auth/authorize/?client_id=test-client-KbyGShIg HTTP/1.1" from [::1]:57000 - 200 2132B in 393.874Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_RedirectURIIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotHaveRedirectURI
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001651] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PJOqoLeB&redirect_uri=https://www.internationalmagnetic.net/robust/models/embrace/architectures HTTP/1.1" from [::1]:57012 - 200 2180B in 499.644Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotHaveRedirectURI (0.00s)
=== RUN   TestAuthorize_ValidateRequest_ResponseTypeIsMissing
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001652] "GET http://localhost:19090/auth/authorize/?client_id=test-client-hLbhomHF&redirect_uri=http://www.customercollaborative.org/leading-edge/compelling HTTP/1.1" from [::1]:57022 - 302 205B in 424.081Âµs
--- PASS: TestAuthorize_ValidateRequest_ResponseTypeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_ResponseTypeIsInvalid
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001653] "GET http://localhost:19090/auth/authorize/?client_id=test-client-VAqRHLMZ&redirect_uri=https://www.leadarchitectures.biz/brand/turn-key&response_type=invalid HTTP/1.1" from [::1]:57028 - 302 193B in 383.525Âµs
--- PASS: TestAuthorize_ValidateRequest_ResponseTypeIsInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeMethodIsMissing
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001654] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nmQekJgp&redirect_uri=http://www.seniorleverage.org/strategize/e-tailers/channels/webservices&response_type=code HTTP/1.1" from [::1]:57036 - 302 207B in 437.747Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeMethodIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeMethodIsInvalid
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001655] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kBqlbGiT&redirect_uri=https://www.investornext-generation.io/integrate/syndicate/syndicate/orchestrate&response_type=code&code_challenge_method=invalid HTTP/1.1" from [::1]:57052 - 302 216B in 343.179Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeMethodIsInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeIsMissing
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001656] "GET http://localhost:19090/auth/authorize/?client_id=test-client-DzbEZrnu&redirect_uri=http://www.leadfunctionalities.name/disintermediate/global/matrix/supply-chains&response_type=code&code_challenge_method=S256 HTTP/1.1" from [::1]:57068 - 302 247B in 362.896Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeInvalid
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001657] "GET http://localhost:19090/auth/authorize/?client_id=test-client-fyXCNXtl&redirect_uri=http://www.corporatee-business.net/bandwidth/distributed/maximize&response_type=code&code_challenge_method=S256&code_challenge=QvsxjlDxKCePatHCpWQaFAkpZLgaKAdFXjtcJZqtWp HTTP/1.1" from [::1]:57074 - 302 233B in 457.003Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001658] "GET http://localhost:19090/auth/authorize/?client_id=test-client-CyZCtDZp&redirect_uri=http://www.customerinitiatives.io/niches/revolutionize/implement&response_type=code&code_challenge_method=S256&code_challenge=OiNzXyfFzZuiTGViggJKAIWCDLHDjHsnXIXLWfHXPjCppmkjOCHcXdpNJHUgSsPugaMlWIsyMWjuenGooOzadtYWHxrPrTTgDCsFbhHlkcTspmDvLImlrUNCWZUyHBhkH HTTP/1.1" from [::1]:57076 - 302 232B in 390.117Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeInvalid (0.01s)
=== RUN   TestAuthorize_ValidateRequest_InvalidResponseMode
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001659] "GET http://localhost:19090/auth/authorize/?client_id=test-client-wWGUydGe&redirect_uri=https://www.customerconvergence.com/reintermediate&response_type=code&code_challenge_method=S256&code_challenge=HAOqAhdyDXRCSgXcAqZBQDRMMOdkYPAXrDLKsVzOtIY&response_mode=invalid HTTP/1.1" from [::1]:57092 - 302 206B in 368.907Âµs
--- PASS: TestAuthorize_ValidateRequest_InvalidResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_QueryResponseMode
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001660] "GET http://localhost:19090/auth/authorize/?client_id=test-client-AIKdONnr&redirect_uri=https://www.legacybandwidth.info/intuitive&response_type=code&code_challenge_method=S256&code_challenge=QsRDeeAzJqdAbgYKLeRlQoOLqCqpZCkKcoReXDbxEVh&response_mode=query&scope=invalid_scope HTTP/1.1" from [::1]:57098 - 302 280B in 391.951Âµs
--- PASS: TestAuthorize_ValidateRequest_QueryResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_FragmentResponseMode
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001661] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kGhJSAiU&redirect_uri=http://www.customerefficient.com/partnerships/implement/b2b&response_type=code&code_challenge_method=S256&code_challenge=BxirDtcsnuOvAYdBZsarjcCjGWeieQEayLauWalBQsa&response_mode=fragment&scope=invalid_scope HTTP/1.1" from [::1]:57108 - 302 297B in 450.231Âµs
--- PASS: TestAuthorize_ValidateRequest_FragmentResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_FormPostResponseMode
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001662] "GET http://localhost:19090/auth/authorize/?client_id=test-client-AsCxoRje&redirect_uri=http://www.dynamiccommunities.io/cross-media/disintermediate&response_type=code&code_challenge_method=S256&code_challenge=GnxxFhVvCCGrmwKswwgIUIJIiOlAyRHzmdZNRQJPldP&response_mode=form_post&scope=invalid_scope HTTP/1.1" from [::1]:57120 - 200 683B in 449.349Âµs
--- PASS: TestAuthorize_ValidateRequest_FormPostResponseMode (0.01s)
=== RUN   TestAuthorize_ValidateScopes_ScopeIsMissing
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001663] "GET http://localhost:19090/auth/authorize/?client_id=test-client-telDMsPq&redirect_uri=http://www.leadstrategic.info/embrace/deliver/envisioneer&response_type=code&code_challenge_method=S256&code_challenge=NZnxCZvnVLOMAbAXHYtJYzEztCZliHCszDRghCtNFoJ HTTP/1.1" from [::1]:57136 - 302 321B in 440.683Âµs
--- PASS: TestAuthorize_ValidateScopes_ScopeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateScopes_UserInfoShouldNotBeIncluded
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001664] "GET http://localhost:19090/auth/authorize/?client_id=test-client-fbtuSedq&code_challenge=zhtZRkBXseRbAajadDqZgDXivHizPWejtOSoAgVVFun&code_challenge_method=S256&redirect_uri=https%3A%2F%2Fwww.centralstreamline.net%2Fstrategic&response_type=code&scope=openid+profile+authserver%3Auserinfo HTTP/1.1" from [::1]:57148 - 302 313B in 367.314Âµs
--- PASS: TestAuthorize_ValidateScopes_UserInfoShouldNotBeIncluded (0.00s)
=== RUN   TestAuthorize_ValidateScopes_InvalidScope
=== RUN   TestAuthorize_ValidateScopes_InvalidScope/Invalid_single_scope
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001665] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JEQkKIFP&redirect_uri=http%3A%2F%2Fwww.chiefend-to-end.biz%2Fmesh%2Fsupply-chains%2Fmesh%2Frevolutionize&response_type=code&code_challenge_method=S256&code_challenge=dMeYkGDrrnoQKHSjwDDDNEfohlOrsxrAwGQKDQxAOGj&scope=my_scope HTTP/1.1" from [::1]:57150 - 302 301B in 378.716Âµs
=== RUN   TestAuthorize_ValidateScopes_InvalidScope/Invalid_complex_scope
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001666] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JEQkKIFP&redirect_uri=http%3A%2F%2Fwww.chiefend-to-end.biz%2Fmesh%2Fsupply-chains%2Fmesh%2Frevolutionize&response_type=code&code_challenge_method=S256&code_challenge=AENvMgsBQyykbKxjJiDUYYSqhCFfELmnyMKTKrrqCrw&scope=my_resource%3Amy_scope%3Asomething HTTP/1.1" from [::1]:57160 - 302 327B in 306.249Âµs
--- PASS: TestAuthorize_ValidateScopes_InvalidScope (0.00s)
    --- PASS: TestAuthorize_ValidateScopes_InvalidScope/Invalid_single_scope (0.00s)
    --- PASS: TestAuthorize_ValidateScopes_InvalidScope/Invalid_complex_scope (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ResourceDoesNotExist
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001667] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nPqLTsez&redirect_uri=https%3A%2F%2Fwww.chiefworld-class.io%2Fvortals%2Fe-enable%2Fbleeding-edge&response_type=code&code_challenge_method=S256&code_challenge=iFSFGtzRHtMMwpIIGosiexCoGujxUDwVPOganzpKDvE&scope=non_existent_resource%3Aread HTTP/1.1" from [::1]:57174 - 302 251B in 345.132Âµs
--- PASS: TestAuthorize_ValidateScopes_ResourceDoesNotExist (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ResourceDoesNotHavePermissionAssociated
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001668] "GET http://localhost:19090/auth/authorize/?client_id=test-client-mvRVWQld&redirect_uri=https%3A%2F%2Fwww.chiefparadigms.info%2Fusers%2Fe-tailers%2Fdot-com&response_type=code&code_challenge_method=S256&code_challenge=ZjUyPMdTIjemIcvRtmwvvjTkyEVUZAboXssaDxqDrOD&scope=test-resource-pMBUmUiA%3Anon_existent_permission HTTP/1.1" from [::1]:57184 - 302 323B in 373.286Âµs
--- PASS: TestAuthorize_ValidateScopes_ResourceDoesNotHavePermissionAssociated (0.01s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001669] "GET http://localhost:19090/auth/authorize/?client_id=test-client-HykHxnxM&redirect_uri=https%3A%2F%2Fwww.internalapplications.org%2Frobust&response_type=code&code_challenge_method=S256&code_challenge=TEJMtydJPVrlQbVvaanGefaBJUffetBjzuGQGOpFaHf&scope=openid+profile+email&state=DtOUAkUP&nonce=JWjITDMm HTTP/1.1" from [::1]:57192 - 302 57B in 652.943Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001670] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57196 - 302 54B in 251.775Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001671] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57200 - 200 2949B in 396.859Âµs
2025/11/25 13:24:45 INFO {"audit_event":"auth_success_pwd","details":{"userId":2470}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001672] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57200 - 302 0B in 35.328854ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001673] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57200 - 302 60B in 329.543Âµs
2025/11/25 13:24:45 INFO {"audit_event":"started_new_user_session","details":{"clientId":5876,"userId":2470}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001674] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57206 - 302 56B in 2.270941ms
2025/11/25 13:24:45 INFO {"audit_event":"created_auth_code","details":{"clientId":5876,"codeId":1112,"userId":2470}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001675] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57216 - 302 219B in 2.000059ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsNotRequired
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001676] "GET http://localhost:19090/auth/authorize/?client_id=test-client-BzEuksZN&redirect_uri=http%3A%2F%2Fwww.dynamicweb-enabled.net%2Fenhance%2Fmarkets%2Fmesh&response_type=code&code_challenge_method=S256&code_challenge=bewZIMeMfabudcvblpQwxajlOoWpNkZShAhIbLhJJnN&scope=openid+profile+email&state=EppZdvJq&nonce=JCdYcGfG HTTP/1.1" from [::1]:57232 - 302 57B in 676.689Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001677] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57246 - 302 54B in 382.403Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001678] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57262 - 200 2949B in 412.991Âµs
2025/11/25 13:24:45 INFO {"audit_event":"auth_success_pwd","details":{"userId":2471}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001679] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57262 - 302 0B in 35.499125ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001680] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57262 - 302 57B in 545.02Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001681] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57266 - 302 60B in 472.323Âµs
2025/11/25 13:24:45 INFO {"audit_event":"started_new_user_session","details":{"clientId":5877,"userId":2471}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001682] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57274 - 302 56B in 2.547153ms
2025/11/25 13:24:45 INFO {"audit_event":"created_auth_code","details":{"clientId":5877,"codeId":1113,"userId":2471}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001683] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57280 - 302 230B in 3.120486ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsNotRequired
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001684] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YxRVhmFv&redirect_uri=http%3A%2F%2Fwww.centralstreamline.name%2Fcutting-edge%2Fmethodologies%2Fengage%2Fnext-generation&response_type=code&code_challenge_method=S256&code_challenge=eXVZmLyOFQOFgRXdeQShuAyxljSezBWziHapKcrcNDK&scope=openid+profile+email&state=McqtvRpk&nonce=EryKDvnS HTTP/1.1" from [::1]:57286 - 302 57B in 405.537Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001685] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57290 - 302 54B in 256.985Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001686] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57296 - 200 2949B in 302.953Âµs
2025/11/25 13:24:45 INFO {"audit_event":"auth_success_pwd","details":{"userId":2472}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001687] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57296 - 302 0B in 35.161537ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001688] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57296 - 302 57B in 393.072Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001689] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57310 - 302 54B in 360.011Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001690] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57314 - 200 2471B in 360.331Âµs
2025/11/25 13:24:45 INFO {"audit_event":"auth_success_otp","details":{"userId":2472}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001691] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57314 - 302 0B in 367.755Âµs
2025/11/25 13:24:45 INFO {"audit_event":"started_new_user_session","details":{"clientId":5878,"userId":2472}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001692] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57314 - 302 56B in 2.251545ms
2025/11/25 13:24:45 INFO {"audit_event":"created_auth_code","details":{"clientId":5878,"codeId":1114,"userId":2472}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001693] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57316 - 302 259B in 2.013955ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001694] "GET http://localhost:19090/auth/authorize/?client_id=test-client-TlKqztlW&redirect_uri=http%3A%2F%2Fwww.internal24-365.io%2Fout-of-the-box%2Freinvent&response_type=code&code_challenge_method=S256&code_challenge=kSIHjLelRyCczTVVPybHgsIzEyiuwqxTnZMTIkiomHG&scope=openid+profile+email&state=exYtkVcD&nonce=mZyhmBjl HTTP/1.1" from [::1]:57332 - 302 57B in 1.19056ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001695] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57344 - 302 54B in 428.71Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001696] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57356 - 200 2949B in 345.863Âµs
2025/11/25 13:24:45 INFO {"audit_event":"auth_success_pwd","details":{"userId":2473}}
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001697] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57356 - 302 0B in 35.362488ms
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001698] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57356 - 302 57B in 408.742Âµs
2025/11/25 13:24:45 [a357f2e3b56e/VGvsVkwcAO-001699] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57368 - 302 54B in 534.29Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001700] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57370 - 200 6194B in 3.665817ms
2025/11/25 13:24:46 INFO {"audit_event":"enabled_otp","details":{"userId":2473}}
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_otp","details":{"userId":2473}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001701] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57370 - 302 0B in 2.93166ms
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5879,"userId":2473}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001702] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57370 - 302 56B in 2.806783ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5879,"codeId":1115,"userId":2473}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001703] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57374 - 302 228B in 2.393683ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001704] "GET http://localhost:19090/auth/authorize/?client_id=test-client-CGBoTlss&redirect_uri=http%3A%2F%2Fwww.centralwireless.net%2Ftarget%2Fglobal%2Fschemas%2Fend-to-end&response_type=code&code_challenge_method=S256&code_challenge=VlFhLfXyUGJcVcYdpLvRXyqzItxBwjBRWzlNWoULXht&scope=openid+profile+email&state=ubETAsoc&nonce=exxxRdLx HTTP/1.1" from [::1]:57386 - 302 57B in 673.713Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001705] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57394 - 302 54B in 364.048Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001706] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57400 - 200 2949B in 524.972Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2474}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001707] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57400 - 302 0B in 38.06839ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001708] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57400 - 302 57B in 489.044Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001709] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57408 - 302 54B in 477.513Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001710] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57416 - 200 2471B in 357.896Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_otp","details":{"userId":2474}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001711] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57416 - 302 0B in 316.378Âµs
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5880,"userId":2474}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001712] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57416 - 302 56B in 2.371501ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5880,"codeId":1116,"userId":2474}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001713] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57426 - 302 239B in 2.509191ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001714] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MNVRdAav&redirect_uri=http%3A%2F%2Fwww.forwardsynergistic.biz%2Fmodels%2Fdrive&response_type=code&code_challenge_method=S256&code_challenge=eUmjkkAgkeqarBVZvqXhyDzrGVQDZNmfFfrndUMSgFV&scope=openid+profile+email+res-BoYFwvgL%3Aperm-wZolIWIt+res-nykugrFo%3Aperm-FKhOioyw&state=hGeTgaAf&nonce=shUBPgpn HTTP/1.1" from [::1]:57428 - 302 57B in 760.547Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001715] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57444 - 302 54B in 227.439Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001716] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57458 - 200 2949B in 294.447Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2475}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001717] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57458 - 302 0B in 35.893169ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001718] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57458 - 302 60B in 601.747Âµs
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5881,"userId":2475}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001719] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57474 - 302 58B in 3.19133ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001720] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57486 - 200 4699B in 683.051Âµs
2025/11/25 13:24:46 INFO {"audit_event":"saved_consent","details":{"clientId":5881,"consentId":199,"userId":2475}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001721] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57486 - 302 0B in 2.947249ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5881,"codeId":1117,"userId":2475}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001722] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57486 - 302 222B in 2.316817ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsFullyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001723] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ktOfILYY&redirect_uri=http%3A%2F%2Fwww.futureb2b.info%2Frobust%2Fworld-class%2Fpartnerships&response_type=code&code_challenge_method=S256&code_challenge=HPFQRhpwXPtynMsVrTzxIVtfnWfMMAtDgYgeeBpHzss&scope=openid+profile+email+res-rDGxJMdY%3Aperm-IhXwyrmY+res-hXLUsSHQ%3Aperm-etKCOaXl&state=nJymTZGf&nonce=OGcavmKX HTTP/1.1" from [::1]:57490 - 302 57B in 930.078Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001724] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57496 - 302 54B in 284.728Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001725] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57504 - 200 2949B in 560.078Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2476}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001726] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57504 - 302 0B in 36.810103ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001727] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57504 - 302 60B in 566.931Âµs
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5882,"userId":2476}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001728] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57506 - 302 58B in 3.148449ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001729] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57514 - 200 4699B in 1.208043ms
2025/11/25 13:24:46 INFO {"audit_event":"saved_consent","details":{"clientId":5882,"consentId":200,"userId":2476}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001730] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57514 - 302 0B in 2.239571ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5882,"codeId":1118,"userId":2476}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001731] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57514 - 302 233B in 2.414071ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsPartiallyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001732] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kKofUQIz&redirect_uri=http%3A%2F%2Fwww.forwardparadigms.org%2Fharness%2Fplatforms%2Fgenerate&response_type=code&code_challenge_method=S256&code_challenge=NlHdiUcbSJaHjxrKiPZtoIQsJbUFxbKbeZkZjESPhRI&scope=openid+profile+email+res-wZDTzOPv%3Aperm-IPcSSZVu+res-XJlToIor%3Aperm-dMKTzMOg&state=ZAPyrLme&nonce=lEbfcoOB HTTP/1.1" from [::1]:57526 - 302 57B in 868.621Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001733] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57536 - 302 54B in 245.865Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001734] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57542 - 200 2949B in 329.462Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2477}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001735] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57542 - 302 0B in 35.366615ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001736] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57542 - 302 57B in 479.456Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001737] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57548 - 302 60B in 447.625Âµs
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5883,"userId":2477}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001738] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57554 - 302 58B in 3.412638ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001739] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57564 - 200 4699B in 638.867Âµs
2025/11/25 13:24:46 INFO {"audit_event":"saved_consent","details":{"clientId":5883,"consentId":201,"userId":2477}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001740] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57564 - 302 0B in 1.997294ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5883,"codeId":1119,"userId":2477}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001741] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57564 - 302 234B in 1.873279ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001742] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zQIWroeC&redirect_uri=http%3A%2F%2Fwww.regionalsynthesize.com%2Fseize&response_type=code&code_challenge_method=S256&code_challenge=PhKIwXdNXwfOpjMWBCOqCFULKmEvwHkXgFoDvJhImmY&scope=openid+profile+email+res-uyCoCFwg%3Aperm-clMwVFZW+res-AizHJIDm%3Aperm-fmPZpxJM&state=AvoXgpue&nonce=mbzOEvKy HTTP/1.1" from [::1]:57566 - 302 57B in 1.028453ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001743] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57578 - 302 54B in 552.915Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001744] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57580 - 200 2949B in 360.601Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2478}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001745] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57580 - 302 0B in 36.354992ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001746] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57580 - 302 57B in 757.892Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001747] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57590 - 302 60B in 841.71Âµs
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5884,"userId":2478}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001748] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57594 - 302 58B in 3.709449ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001749] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57606 - 200 4699B in 865.625Âµs
2025/11/25 13:24:46 INFO {"audit_event":"saved_consent","details":{"clientId":5884,"consentId":202,"userId":2478}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001750] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57606 - 302 0B in 3.000038ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5884,"codeId":1120,"userId":2478}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001751] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57606 - 302 215B in 2.414382ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.11s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001752] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ROsVzOXC&redirect_uri=http%3A%2F%2Fwww.corporatesolutions.net%2Fb2c%2Fvisionary&response_type=code&code_challenge_method=S256&code_challenge=KtXNxcHDsyMoasmRlttboPnDuqeIFvXyXYSXergqIeI&scope=openid+profile+email+res-uoPDCIQM%3Aperm-acVlqcEP+res-ViWETsVC%3Aperm-rHmUdoup&state=cbbdrxLJ&nonce=lHMbkrgl HTTP/1.1" from [::1]:57622 - 302 57B in 892.757Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001753] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57624 - 302 54B in 281.392Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001754] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57636 - 200 2949B in 315.095Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2479}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001755] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57636 - 302 0B in 35.396371ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001756] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57636 - 302 57B in 427.548Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001757] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57638 - 302 54B in 366.222Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001758] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57652 - 200 2471B in 482.391Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_otp","details":{"userId":2479}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001759] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57652 - 302 0B in 341.124Âµs
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5885,"userId":2479}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001760] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57652 - 302 58B in 3.168808ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001761] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57664 - 200 4699B in 666.108Âµs
2025/11/25 13:24:46 INFO {"audit_event":"saved_consent","details":{"clientId":5885,"consentId":203,"userId":2479}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001762] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57664 - 302 0B in 2.342436ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5885,"codeId":1121,"userId":2479}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001763] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57664 - 302 223B in 4.156373ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted (0.11s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001764] "GET http://localhost:19090/auth/authorize/?client_id=test-client-uMRWBjqb&redirect_uri=http%3A%2F%2Fwww.nationalexpedite.org%2Fimpactful%2Frich%2Fleverage&response_type=code&code_challenge_method=S256&code_challenge=OWiBxwgJiJnXEqLSqzLIBxvvFVKVTzDfcUbSJcgjBjr&scope=openid+profile+email+res-mgjDOnUU%3Aperm-HbGPjFtz+res-WktgVLOP%3Aperm-yvoftuAN&state=xPmJJuMx&nonce=zDTnlnUG HTTP/1.1" from [::1]:57670 - 302 57B in 1.369007ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001765] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57686 - 302 54B in 274.528Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001766] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57698 - 200 2949B in 365.41Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2480}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001767] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57698 - 302 0B in 35.424654ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001768] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57698 - 302 57B in 415.666Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001769] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57700 - 302 54B in 496.939Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001770] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57706 - 200 2471B in 426.807Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_otp","details":{"userId":2480}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001771] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57706 - 302 0B in 414.814Âµs
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5886,"userId":2480}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001772] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57706 - 302 58B in 4.33485ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001773] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57722 - 200 4699B in 668.042Âµs
2025/11/25 13:24:46 INFO {"audit_event":"saved_consent","details":{"clientId":5886,"consentId":204,"userId":2480}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001774] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57722 - 302 0B in 2.240383ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5886,"codeId":1122,"userId":2480}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001775] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57722 - 302 231B in 2.467412ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001776] "GET http://localhost:19090/auth/authorize/?client_id=test-client-yeCcnBXj&redirect_uri=https%3A%2F%2Fwww.seniorcross-platform.io%2Fdot-com%2Fparadigms%2Fembrace&response_type=code&code_challenge_method=S256&code_challenge=xVDwiguxqDXYEluenjAcjkFjOqBeUtpTTMENfKvgvcp&scope=openid+profile+email+res-WPJYqFnB%3Aperm-AIAjbIEr+res-jLeELxcG%3Aperm-eUmdXuot&state=zWfNqDYl&nonce=zIEJtavZ HTTP/1.1" from [::1]:57738 - 302 57B in 1.212692ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001777] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57752 - 302 54B in 234.443Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001778] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57760 - 200 2949B in 289.597Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2481}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001779] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57760 - 302 0B in 36.529983ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001780] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57760 - 302 57B in 881.355Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001781] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57764 - 302 54B in 696.837Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001782] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57766 - 200 6222B in 4.09102ms
2025/11/25 13:24:46 INFO {"audit_event":"enabled_otp","details":{"userId":2481}}
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_otp","details":{"userId":2481}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001783] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57766 - 302 0B in 2.349389ms
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5887,"userId":2481}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001784] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57766 - 302 58B in 3.266972ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001785] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57778 - 200 4699B in 646.511Âµs
2025/11/25 13:24:46 INFO {"audit_event":"saved_consent","details":{"clientId":5887,"consentId":205,"userId":2481}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001786] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57778 - 302 0B in 2.102743ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5887,"codeId":1123,"userId":2481}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001787] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57778 - 302 237B in 1.938262ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted (0.11s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001788] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zwEXYbpc&redirect_uri=https%3A%2F%2Fwww.forwardturn-key.org%2Fevolve&response_type=code&code_challenge_method=S256&code_challenge=zhZejyfSDXwuJnGQOSXjEFKoaKZjzIHmIBGtbCOCUxH&scope=openid+profile+email+res-EeRCMWNe%3Aperm-SwFEWkqF+res-juUzkbnA%3Aperm-llCQrrEm&state=OginFlnI&nonce=PitoHymE HTTP/1.1" from [::1]:57786 - 302 57B in 1.045395ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001789] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57796 - 302 54B in 317.149Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001790] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57798 - 200 2949B in 344.42Âµs
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_pwd","details":{"userId":2482}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001791] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57798 - 302 0B in 35.62908ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001792] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57798 - 302 57B in 735.15Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001793] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57806 - 302 54B in 577.822Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001794] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57810 - 200 6154B in 3.656709ms
2025/11/25 13:24:46 INFO {"audit_event":"enabled_otp","details":{"userId":2482}}
2025/11/25 13:24:46 INFO {"audit_event":"auth_success_otp","details":{"userId":2482}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001795] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57810 - 302 0B in 2.767459ms
2025/11/25 13:24:46 INFO {"audit_event":"started_new_user_session","details":{"clientId":5888,"userId":2482}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001796] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57810 - 302 58B in 4.779251ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001797] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57812 - 200 4699B in 620.943Âµs
2025/11/25 13:24:46 INFO {"audit_event":"saved_consent","details":{"clientId":5888,"consentId":206,"userId":2482}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001798] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57812 - 302 0B in 2.005078ms
2025/11/25 13:24:46 INFO {"audit_event":"created_auth_code","details":{"clientId":5888,"codeId":1124,"userId":2482}}
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001799] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57812 - 302 214B in 2.485356ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.11s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001800] "GET http://localhost:19090/auth/authorize/?client_id=test-client-voZzspEs&redirect_uri=https%3A%2F%2Fwww.chiefworld-class.com%2Ftransparent%2Fengage%2Fvalue-added%2Fsticky&response_type=code&code_challenge_method=S256&code_challenge=aIAACiXsMZYZXFchglYMXPHnBCbiymwQurwyNdwshSo&scope=openid+profile+email+res-lsjsDzXm%3Aperm-rhKSzRRe+res-GWgTxsCO%3Aperm-lOrazUdB&state=txFnkoHu&nonce=iBHIfbYG HTTP/1.1" from [::1]:57824 - 302 57B in 1.020317ms
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001801] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57830 - 302 54B in 256.816Âµs
2025/11/25 13:24:46 [a357f2e3b56e/VGvsVkwcAO-001802] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57844 - 200 2949B in 298.935Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2483}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001803] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57844 - 302 0B in 35.755138ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001804] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57844 - 302 57B in 570.819Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001805] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57846 - 302 54B in 696.376Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001806] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57852 - 200 2471B in 493.442Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_otp","details":{"userId":2483}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001807] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57852 - 302 0B in 273.827Âµs
2025/11/25 13:24:47 INFO {"audit_event":"started_new_user_session","details":{"clientId":5889,"userId":2483}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001808] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57852 - 302 58B in 3.299644ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001809] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57858 - 200 4699B in 554.617Âµs
2025/11/25 13:24:47 INFO {"audit_event":"saved_consent","details":{"clientId":5889,"consentId":207,"userId":2483}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001810] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57858 - 302 0B in 1.950816ms
2025/11/25 13:24:47 INFO {"audit_event":"created_auth_code","details":{"clientId":5889,"codeId":1125,"userId":2483}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001811] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57858 - 302 246B in 2.82081ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001812] "GET http://localhost:19090/auth/authorize/?client_id=test-client-wRCovasu&redirect_uri=http%3A%2F%2Fwww.chiefdynamic.info%2Finfrastructures%2Fstreamline%2Finteractive&response_type=code&code_challenge_method=S256&code_challenge=BkncYYRUZgnhabHLgOHbTdXuZRkZbRGlHeapsBnhdpR&scope=openid+profile+email+res-gZXnHnTG%3Aperm-SFuCwBJu+res-EovWhrtM%3Aperm-iMCHfchS&state=uqqmaWme&nonce=mHzcBmvp HTTP/1.1" from [::1]:57866 - 302 57B in 1.241766ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001813] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57876 - 302 54B in 309.876Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001814] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57892 - 200 2949B in 311.439Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2484}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001815] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57892 - 302 0B in 35.339484ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001816] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57892 - 302 57B in 606.196Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001817] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57906 - 302 54B in 524.241Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001818] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57912 - 200 2471B in 451.804Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_otp","details":{"userId":2484}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001819] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:57912 - 302 0B in 336.536Âµs
2025/11/25 13:24:47 INFO {"audit_event":"started_new_user_session","details":{"clientId":5890,"userId":2484}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001820] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57912 - 302 58B in 3.097192ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001821] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57922 - 200 4699B in 698.26Âµs
2025/11/25 13:24:47 INFO {"audit_event":"saved_consent","details":{"clientId":5890,"consentId":208,"userId":2484}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001822] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57922 - 302 0B in 3.005178ms
2025/11/25 13:24:47 INFO {"audit_event":"created_auth_code","details":{"clientId":5890,"codeId":1126,"userId":2484}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001823] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57922 - 302 243B in 1.866587ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001824] "GET http://localhost:19090/auth/authorize/?client_id=test-client-dDrFhVnp&redirect_uri=https%3A%2F%2Fwww.internalchannels.net%2Froi%2Finteractive&response_type=code&code_challenge_method=S256&code_challenge=LWrmNOtvCFhLNFzztxamzgCTsVgedqbsSiNFcOojlTB&scope=openid+profile+email+res-brceucND%3Aperm-XxnZArFG+res-xswaVHvP%3Aperm-fqhsqCsa&state=fLTxVJgX&nonce=RgTFMFSF HTTP/1.1" from [::1]:57930 - 302 57B in 903.847Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001825] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57940 - 302 54B in 271.463Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001826] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57946 - 200 2949B in 350.502Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2485}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001827] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57946 - 302 0B in 35.385029ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001828] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57946 - 302 60B in 485.408Âµs
2025/11/25 13:24:47 INFO {"audit_event":"started_new_user_session","details":{"clientId":5891,"userId":2485}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001829] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57954 - 302 58B in 3.299805ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001830] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57968 - 200 4699B in 711.665Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001831] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:57968 - 302 0B in 495.867Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsCancelled (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001832] "GET http://localhost:19090/auth/authorize/?client_id=test-client-HJCbLvCi&redirect_uri=https%3A%2F%2Fwww.seniorseize.biz%2Fmodels%2Fextensible%2Fclicks-and-mortar&response_type=code&code_challenge_method=S256&code_challenge=IYODnunAGlzROEZbRhBSRbZGGhHEaymVDaBROwECrPt&scope=openid+profile+email+res-iOAEEFur%3Aperm-ZmpmfYaD+res-KcSapKVR%3Aperm-jSSshNGZ&state=ACXVQbIT&nonce=JtHGzKnc HTTP/1.1" from [::1]:57980 - 302 57B in 1.198044ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001833] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57992 - 302 54B in 397.291Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001834] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58004 - 200 2949B in 364.95Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2486}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001835] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58004 - 302 0B in 35.538079ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001836] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58004 - 302 57B in 523.219Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001837] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58010 - 302 60B in 427.949Âµs
2025/11/25 13:24:47 INFO {"audit_event":"started_new_user_session","details":{"clientId":5892,"userId":2486}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001838] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58012 - 302 58B in 3.145343ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001839] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:58028 - 200 4699B in 577.562Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001840] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:58028 - 302 0B in 231.678Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001841] "GET http://localhost:19090/auth/authorize/?client_id=test-client-mXZiwWXs&redirect_uri=http%3A%2F%2Fwww.productreal-time.io%2Fbenchmark%2Finfrastructures%2Fcutting-edge%2Fenhance&response_type=code&code_challenge_method=S256&code_challenge=FOhLNwzyApyHFVaCUctfPuAwvNcEESRqcMUwGoxuoHY&scope=openid+profile+email+res-RXdoCOJk%3Aperm-YTcjDJPa+res-yvhTifRY%3Aperm-xPAgmlsa&state=LKqdSqmo&nonce=OuZAsZrv HTTP/1.1" from [::1]:58042 - 302 57B in 1.530562ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001842] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58048 - 302 54B in 508.22Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001843] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58054 - 200 2949B in 590.726Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2487}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001844] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58054 - 302 0B in 36.457856ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001845] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58054 - 302 57B in 799.741Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001846] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58060 - 302 54B in 1.083597ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001847] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58076 - 200 2471B in 431.615Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_otp","details":{"userId":2487}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001848] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58076 - 302 0B in 283.486Âµs
2025/11/25 13:24:47 INFO {"audit_event":"started_new_user_session","details":{"clientId":5893,"userId":2487}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001849] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58076 - 302 58B in 3.4665ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001850] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:58086 - 200 4699B in 711.865Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001851] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:58086 - 302 0B in 243.37Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001852] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gwyMevow&redirect_uri=https%3A%2F%2Fwww.internationale-enable.org%2Funleash&response_type=code&code_challenge_method=S256&code_challenge=cgUkllrrhkEzFmLiQUwPArHsqxqbYUZlaAnqwiaodDs&scope=openid+profile+email+res-BMNpfHJW%3Aperm-tyswNyeW+res-ZGbKTIWb%3Aperm-wGPvXqUl&state=xyhbWgvz&nonce=axoIFPoZ HTTP/1.1" from [::1]:58098 - 302 57B in 1.08496ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001853] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58106 - 302 54B in 638.306Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001854] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58110 - 200 2949B in 851.629Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2488}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001855] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58110 - 302 0B in 37.791557ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001856] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58110 - 302 57B in 867.589Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001857] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58120 - 302 54B in 820.199Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001858] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58124 - 200 6166B in 4.297059ms
2025/11/25 13:24:47 INFO {"audit_event":"enabled_otp","details":{"userId":2488}}
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_otp","details":{"userId":2488}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001859] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58124 - 302 0B in 2.717575ms
2025/11/25 13:24:47 INFO {"audit_event":"started_new_user_session","details":{"clientId":5894,"userId":2488}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001860] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58124 - 302 58B in 3.043921ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001861] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:58138 - 200 4699B in 667.982Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001862] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:58138 - 302 0B in 294.346Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled (0.11s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001863] "GET http://localhost:19090/auth/authorize/?client_id=test-client-VyWRpfFK&redirect_uri=http%3A%2F%2Fwww.leadmonetize.net%2Freinvent%2Fimplement%2Fsolutions%2Fout-of-the-box&response_type=code&code_challenge_method=S256&code_challenge=gwUFYDbgsovyGPMZYVlKBirlDjWzizKrIhaSvQzSLed&scope=openid+profile+email+res-EKJubBvF%3Aperm-wFbzzSOp+res-pQrechEI%3Aperm-MKleGMQy&state=RNXZnBXM&nonce=sLjrkdxQ HTTP/1.1" from [::1]:58140 - 302 57B in 943.683Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001864] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58150 - 302 54B in 302.342Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001865] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58152 - 200 2949B in 673.313Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2489}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001866] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58152 - 302 0B in 35.735241ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001867] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58152 - 302 57B in 675.717Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001868] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58158 - 302 54B in 824.758Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001869] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58174 - 200 2471B in 438.148Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_otp","details":{"userId":2489}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001870] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58174 - 302 0B in 314.134Âµs
2025/11/25 13:24:47 INFO {"audit_event":"started_new_user_session","details":{"clientId":5895,"userId":2489}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001871] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58174 - 302 58B in 3.389594ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001872] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:58190 - 200 4699B in 676.188Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001873] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:58190 - 302 0B in 282.965Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired_PasswordIsIncorrect
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001874] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YQYoXyrn&redirect_uri=https%3A%2F%2Fwww.investorfrictionless.com%2Fwhiteboard%2Fseize%2Fsyndicate%2Futilize&response_type=code&code_challenge_method=S256&code_challenge=tpwblgOVSTUCFkPnRHvIFBPHGAtKyGCQfUCkiuRvWeV&scope=openid+profile+email&state=yepKDnCN&nonce=YnUHBihU HTTP/1.1" from [::1]:58198 - 302 57B in 771.548Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001875] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58204 - 302 54B in 248.4Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001876] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58212 - 200 2949B in 312.601Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_failed_pwd","details":{"email":"brentprosacco@hettinger.io"}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001877] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58212 - 200 3014B in 35.59201ms
2025/11/25 13:24:47 ERROR authContext.AuthState 'level1_password' does not match any required state
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthLevel1CompletedGet.3
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_level1.go:78
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthLevel1CompletedGet.3
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_level1.go:78
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/VGvsVkwcAO-001878
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001878] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58212 - 500 2303B in 723.166Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired_PasswordIsIncorrect (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired_OtpCodeIsIncorrect
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001879] "GET http://localhost:19090/auth/authorize/?client_id=test-client-KsjZnlPj&redirect_uri=http%3A%2F%2Fwww.customermodels.biz%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=UMakHviuvXmKaidBNdFdanLfhapeQHgvDcQDGBYQcfu&scope=openid+profile+email&state=CpILSILy&nonce=YRbfHOhe HTTP/1.1" from [::1]:58216 - 302 57B in 548.907Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001880] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58224 - 302 54B in 319.714Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001881] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58228 - 200 2949B in 374.568Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2491}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001882] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58228 - 302 0B in 38.182946ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001883] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58228 - 302 57B in 336.977Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001884] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58242 - 302 54B in 438.087Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001885] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58244 - 200 6134B in 3.563113ms
2025/11/25 13:24:47 INFO {"audit_event":"auth_failed_otp","details":{"userId":2491}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001886] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58244 - 200 6361B in 473.665Âµs
2025/11/25 13:24:47 ERROR authContext.AuthState is not authentication_completed
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/VGvsVkwcAO-001887
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001887] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58244 - 500 2303B in 320.826Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired_OtpCodeIsIncorrect (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired_OtpIsIncorrect
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001888] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qJJJynrE&redirect_uri=https%3A%2F%2Fwww.futuremindshare.org%2Fb2b%2Fmatrix&response_type=code&code_challenge_method=S256&code_challenge=xYLTNDvDwtYajDEykBetyeCuHZxnBrBYdzFVHRIHkYP&scope=openid+profile+email&state=JoVSzgRL&nonce=HHnztNZE HTTP/1.1" from [::1]:58248 - 302 57B in 771.477Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001889] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58256 - 302 54B in 558.996Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001890] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58270 - 200 2949B in 386.55Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2492}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001891] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58270 - 302 0B in 36.108898ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001892] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58270 - 302 57B in 401.829Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001893] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58282 - 302 54B in 889.311Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001894] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58286 - 200 2471B in 439.09Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_failed_otp","details":{"userId":2492}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001895] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58286 - 200 2698B in 334.512Âµs
2025/11/25 13:24:47 ERROR authContext.AuthState is not authentication_completed
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/VGvsVkwcAO-001896
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001896] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58286 - 500 2303B in 279.759Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired_OtpIsIncorrect (0.08s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel1Request
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001897] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ONXeyhbI&redirect_uri=https%3A%2F%2Fwww.nationaleyeballs.io%2Fmindshare%2Fe-business%2Fbest-of-breed%2Fmission-critical&response_type=code&code_challenge_method=S256&code_challenge=YrQFxXBlLYpKejPhOQoSadVKRyfObcyEONAAgiEuqcu&scope=openid+profile+email&state=jOFbWZkq&nonce=bCASEvLH HTTP/1.1" from [::1]:58290 - 302 57B in 558.645Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001898] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58292 - 302 54B in 224.514Âµs
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001899] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58298 - 200 2949B in 364.048Âµs
2025/11/25 13:24:47 INFO {"audit_event":"auth_success_pwd","details":{"userId":2493}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001900] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58298 - 302 0B in 35.467606ms
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001901] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58298 - 302 60B in 620.342Âµs
2025/11/25 13:24:47 INFO {"audit_event":"started_new_user_session","details":{"clientId":5899,"userId":2493}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001902] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58300 - 302 56B in 2.55602ms
2025/11/25 13:24:47 INFO {"audit_event":"created_auth_code","details":{"clientId":5899,"codeId":1127,"userId":2493}}
2025/11/25 13:24:47 [a357f2e3b56e/VGvsVkwcAO-001903] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58308 - 302 259B in 2.633456ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001904] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ONXeyhbI&redirect_uri=https%3A%2F%2Fwww.nationaleyeballs.io%2Fmindshare%2Fe-business%2Fbest-of-breed%2Fmission-critical&response_type=code&code_challenge_method=S256&code_challenge=EInsQawMouLQjAUidojjqiwliveUdMIhScRuGEPyshw&scope=openid+profile+email&state=vEbiraMq&nonce=CricDpbm&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:58324 - 302 66B in 1.912814ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001905] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58328 - 302 60B in 1.860225ms
2025/11/25 13:24:48 INFO {"audit_event":"bumped_user_session","details":{"clientId":5899,"userId":2493}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001906] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58330 - 302 56B in 2.775314ms
2025/11/25 13:24:48 INFO {"audit_event":"created_auth_code","details":{"clientId":5899,"codeId":1128,"userId":2493}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001907] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58332 - 302 259B in 2.055383ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel1Request (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001908] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ymZdAgMj&redirect_uri=https%3A%2F%2Fwww.producteyeballs.org%2Freintermediate%2Fincubate%2Fturn-key&response_type=code&code_challenge_method=S256&code_challenge=IETlJKDavsrufuCqjqQcviaSGnGlPgBUpYTxLHwhDmO&scope=openid+profile+email&state=wMHpzlRi&nonce=ljdBPlwL HTTP/1.1" from [::1]:58334 - 302 57B in 750.097Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001909] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58344 - 302 54B in 353.668Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001910] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58350 - 200 2949B in 380.609Âµs
2025/11/25 13:24:48 INFO {"audit_event":"auth_success_pwd","details":{"userId":2494}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001911] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58350 - 302 0B in 36.29518ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001912] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58350 - 302 60B in 351.284Âµs
2025/11/25 13:24:48 INFO {"audit_event":"started_new_user_session","details":{"clientId":5900,"userId":2494}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001913] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58366 - 302 56B in 3.393862ms
2025/11/25 13:24:48 INFO {"audit_event":"created_auth_code","details":{"clientId":5900,"codeId":1129,"userId":2494}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001914] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58370 - 302 240B in 3.944884ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001915] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ymZdAgMj&redirect_uri=https%3A%2F%2Fwww.producteyeballs.org%2Freintermediate%2Fincubate%2Fturn-key&response_type=code&code_challenge_method=S256&code_challenge=rmyDoMwXvyxWyDDcMqEvDBMUEohVRmgkOfKaLslwFjf&scope=openid+profile+email&state=SSuVIyHD&nonce=EAKnVdcZ&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:58374 - 302 66B in 1.223902ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001916] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58382 - 302 57B in 566.751Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001917] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58394 - 302 60B in 1.034675ms
2025/11/25 13:24:48 INFO {"audit_event":"bumped_user_session","details":{"clientId":5900,"userId":2494}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001918] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58398 - 302 56B in 2.837321ms
2025/11/25 13:24:48 INFO {"audit_event":"created_auth_code","details":{"clientId":5900,"codeId":1130,"userId":2494}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001919] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58412 - 302 240B in 2.25452ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpDisabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001920] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qEmbNELo&redirect_uri=https%3A%2F%2Fwww.dynamicubiquitous.name%2Foptimize%2Fembrace%2Fsexy&response_type=code&code_challenge_method=S256&code_challenge=JCWEeeOzkdScyxOjnBJONqfmsTxkGfgOQczGWYixDrd&scope=openid+profile+email&state=YYFCGEeZ&nonce=BToXTbXw HTTP/1.1" from [::1]:58422 - 302 57B in 712.296Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001921] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58426 - 302 54B in 340.122Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001922] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58438 - 200 2949B in 442.777Âµs
2025/11/25 13:24:48 INFO {"audit_event":"auth_success_pwd","details":{"userId":2495}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001923] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58438 - 302 0B in 35.514103ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001924] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58438 - 302 60B in 468.144Âµs
2025/11/25 13:24:48 INFO {"audit_event":"started_new_user_session","details":{"clientId":5901,"userId":2495}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001925] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58446 - 302 56B in 3.060463ms
2025/11/25 13:24:48 INFO {"audit_event":"created_auth_code","details":{"clientId":5901,"codeId":1131,"userId":2495}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001926] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58456 - 302 232B in 2.748934ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001927] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qEmbNELo&redirect_uri=https%3A%2F%2Fwww.dynamicubiquitous.name%2Foptimize%2Fembrace%2Fsexy&response_type=code&code_challenge_method=S256&code_challenge=GMiiytjmTBtJIEsAoMvXFXiNCdHhdPqtZPhrxJBUQAp&scope=openid+profile+email&state=iPIlDpFX&nonce=TAjCnKCH&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:58468 - 302 66B in 1.509141ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001928] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58482 - 302 57B in 458.777Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001929] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58498 - 302 54B in 378.655Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001930] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58510 - 200 2471B in 523.459Âµs
2025/11/25 13:24:48 INFO {"audit_event":"auth_success_otp","details":{"userId":2495}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001931] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58510 - 302 0B in 346.905Âµs
2025/11/25 13:24:48 INFO {"audit_event":"bumped_user_session","details":{"clientId":5901,"userId":2495}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001932] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58510 - 302 56B in 2.731681ms
2025/11/25 13:24:48 INFO {"audit_event":"created_auth_code","details":{"clientId":5901,"codeId":1132,"userId":2495}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001933] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58520 - 302 232B in 2.034795ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpEnabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001934] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iqvgfTpL&redirect_uri=http%3A%2F%2Fwww.productconvergence.com%2Fworld-class%2Fenhance&response_type=code&code_challenge_method=S256&code_challenge=HorMnSdzaAPPlDnYOyXVhtsHzrnxTdlsACYibLMnnln&scope=openid+profile+email&state=LXytcaGN&nonce=fzodmQhr HTTP/1.1" from [::1]:58522 - 302 57B in 416.727Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001935] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58524 - 302 54B in 339.412Âµs
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001936] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58526 - 200 2949B in 348.469Âµs
2025/11/25 13:24:48 INFO {"audit_event":"auth_success_pwd","details":{"userId":2496}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001937] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58526 - 302 0B in 35.241248ms
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001938] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58526 - 302 60B in 483.123Âµs
2025/11/25 13:24:48 INFO {"audit_event":"started_new_user_session","details":{"clientId":5902,"userId":2496}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001939] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58528 - 302 56B in 2.616834ms
2025/11/25 13:24:48 INFO {"audit_event":"created_auth_code","details":{"clientId":5902,"codeId":1133,"userId":2496}}
2025/11/25 13:24:48 [a357f2e3b56e/VGvsVkwcAO-001940] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58538 - 302 229B in 2.964682ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001941] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iqvgfTpL&redirect_uri=http%3A%2F%2Fwww.productconvergence.com%2Fworld-class%2Fenhance&response_type=code&code_challenge_method=S256&code_challenge=EwmalPFJqCMurMaANJmASlYHfHUZJuyEBqRIZHlNBYm&scope=openid+profile+email&state=MxnHnQpY&nonce=OvuaHQJg&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:58548 - 302 66B in 1.273586ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001942] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58554 - 302 57B in 821.823Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001943] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58556 - 302 54B in 440.362Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001944] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58570 - 200 6218B in 4.071282ms
2025/11/25 13:24:49 INFO {"audit_event":"enabled_otp","details":{"userId":2496}}
2025/11/25 13:24:49 INFO {"audit_event":"auth_success_otp","details":{"userId":2496}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001945] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58570 - 302 0B in 2.834526ms
2025/11/25 13:24:49 INFO {"audit_event":"bumped_user_session","details":{"clientId":5902,"userId":2496}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001946] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58570 - 302 56B in 2.555869ms
2025/11/25 13:24:49 INFO {"audit_event":"created_auth_code","details":{"clientId":5902,"codeId":1134,"userId":2496}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001947] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58582 - 302 229B in 2.254089ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpDisabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001948] "GET http://localhost:19090/auth/authorize/?client_id=test-client-dnoBrTrC&redirect_uri=https%3A%2F%2Fwww.customerniches.biz%2Fout-of-the-box&response_type=code&code_challenge_method=S256&code_challenge=kZseOzNZDtyqemlanQKGJyuvwlbNYMtsoRqzLlyMbIE&scope=openid+profile+email&state=WBQmcGGJ&nonce=BhjKhDUj HTTP/1.1" from [::1]:58590 - 302 57B in 548.166Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001949] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58606 - 302 54B in 236.296Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001950] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58620 - 200 2949B in 344.661Âµs
2025/11/25 13:24:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":2497}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001951] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58620 - 302 0B in 35.186173ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001952] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58620 - 302 60B in 436.776Âµs
2025/11/25 13:24:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":5903,"userId":2497}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001953] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58632 - 302 56B in 2.330153ms
2025/11/25 13:24:49 INFO {"audit_event":"created_auth_code","details":{"clientId":5903,"codeId":1135,"userId":2497}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001954] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58638 - 302 221B in 2.701534ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001955] "GET http://localhost:19090/auth/authorize/?client_id=test-client-dnoBrTrC&redirect_uri=https%3A%2F%2Fwww.customerniches.biz%2Fout-of-the-box&response_type=code&code_challenge_method=S256&code_challenge=FEsdwfjrUuJWgZApvsBFUpwFJSxnvLkxLlElnQMQxFY&scope=openid+profile+email&state=pEHOMdNY&nonce=KVwcwznq&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:58654 - 302 66B in 1.289677ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001956] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58666 - 302 57B in 527.246Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001957] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58676 - 302 54B in 408.091Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001958] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58680 - 200 2471B in 553.707Âµs
2025/11/25 13:24:49 INFO {"audit_event":"auth_success_otp","details":{"userId":2497}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001959] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58680 - 302 0B in 377.263Âµs
2025/11/25 13:24:49 INFO {"audit_event":"bumped_user_session","details":{"clientId":5903,"userId":2497}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001960] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58680 - 302 56B in 4.367422ms
2025/11/25 13:24:49 INFO {"audit_event":"created_auth_code","details":{"clientId":5903,"codeId":1136,"userId":2497}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001961] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58696 - 302 221B in 2.024756ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpEnabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel1Request
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001962] "GET http://localhost:19090/auth/authorize/?client_id=test-client-QBIkwHYS&redirect_uri=http%3A%2F%2Fwww.seniorincubate.name%2Fefficient&response_type=code&code_challenge_method=S256&code_challenge=QheWKmeabzWSpNUMUsiAcbXNdmFpCilvQKuhiKYNAyu&scope=openid+profile+email&state=HCDmppoi&nonce=HPFXbdZh HTTP/1.1" from [::1]:58700 - 302 57B in 576.159Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001963] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58708 - 302 54B in 353.428Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001964] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58720 - 200 2949B in 315.446Âµs
2025/11/25 13:24:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":2498}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001965] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58720 - 302 0B in 36.228353ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001966] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58720 - 302 57B in 579.345Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001967] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58722 - 302 60B in 595.665Âµs
2025/11/25 13:24:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":5904,"userId":2498}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001968] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58738 - 302 56B in 2.40847ms
2025/11/25 13:24:49 INFO {"audit_event":"created_auth_code","details":{"clientId":5904,"codeId":1137,"userId":2498}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001969] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58744 - 302 216B in 2.117942ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001970] "GET http://localhost:19090/auth/authorize/?client_id=test-client-QBIkwHYS&redirect_uri=http%3A%2F%2Fwww.seniorincubate.name%2Fefficient&response_type=code&code_challenge_method=S256&code_challenge=bICxweaVaKfQDuUFTGeztLqFBCGqSIxhLLRghTSmwwy&scope=openid+profile+email&state=uexDqqpy&nonce=zKUSAYaX&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:58760 - 302 66B in 1.580567ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001971] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58774 - 302 60B in 582.391Âµs
2025/11/25 13:24:49 INFO {"audit_event":"bumped_user_session","details":{"clientId":5904,"userId":2498}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001972] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58790 - 302 56B in 2.938662ms
2025/11/25 13:24:49 INFO {"audit_event":"created_auth_code","details":{"clientId":5904,"codeId":1138,"userId":2498}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001973] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58798 - 302 216B in 2.347616ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel1Request (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001974] "GET http://localhost:19090/auth/authorize/?client_id=test-client-coCPxYSd&redirect_uri=https%3A%2F%2Fwww.internationalreinvent.info%2Fintegrate%2Fstrategize&response_type=code&code_challenge_method=S256&code_challenge=MdhLfPeKDsQjmZIyhDHTNltEfMAeqWRjJyySaBIwbwt&scope=openid+profile+email&state=KScTdTRX&nonce=fiPIZhdu HTTP/1.1" from [::1]:58802 - 302 57B in 642.654Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001975] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58818 - 302 54B in 252.818Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001976] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58832 - 200 2949B in 612.518Âµs
2025/11/25 13:24:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":2499}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001977] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58832 - 302 0B in 45.303049ms
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001978] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58832 - 302 57B in 795.112Âµs
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001979] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58834 - 302 60B in 541.123Âµs
2025/11/25 13:24:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":5905,"userId":2499}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001980] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58836 - 302 56B in 2.536443ms
2025/11/25 13:24:49 INFO {"audit_event":"created_auth_code","details":{"clientId":5905,"codeId":1139,"userId":2499}}
2025/11/25 13:24:49 [a357f2e3b56e/VGvsVkwcAO-001981] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58852 - 302 235B in 2.246294ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001982] "GET http://localhost:19090/auth/authorize/?client_id=test-client-coCPxYSd&redirect_uri=https%3A%2F%2Fwww.internationalreinvent.info%2Fintegrate%2Fstrategize&response_type=code&code_challenge_method=S256&code_challenge=wKinqNENJCyBgySwCBCCpTDkkiVVuhLhHPAfVTAWucx&scope=openid+profile+email&state=OTDfIXzU&nonce=AbDYywfB&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:58856 - 302 66B in 1.42373ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001983] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58868 - 302 60B in 803.068Âµs
2025/11/25 13:24:50 INFO {"audit_event":"bumped_user_session","details":{"clientId":5905,"userId":2499}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001984] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58876 - 302 56B in 3.041086ms
2025/11/25 13:24:50 INFO {"audit_event":"created_auth_code","details":{"clientId":5905,"codeId":1140,"userId":2499}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001985] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58880 - 302 235B in 2.42392ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpDisabled (0.32s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001986] "GET http://localhost:19090/auth/authorize/?client_id=test-client-GWSVnZeE&redirect_uri=https%3A%2F%2Fwww.international24-365.biz%2Ftransform%2Fbleeding-edge%2Fglobal&response_type=code&code_challenge_method=S256&code_challenge=KubsnosNhZdHYeUiUqQtJkNYdFhrPyVhjNwxCUJnTaL&scope=openid+profile+email&state=kuGbyWQx&nonce=HRdegJkx HTTP/1.1" from [::1]:58888 - 302 57B in 863.953Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001987] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58898 - 302 54B in 279.017Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001988] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58900 - 200 2949B in 415.155Âµs
2025/11/25 13:24:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":2500}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001989] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58900 - 302 0B in 44.217548ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001990] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58900 - 302 57B in 712.095Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001991] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58910 - 302 60B in 581.559Âµs
2025/11/25 13:24:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":5906,"userId":2500}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001992] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58918 - 302 56B in 4.561389ms
2025/11/25 13:24:50 INFO {"audit_event":"created_auth_code","details":{"clientId":5906,"codeId":1141,"userId":2500}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001993] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58926 - 302 242B in 2.515102ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001994] "GET http://localhost:19090/auth/authorize/?client_id=test-client-GWSVnZeE&redirect_uri=https%3A%2F%2Fwww.international24-365.biz%2Ftransform%2Fbleeding-edge%2Fglobal&response_type=code&code_challenge_method=S256&code_challenge=zGXJUYLnUsvRgOZJASSEkgxaYzZhxDDUrQKCuIJtzOS&scope=openid+profile+email&state=xMllmkwf&nonce=wtHvwgsD&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:58930 - 302 66B in 1.716183ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001995] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58946 - 302 57B in 2.459597ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001996] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58962 - 302 54B in 553.015Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001997] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58976 - 200 2471B in 598.922Âµs
2025/11/25 13:24:50 INFO {"audit_event":"auth_success_otp","details":{"userId":2500}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001998] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:58976 - 302 0B in 459.228Âµs
2025/11/25 13:24:50 INFO {"audit_event":"bumped_user_session","details":{"clientId":5906,"userId":2500}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-001999] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58976 - 302 56B in 2.880833ms
2025/11/25 13:24:50 INFO {"audit_event":"created_auth_code","details":{"clientId":5906,"codeId":1142,"userId":2500}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002000] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58988 - 302 242B in 2.039674ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpEnabled (0.33s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002001] "GET http://localhost:19090/auth/authorize/?client_id=test-client-eQtyuDJh&redirect_uri=https%3A%2F%2Fwww.forwardinitiatives.info%2Fengage%2Fmetrics%2Fscale%2Fwhiteboard&response_type=code&code_challenge_method=S256&code_challenge=WqReDGKLnQubqOxUkCxQEypgyJlIPxuGPuVkEgjoLqc&scope=openid+profile+email&state=CcuUKAka&nonce=RqQNlmkN HTTP/1.1" from [::1]:59000 - 302 57B in 874.322Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002002] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59014 - 302 54B in 330.674Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002003] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59018 - 200 2949B in 392.431Âµs
2025/11/25 13:24:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":2501}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002004] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59018 - 302 0B in 45.755986ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002005] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59018 - 302 57B in 774.022Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002006] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59032 - 302 60B in 959.463Âµs
2025/11/25 13:24:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":5907,"userId":2501}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002007] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59038 - 302 56B in 3.252426ms
2025/11/25 13:24:50 INFO {"audit_event":"created_auth_code","details":{"clientId":5907,"codeId":1143,"userId":2501}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002008] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59046 - 302 243B in 2.282432ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002009] "GET http://localhost:19090/auth/authorize/?client_id=test-client-eQtyuDJh&redirect_uri=https%3A%2F%2Fwww.forwardinitiatives.info%2Fengage%2Fmetrics%2Fscale%2Fwhiteboard&response_type=code&code_challenge_method=S256&code_challenge=TdFWOjJwjYinMAdgZPUMjLjKPbCJUrrBXSACQqIucsF&scope=openid+profile+email&state=zjFLyZIP&nonce=BpBXLDcq&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:59056 - 302 66B in 1.395998ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002010] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59062 - 302 57B in 578.994Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002011] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59078 - 302 54B in 488.774Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002012] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59094 - 200 6162B in 5.676907ms
2025/11/25 13:24:50 INFO {"audit_event":"enabled_otp","details":{"userId":2501}}
2025/11/25 13:24:50 INFO {"audit_event":"auth_success_otp","details":{"userId":2501}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002013] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59094 - 302 0B in 2.812544ms
2025/11/25 13:24:50 INFO {"audit_event":"bumped_user_session","details":{"clientId":5907,"userId":2501}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002014] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59094 - 302 56B in 3.431274ms
2025/11/25 13:24:50 INFO {"audit_event":"created_auth_code","details":{"clientId":5907,"codeId":1144,"userId":2501}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002015] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59102 - 302 243B in 2.113473ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpDisabled (0.33s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002016] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FTZXhJqs&redirect_uri=http%3A%2F%2Fwww.directefficient.io%2Fstreamline%2Fenvisioneer%2Fvortals%2Fgenerate&response_type=code&code_challenge_method=S256&code_challenge=zOioXPpXFRLFLqytdsQRyGfVoHWnOduTGcfJfNfHrEw&scope=openid+profile+email&state=PzojnzlX&nonce=DRUEOusp HTTP/1.1" from [::1]:59112 - 302 57B in 679.895Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002017] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59126 - 302 54B in 310.236Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002018] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59128 - 200 2949B in 934.726Âµs
2025/11/25 13:24:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":2502}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002019] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59128 - 302 0B in 46.401695ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002020] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59128 - 302 57B in 518.119Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002021] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59138 - 302 60B in 403.983Âµs
2025/11/25 13:24:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":5908,"userId":2502}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002022] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59154 - 302 56B in 3.374055ms
2025/11/25 13:24:50 INFO {"audit_event":"created_auth_code","details":{"clientId":5908,"codeId":1145,"userId":2502}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002023] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59166 - 302 245B in 2.192914ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002024] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FTZXhJqs&redirect_uri=http%3A%2F%2Fwww.directefficient.io%2Fstreamline%2Fenvisioneer%2Fvortals%2Fgenerate&response_type=code&code_challenge_method=S256&code_challenge=hSbFXVwFUZgAcKsOQMxsgMDowLIqdgnMTHMnDiAUhKb&scope=openid+profile+email&state=sXrbZfqX&nonce=IegpiyUf&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:59176 - 302 66B in 1.52394ms
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002025] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59178 - 302 57B in 531.324Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002026] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59180 - 302 54B in 667.882Âµs
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002027] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59188 - 200 2471B in 688.171Âµs
2025/11/25 13:24:50 INFO {"audit_event":"auth_success_otp","details":{"userId":2502}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002028] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59188 - 302 0B in 488.884Âµs
2025/11/25 13:24:50 INFO {"audit_event":"bumped_user_session","details":{"clientId":5908,"userId":2502}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002029] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59188 - 302 56B in 3.065843ms
2025/11/25 13:24:50 INFO {"audit_event":"created_auth_code","details":{"clientId":5908,"codeId":1146,"userId":2502}}
2025/11/25 13:24:50 [a357f2e3b56e/VGvsVkwcAO-002030] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59194 - 302 245B in 2.559717ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpEnabled (0.32s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel1Request
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002031] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SczkCVob&redirect_uri=https%3A%2F%2Fwww.dynamicrobust.info%2Fsystems&response_type=code&code_challenge_method=S256&code_challenge=RhQffSlQOWJSCFUVWATrMPZzLNsJELGDnyJnFIDjYlN&scope=openid+profile+email&state=piKcwAPb&nonce=HbwCsafV HTTP/1.1" from [::1]:59202 - 302 57B in 554.027Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002032] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59212 - 302 54B in 247.668Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002033] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59214 - 200 2949B in 373.265Âµs
2025/11/25 13:24:51 INFO {"audit_event":"auth_success_pwd","details":{"userId":2503}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002034] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59214 - 302 0B in 46.056033ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002035] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59214 - 302 57B in 698.66Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002036] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59224 - 302 54B in 614.181Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002037] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59230 - 200 2471B in 533.538Âµs
2025/11/25 13:24:51 INFO {"audit_event":"auth_success_otp","details":{"userId":2503}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002038] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59230 - 302 0B in 361.372Âµs
2025/11/25 13:24:51 INFO {"audit_event":"started_new_user_session","details":{"clientId":5909,"userId":2503}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002039] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59230 - 302 56B in 2.628637ms
2025/11/25 13:24:51 INFO {"audit_event":"created_auth_code","details":{"clientId":5909,"codeId":1147,"userId":2503}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002040] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59244 - 302 214B in 2.15922ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002041] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SczkCVob&redirect_uri=https%3A%2F%2Fwww.dynamicrobust.info%2Fsystems&response_type=code&code_challenge_method=S256&code_challenge=CrncpBUADiIPYkDNQGWiUXGycSgRvNLEXvtYHkoEtMF&scope=openid+profile+email&state=oLCqtXnp&nonce=baMOHCWr&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:59250 - 302 66B in 1.564226ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002042] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59258 - 302 60B in 586.428Âµs
2025/11/25 13:24:51 INFO {"audit_event":"bumped_user_session","details":{"clientId":5909,"userId":2503}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002043] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59268 - 302 56B in 3.026278ms
2025/11/25 13:24:51 INFO {"audit_event":"created_auth_code","details":{"clientId":5909,"codeId":1148,"userId":2503}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002044] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59278 - 302 214B in 2.508289ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel1Request (0.32s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002045] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LmaafqHn&redirect_uri=http%3A%2F%2Fwww.corporateinfrastructures.name%2Fholistic%2Fb2c&response_type=code&code_challenge_method=S256&code_challenge=QJnQjhkEfhfTIDJYKfelgtKMDFyxGbvONlOTHOwBlfo&scope=openid+profile+email&state=AbNvuAMv&nonce=HhqFqtaV HTTP/1.1" from [::1]:59284 - 302 57B in 809.559Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002046] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59288 - 302 54B in 244.823Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002047] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59294 - 200 2949B in 366.753Âµs
2025/11/25 13:24:51 INFO {"audit_event":"auth_success_pwd","details":{"userId":2504}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002048] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59294 - 302 0B in 45.802744ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002049] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59294 - 302 57B in 688.43Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002050] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59300 - 302 54B in 418.931Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002051] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59316 - 200 2471B in 559.327Âµs
2025/11/25 13:24:51 INFO {"audit_event":"auth_success_otp","details":{"userId":2504}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002052] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59316 - 302 0B in 435.713Âµs
2025/11/25 13:24:51 INFO {"audit_event":"started_new_user_session","details":{"clientId":5910,"userId":2504}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002053] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59316 - 302 56B in 2.580696ms
2025/11/25 13:24:51 INFO {"audit_event":"created_auth_code","details":{"clientId":5910,"codeId":1149,"userId":2504}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002054] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59320 - 302 229B in 2.980622ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002055] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LmaafqHn&redirect_uri=http%3A%2F%2Fwww.corporateinfrastructures.name%2Fholistic%2Fb2c&response_type=code&code_challenge_method=S256&code_challenge=jQKPWGgzBJeAxMHKRAxQGJzsdUryYcAbRrPtTNCMuYR&scope=openid+profile+email&state=ZcYVhaKS&nonce=LaNfrngP&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:59328 - 302 66B in 1.562873ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002056] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59344 - 302 60B in 553.286Âµs
2025/11/25 13:24:51 INFO {"audit_event":"bumped_user_session","details":{"clientId":5910,"userId":2504}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002057] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59354 - 302 56B in 3.276711ms
2025/11/25 13:24:51 INFO {"audit_event":"created_auth_code","details":{"clientId":5910,"codeId":1150,"userId":2504}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002058] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59368 - 302 229B in 2.442485ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpDisabled (0.32s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002059] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PxlsHkOu&redirect_uri=http%3A%2F%2Fwww.corporateout-of-the-box.io%2Fholistic&response_type=code&code_challenge_method=S256&code_challenge=KimtjANEOKvgQGFktcYQQKuVBPzsPVcHYxTaxftaESE&scope=openid+profile+email&state=opIgeLNy&nonce=stQngANI HTTP/1.1" from [::1]:59382 - 302 57B in 754.155Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002060] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59384 - 302 54B in 251.736Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002061] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59392 - 200 2949B in 401.188Âµs
2025/11/25 13:24:51 INFO {"audit_event":"auth_success_pwd","details":{"userId":2505}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002062] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59392 - 302 0B in 46.009324ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002063] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59392 - 302 57B in 437.456Âµs
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002064] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59402 - 302 54B in 1.198345ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002065] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59412 - 200 2471B in 791.355Âµs
2025/11/25 13:24:51 INFO {"audit_event":"auth_success_otp","details":{"userId":2505}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002066] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59412 - 302 0B in 461.001Âµs
2025/11/25 13:24:51 INFO {"audit_event":"started_new_user_session","details":{"clientId":5911,"userId":2505}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002067] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59412 - 302 56B in 2.857559ms
2025/11/25 13:24:51 INFO {"audit_event":"created_auth_code","details":{"clientId":5911,"codeId":1151,"userId":2505}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002068] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59424 - 302 222B in 3.261783ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002069] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PxlsHkOu&redirect_uri=http%3A%2F%2Fwww.corporateout-of-the-box.io%2Fholistic&response_type=code&code_challenge_method=S256&code_challenge=LlUdnZOKvysOvXIWSYsuFGJxoiDNKqHyaeOHjOWkwTx&scope=openid+profile+email&state=bWttftxB&nonce=abZzIaOU&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:59430 - 302 66B in 1.970443ms
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002070] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59440 - 302 60B in 894.25Âµs
2025/11/25 13:24:51 INFO {"audit_event":"bumped_user_session","details":{"clientId":5911,"userId":2505}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002071] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59452 - 302 56B in 3.209755ms
2025/11/25 13:24:51 INFO {"audit_event":"created_auth_code","details":{"clientId":5911,"codeId":1152,"userId":2505}}
2025/11/25 13:24:51 [a357f2e3b56e/VGvsVkwcAO-002072] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59460 - 302 222B in 2.107842ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpEnabled (0.32s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002073] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gukflCkQ&redirect_uri=http%3A%2F%2Fwww.internalworld-class.biz%2Fextend%2Fusers%2Fvalue-added%2Fbandwidth&response_type=code&code_challenge_method=S256&code_challenge=RoHgjoPbDHIAxfIhStcIkxaMpWAgCpBoLIxvhHJlZKc&scope=openid+profile+email&state=zCwFflSK&nonce=lOcVWPvK HTTP/1.1" from [::1]:59464 - 302 57B in 797.437Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002074] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59472 - 302 54B in 280.039Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002075] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59484 - 200 2949B in 376.772Âµs
2025/11/25 13:24:52 INFO {"audit_event":"auth_success_pwd","details":{"userId":2506}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002076] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59484 - 302 0B in 45.667949ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002077] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59484 - 302 57B in 851.78Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002078] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59498 - 302 54B in 527.297Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002079] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59514 - 200 2471B in 502.439Âµs
2025/11/25 13:24:52 INFO {"audit_event":"auth_success_otp","details":{"userId":2506}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002080] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59514 - 302 0B in 371.652Âµs
2025/11/25 13:24:52 INFO {"audit_event":"started_new_user_session","details":{"clientId":5912,"userId":2506}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002081] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59514 - 302 56B in 2.650558ms
2025/11/25 13:24:52 INFO {"audit_event":"created_auth_code","details":{"clientId":5912,"codeId":1153,"userId":2506}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002082] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59526 - 302 245B in 2.346323ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002083] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gukflCkQ&redirect_uri=http%3A%2F%2Fwww.internalworld-class.biz%2Fextend%2Fusers%2Fvalue-added%2Fbandwidth&response_type=code&code_challenge_method=S256&code_challenge=vFgkNmCTWHMwcxGXdRFQSbCPAJmSKlWxsnFODWHSWjH&scope=openid+profile+email&state=urkuyhBX&nonce=XuuwuSOS&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:59532 - 302 66B in 1.551121ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002084] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59540 - 302 57B in 2.700041ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002085] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59548 - 302 54B in 558.605Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002086] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59562 - 200 6166B in 4.78484ms
2025/11/25 13:24:52 INFO {"audit_event":"enabled_otp","details":{"userId":2506}}
2025/11/25 13:24:52 INFO {"audit_event":"auth_success_otp","details":{"userId":2506}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002087] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59562 - 302 0B in 3.491968ms
2025/11/25 13:24:52 INFO {"audit_event":"bumped_user_session","details":{"clientId":5912,"userId":2506}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002088] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59562 - 302 56B in 2.783519ms
2025/11/25 13:24:52 INFO {"audit_event":"created_auth_code","details":{"clientId":5912,"codeId":1154,"userId":2506}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002089] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59568 - 302 245B in 2.073107ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpDisabled (0.33s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002090] "GET http://localhost:19090/auth/authorize/?client_id=test-client-hwEVnHGM&redirect_uri=https%3A%2F%2Fwww.dynamicinnovate.info%2Fdrive%2Fone-to-one%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=GWklbFyYPujXDreJYEaSzPUXDbUISBeTBDuoOSFUCJs&scope=openid+profile+email&state=bOilKIER&nonce=wYPaepgv HTTP/1.1" from [::1]:59570 - 302 57B in 915.24Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002091] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59580 - 302 54B in 260.202Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002092] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59592 - 200 2949B in 327.328Âµs
2025/11/25 13:24:52 INFO {"audit_event":"auth_success_pwd","details":{"userId":2507}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002093] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59592 - 302 0B in 45.675223ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002094] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59592 - 302 57B in 615.263Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002095] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59598 - 302 54B in 463.716Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002096] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59600 - 200 2471B in 503.181Âµs
2025/11/25 13:24:52 INFO {"audit_event":"auth_success_otp","details":{"userId":2507}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002097] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:59600 - 302 0B in 349.13Âµs
2025/11/25 13:24:52 INFO {"audit_event":"started_new_user_session","details":{"clientId":5913,"userId":2507}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002098] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59600 - 302 56B in 2.516324ms
2025/11/25 13:24:52 INFO {"audit_event":"created_auth_code","details":{"clientId":5913,"codeId":1155,"userId":2507}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002099] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59606 - 302 233B in 2.592729ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002100] "GET http://localhost:19090/auth/authorize/?client_id=test-client-hwEVnHGM&redirect_uri=https%3A%2F%2Fwww.dynamicinnovate.info%2Fdrive%2Fone-to-one%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=dPCEOXStcChOayVftgHAcALzKWvhIywJqkakVPDRtMb&scope=openid+profile+email&state=lGBQIUYw&nonce=YUDgKMUM&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:59618 - 302 66B in 1.600564ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002101] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59632 - 302 60B in 840.097Âµs
2025/11/25 13:24:52 INFO {"audit_event":"bumped_user_session","details":{"clientId":5913,"userId":2507}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002102] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59634 - 302 56B in 3.234852ms
2025/11/25 13:24:52 INFO {"audit_event":"created_auth_code","details":{"clientId":5913,"codeId":1156,"userId":2507}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002103] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59648 - 302 233B in 2.229282ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpEnabled (0.32s)
=== RUN   TestDCR_Disabled_Returns403
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002104] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59654 - 403 91B in 210.658Âµs
--- PASS: TestDCR_Disabled_Returns403 (0.00s)
=== RUN   TestDCR_PublicClient_MCP_UseCase_Success
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5914,"clientIdentifier":"dcr_af3d23ae-8c6a-4c84-af81-48e002c87da8","grantTypes":["authorization_code","refresh_token"],"isPublic":true,"sourceIP":"[::1]:59666"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002105] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59666 - 201 293B in 3.570136ms
--- PASS: TestDCR_PublicClient_MCP_UseCase_Success (0.01s)
=== RUN   TestDCR_ConfidentialClient_Success
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5915,"clientIdentifier":"dcr_af375798-220e-4dc0-9c34-96397b370791","grantTypes":["authorization_code","client_credentials","refresh_token"],"isPublic":false,"sourceIP":"[::1]:59676"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002106] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59676 - 201 408B in 3.480065ms
--- PASS: TestDCR_ConfidentialClient_Success (0.01s)
=== RUN   TestDCR_DefaultValues_Applied
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5916,"clientIdentifier":"dcr_7698315e-f6f3-45a9-91f7-6ba921e7fc64","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:59680"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002107] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59680 - 201 370B in 3.728084ms
--- PASS: TestDCR_DefaultValues_Applied (0.01s)
=== RUN   TestDCR_RedirectURI_Validation
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_localhost_HTTP_allowed
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5917,"clientIdentifier":"dcr_c4d7b302-1005-49ea-afc0-893c0111c45d","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59694"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002108] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59694 - 201 298B in 3.464516ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_127.0.0.1_HTTP_allowed
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5918,"clientIdentifier":"dcr_e2ef898d-ba71-42d9-9e1a-e64f87cac3a6","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59704"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002109] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59704 - 201 298B in 3.378303ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_IPv6_localhost_allowed
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5919,"clientIdentifier":"dcr_16c011bc-11b2-4a07-9860-7b65c89db794","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59706"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002110] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59706 - 201 294B in 3.309743ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_custom_scheme_allowed
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5920,"clientIdentifier":"dcr_b4b68dd3-93a1-4749-a45e-3a91d698bf5c","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59708"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002111] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59708 - 201 283B in 4.265139ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_HTTPS_rejected_(security)
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002112] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59714 - 400 143B in 192.644Âµs
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_non-localhost_HTTP_rejected
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002113] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59716 - 400 116B in 148.781Âµs
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_HTTPS_allowed
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5921,"clientIdentifier":"dcr_a969f0fe-4028-433f-84b4-afb818b93994","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:59732"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002114] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59732 - 201 390B in 3.258738ms
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_localhost_HTTP_allowed
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5922,"clientIdentifier":"dcr_7b894ff3-6389-4b36-bda3-7f99e892cd30","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:59742"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002115] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59742 - 201 397B in 3.505754ms
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_non-localhost_HTTP_rejected
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002116] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59744 - 400 93B in 153.781Âµs
=== RUN   TestDCR_RedirectURI_Validation/Missing_redirect_uris_for_authorization_code
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002117] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59756 - 400 112B in 147.78Âµs
=== RUN   TestDCR_RedirectURI_Validation/Client_credentials_-_no_redirect_uris_required
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5923,"clientIdentifier":"dcr_e4fcd4b1-0ee6-44ef-a8c4-5eeeaf669866","grantTypes":["client_credentials"],"isPublic":false,"sourceIP":"[::1]:59766"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002118] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59766 - 201 348B in 1.815321ms
=== RUN   TestDCR_RedirectURI_Validation/Invalid_URI_format
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002119] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59778 - 400 100B in 181.062Âµs
--- PASS: TestDCR_RedirectURI_Validation (0.03s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_localhost_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_127.0.0.1_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_IPv6_localhost_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_custom_scheme_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_HTTPS_rejected_(security) (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_non-localhost_HTTP_rejected (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_HTTPS_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_localhost_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_non-localhost_HTTP_rejected (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Missing_redirect_uris_for_authorization_code (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Client_credentials_-_no_redirect_uris_required (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Invalid_URI_format (0.00s)
=== RUN   TestDCR_GrantType_Validation
=== RUN   TestDCR_GrantType_Validation/Valid_grant_types
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5924,"clientIdentifier":"dcr_dfd297a2-2657-4a1d-bd4b-638fc4ce0a16","grantTypes":["authorization_code","client_credentials","refresh_token"],"isPublic":false,"sourceIP":"[::1]:59782"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002120] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59782 - 201 409B in 3.394193ms
=== RUN   TestDCR_GrantType_Validation/Unsupported_grant_type
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002121] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59788 - 400 91B in 246.877Âµs
=== RUN   TestDCR_GrantType_Validation/Unsupported_implicit_grant
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002122] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59798 - 400 91B in 243.44Âµs
=== RUN   TestDCR_GrantType_Validation/Mixed_valid_and_invalid
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002123] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59804 - 400 91B in 238.039Âµs
--- PASS: TestDCR_GrantType_Validation (0.01s)
    --- PASS: TestDCR_GrantType_Validation/Valid_grant_types (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Unsupported_grant_type (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Unsupported_implicit_grant (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Mixed_valid_and_invalid (0.00s)
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/none_-_public_client
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5925,"clientIdentifier":"dcr_8d8f6492-69cb-43af-a524-2b2958c2aba2","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59808"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002124] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59808 - 201 280B in 3.704991ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/client_secret_basic
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5926,"clientIdentifier":"dcr_6f1c453e-39dc-485d-a71e-889f8d8b4e17","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:59810"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002125] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59810 - 201 373B in 3.549357ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/client_secret_post
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5927,"clientIdentifier":"dcr_bc2fe9c0-6570-46b2-a23e-8b7a3a5b4672","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:59816"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002126] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59816 - 201 371B in 3.676887ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_method
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002127] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59822 - 400 116B in 277.965Âµs
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_private_key_jwt
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002128] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59824 - 400 114B in 163.629Âµs
--- PASS: TestDCR_TokenEndpointAuthMethod_Validation (0.02s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/none_-_public_client (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/client_secret_basic (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/client_secret_post (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_method (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_private_key_jwt (0.00s)
=== RUN   TestDCR_ClientName_Validation
=== RUN   TestDCR_ClientName_Validation/Normal_name
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5928,"clientIdentifier":"dcr_a700b76f-254e-41f7-9933-724674b73454","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59826"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002129] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59826 - 201 274B in 4.247716ms
=== RUN   TestDCR_ClientName_Validation/Empty_name_allowed
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5929,"clientIdentifier":"dcr_c3834600-f367-410d-81b9-39e70768c1b0","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59842"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002130] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59842 - 201 243B in 3.587559ms
=== RUN   TestDCR_ClientName_Validation/Max_length_(128_chars)
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5930,"clientIdentifier":"dcr_c71ef551-9ac4-4d86-9999-9285a2c5149d","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59846"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002131] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59846 - 201 388B in 3.381519ms
=== RUN   TestDCR_ClientName_Validation/Too_long_(129_chars)
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002132] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59848 - 400 99B in 192.404Âµs
--- PASS: TestDCR_ClientName_Validation (0.02s)
    --- PASS: TestDCR_ClientName_Validation/Normal_name (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Empty_name_allowed (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Max_length_(128_chars) (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Too_long_(129_chars) (0.00s)
=== RUN   TestDCR_WellKnown_Metadata
=== RUN   TestDCR_WellKnown_Metadata/DCR_enabled_-_registration_endpoint_present
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002133] "GET http://localhost:19090/.well-known/openid-configuration HTTP/1.1" from [::1]:59858 - 200 1275B in 223.562Âµs
=== RUN   TestDCR_WellKnown_Metadata/DCR_disabled_-_registration_endpoint_absent
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002134] "GET http://localhost:19090/.well-known/openid-configuration HTTP/1.1" from [::1]:59874 - 200 1209B in 158.289Âµs
--- PASS: TestDCR_WellKnown_Metadata (0.01s)
    --- PASS: TestDCR_WellKnown_Metadata/DCR_enabled_-_registration_endpoint_present (0.00s)
    --- PASS: TestDCR_WellKnown_Metadata/DCR_disabled_-_registration_endpoint_absent (0.00s)
=== RUN   TestDCR_MultipleRedirectURIs
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5931,"clientIdentifier":"dcr_146b759a-a441-45d9-8d5b-46a0f189a940","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:59882"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002135] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59882 - 201 338B in 7.395132ms
--- PASS: TestDCR_MultipleRedirectURIs (0.01s)
=== RUN   TestDCR_ConfidentialClient_DefaultAcrLevel
2025/11/25 13:24:52 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":5932,"clientIdentifier":"dcr_00f98a20-1487-4161-8194-1874711d3d09","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:59890"}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002136] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:59890 - 201 371B in 3.791594ms
--- PASS: TestDCR_ConfidentialClient_DefaultAcrLevel (0.01s)
=== RUN   TestToken_ClientIdIsMissing
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002137] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59898 - 400 88B in 429.501Âµs
--- PASS: TestToken_ClientIdIsMissing (0.00s)
=== RUN   TestToken_ClientDoesNotExist
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002138] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59912 - 400 73B in 357.455Âµs
--- PASS: TestToken_ClientDoesNotExist (0.00s)
=== RUN   TestToken_InvalidGrantType
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002139] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59916 - 400 81B in 295.077Âµs
--- PASS: TestToken_InvalidGrantType (0.00s)
=== RUN   TestToken_AuthCode_MissingCode
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002140] "GET http://localhost:19090/auth/authorize/?client_id=test-client-mazcfFdB&redirect_uri=http%3A%2F%2Fwww.principalunleash.info%2Fmethodologies%2Fbrand%2Fstrategic%2Ffrictionless&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=NBmMmUps&nonce=BwaFzFxE HTTP/1.1" from [::1]:59918 - 302 57B in 858.703Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002141] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59922 - 302 54B in 298.063Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002142] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59928 - 200 2949B in 433.068Âµs
2025/11/25 13:24:52 INFO {"audit_event":"auth_success_pwd","details":{"userId":2508}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002143] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59928 - 302 0B in 45.930075ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002144] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59928 - 302 57B in 523.92Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002145] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59932 - 302 60B in 589.424Âµs
2025/11/25 13:24:52 INFO {"audit_event":"started_new_user_session","details":{"clientId":5934,"userId":2508}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002146] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59940 - 302 56B in 2.840046ms
2025/11/25 13:24:52 INFO {"audit_event":"created_auth_code","details":{"clientId":5934,"codeId":1157,"userId":2508}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002147] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59946 - 302 251B in 2.178076ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002148] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59956 - 400 83B in 460.971Âµs
--- PASS: TestToken_AuthCode_MissingCode (0.11s)
=== RUN   TestToken_AuthCode_MissingRedirectURI
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002149] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gGSAELIn&redirect_uri=https%3A%2F%2Fwww.forwarddrive.name%2Fviral%2Froi%2Fgenerate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=sjnyHGoW&nonce=VnsaHUzF HTTP/1.1" from [::1]:59960 - 302 57B in 821.823Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002150] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59964 - 302 54B in 286.04Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002151] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59968 - 200 2949B in 345.333Âµs
2025/11/25 13:24:52 INFO {"audit_event":"auth_success_pwd","details":{"userId":2509}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002152] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59968 - 302 0B in 38.369007ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002153] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59968 - 302 57B in 408.402Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002154] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59978 - 302 60B in 451.764Âµs
2025/11/25 13:24:52 INFO {"audit_event":"started_new_user_session","details":{"clientId":5935,"userId":2509}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002155] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59982 - 302 56B in 2.744866ms
2025/11/25 13:24:52 INFO {"audit_event":"created_auth_code","details":{"clientId":5935,"codeId":1158,"userId":2509}}
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002156] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59992 - 302 224B in 2.065533ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002157] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60002 - 400 91B in 311.018Âµs
--- PASS: TestToken_AuthCode_MissingRedirectURI (0.10s)
=== RUN   TestToken_AuthCode_MissingCodeVerifier
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002158] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qzdOjTEX&redirect_uri=https%3A%2F%2Fwww.globalsynergistic.com%2Fe-commerce&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=ycUQvljt&nonce=VYWzwcyy HTTP/1.1" from [::1]:60012 - 302 57B in 1.297913ms
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002159] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60026 - 302 54B in 294.687Âµs
2025/11/25 13:24:52 [a357f2e3b56e/VGvsVkwcAO-002160] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60040 - 200 2949B in 368.066Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2510}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002161] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60040 - 302 0B in 35.659589ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002162] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60040 - 302 57B in 700.093Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002163] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60048 - 302 60B in 694.612Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5936,"userId":2510}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002164] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60064 - 302 56B in 2.529089ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5936,"codeId":1159,"userId":2510}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002165] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60078 - 302 220B in 3.332417ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002166] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60080 - 400 92B in 578.112Âµs
--- PASS: TestToken_AuthCode_MissingCodeVerifier (0.09s)
=== RUN   TestToken_AuthCode_ClientDoesNotExist
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002167] "GET http://localhost:19090/auth/authorize/?client_id=test-client-yaWJfErh&redirect_uri=https%3A%2F%2Fwww.globalefficient.com%2Fredefine&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=vGNmBbSP&nonce=pRYnXhHl HTTP/1.1" from [::1]:60090 - 302 57B in 568.394Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002168] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60102 - 302 54B in 197.813Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002169] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60108 - 200 2949B in 298.324Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2511}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002170] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60108 - 302 0B in 35.079933ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002171] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60108 - 302 57B in 379.057Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002172] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60118 - 302 60B in 331.326Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5937,"userId":2511}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002173] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60120 - 302 56B in 2.571589ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5937,"codeId":1160,"userId":2511}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002174] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60124 - 302 216B in 3.882536ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002175] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60130 - 400 73B in 638.697Âµs
--- PASS: TestToken_AuthCode_ClientDoesNotExist (0.09s)
=== RUN   TestToken_AuthCode_CodeIsInvalid
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002176] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LNgGeoDG&redirect_uri=http%3A%2F%2Fwww.productone-to-one.net%2Fworld-class%2Fengage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=phGhbvro&nonce=PhHEHfIH HTTP/1.1" from [::1]:60144 - 302 57B in 837.883Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002177] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60152 - 302 54B in 277.574Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002178] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60160 - 200 2949B in 301.7Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2512}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002179] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60160 - 302 0B in 35.213846ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002180] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60160 - 302 57B in 389.586Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002181] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60168 - 302 60B in 405.546Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5938,"userId":2512}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002182] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60182 - 302 56B in 2.468745ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5938,"codeId":1161,"userId":2512}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002183] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60186 - 302 227B in 2.062106ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002184] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60198 - 400 65B in 383.444Âµs
--- PASS: TestToken_AuthCode_CodeIsInvalid (0.09s)
=== RUN   TestToken_AuthCode_RedirectURIIsInvalid
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002185] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ttubCaIt&redirect_uri=http%3A%2F%2Fwww.dynamic24-7.biz%2Funleash%2Fsolutions%2Frobust%2Fintegrate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=PNPOTyIz&nonce=YQmiECtb HTTP/1.1" from [::1]:60202 - 302 57B in 692.198Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002186] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60212 - 302 54B in 315.847Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002187] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60224 - 200 2949B in 325.916Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2513}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002188] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60224 - 302 0B in 35.16283ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002189] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60224 - 302 57B in 432.998Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002190] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60240 - 302 60B in 328.671Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5939,"userId":2513}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002191] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60256 - 302 56B in 2.227158ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5939,"codeId":1162,"userId":2513}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002192] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60260 - 302 237B in 3.613438ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002193] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60268 - 400 70B in 352.175Âµs
--- PASS: TestToken_AuthCode_RedirectURIIsInvalid (0.09s)
=== RUN   TestToken_AuthCode_WrongClient
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002194] "GET http://localhost:19090/auth/authorize/?client_id=test-client-RjEnjzWV&redirect_uri=http%3A%2F%2Fwww.regionalcompelling.info%2Fe-business%2Fkiller%2Frevolutionary&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=HOxwAymc&nonce=RVObvJsa HTTP/1.1" from [::1]:60284 - 302 57B in 563.675Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002195] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60290 - 302 54B in 279.729Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002196] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60302 - 200 2949B in 317.991Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2514}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002197] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60302 - 302 0B in 35.135949ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002198] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60302 - 302 57B in 463.946Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002199] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60316 - 302 60B in 333.651Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5940,"userId":2514}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002200] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60330 - 302 56B in 2.407409ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5940,"codeId":1163,"userId":2514}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002201] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60332 - 302 242B in 1.958431ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002202] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60338 - 400 111B in 526.745Âµs
--- PASS: TestToken_AuthCode_WrongClient (0.09s)
=== RUN   TestToken_AuthCode_ConfidentialClient_NoClientSecret
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002203] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LRgkybDI&redirect_uri=https%3A%2F%2Fwww.districtarchitect.name%2Fdeploy%2Fcutting-edge%2Fincentivize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=UOPHREzz&nonce=UxjrUKea HTTP/1.1" from [::1]:60346 - 302 57B in 555.65Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002204] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60360 - 302 54B in 204.316Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002205] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60376 - 200 2949B in 412.961Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2515}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002206] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60376 - 302 0B in 35.161447ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002207] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60376 - 302 57B in 545.29Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002208] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60388 - 302 60B in 374.277Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5942,"userId":2515}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002209] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60404 - 302 56B in 2.411917ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5942,"codeId":1164,"userId":2515}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002210] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60410 - 302 242B in 1.998326ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002211] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60420 - 400 215B in 569.787Âµs
--- PASS: TestToken_AuthCode_ConfidentialClient_NoClientSecret (0.09s)
=== RUN   TestToken_AuthCode_ConfidentialClient_ClientAuthFailed
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002212] "GET http://localhost:19090/auth/authorize/?client_id=test-client-NFpVFury&redirect_uri=http%3A%2F%2Fwww.internalportals.name%2Fenvisioneer%2Fe-enable%2Fone-to-one%2Fextensible&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=RmXUdMdw&nonce=ZALvYtCJ HTTP/1.1" from [::1]:60422 - 302 57B in 952.319Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002213] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60436 - 302 54B in 335.615Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002214] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60438 - 200 2949B in 396.81Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2516}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002215] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60438 - 302 0B in 35.530795ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002216] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60438 - 302 57B in 476.971Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002217] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60444 - 302 60B in 494.795Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5943,"userId":2516}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002218] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60452 - 302 56B in 4.601123ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5943,"codeId":1165,"userId":2516}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002219] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60466 - 302 250B in 1.990621ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002220] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60476 - 400 112B in 564.416Âµs
--- PASS: TestToken_AuthCode_ConfidentialClient_ClientAuthFailed (0.09s)
=== RUN   TestToken_AuthCode_InvalidCodeVerifier
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002221] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JXVqkJxB&redirect_uri=https%3A%2F%2Fwww.customerexpedite.com%2Fwireless&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=fBSLrRlr&nonce=MoVKbbhk HTTP/1.1" from [::1]:60486 - 302 57B in 964.923Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002222] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60496 - 302 54B in 270.451Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002223] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60508 - 200 2949B in 353.698Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2517}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002224] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60508 - 302 0B in 35.366174ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002225] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60508 - 302 57B in 361.533Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002226] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60512 - 302 60B in 347.987Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5944,"userId":2517}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002227] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60524 - 302 56B in 2.409793ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5944,"codeId":1166,"userId":2517}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002228] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60540 - 302 217B in 2.293624ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002229] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60544 - 400 78B in 665.497Âµs
--- PASS: TestToken_AuthCode_InvalidCodeVerifier (0.09s)
=== RUN   TestToken_AuthCode_SuccessPath
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002230] "GET http://localhost:19090/auth/authorize/?client_id=test-client-vyJCrpRa&redirect_uri=http%3A%2F%2Fwww.forwarde-business.name%2Fparadigms%2Fsystems%2Fengineer%2Fmindshare&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=QyEjfKSa&nonce=XukhToLD HTTP/1.1" from [::1]:60550 - 302 57B in 511.036Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002231] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60560 - 302 54B in 199.106Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002232] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60572 - 200 2949B in 582.972Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2518}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002233] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60572 - 302 0B in 36.158411ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002234] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60572 - 302 57B in 539.76Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002235] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60574 - 302 60B in 468.275Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5945,"userId":2518}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002236] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60578 - 302 56B in 2.796775ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5945,"codeId":1167,"userId":2518}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002237] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60582 - 302 246B in 2.983367ms
2025/11/25 13:24:53 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1167}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002238] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60590 - 200 4240B in 15.042783ms
--- PASS: TestToken_AuthCode_SuccessPath (0.10s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_Success
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002239] "GET http://localhost:19090/auth/authorize/?client_id=test-client-GhQAlEVv&redirect_uri=http%3A%2F%2Fwww.customerintegrated.biz%2Fexploit&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=kkNuSnuG&nonce=giQQcVgD HTTP/1.1" from [::1]:60602 - 302 57B in 803.418Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002240] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60614 - 302 54B in 237.178Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002241] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60618 - 200 2949B in 373.355Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2519}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002242] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60618 - 302 0B in 35.245796ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002243] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60618 - 302 57B in 341.816Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002244] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60620 - 302 60B in 540.08Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5946,"userId":2519}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002245] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60626 - 302 56B in 2.410825ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5946,"codeId":1168,"userId":2519}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002246] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60638 - 302 217B in 2.09575ms
2025/11/25 13:24:53 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1168}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002247] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60642 - 200 4242B in 15.724772ms
--- PASS: TestToken_AuthCode_ClientSecretBasic_Success (0.10s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_WrongSecret
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002248] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gsNcAtVy&redirect_uri=https%3A%2F%2Fwww.seniorproactive.com%2Finitiatives%2Fenable%2Fempower&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=UOmhUhNe&nonce=MqYramog HTTP/1.1" from [::1]:60654 - 302 57B in 670.778Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002249] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60660 - 302 54B in 260.613Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002250] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60664 - 200 2949B in 331.857Âµs
2025/11/25 13:24:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":2520}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002251] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60664 - 302 0B in 35.577273ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002252] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60664 - 302 57B in 381.872Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002253] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60668 - 302 60B in 375.98Âµs
2025/11/25 13:24:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":5947,"userId":2520}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002254] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60676 - 302 56B in 2.342677ms
2025/11/25 13:24:53 INFO {"audit_event":"created_auth_code","details":{"clientId":5947,"codeId":1169,"userId":2520}}
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002255] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60678 - 302 234B in 2.780573ms
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002256] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60692 - 400 112B in 705.793Âµs
--- PASS: TestToken_AuthCode_ClientSecretBasic_WrongSecret (0.09s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_BothMethodsProvided
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002257] "GET http://localhost:19090/auth/authorize/?client_id=test-client-jKjvnevF&redirect_uri=https%3A%2F%2Fwww.internationaltransparent.biz%2Fcutting-edge%2Fharness%2Fstrategic%2Fusers&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=QvDBMSNu&nonce=BODsvvsk HTTP/1.1" from [::1]:60696 - 302 57B in 481.25Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002258] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60698 - 302 54B in 216.319Âµs
2025/11/25 13:24:53 [a357f2e3b56e/VGvsVkwcAO-002259] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60714 - 200 2949B in 287.703Âµs
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2521}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002260] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60714 - 302 0B in 35.548559ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002261] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60714 - 302 57B in 717.967Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002262] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60716 - 302 60B in 451.123Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5948,"userId":2521}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002263] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60726 - 302 56B in 2.648785ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5948,"codeId":1170,"userId":2521}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002264] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60738 - 302 253B in 2.618919ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002265] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60744 - 400 211B in 305.898Âµs
--- PASS: TestToken_AuthCode_ClientSecretBasic_BothMethodsProvided (0.09s)
=== RUN   TestToken_ClientCred_ClientSecretBasic_Success
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5949}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002266] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60758 - 200 1213B in 4.349999ms
--- PASS: TestToken_ClientCred_ClientSecretBasic_Success (0.01s)
=== RUN   TestToken_ClientCred_ClientSecretBasic_WrongSecret
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002267] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60762 - 401 79B in 292.322Âµs
--- PASS: TestToken_ClientCred_ClientSecretBasic_WrongSecret (0.00s)
=== RUN   TestToken_Refresh_ClientSecretBasic_Success
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002268] "GET http://localhost:19090/auth/authorize/?client_id=test-client-EOzPyFBr&redirect_uri=http%3A%2F%2Fwww.leadcross-media.org%2Fniches%2Fvortals%2Fnext-generation%2Fsticky&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=rWidFwwv&nonce=ogmevLEi HTTP/1.1" from [::1]:60774 - 302 57B in 893.128Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002269] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60786 - 302 54B in 276.433Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002270] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60802 - 200 2949B in 308.613Âµs
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2522}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002271] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60802 - 302 0B in 35.50224ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002272] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60802 - 302 57B in 465.349Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002273] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60810 - 302 60B in 374.828Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5951,"userId":2522}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002274] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60824 - 302 56B in 2.412468ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5951,"codeId":1171,"userId":2522}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002275] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60838 - 302 244B in 2.100048ms
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1171}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002276] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60852 - 200 4240B in 16.085453ms
2025/11/25 13:24:54 INFO {"audit_event":"bumped_user_session","details":{"clientId":5951,"userId":2522}}
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":1171,"refreshTokenJti":"d746a0ac-47ad-4069-b2d9-7c0fa7f668b4"}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002277] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60852 - 200 4240B in 17.629451ms
--- PASS: TestToken_Refresh_ClientSecretBasic_Success (0.12s)
=== RUN   TestToken_Refresh_ClientSecretBasic_WrongSecret
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002278] "GET http://localhost:19090/auth/authorize/?client_id=test-client-fEqotavw&redirect_uri=https%3A%2F%2Fwww.chiefdynamic.net%2Fnext-generation%2Fopen-source&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=cpNwFcdK&nonce=zGCUFcut HTTP/1.1" from [::1]:60856 - 302 57B in 747.823Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002279] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60858 - 302 54B in 291.751Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002280] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60874 - 200 2949B in 325.806Âµs
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2523}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002281] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60874 - 302 0B in 35.527699ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002282] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60874 - 302 57B in 424.833Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002283] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60878 - 302 60B in 368.526Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5952,"userId":2523}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002284] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60888 - 302 56B in 3.525702ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5952,"codeId":1172,"userId":2523}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002285] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60900 - 302 232B in 2.072646ms
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1172}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002286] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60914 - 200 4240B in 15.063342ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002287] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60914 - 400 112B in 346.344Âµs
--- PASS: TestToken_Refresh_ClientSecretBasic_WrongSecret (0.10s)
=== RUN   TestToken_ClientCred_FlowIsNotEnabled
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002288] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60928 - 400 146B in 264.98Âµs
--- PASS: TestToken_ClientCred_FlowIsNotEnabled (0.00s)
=== RUN   TestToken_ClientCred_ClientSecretIsMissing
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002289] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60938 - 400 215B in 237.8Âµs
--- PASS: TestToken_ClientCred_ClientSecretIsMissing (0.00s)
=== RUN   TestToken_ClientCred_ClientAuthFailed
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002290] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60954 - 401 79B in 225.626Âµs
--- PASS: TestToken_ClientCred_ClientAuthFailed (0.00s)
=== RUN   TestToken_ClientCred_InvalidScope
=== RUN   TestToken_ClientCred_InvalidScope/openid
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002291] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60962 - 400 269B in 347.587Âµs
=== RUN   TestToken_ClientCred_InvalidScope/groups
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002292] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60964 - 400 269B in 303.233Âµs
=== RUN   TestToken_ClientCred_InvalidScope/aaa
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002293] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60978 - 400 199B in 272.345Âµs
=== RUN   TestToken_ClientCred_InvalidScope/invalid:perm
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002294] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60986 - 400 132B in 329.132Âµs
=== RUN   TestToken_ClientCred_InvalidScope/backend-svcA-QVudHkNX:perm
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002295] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60994 - 400 190B in 498.382Âµs
=== RUN   TestToken_ClientCred_InvalidScope/backend-svcA-QVudHkNX:read-product-uevteWHs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002296] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60996 - 400 151B in 373.606Âµs
--- PASS: TestToken_ClientCred_InvalidScope (0.01s)
    --- PASS: TestToken_ClientCred_InvalidScope/openid (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/groups (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/aaa (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/invalid:perm (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/backend-svcA-QVudHkNX:perm (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/backend-svcA-QVudHkNX:read-product-uevteWHs (0.00s)
=== RUN   TestToken_ClientCred_NoScopesGiven
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5957}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002297] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32778 - 200 1359B in 4.356772ms
--- PASS: TestToken_ClientCred_NoScopesGiven (0.02s)
=== RUN   TestToken_ClientCred_SpecificScope
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":5958}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002298] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32786 - 200 1228B in 4.44592ms
--- PASS: TestToken_ClientCred_SpecificScope (0.02s)
=== RUN   TestToken_Refresh_ClientSecretIsMissing
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002299] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32800 - 400 215B in 254.511Âµs
--- PASS: TestToken_Refresh_ClientSecretIsMissing (0.00s)
=== RUN   TestToken_Refresh_ClientAuthFailed
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002300] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nURcxrcY&redirect_uri=https%3A%2F%2Fwww.producte-business.name%2Fback-end%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=QdQkIHLd&nonce=aLHsRyri HTTP/1.1" from [::1]:56016 - 302 57B in 641.813Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002301] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56026 - 302 54B in 242.899Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002302] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56040 - 200 2949B in 369.919Âµs
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2524}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002303] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56040 - 302 0B in 35.242449ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002304] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56040 - 302 57B in 477.342Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002305] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56042 - 302 60B in 424.472Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5960,"userId":2524}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002306] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56058 - 302 56B in 2.279297ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5960,"codeId":1173,"userId":2524}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002307] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56068 - 302 227B in 2.172265ms
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1173}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002308] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56082 - 200 4232B in 14.847453ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002309] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56082 - 400 112B in 365.11Âµs
--- PASS: TestToken_Refresh_ClientAuthFailed (0.10s)
=== RUN   TestToken_Refresh_MissingRefreshToken
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002310] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XbmlpXQA&redirect_uri=http%3A%2F%2Fwww.leadvisionary.info%2Fvirtual%2Fwebservices%2Fenvisioneer%2Ftarget&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=eqPgEGPh&nonce=gGLdAPFK HTTP/1.1" from [::1]:56096 - 302 57B in 1.012743ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002311] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56110 - 302 54B in 246.426Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002312] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56126 - 200 2949B in 395.387Âµs
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2525}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002313] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56126 - 302 0B in 35.475159ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002314] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56126 - 302 57B in 405.576Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002315] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56128 - 302 60B in 370.38Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5961,"userId":2525}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002316] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56130 - 302 56B in 2.286219ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5961,"codeId":1174,"userId":2525}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002317] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56148 - 302 244B in 2.120937ms
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1174}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002318] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56150 - 200 4234B in 14.941522ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002319] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56150 - 400 92B in 367.144Âµs
--- PASS: TestToken_Refresh_MissingRefreshToken (0.10s)
=== RUN   TestToken_Refresh_TokenWithBadSignature
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002320] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oaWhjjTx&redirect_uri=https%3A%2F%2Fwww.seniormethodologies.name%2Feyeballs%2Fuser-centric&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=KBiFCbQK&nonce=GYHdpuPZ HTTP/1.1" from [::1]:56164 - 302 57B in 916.542Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002321] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56176 - 302 54B in 311.108Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002322] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56186 - 200 2949B in 431.064Âµs
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2526}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002323] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56186 - 302 0B in 35.602541ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002324] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56186 - 302 57B in 364.389Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002325] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56196 - 302 60B in 425.394Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5962,"userId":2526}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002326] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56200 - 302 56B in 3.441333ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5962,"codeId":1175,"userId":2526}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002327] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56204 - 302 234B in 2.051687ms
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1175}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002328] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56212 - 200 4218B in 14.931302ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002329] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56212 - 400 139B in 723.046Âµs
--- PASS: TestToken_Refresh_TokenWithBadSignature (0.14s)
=== RUN   TestToken_Refresh_TokenExpired
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002330] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:56220 - 400 123B in 609.171Âµs
--- PASS: TestToken_Refresh_TokenExpired (0.01s)
=== RUN   TestToken_Refresh_WrongClient
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002331] "GET http://localhost:19090/auth/authorize/?client_id=test-client-inoDNZFn&redirect_uri=http%3A%2F%2Fwww.legacycultivate.name%2Fproductize%2Fiterate%2Fexploit%2Frepurpose&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=OpeGnXTw&nonce=gCsrKCiL HTTP/1.1" from [::1]:56226 - 302 57B in 617.697Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002332] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56244 - 302 54B in 309.355Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002333] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56252 - 200 2949B in 297.402Âµs
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2527}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002334] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56252 - 302 0B in 35.213996ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002335] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56252 - 302 57B in 475.739Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002336] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56262 - 302 60B in 454.93Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5964,"userId":2527}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002337] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56278 - 302 56B in 2.81558ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5964,"codeId":1176,"userId":2527}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002338] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56286 - 302 244B in 2.959722ms
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1176}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002339] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56296 - 200 4230B in 14.852223ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002340] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56296 - 400 121B in 901.895Âµs
--- PASS: TestToken_Refresh_WrongClient (0.10s)
=== RUN   TestToken_Refresh_WithAdditionalScope
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002341] "GET http://localhost:19090/auth/authorize/?client_id=test-client-HSTipQcI&redirect_uri=http%3A%2F%2Fwww.nationalredefine.info%2Fproactive%2Fcultivate%2Fleverage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=izMAMBPr&nonce=TpCnGTrt HTTP/1.1" from [::1]:56310 - 302 57B in 530.542Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002342] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56326 - 302 54B in 212.181Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002343] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56342 - 200 2949B in 316.518Âµs
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2528}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002344] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56342 - 302 0B in 35.329845ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002345] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56342 - 302 57B in 401.679Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002346] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56348 - 302 60B in 427.588Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5966,"userId":2528}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002347] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56356 - 302 56B in 2.485075ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5966,"codeId":1177,"userId":2528}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002348] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56360 - 302 237B in 2.083666ms
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1177}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002349] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56362 - 200 4232B in 16.270252ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002350] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56362 - 400 220B in 853.122Âµs
2025/11/25 13:24:54 INFO {"audit_event":"bumped_user_session","details":{"clientId":5966,"userId":2528}}
2025/11/25 13:24:54 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":1177,"refreshTokenJti":"01c64a75-1279-462d-bbd5-ed0695ecbc98"}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002351] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56362 - 200 4232B in 16.827825ms
--- PASS: TestToken_Refresh_WithAdditionalScope (0.13s)
=== RUN   TestToken_Refresh_ConsentRemoved
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002352] "GET http://localhost:19090/auth/authorize/?client_id=test-client-bVPGTQtT&redirect_uri=http%3A%2F%2Fwww.seniormarkets.com%2Fapplications%2Ftarget&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+res-cPRGNFGU%3Aperm-mhdjBHul&state=hPUPfWsQ&nonce=QFoeutht HTTP/1.1" from [::1]:56376 - 302 57B in 524.942Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002353] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56386 - 302 54B in 398.713Âµs
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002354] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56400 - 200 2949B in 1.458565ms
2025/11/25 13:24:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":2529}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002355] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56400 - 302 0B in 36.019818ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002356] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56400 - 302 60B in 390.217Âµs
2025/11/25 13:24:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":5967,"userId":2529}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002357] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56404 - 302 58B in 2.91132ms
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002358] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:56414 - 200 4267B in 883.149Âµs
2025/11/25 13:24:54 INFO {"audit_event":"saved_consent","details":{"clientId":5967,"consentId":209,"userId":2529}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002359] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:56414 - 302 0B in 2.150002ms
2025/11/25 13:24:54 INFO {"audit_event":"created_auth_code","details":{"clientId":5967,"codeId":1178,"userId":2529}}
2025/11/25 13:24:54 [a357f2e3b56e/VGvsVkwcAO-002360] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56414 - 302 224B in 2.01676ms
2025/11/25 13:24:55 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1178}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002361] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:56428 - 200 4327B in 16.619392ms
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002362] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:56428 - 400 153B in 1.128021ms
--- PASS: TestToken_Refresh_ConsentRemoved (0.11s)
=== RUN   TestToken_Refresh_ConsentDoesNotIncludeScope
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002363] "GET http://localhost:19090/auth/authorize/?client_id=test-client-CmsEdxUh&redirect_uri=https%3A%2F%2Fwww.productcollaborative.com%2Fengage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=SsedIOuS&nonce=OARchtLU HTTP/1.1" from [::1]:56442 - 302 57B in 699.131Âµs
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002364] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56444 - 302 54B in 499.925Âµs
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002365] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56446 - 200 2949B in 457.615Âµs
2025/11/25 13:24:55 INFO {"audit_event":"auth_success_pwd","details":{"userId":2530}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002366] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56446 - 302 0B in 36.667372ms
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002367] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56446 - 302 60B in 760.497Âµs
2025/11/25 13:24:55 INFO {"audit_event":"started_new_user_session","details":{"clientId":5968,"userId":2530}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002368] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56458 - 302 58B in 3.597217ms
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002369] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:56470 - 200 3835B in 950.436Âµs
2025/11/25 13:24:55 INFO {"audit_event":"saved_consent","details":{"clientId":5968,"consentId":210,"userId":2530}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002370] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:56470 - 302 0B in 2.403341ms
2025/11/25 13:24:55 INFO {"audit_event":"created_auth_code","details":{"clientId":5968,"codeId":1179,"userId":2530}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002371] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56470 - 302 219B in 2.440722ms
2025/11/25 13:24:55 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1179}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002372] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:56476 - 200 4206B in 17.740871ms
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002373] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:56476 - 400 188B in 1.081454ms
--- PASS: TestToken_Refresh_ConsentDoesNotIncludeScope (0.12s)
=== RUN   TestToken_Refresh_TokenMarkedAsUsed
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002374] "GET http://localhost:19090/auth/authorize/?client_id=test-client-EhtjopNk&redirect_uri=http%3A%2F%2Fwww.futurevisualize.org%2Fsexy%2Fengage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=PdMFHqih&nonce=FWDqMxje HTTP/1.1" from [::1]:56490 - 302 57B in 504.213Âµs
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002375] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56492 - 302 54B in 262.245Âµs
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002376] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56500 - 200 2949B in 427.788Âµs
2025/11/25 13:24:55 INFO {"audit_event":"auth_success_pwd","details":{"userId":2531}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002377] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56500 - 302 0B in 35.600527ms
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002378] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56500 - 302 57B in 463.005Âµs
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002379] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56516 - 302 60B in 474.447Âµs
2025/11/25 13:24:55 INFO {"audit_event":"started_new_user_session","details":{"clientId":5969,"userId":2531}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002380] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56520 - 302 56B in 2.410344ms
2025/11/25 13:24:55 INFO {"audit_event":"created_auth_code","details":{"clientId":5969,"codeId":1180,"userId":2531}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002381] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56536 - 302 218B in 2.023573ms
2025/11/25 13:24:55 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1180}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002382] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56542 - 200 4216B in 14.996075ms
2025/11/25 13:24:55 INFO {"audit_event":"bumped_user_session","details":{"clientId":5969,"userId":2531}}
2025/11/25 13:24:55 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":1180,"refreshTokenJti":"b0a74dea-31f0-4127-ab1e-d40c897bdf96"}}
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56542 - 200 4216B in 17.969173ms
2025/11/25 13:24:55 [a357f2e3b56e/VGvsVkwcAO-002384] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56542 - 400 85B in 854.434Âµs
--- PASS: TestToken_Refresh_TokenMarkedAsUsed (0.12s)
PASS
ok  	github.com/leodip/goiabada/authserver/tests/integration	29.862s
Tests finished. Killing the server...
Checking for processes on port 19090...
Found processes listening on port 19090: 132422
Killing process 132422 on port 19090
Checking for processes on port 19091...
No processes found on port 19091
./run-tests.sh: line 78: 132422 Killed                  ./tmp/goiabada-authserver
Port 19090 is now free
Port 19091 is now free
=== Completed integration tests with mysql ===

=== Running integration tests with postgres ===
Configuring for database: postgres
Started server with PID: 132787
Waiting for the server to start...
BROWSER=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/bin/helpers/browser.sh
COLORTERM=truecolor
DEBIAN_FRONTEND=noninteractive
DISPLAY=:0
DOCKER_BUILDKIT=1
GIT_ASKPASS=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/extensions/git/dist/askpass.sh
GOIABADA_ADMINCONSOLE_BASEURL=http://localhost:19091
GOIABADA_ADMINCONSOLE_CERTFILE=
GOIABADA_ADMINCONSOLE_KEYFILE=
GOIABADA_ADMINCONSOLE_LISTEN_HOST_HTTP=0.0.0.0
GOIABADA_ADMINCONSOLE_LISTEN_HOST_HTTPS=0.0.0.0
GOIABADA_ADMINCONSOLE_LISTEN_PORT_HTTP=19091
GOIABADA_ADMINCONSOLE_LISTEN_PORT_HTTPS=19444
GOIABADA_ADMINCONSOLE_LOG_HTTP_REQUESTS=true
GOIABADA_ADMINCONSOLE_OAUTH_CLIENT_ID=admin-console-client
GOIABADA_ADMINCONSOLE_OAUTH_CLIENT_SECRET=devcontainer-admin-console-secret-0123456789abcdef
GOIABADA_ADMINCONSOLE_SESSION_AUTHENTICATION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210
GOIABADA_ADMINCONSOLE_SESSION_ENCRYPTION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210
GOIABADA_ADMINCONSOLE_STATICDIR=
GOIABADA_ADMINCONSOLE_TEMPLATEDIR=
GOIABADA_ADMINCONSOLE_TRUST_PROXY_HEADERS=false
GOIABADA_ADMIN_EMAIL=admin@example.com
GOIABADA_ADMIN_PASSWORD=changeme
GOIABADA_APPNAME=Goiabada
GOIABADA_AUTHSERVER_AUDIT_LOGS_IN_CONSOLE=true
GOIABADA_AUTHSERVER_BASEURL=http://localhost:19090
GOIABADA_AUTHSERVER_CERTFILE=
GOIABADA_AUTHSERVER_DEBUG_API_REQUESTS=false
GOIABADA_AUTHSERVER_INTERNALBASEURL=
GOIABADA_AUTHSERVER_KEYFILE=
GOIABADA_AUTHSERVER_LISTEN_HOST_HTTP=0.0.0.0
GOIABADA_AUTHSERVER_LISTEN_HOST_HTTPS=0.0.0.0
GOIABADA_AUTHSERVER_LISTEN_PORT_HTTP=19090
GOIABADA_AUTHSERVER_LISTEN_PORT_HTTPS=19443
GOIABADA_AUTHSERVER_LOG_HTTP_REQUESTS=true
GOIABADA_AUTHSERVER_LOG_SQL=false
GOIABADA_AUTHSERVER_RATELIMITER_ENABLED=false
GOIABADA_AUTHSERVER_SESSION_AUTHENTICATION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
GOIABADA_AUTHSERVER_SESSION_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
GOIABADA_AUTHSERVER_STATICDIR=
GOIABADA_AUTHSERVER_TEMPLATEDIR=
GOIABADA_AUTHSERVER_TRUST_PROXY_HEADERS=false
GOIABADA_DB_DSN=
GOIABADA_DB_HOST=postgres-server
GOIABADA_DB_NAME=goiabada_integration
GOIABADA_DB_PASSWORD=myPostgresPass123
GOIABADA_DB_PORT=15432
GOIABADA_DB_TYPE=postgres
GOIABADA_DB_USERNAME=postgres
HOME=/root
HOSTNAME=a357f2e3b56e
LANG=en_US.UTF-8
LESSCLOSE=/usr/bin/lesspipe %s %s
LESSOPEN=| /usr/bin/lesspipe %s
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=00:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.avif=01;35:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:*~=00;90:*#=00;90:*.bak=00;90:*.crdownload=00;90:*.dpkg-dist=00;90:*.dpkg-new=00;90:*.dpkg-old=00;90:*.dpkg-tmp=00;90:*.old=00;90:*.orig=00;90:*.part=00;90:*.rej=00;90:*.rpmnew=00;90:*.rpmorig=00;90:*.rpmsave=00;90:*.swp=00;90:*.tmp=00;90:*.ucf-dist=00;90:*.ucf-new=00;90:*.ucf-old=00;90:
OLDPWD=/workspaces/goiabada/src
PATH=/opt/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/go/bin:/root/go/bin
PWD=/workspaces/goiabada/src/authserver
REMOTE_CONTAINERS=true
REMOTE_CONTAINERS_DISPLAY_SOCK=/tmp/.X11-unix/X0
REMOTE_CONTAINERS_IPC=/tmp/vscode-remote-containers-ipc-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock
REMOTE_CONTAINERS_SOCKETS=["/tmp/vscode-ssh-auth-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock","/tmp/.X11-unix/X0","/root/.gnupg/S.gpg-agent"]
SHELL=/bin/bash
SHLVL=3
SSH_AUTH_SOCK=/tmp/vscode-ssh-auth-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock
TERM=xterm-256color
TERM_PROGRAM=vscode
TERM_PROGRAM_VERSION=1.106.2
TZ=Europe/Lisbon
VSCODE_GIT_ASKPASS_EXTRA_ARGS=
VSCODE_GIT_ASKPASS_MAIN=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/extensions/git/dist/askpass-main.js
VSCODE_GIT_ASKPASS_NODE=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/node
VSCODE_GIT_IPC_HANDLE=/tmp/user/0/vscode-git-27ddbaf538.sock
VSCODE_IPC_HOOK_CLI=/tmp/vscode-ipc-8cdca7a1-b8b6-4c1d-9f11-9fd95bbdc4c8.sock
VSCODE_PYTHON_AUTOACTIVATE_GUARD=1
WAYLAND_DISPLAY=vscode-wayland-7cc23a66-0244-472f-8cfe-838db66f3a44.sock
XDG_RUNTIME_DIR=/tmp/user/0
_=/usr/bin/env
2025/11/25 13:24:57 INFO auth server started
2025/11/25 13:24:57 INFO goiabada version: development
2025/11/25 13:24:57 INFO build date: development
2025/11/25 13:24:57 INFO git commit: development
2025/11/25 13:24:57 INFO config loaded
2025/11/25 13:24:57 INFO auth server base URL: http://localhost:19090
2025/11/25 13:24:57 INFO auth server internal base URL: 
2025/11/25 13:24:57 INFO admin console base URL: http://localhost:19091
2025/11/25 13:24:57 INFO debug API requests: false
2025/11/25 13:24:57 INFO current working directory: /workspaces/goiabada/src/authserver
2025/11/25 13:24:57 INFO timezones loaded
2025/11/25 13:24:57 INFO current time zone is: Europe/Lisbon
2025/11/25 13:24:57 INFO current local time is: 2025-11-25 13:24:57.28535997 +0000 WET m=+0.002548146
2025/11/25 13:24:57 INFO current UTC time is: 2025-11-25 13:24:57.28536532 +0000 UTC
2025/11/25 13:24:57 INFO db type is postgres
2025/11/25 13:24:57 INFO creating postgres database
2025/11/25 13:24:57 INFO using database postgres
2025/11/25 13:24:57 INFO db username: postgres
2025/11/25 13:24:57 INFO db host: postgres-server
2025/11/25 13:24:57 INFO db port: 15432
2025/11/25 13:24:57 INFO db name: goiabada_integration
Server is not ready yet. Retrying...
2025/11/25 13:24:57 INFO created database connection
2025/11/25 13:24:57 INFO database already initialized, proceeding with normal startup
2025/11/25 13:24:57 INFO session keys validated
2025/11/25 13:24:57 INFO set cookie secure: false
2025/11/25 13:24:57 INFO initialized chunked cookie session store
2025/11/25 13:24:57 INFO using embedded static files directory
2025/11/25 13:24:57 INFO using embedded template files directory
2025/11/25 13:24:57 INFO background worker service started
2025/11/25 13:24:57 INFO initializing middleware
2025/11/25 13:24:57 INFO not adding real ip middleware
2025/11/25 13:24:57 INFO http request logging enabled
2025/11/25 13:24:57 INFO CSRF middleware configured trustedOrigins="[localhost:19090 localhost:19091]" secure=false
2025/11/25 13:24:57 INFO finished initializing middleware
2025/11/25 13:24:57 INFO listen host https: 0.0.0.0
2025/11/25 13:24:57 INFO listen port https: 19443
2025/11/25 13:24:57 INFO cert file: 
2025/11/25 13:24:57 INFO key file: 
2025/11/25 13:24:57 INFO https enabled: false
2025/11/25 13:24:57 INFO listen host http: 0.0.0.0
2025/11/25 13:24:57 INFO listen port http: 19090
2025/11/25 13:24:57 INFO http enabled: true
2025/11/25 13:24:57 WARN === WARNING ===
2025/11/25 13:24:57 WARN You are running the auth server with HTTP (without TLS/HTTPS).
2025/11/25 13:24:57 WARN This is HIGHLY INSECURE unless you are:
2025/11/25 13:24:57 WARN   1. Only doing development/testing, OR
2025/11/25 13:24:57 WARN   2. Running behind a reverse proxy that handles HTTPS
2025/11/25 13:24:57 WARN 
2025/11/25 13:24:57 WARN In production environments, you should either:
2025/11/25 13:24:57 WARN   - Enable HTTPS configuration, OR
2025/11/25 13:24:57 WARN   - Ensure your reverse proxy handles HTTPS properly
2025/11/25 13:24:57 WARN ===============
2025/11/25 13:24:57 INFO starting HTTP server on 0.0.0.0:19090
Server is up and running
Running integration tests...
2025/11/25 13:24:58 INFO running TestMain
2025/11/25 13:24:58 INFO db type is postgres
2025/11/25 13:24:58 INFO creating postgres database
2025/11/25 13:24:58 INFO using database postgres
2025/11/25 13:24:58 INFO db username: postgres
2025/11/25 13:24:58 INFO db host: postgres-server
2025/11/25 13:24:58 INFO db port: 15432
2025/11/25 13:24:58 INFO db name: goiabada_integration
2025/11/25 13:24:58 INFO no need to migrate the database
=== RUN   TestAPIAccountAddressPut_Success
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000002] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-lMHJNBnE&redirect_uri=http%3A%2F%2Fwww.directinfomediaries.name%2Finterfaces%2Faction-items%2Fglobal%2Fbest-of-breed&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JimfZUNd&nonce=ECPXOtMd HTTP/1.1" from [::1]:56558 - 302 57B in 1.50848ms
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000003] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56568 - 302 54B in 205.498Âµs
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000004] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56572 - 200 2949B in 284.387Âµs
2025/11/25 13:24:58 INFO {"audit_event":"auth_success_pwd","details":{"userId":1764}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000005] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56572 - 302 0B in 35.900103ms
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000006] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56572 - 302 57B in 449.67Âµs
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000007] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56578 - 302 60B in 1.337778ms
2025/11/25 13:24:58 INFO {"audit_event":"started_new_user_session","details":{"clientId":4167,"userId":1764}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000008] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56590 - 302 56B in 2.599742ms
2025/11/25 13:24:58 INFO {"audit_event":"created_auth_code","details":{"clientId":4167,"codeId":818,"userId":1764}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000009] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56602 - 302 256B in 1.121008ms
2025/11/25 13:24:58 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":818}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000010] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56604 - 200 4328B in 14.26312ms
2025/11/25 13:24:58 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"17343112-75c7-45cc-8930-02fd052028d9","userId":1764}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000011] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56610 - 200 733B in 1.601416ms
--- PASS: TestAPIAccountAddressPut_Success (0.10s)
=== RUN   TestAPIAccountAddressPut_PartialAddress
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000012] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-hzkxTxcO&redirect_uri=https%3A%2F%2Fwww.centralmarkets.info%2Fcompelling%2Fworld-class%2Fharness&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JfQjYPTo&nonce=vIRGTazN HTTP/1.1" from [::1]:56620 - 302 57B in 692.067Âµs
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000013] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56630 - 302 54B in 407.199Âµs
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000014] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56640 - 200 2949B in 423.651Âµs
2025/11/25 13:24:58 INFO {"audit_event":"auth_success_pwd","details":{"userId":1765}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000015] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56640 - 302 0B in 36.780326ms
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000016] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56640 - 302 57B in 622.386Âµs
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000017] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56656 - 302 60B in 397.611Âµs
2025/11/25 13:24:58 INFO {"audit_event":"started_new_user_session","details":{"clientId":4168,"userId":1765}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000018] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56666 - 302 56B in 1.996022ms
2025/11/25 13:24:58 INFO {"audit_event":"created_auth_code","details":{"clientId":4168,"codeId":819,"userId":1765}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000019] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56682 - 302 238B in 947.821Âµs
2025/11/25 13:24:58 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":819}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000020] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56696 - 200 4338B in 12.313476ms
2025/11/25 13:24:58 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"dc6962ad-24d0-4447-a2ab-6a2185c60385","userId":1765}}
2025/11/25 13:24:58 [a357f2e3b56e/8P1BS7F7Qi-000021] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56710 - 200 719B in 1.441533ms
--- PASS: TestAPIAccountAddressPut_PartialAddress (0.10s)
=== RUN   TestAPIAccountAddressPut_ClearAllFields
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000022] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-KcagjPFj&redirect_uri=https%3A%2F%2Fwww.legacystreamline.org%2Frevolutionary%2Fcontent%2Fmagnetic%2Farchitect&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=bnqRLKrI&nonce=oUuHAZWO HTTP/1.1" from [::1]:56724 - 302 57B in 1.134283ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000023] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56728 - 302 54B in 284.398Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000024] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56732 - 200 2949B in 302.942Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1766}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000025] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56732 - 302 0B in 35.831583ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000026] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56732 - 302 57B in 330.805Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000027] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56736 - 302 60B in 332.357Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4169,"userId":1766}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000028] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56740 - 302 56B in 2.399053ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4169,"codeId":820,"userId":1766}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000029] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56752 - 302 249B in 916.662Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":820}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000030] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56758 - 200 4322B in 12.736876ms
2025/11/25 13:24:59 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"54d989ca-f122-4e14-9f0b-17e3b065aa1f","userId":1766}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000031] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56772 - 200 694B in 1.526014ms
--- PASS: TestAPIAccountAddressPut_ClearAllFields (0.10s)
=== RUN   TestAPIAccountAddressPut_ValidationErrors
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000032] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-qwOFMESC&redirect_uri=https%3A%2F%2Fwww.centralaggregate.org%2Fback-end%2Fchannels&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JEcGtQJC&nonce=zeuvSIyg HTTP/1.1" from [::1]:56776 - 302 57B in 667.862Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000033] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56784 - 302 54B in 332.909Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000034] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56788 - 200 2949B in 372.284Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1767}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000035] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56788 - 302 0B in 35.175223ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000036] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56788 - 302 57B in 796.886Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000037] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56790 - 302 60B in 358.507Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4170,"userId":1767}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000038] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56794 - 302 56B in 1.470368ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4170,"codeId":821,"userId":1767}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000039] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56800 - 302 226B in 943.923Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":821}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000040] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56812 - 200 4322B in 13.595028ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000041] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56822 - 400 116B in 573.664Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000042] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56828 - 400 116B in 456.633Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000043] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56836 - 400 110B in 370.871Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000044] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56850 - 400 108B in 356.424Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000045] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56852 - 400 113B in 762.912Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000046] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56860 - 400 67B in 739.057Âµs
--- PASS: TestAPIAccountAddressPut_ValidationErrors (0.10s)
=== RUN   TestAPIAccountAddressPut_UnauthorizedAndScope
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000047] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56864 - 401 22B in 94.047Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000048] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56876 - 401 22B in 282.183Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4171}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000049] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56890 - 200 1165B in 4.283523ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000050] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56904 - 403 19B in 338.159Âµs
--- PASS: TestAPIAccountAddressPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountAddressPut_InvalidRequestBody
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000051] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-eZKOcPav&redirect_uri=https%3A%2F%2Fwww.internalroi.name%2Fmethodologies%2Ftarget%2Fone-to-one&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=PWevsyEW&nonce=YfHtVziB HTTP/1.1" from [::1]:56918 - 302 57B in 909.939Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000052] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56922 - 302 54B in 181.333Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000053] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56934 - 200 2949B in 267.936Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1768}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000054] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56934 - 302 0B in 35.35868ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000055] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56934 - 302 57B in 481.61Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000056] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56946 - 302 60B in 419.523Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4172,"userId":1768}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000057] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56948 - 302 56B in 1.605824ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4172,"codeId":822,"userId":1768}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000058] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56950 - 302 236B in 1.544919ms
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":822}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000059] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56964 - 200 4344B in 12.920273ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000060] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56980 - 400 75B in 406.428Âµs
--- PASS: TestAPIAccountAddressPut_InvalidRequestBody (0.10s)
=== RUN   TestAPIAccountConsentsGet_Success
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000061] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-qHmemjjS&redirect_uri=http%3A%2F%2Fwww.seniorembrace.io%2Freintermediate%2Fsticky&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=vJXvzFXZ&nonce=cdgEDfak HTTP/1.1" from [::1]:56996 - 302 57B in 520.333Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000062] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57000 - 302 54B in 159.942Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000063] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57002 - 200 2949B in 427.167Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1769}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000064] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57002 - 302 0B in 35.555962ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000065] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57002 - 302 57B in 589.194Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000066] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57006 - 302 60B in 617.076Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4173,"userId":1769}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000067] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57012 - 302 56B in 1.708899ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4173,"codeId":823,"userId":1769}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000068] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57020 - 302 225B in 945.066Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":823}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000069] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57030 - 200 4326B in 12.63795ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000070] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:57042 - 200 315B in 1.051797ms
--- PASS: TestAPIAccountConsentsGet_Success (0.10s)
=== RUN   TestAPIAccountConsentsGet_UnauthorizedAndScope
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000071] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:57052 - 401 22B in 85.572Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000072] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:57058 - 401 22B in 231.608Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4175}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000073] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57068 - 200 1165B in 4.09067ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000074] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:57084 - 403 19B in 293.745Âµs
--- PASS: TestAPIAccountConsentsGet_UnauthorizedAndScope (0.03s)
=== RUN   TestAPIAccountConsentDelete_Success
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000075] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-mcZqVdNe&redirect_uri=https%3A%2F%2Fwww.futuretechnologies.io%2Fpartnerships&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=LFfYgYIw&nonce=tOcJowBo HTTP/1.1" from [::1]:57088 - 302 57B in 600.435Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000076] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57092 - 302 54B in 182.295Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000077] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57100 - 200 2949B in 280.921Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1770}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000078] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57100 - 302 0B in 35.74001ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000079] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57100 - 302 57B in 471.411Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000080] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57116 - 302 60B in 728.145Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4176,"userId":1770}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000081] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57122 - 302 56B in 1.40779ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4176,"codeId":824,"userId":1770}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000082] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57132 - 302 222B in 866.948Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":824}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000083] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57138 - 200 4350B in 13.100443ms
2025/11/25 13:24:59 INFO {"audit_event":"deleted_own_user_consent","details":{"consentId":149,"loggedInUser":"f402f492-d156-4942-b378-a05e8d09e83f","userId":1770}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000084] "DELETE http://localhost:19090/api/v1/account/consents/149 HTTP/1.1" from [::1]:57152 - 200 17B in 1.245092ms
--- PASS: TestAPIAccountConsentDelete_Success (0.10s)
=== RUN   TestAPIAccountConsentDelete_ForbiddenOnOtherUser
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000085] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-BqyAzUbG&redirect_uri=http%3A%2F%2Fwww.corporatemagnetic.biz%2Ftechnologies%2Fsticky&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=kYKIskyg&nonce=csnNEGTV HTTP/1.1" from [::1]:57164 - 302 57B in 662.953Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000086] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57174 - 302 54B in 203.625Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000087] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57188 - 200 2949B in 250.143Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1771}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000088] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57188 - 302 0B in 35.315789ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000089] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57188 - 302 57B in 353.047Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000090] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57198 - 302 60B in 335.695Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4178,"userId":1771}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000091] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57214 - 302 56B in 1.288955ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4178,"codeId":825,"userId":1771}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000092] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57224 - 302 228B in 965.134Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":825}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000093] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57232 - 200 4322B in 12.651525ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000094] "DELETE http://localhost:19090/api/v1/account/consents/150 HTTP/1.1" from [::1]:57246 - 403 53B in 442.807Âµs
--- PASS: TestAPIAccountConsentDelete_ForbiddenOnOtherUser (0.10s)
=== RUN   TestAPIAccountConsentDelete_NotFoundAndBadId
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000095] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-cMrTMgfO&redirect_uri=https%3A%2F%2Fwww.dynamicbricks-and-clicks.info%2Finfrastructures%2Fdot-com%2Fwebservices&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=dqmXoHBQ&nonce=PMVVsMUV HTTP/1.1" from [::1]:57256 - 302 57B in 377.724Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000096] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57272 - 302 54B in 181.803Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000097] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57288 - 200 2949B in 284.197Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1773}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000098] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57288 - 302 0B in 35.219366ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000099] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57288 - 302 57B in 977.236Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000100] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57300 - 302 60B in 348.328Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4180,"userId":1773}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000101] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57302 - 302 56B in 1.438939ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4180,"codeId":826,"userId":1773}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000102] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57304 - 302 253B in 883.77Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":826}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000103] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57316 - 200 4344B in 12.23091ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000104] "DELETE http://localhost:19090/api/v1/account/consents/999999999 HTTP/1.1" from [::1]:57324 - 404 61B in 443.127Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000105] "DELETE http://localhost:19090/api/v1/account/consents/abc HTTP/1.1" from [::1]:57334 - 400 76B in 1.167005ms
--- PASS: TestAPIAccountConsentDelete_NotFoundAndBadId (0.09s)
=== RUN   TestAPIAccountEmailPut_Success
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000106] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-OWEjXwmu&redirect_uri=https%3A%2F%2Fwww.internationalscalable.io%2Fenvisioneer%2Fseize%2Finnovate%2Frelationships&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=LolbkZdU&nonce=XIHhEpHk HTTP/1.1" from [::1]:57342 - 302 57B in 603.32Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000107] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57344 - 302 54B in 174.019Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000108] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57348 - 200 2949B in 283.145Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1774}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000109] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57348 - 302 0B in 35.565761ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000110] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57348 - 302 57B in 320.566Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000111] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57356 - 302 60B in 401.549Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4181,"userId":1774}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000112] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57368 - 302 56B in 1.460639ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4181,"codeId":827,"userId":1774}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000113] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57380 - 302 253B in 802.146Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":827}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000114] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57392 - 200 4330B in 12.608092ms
2025/11/25 13:24:59 INFO {"audit_event":"updated_own_email","details":{"loggedInUser":"9239260f-024e-4d88-810a-fc7f9413a431","userId":1774}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000115] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57396 - 200 694B in 1.132981ms
--- PASS: TestAPIAccountEmailPut_Success (0.10s)
=== RUN   TestAPIAccountEmailPut_ValidationErrors
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000116] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ukSvCePS&redirect_uri=http%3A%2F%2Fwww.chiefmesh.name%2Fintuitive%2Fenvisioneer&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=UyajuDkK&nonce=tjBcSilK HTTP/1.1" from [::1]:57402 - 302 57B in 453.937Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000117] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57418 - 302 54B in 160.574Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000118] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57420 - 200 2949B in 233.241Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1775}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000119] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57420 - 302 0B in 35.317211ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000120] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57420 - 302 57B in 282.594Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000121] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57436 - 302 60B in 320.776Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4182,"userId":1775}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000122] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57450 - 302 56B in 1.404784ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4182,"codeId":828,"userId":1775}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000123] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57460 - 302 223B in 1.161886ms
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":828}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000124] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57466 - 200 4342B in 12.344004ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000125] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57472 - 400 81B in 429.952Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000126] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57480 - 400 86B in 387.553Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000127] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57494 - 400 117B in 338.54Âµs
--- PASS: TestAPIAccountEmailPut_ValidationErrors (0.09s)
=== RUN   TestAPIAccountEmailPut_EmailAlreadyExists
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000128] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-nLkkCMWo&redirect_uri=http%3A%2F%2Fwww.customer24-7.name%2Ftransition%2Fmesh%2Fengage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=WXPiFWKf&nonce=UCEhDijl HTTP/1.1" from [::1]:57504 - 302 57B in 545.961Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000129] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57512 - 302 54B in 232.97Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000130] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57522 - 200 2949B in 652.223Âµs
2025/11/25 13:24:59 INFO {"audit_event":"auth_success_pwd","details":{"userId":1776}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000131] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57522 - 302 0B in 37.118885ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000132] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57522 - 302 57B in 438.709Âµs
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000133] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57524 - 302 60B in 723.517Âµs
2025/11/25 13:24:59 INFO {"audit_event":"started_new_user_session","details":{"clientId":4183,"userId":1776}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000134] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57532 - 302 56B in 1.864964ms
2025/11/25 13:24:59 INFO {"audit_event":"created_auth_code","details":{"clientId":4183,"codeId":829,"userId":1776}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000135] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57540 - 302 227B in 943.973Âµs
2025/11/25 13:24:59 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":829}}
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000136] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57554 - 200 4334B in 12.783244ms
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000137] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57562 - 400 107B in 578.393Âµs
--- PASS: TestAPIAccountEmailPut_EmailAlreadyExists (0.10s)
=== RUN   TestAPIAccountEmailPut_UnauthorizedAndScope
2025/11/25 13:24:59 [a357f2e3b56e/8P1BS7F7Qi-000138] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57576 - 401 22B in 108.725Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4184}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000139] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57578 - 200 1165B in 4.125775ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000140] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57582 - 403 19B in 321.568Âµs
--- PASS: TestAPIAccountEmailPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountEmailPut_InvalidRequestBody
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000141] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-WSkMgHoq&redirect_uri=https%3A%2F%2Fwww.corporatereinvent.io%2Fstrategize%2Fb2b&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=kDJXBidV&nonce=NvsjqNIY HTTP/1.1" from [::1]:57586 - 302 57B in 745.979Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000142] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57592 - 302 54B in 218.803Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000143] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57608 - 200 2949B in 275.53Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1778}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000144] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57608 - 302 0B in 35.886187ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000145] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57608 - 302 57B in 304.715Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000146] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57610 - 302 60B in 299.296Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4185,"userId":1778}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000147] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57618 - 302 56B in 1.421526ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4185,"codeId":830,"userId":1778}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000148] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57626 - 302 223B in 809.41Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":830}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000149] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57636 - 200 4334B in 12.164665ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000150] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57644 - 400 75B in 261.765Âµs
--- PASS: TestAPIAccountEmailPut_InvalidRequestBody (0.09s)
=== RUN   TestAPIAccountEmailVerificationSend_Success
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000151] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ubQfrLMq&redirect_uri=https%3A%2F%2Fwww.dynamicextend.io%2Fkiller%2Fleading-edge%2Frelationships%2Ftarget&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=CghpLTfZ&nonce=ywWAbAND HTTP/1.1" from [::1]:57652 - 302 57B in 445.232Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000152] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57654 - 302 54B in 167.256Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000153] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57658 - 200 2949B in 245.173Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1779}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000154] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57658 - 302 0B in 35.590868ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000155] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57658 - 302 57B in 881.186Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000156] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57670 - 302 60B in 639.197Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4186,"userId":1779}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000157] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57676 - 302 56B in 1.548285ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4186,"codeId":831,"userId":1779}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000158] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57692 - 302 245B in 1.03741ms
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":831}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000159] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57698 - 200 4338B in 12.763587ms
2025/11/25 13:25:00 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"jeffsteuber@schowalter.biz","loggedInUser":"f5a641a9-e76e-4152-86d3-1dfc710a8c5b","userId":1779}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000160] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:57700 - 200 143B in 1.679343ms
--- PASS: TestAPIAccountEmailVerificationSend_Success (0.10s)
=== RUN   TestAPIAccountEmailVerificationSend_TooManyRequests
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000161] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-XUbJYTlg&redirect_uri=https%3A%2F%2Fwww.dynamicincentivize.name%2Fvortals%2Fcross-media%2Fnetworks&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=fqsPFPgZ&nonce=dUBZHwsd HTTP/1.1" from [::1]:57704 - 302 57B in 683.111Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000162] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57708 - 302 54B in 253.85Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000163] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57710 - 200 2949B in 375.319Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1780}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000164] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57710 - 302 0B in 35.254392ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000165] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57710 - 302 57B in 322.509Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000166] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57718 - 302 60B in 386.069Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4187,"userId":1780}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000167] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57732 - 302 56B in 1.148109ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4187,"codeId":832,"userId":1780}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000168] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57738 - 302 240B in 758.023Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":832}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000169] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57742 - 200 4350B in 12.311953ms
2025/11/25 13:25:00 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"americaparisian@cartwright.org","loggedInUser":"171d4096-bd0f-4f12-a08b-4a8b190f42cf","userId":1780}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000170] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:57748 - 200 147B in 1.645519ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000171] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:57760 - 200 118B in 395.377Âµs
--- PASS: TestAPIAccountEmailVerificationSend_TooManyRequests (0.12s)
=== RUN   TestAPIAccountEmailVerificationSend_AlreadyVerified
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000172] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-tkjUeSxQ&redirect_uri=https%3A%2F%2Fwww.internationalproactive.name%2Ftarget%2Fsexy&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=KVBQTmBw&nonce=HltCpCpD HTTP/1.1" from [::1]:57764 - 302 57B in 584.856Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000173] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57778 - 302 54B in 197.383Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000174] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57788 - 200 2949B in 799.36Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1781}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000175] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57788 - 302 0B in 36.048162ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000176] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57788 - 302 57B in 484.615Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000177] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57804 - 302 60B in 350.953Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4188,"userId":1781}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000178] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57812 - 302 56B in 1.56685ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4188,"codeId":833,"userId":1781}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000179] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57828 - 302 227B in 948.202Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":833}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000180] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57830 - 200 4330B in 13.605047ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000181] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:57840 - 200 117B in 508.841Âµs
--- PASS: TestAPIAccountEmailVerificationSend_AlreadyVerified (0.10s)
=== RUN   TestAPIAccountEmailVerificationSend_SMTPDisabled
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000182] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-nursQZKv&redirect_uri=http%3A%2F%2Fwww.dynamice-business.org%2Fholistic%2Freinvent&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=GWQRIrwV&nonce=PnsTzCez HTTP/1.1" from [::1]:57854 - 302 57B in 625.081Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000183] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57858 - 302 54B in 203.534Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000184] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57860 - 200 2949B in 311.649Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1782}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000185] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57860 - 302 0B in 36.034316ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000186] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57860 - 302 57B in 399.936Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000187] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57868 - 302 60B in 245.153Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4189,"userId":1782}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000188] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57874 - 302 56B in 1.584023ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4189,"codeId":834,"userId":1782}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000189] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57886 - 302 226B in 875.574Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":834}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000190] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57898 - 200 4334B in 12.216563ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000191] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:57910 - 400 70B in 287.032Âµs
--- PASS: TestAPIAccountEmailVerificationSend_SMTPDisabled (0.10s)
=== RUN   TestAPIAccountEmailVerificationSend_Unauthorized
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000192] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:57914 - 401 22B in 63.22Âµs
--- PASS: TestAPIAccountEmailVerificationSend_Unauthorized (0.00s)
=== RUN   TestAPIAccountEmailVerification_VerifySuccess
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000193] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-sZyJhQks&redirect_uri=http%3A%2F%2Fwww.legacyeyeballs.net%2Finnovate%2Fe-business%2Fmodels&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=WVKavBcL&nonce=ZtUFepHb HTTP/1.1" from [::1]:57922 - 302 57B in 341.836Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000194] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57924 - 302 54B in 213.313Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000195] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57932 - 200 2949B in 249.171Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1783}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000196] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57932 - 302 0B in 36.28539ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000197] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57932 - 302 57B in 745.78Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000198] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57940 - 302 60B in 324.733Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4190,"userId":1783}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000199] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57954 - 302 56B in 1.31265ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4190,"codeId":835,"userId":1783}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000200] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57968 - 302 232B in 783.2Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":835}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000201] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57978 - 200 4334B in 12.186857ms
2025/11/25 13:25:00 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"sydneebayer@dietrich.biz","loggedInUser":"89aaba8f-f457-4520-8c99-26d7dc4feef1","userId":1783}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000202] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:57992 - 200 141B in 1.747192ms
2025/11/25 13:25:00 INFO {"audit_event":"verified_email","details":{"loggedInUser":"89aaba8f-f457-4520-8c99-26d7dc4feef1","userId":1783}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000203] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58002 - 200 696B in 896.223Âµs
--- PASS: TestAPIAccountEmailVerification_VerifySuccess (0.10s)
=== RUN   TestAPIAccountEmailVerification_VerifyInvalidCode
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000204] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-TcCYoywo&redirect_uri=https%3A%2F%2Fwww.globalrecontextualize.biz%2Fdeliver%2Farchitectures%2Fsupply-chains&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=LgFDCQDb&nonce=ZfLuzNaa HTTP/1.1" from [::1]:58018 - 302 57B in 454.449Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000205] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58030 - 302 54B in 154.802Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000206] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58046 - 200 2949B in 229.624Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1784}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000207] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58046 - 302 0B in 36.011443ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000208] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58046 - 302 57B in 359.189Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000209] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58060 - 302 60B in 335.844Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4191,"userId":1784}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000210] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58064 - 302 56B in 1.376421ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4191,"codeId":836,"userId":1784}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000211] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58070 - 302 249B in 786.987Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":836}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000212] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58084 - 200 4326B in 12.147954ms
2025/11/25 13:25:00 INFO {"audit_event":"failed_email_verification_code","details":{"loggedInUser":"fb37ed9a-fdfe-4d99-9095-477c6596268d","userId":1784}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000213] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58094 - 400 107B in 326.988Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyInvalidCode (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifyExpiredCode
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000214] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-poPCyDIZ&redirect_uri=http%3A%2F%2Fwww.humanwireless.com%2Fembrace%2Fcross-platform&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=nSTwFEDq&nonce=NiSrtNlj HTTP/1.1" from [::1]:58100 - 302 57B in 417.408Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000215] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58104 - 302 54B in 140.486Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000216] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58106 - 200 2949B in 240.875Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1785}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000217] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58106 - 302 0B in 35.100131ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000218] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58106 - 302 57B in 825.159Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000219] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58112 - 302 60B in 319.985Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4192,"userId":1785}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000220] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58128 - 302 56B in 1.68821ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4192,"codeId":837,"userId":1785}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000221] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58138 - 302 227B in 902.164Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":837}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000222] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58148 - 200 4336B in 12.25695ms
2025/11/25 13:25:00 INFO {"audit_event":"failed_email_verification_code","details":{"loggedInUser":"cd7ae487-fecd-4119-9289-55ffda9ff214","userId":1785}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000223] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58152 - 400 107B in 383.043Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyExpiredCode (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifyAlreadyVerified
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000224] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-fVoxOFsD&redirect_uri=https%3A%2F%2Fwww.legacyexpedite.name%2Ffunctionalities&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=GMcqPYKV&nonce=CNfoJUVu HTTP/1.1" from [::1]:58160 - 302 57B in 689.152Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000225] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58176 - 302 54B in 195.88Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000226] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58190 - 200 2949B in 727.905Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1786}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000227] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58190 - 302 0B in 37.048934ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000228] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58190 - 302 57B in 460.6Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000229] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58194 - 302 60B in 578.924Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4193,"userId":1786}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000230] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58204 - 302 56B in 1.623698ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4193,"codeId":838,"userId":1786}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000231] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58210 - 302 223B in 970.343Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":838}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000232] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58218 - 200 4344B in 12.623572ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000233] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58232 - 200 698B in 379.928Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyAlreadyVerified (0.10s)
=== RUN   TestAPIAccountEmailVerification_VerifySMTPDisabled
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000234] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-oaMlZTdn&redirect_uri=https%3A%2F%2Fwww.forwardnext-generation.biz%2Fcollaborative%2Fsolutions&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=RdykWWMX&nonce=KgGaOCzs HTTP/1.1" from [::1]:58238 - 302 57B in 631.744Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000235] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58252 - 302 54B in 175.262Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000236] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58266 - 200 2949B in 285.259Âµs
2025/11/25 13:25:00 INFO {"audit_event":"auth_success_pwd","details":{"userId":1787}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000237] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58266 - 302 0B in 35.771911ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000238] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58266 - 302 57B in 308.503Âµs
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000239] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58270 - 302 60B in 416.558Âµs
2025/11/25 13:25:00 INFO {"audit_event":"started_new_user_session","details":{"clientId":4194,"userId":1787}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000240] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58278 - 302 56B in 1.331326ms
2025/11/25 13:25:00 INFO {"audit_event":"created_auth_code","details":{"clientId":4194,"codeId":839,"userId":1787}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000241] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58292 - 302 238B in 880.464Âµs
2025/11/25 13:25:00 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":839}}
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58296 - 200 4326B in 12.500129ms
2025/11/25 13:25:00 [a357f2e3b56e/8P1BS7F7Qi-000243] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58306 - 400 70B in 302.742Âµs
--- PASS: TestAPIAccountEmailVerification_VerifySMTPDisabled (0.10s)
=== RUN   TestAPIAccountEmailVerification_VerifyInvalidRequestBody
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000244] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-WGCKEOWx&redirect_uri=http%3A%2F%2Fwww.districtback-end.net%2Fvisionary%2Fbricks-and-clicks%2Fdynamic%2Fkiller&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=WQqYtRHz&nonce=pcvmPHPv HTTP/1.1" from [::1]:58316 - 302 57B in 409.995Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000245] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58324 - 302 54B in 176.083Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000246] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58336 - 200 2949B in 236.066Âµs
2025/11/25 13:25:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":1788}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000247] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58336 - 302 0B in 35.403374ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000248] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58336 - 302 57B in 265.651Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000249] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58350 - 302 60B in 268.146Âµs
2025/11/25 13:25:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":4195,"userId":1788}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000250] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58354 - 302 56B in 1.241897ms
2025/11/25 13:25:01 INFO {"audit_event":"created_auth_code","details":{"clientId":4195,"codeId":840,"userId":1788}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000251] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58360 - 302 250B in 786.095Âµs
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":840}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000252] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58376 - 200 4330B in 12.522782ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000253] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58388 - 400 75B in 271.382Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyInvalidRequestBody (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifyUnauthorized
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000254] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58392 - 401 22B in 58.33Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyUnauthorized (0.00s)
=== RUN   TestAPIAccountLogoutRequest_Success_And_LogoutFlow_WithAndWithoutCookie
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000255] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-pejmpFgY&redirect_uri=http%3A%2F%2Fwww.centralincentivize.biz%2Fmaximize%2Fimpactful&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=QgHQPLVj&nonce=VwtGcnLA HTTP/1.1" from [::1]:58404 - 302 57B in 412.649Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000256] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58406 - 302 54B in 155.023Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000257] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58416 - 200 2949B in 236.797Âµs
2025/11/25 13:25:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":1789}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000258] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58416 - 302 0B in 35.211441ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000259] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58416 - 302 57B in 256.174Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000260] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58424 - 302 60B in 248.239Âµs
2025/11/25 13:25:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":4196,"userId":1789}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000261] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58434 - 302 56B in 1.232379ms
2025/11/25 13:25:01 INFO {"audit_event":"created_auth_code","details":{"clientId":4196,"codeId":841,"userId":1789}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000262] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58440 - 302 228B in 800.172Âµs
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":841}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000263] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58456 - 200 4346B in 12.169324ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000264] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58464 - 200 1220B in 171.026642ms
2025/11/25 13:25:01 INFO {"audit_event":"deleted_user_session_client","details":{"clientId":4196,"loggedInUser":"","userId":1789,"userSessionId":1758}}
2025/11/25 13:25:01 INFO {"audit_event":"logout","details":{"loggedInUser":"","sessionIdentifier":"a2b5d372-7825-41d0-a247-6e7c32c6c378","userId":1789}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000265] "GET http://localhost:19090/auth/logout?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzNmNlMzg0LTcwYmEtNGYxZC1hNDQ4LTYxMmI5YjcyMGY0MyIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhY2N0c2NvcGUtY2xpZW50LXBlam1wRmdZIiwiZXhwIjoxNzY0MDc3MTYxLCJpYXQiOjE3NjQwNzcxMDEsImlzcyI6Imlzc3Vlci1ueW5PRXQiLCJzaWQiOiJhMmI1ZDM3Mi03ODI1LTQxZDAtYTI0Ny02ZTdjMzJjNmMzNzgiLCJzdWIiOiJhOTA4ZWU4ZS1iNDNlLTRkM2EtOTY1NC00YzQ4NGRiYzQ3M2EiLCJ0eXAiOiJJRCJ9.yEXaY6Y_KRdeoYOtFbYsn-esOlFEr6UrgeJUwSsrAC5UbnKkpfhF2mV8FjLGzwc09Aq0-lKzPyzgltPzEmmRYdahEYf9FUEvcUe72y5JdSuX-MwFGqkBfCjRZ5gkBE1WuwXDwTu0eFXqro3bio0inpbpBQ31BqNXKqwIyzKMacUAKpMDQV9NuWNw6BzYzaciSZMcU1OUosUi-ysVCgULi2_-81xtZZd2VmmU3rrJ4XjLahxlS-aL3l7tZ4uu52sldVFL2V4vWwQux7drCBREt0maGLAXkAxZ0Gy8k3sB2pkBmisF26n5nO3494kJbmO8cY06-_FpTSmXc689kxVggD4OZl5xb-AB9wOuhcAQgFft7YVuxvfUKaiXrzpCS-Qeb04l3VQVz4ZxndPEEC6Hn3eluNz2UY3YpjGpKS6xy6pgb3jeFOVYntyp6uzPrinl2fUEWkVr990576A2bU_4bxNnav-e2nKFDo6pka11VD4IMmpQTssCwtJkjMqN9orTQL4H9b9H-ngs1U0p-Zp_yb5eEZNvnTgS7ryifAHUJHfyTyF6r7pMySFXqVVNNP6QIejAvyr3b0yGNstkxZ-rwLbp2JFhCnadMSW229qGEbMaO9lZcGk9vGpGoIWhEnXeX7yXW0rgES0dsbNGTQa6XYkRedR6hwpBGWvBzoMVupY&post_logout_redirect_uri=http%3A%2F%2Fwww.centralincentivize.biz%2Fmaximize%2Fimpactful&state=pJMpboqpJyAB HTTP/1.1" from [::1]:58456 - 302 139B in 3.19139ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000266] "GET http://localhost:19090/auth/logout?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IjMzNmNlMzg0LTcwYmEtNGYxZC1hNDQ4LTYxMmI5YjcyMGY0MyIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhY2N0c2NvcGUtY2xpZW50LXBlam1wRmdZIiwiZXhwIjoxNzY0MDc3MTYxLCJpYXQiOjE3NjQwNzcxMDEsImlzcyI6Imlzc3Vlci1ueW5PRXQiLCJzaWQiOiJhMmI1ZDM3Mi03ODI1LTQxZDAtYTI0Ny02ZTdjMzJjNmMzNzgiLCJzdWIiOiJhOTA4ZWU4ZS1iNDNlLTRkM2EtOTY1NC00YzQ4NGRiYzQ3M2EiLCJ0eXAiOiJJRCJ9.yEXaY6Y_KRdeoYOtFbYsn-esOlFEr6UrgeJUwSsrAC5UbnKkpfhF2mV8FjLGzwc09Aq0-lKzPyzgltPzEmmRYdahEYf9FUEvcUe72y5JdSuX-MwFGqkBfCjRZ5gkBE1WuwXDwTu0eFXqro3bio0inpbpBQ31BqNXKqwIyzKMacUAKpMDQV9NuWNw6BzYzaciSZMcU1OUosUi-ysVCgULi2_-81xtZZd2VmmU3rrJ4XjLahxlS-aL3l7tZ4uu52sldVFL2V4vWwQux7drCBREt0maGLAXkAxZ0Gy8k3sB2pkBmisF26n5nO3494kJbmO8cY06-_FpTSmXc689kxVggD4OZl5xb-AB9wOuhcAQgFft7YVuxvfUKaiXrzpCS-Qeb04l3VQVz4ZxndPEEC6Hn3eluNz2UY3YpjGpKS6xy6pgb3jeFOVYntyp6uzPrinl2fUEWkVr990576A2bU_4bxNnav-e2nKFDo6pka11VD4IMmpQTssCwtJkjMqN9orTQL4H9b9H-ngs1U0p-Zp_yb5eEZNvnTgS7ryifAHUJHfyTyF6r7pMySFXqVVNNP6QIejAvyr3b0yGNstkxZ-rwLbp2JFhCnadMSW229qGEbMaO9lZcGk9vGpGoIWhEnXeX7yXW0rgES0dsbNGTQa6XYkRedR6hwpBGWvBzoMVupY&post_logout_redirect_uri=http%3A%2F%2Fwww.centralincentivize.biz%2Fmaximize%2Fimpactful&state=pJMpboqpJyAB HTTP/1.1" from [::1]:58476 - 302 139B in 698.31Âµs
--- PASS: TestAPIAccountLogoutRequest_Success_And_LogoutFlow_WithAndWithoutCookie (0.27s)
=== RUN   TestAPIAccountLogoutRequest_ValidationErrors_And_Scope
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000267] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ROXCdOGe&redirect_uri=https%3A%2F%2Fwww.districtwebservices.name%2F24-365%2Fwireless%2Fredefine%2Fsolutions&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=hCsaRIVJ&nonce=TbuoUjAz HTTP/1.1" from [::1]:58480 - 302 57B in 644.428Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000268] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58486 - 302 54B in 288.384Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000269] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58494 - 200 2949B in 642.925Âµs
2025/11/25 13:25:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":1790}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000270] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58494 - 302 0B in 35.860738ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000271] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58494 - 302 57B in 307.33Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000272] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58504 - 302 60B in 278.446Âµs
2025/11/25 13:25:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":4197,"userId":1790}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000273] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58510 - 302 56B in 1.425053ms
2025/11/25 13:25:01 INFO {"audit_event":"created_auth_code","details":{"clientId":4197,"codeId":842,"userId":1790}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000274] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58524 - 302 247B in 856.178Âµs
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":842}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58530 - 200 4322B in 12.305241ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000276] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58536 - 400 84B in 293.695Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000277] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58550 - 400 128B in 160.153376ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000278] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58552 - 401 22B in 177.696Âµs
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4198}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58568 - 200 1165B in 4.251863ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000280] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58582 - 403 19B in 495.786Âµs
--- PASS: TestAPIAccountLogoutRequest_ValidationErrors_And_Scope (0.27s)
=== RUN   TestAPIAccountOTPEnrollmentGet_Success
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000281] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-CYzxOxGe&redirect_uri=http%3A%2F%2Fwww.nationalend-to-end.com%2Fvirtual%2Fkiller%2Fimplement%2Fintegrate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=LIRvzFTg&nonce=LfMAqHsV HTTP/1.1" from [::1]:58594 - 302 57B in 449.149Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000282] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58604 - 302 54B in 196.782Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000283] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58620 - 200 2949B in 260.803Âµs
2025/11/25 13:25:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":1791}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000284] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58620 - 302 0B in 35.732976ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000285] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58620 - 302 57B in 253.799Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000286] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58632 - 302 60B in 259.21Âµs
2025/11/25 13:25:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":4199,"userId":1791}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000287] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58644 - 302 56B in 1.882046ms
2025/11/25 13:25:01 INFO {"audit_event":"created_auth_code","details":{"clientId":4199,"codeId":843,"userId":1791}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000288] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58646 - 302 244B in 821.762Âµs
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":843}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000289] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58660 - 200 4328B in 12.186076ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000290] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:58668 - 200 693B in 394.074Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000291] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:58670 - 200 2198B in 3.391969ms
--- PASS: TestAPIAccountOTPEnrollmentGet_Success (0.10s)
=== RUN   TestAPIAccountOTPEnrollmentGet_AlreadyEnabled
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000292] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-iHnpDfMY&redirect_uri=https%3A%2F%2Fwww.forwardunleash.net%2Fmetrics%2Ftarget&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=eidbgKfX&nonce=sdfXzMJN HTTP/1.1" from [::1]:58686 - 302 57B in 485.718Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000293] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58700 - 302 54B in 162.597Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000294] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58714 - 200 2949B in 233.872Âµs
2025/11/25 13:25:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":1792}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000295] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58714 - 302 0B in 36.129405ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000296] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58714 - 302 57B in 253.99Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000297] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58718 - 302 60B in 731.563Âµs
2025/11/25 13:25:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":4200,"userId":1792}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000298] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58730 - 302 56B in 1.568534ms
2025/11/25 13:25:01 INFO {"audit_event":"created_auth_code","details":{"clientId":4200,"codeId":844,"userId":1792}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000299] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58738 - 302 221B in 1.062307ms
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":844}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000300] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58750 - 200 4336B in 12.785027ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000301] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:58766 - 200 696B in 452.184Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000302] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:58774 - 400 76B in 452.705Âµs
--- PASS: TestAPIAccountOTPEnrollmentGet_AlreadyEnabled (0.09s)
=== RUN   TestAPIAccountOTPEnrollmentGet_UnauthorizedAndScope
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000303] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:58778 - 401 22B in 131.037Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000304] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:58792 - 401 22B in 221.92Âµs
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4201}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000305] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58798 - 200 1165B in 4.1599ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000306] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:58808 - 403 19B in 605.334Âµs
--- PASS: TestAPIAccountOTPEnrollmentGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountOTPPut_Enable_Success
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000307] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-TGdmHLDt&redirect_uri=http%3A%2F%2Fwww.districtcollaborative.io%2Ftransform%2Fweb-readiness%2Fseize%2Fseamless&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=jAkKUmey&nonce=VwYEBlGd HTTP/1.1" from [::1]:58810 - 302 57B in 529.41Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000308] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58826 - 302 54B in 161.294Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000309] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58834 - 200 2949B in 307.281Âµs
2025/11/25 13:25:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":1793}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000310] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58834 - 302 0B in 36.1953ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000311] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58834 - 302 57B in 302.913Âµs
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000312] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58850 - 302 60B in 1.038472ms
2025/11/25 13:25:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":4202,"userId":1793}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000313] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58864 - 302 56B in 1.367985ms
2025/11/25 13:25:01 INFO {"audit_event":"created_auth_code","details":{"clientId":4202,"codeId":845,"userId":1793}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000314] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58880 - 302 250B in 860.096Âµs
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":845}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000315] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58890 - 200 4326B in 13.141119ms
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000316] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:58900 - 200 692B in 652.793Âµs
2025/11/25 13:25:01 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4203}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000317] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58906 - 200 1156B in 4.14433ms
2025/11/25 13:25:01 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-TnkjwUEz","userId":1793}}
2025/11/25 13:25:01 [a357f2e3b56e/8P1BS7F7Qi-000318] "PUT http://localhost:19090/api/v1/admin/users/1793/password HTTP/1.1" from [::1]:58916 - 200 692B in 36.763925ms
2025/11/25 13:25:02 INFO {"audit_event":"enabled_otp","details":{"userId":1793}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000319] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:58924 - 200 691B in 38.027432ms
--- PASS: TestAPIAccountOTPPut_Enable_Success (0.21s)
=== RUN   TestAPIAccountOTPPut_Enable_AuthFailed
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000320] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-tJKmNqCj&redirect_uri=http%3A%2F%2Fwww.dynamicaction-items.name%2Fgenerate%2Fcutting-edge%2Ffrictionless&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=misXOmOx&nonce=XMBvEPYj HTTP/1.1" from [::1]:58928 - 302 57B in 732.183Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000321] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58942 - 302 54B in 190.349Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000322] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58946 - 200 2949B in 327.159Âµs
2025/11/25 13:25:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":1794}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000323] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58946 - 302 0B in 36.347167ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000324] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58946 - 302 57B in 1.059592ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000325] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58956 - 302 60B in 547.865Âµs
2025/11/25 13:25:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":4204,"userId":1794}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000326] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58958 - 302 56B in 1.560879ms
2025/11/25 13:25:02 INFO {"audit_event":"created_auth_code","details":{"clientId":4204,"codeId":846,"userId":1794}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000327] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58974 - 302 246B in 913.957Âµs
2025/11/25 13:25:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":846}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000328] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58980 - 200 4312B in 12.806698ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000329] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:58990 - 200 687B in 484.766Âµs
2025/11/25 13:25:02 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4205}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59000 - 200 1156B in 4.142838ms
2025/11/25 13:25:02 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-UjEssGFL","userId":1794}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000331] "PUT http://localhost:19090/api/v1/admin/users/1794/password HTTP/1.1" from [::1]:59010 - 200 687B in 37.20104ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000332] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59022 - 400 113B in 36.103377ms
--- PASS: TestAPIAccountOTPPut_Enable_AuthFailed (0.21s)
=== RUN   TestAPIAccountOTPPut_Enable_InvalidFormats
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000333] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-sExAGTPc&redirect_uri=https%3A%2F%2Fwww.leadinfomediaries.biz%2Fdeliver&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=lxtLihuR&nonce=vweXOwwP HTTP/1.1" from [::1]:59028 - 302 57B in 888.669Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000334] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59032 - 302 54B in 371.873Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000335] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59048 - 200 2949B in 1.012864ms
2025/11/25 13:25:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":1795}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000336] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59048 - 302 0B in 36.575429ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000337] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59048 - 302 57B in 546.041Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000338] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59050 - 302 60B in 511.647Âµs
2025/11/25 13:25:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":4206,"userId":1795}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000339] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59052 - 302 56B in 1.649437ms
2025/11/25 13:25:02 INFO {"audit_event":"created_auth_code","details":{"clientId":4206,"codeId":847,"userId":1795}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000340] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59066 - 302 217B in 1.149012ms
2025/11/25 13:25:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":847}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000341] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59070 - 200 4342B in 14.135188ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000342] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59086 - 200 698B in 667.07Âµs
2025/11/25 13:25:02 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4207}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000343] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59098 - 200 1156B in 4.271951ms
2025/11/25 13:25:02 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-szbrflbA","userId":1795}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000344] "PUT http://localhost:19090/api/v1/admin/users/1795/password HTTP/1.1" from [::1]:59100 - 200 698B in 37.832163ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000345] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59114 - 400 68B in 36.592381ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000346] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59116 - 400 79B in 37.519923ms
--- PASS: TestAPIAccountOTPPut_Enable_InvalidFormats (0.26s)
=== RUN   TestAPIAccountOTPPut_Enable_WrongCode
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000347] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-zGlAQyKA&redirect_uri=http%3A%2F%2Fwww.seniormesh.com%2Fproactive%2Finterfaces%2Fe-markets%2Ffrictionless&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=XhLCMFUZ&nonce=wTNHvJVz HTTP/1.1" from [::1]:59118 - 302 57B in 659.887Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000348] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59132 - 302 54B in 201.41Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000349] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59144 - 200 2949B in 267.355Âµs
2025/11/25 13:25:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":1796}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000350] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59144 - 302 0B in 36.937112ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000351] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59144 - 302 57B in 376.912Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000352] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59158 - 302 60B in 560.278Âµs
2025/11/25 13:25:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":4208,"userId":1796}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000353] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59174 - 302 56B in 1.999178ms
2025/11/25 13:25:02 INFO {"audit_event":"created_auth_code","details":{"clientId":4208,"codeId":848,"userId":1796}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000354] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59184 - 302 245B in 869.463Âµs
2025/11/25 13:25:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":848}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000355] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59186 - 200 4338B in 13.214749ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000356] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59194 - 200 697B in 488.874Âµs
2025/11/25 13:25:02 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4209}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000357] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59210 - 200 1156B in 4.151043ms
2025/11/25 13:25:02 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-GnhpZJHv","userId":1796}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000358] "PUT http://localhost:19090/api/v1/admin/users/1796/password HTTP/1.1" from [::1]:59220 - 200 697B in 38.220267ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000359] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59234 - 400 209B in 36.870436ms
--- PASS: TestAPIAccountOTPPut_Enable_WrongCode (0.23s)
=== RUN   TestAPIAccountOTPPut_Disable_Success
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000360] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-DvVTYnZv&redirect_uri=http%3A%2F%2Fwww.customerroi.name%2Fback-end%2Fdistributed%2Froi&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=rIoReymM&nonce=TcroeZxq HTTP/1.1" from [::1]:59250 - 302 57B in 676.969Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000361] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59264 - 302 54B in 603.69Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000362] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59272 - 200 2949B in 489.385Âµs
2025/11/25 13:25:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":1797}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000363] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59272 - 302 0B in 36.338531ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000364] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59272 - 302 57B in 507.078Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000365] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59274 - 302 60B in 427.127Âµs
2025/11/25 13:25:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":4210,"userId":1797}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000366] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59278 - 302 56B in 1.545901ms
2025/11/25 13:25:02 INFO {"audit_event":"created_auth_code","details":{"clientId":4210,"codeId":849,"userId":1797}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000367] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59284 - 302 228B in 863.712Âµs
2025/11/25 13:25:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":849}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000368] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59288 - 200 4342B in 12.661663ms
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000369] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59296 - 200 698B in 418.781Âµs
2025/11/25 13:25:02 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4211}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000370] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59300 - 200 1156B in 4.187592ms
2025/11/25 13:25:02 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-GZdrUXzF","userId":1797}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000371] "PUT http://localhost:19090/api/v1/admin/users/1797/password HTTP/1.1" from [::1]:59316 - 200 698B in 37.605114ms
2025/11/25 13:25:02 INFO {"audit_event":"disabled_otp","details":{"userId":1797}}
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000372] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59328 - 200 696B in 38.708489ms
--- PASS: TestAPIAccountOTPPut_Disable_Success (0.22s)
=== RUN   TestAPIAccountOTPPut_Enable_SetsSessionFlag
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000373] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-lSXMnAPw&redirect_uri=https%3A%2F%2Fwww.districtrevolutionize.biz%2Fexpedite%2Fnetworks%2Fnext-generation&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=tyRpjIop&nonce=zUDoinuJ HTTP/1.1" from [::1]:59344 - 302 57B in 646.141Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000374] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59356 - 302 54B in 175.502Âµs
2025/11/25 13:25:02 [a357f2e3b56e/8P1BS7F7Qi-000375] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59364 - 200 2949B in 277.054Âµs
2025/11/25 13:25:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":1798}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000376] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59364 - 302 0B in 36.609924ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000377] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59364 - 302 57B in 459.338Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000378] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59378 - 302 60B in 306.709Âµs
2025/11/25 13:25:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":4212,"userId":1798}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000379] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59390 - 302 56B in 1.432977ms
2025/11/25 13:25:03 INFO {"audit_event":"created_auth_code","details":{"clientId":4212,"codeId":850,"userId":1798}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000380] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59400 - 302 247B in 1.023754ms
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":850}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000381] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59416 - 200 4352B in 12.337071ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000382] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59430 - 200 702B in 391.11Âµs
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4213}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59434 - 200 1156B in 4.507767ms
2025/11/25 13:25:03 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-BEVCZpSD","userId":1798}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000384] "PUT http://localhost:19090/api/v1/admin/users/1798/password HTTP/1.1" from [::1]:59438 - 200 701B in 37.368317ms
2025/11/25 13:25:03 INFO {"audit_event":"enabled_otp","details":{"userId":1798}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000385] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59440 - 200 701B in 37.619992ms
--- PASS: TestAPIAccountOTPPut_Enable_SetsSessionFlag (0.21s)
=== RUN   TestAPIAccountOTPPut_Disable_SetsSessionFlag
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000386] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-OhyfZJWH&redirect_uri=http%3A%2F%2Fwww.principalorchestrate.name%2Fdeliver&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=iKHXlVJO&nonce=dJAjzLBz HTTP/1.1" from [::1]:59448 - 302 57B in 584.985Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000387] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59450 - 302 54B in 186.783Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000388] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59454 - 200 2949B in 879.593Âµs
2025/11/25 13:25:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":1799}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000389] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59454 - 302 0B in 36.348991ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000390] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59454 - 302 57B in 369.458Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000391] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59464 - 302 60B in 595.155Âµs
2025/11/25 13:25:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":4214,"userId":1799}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000392] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59466 - 302 56B in 1.647022ms
2025/11/25 13:25:03 INFO {"audit_event":"created_auth_code","details":{"clientId":4214,"codeId":851,"userId":1799}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000393] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59482 - 302 220B in 1.106561ms
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":851}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000394] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59498 - 200 4342B in 12.738098ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000395] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59508 - 200 698B in 620.593Âµs
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4215}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000396] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59522 - 200 1156B in 4.107972ms
2025/11/25 13:25:03 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-vhnflIUm","userId":1799}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000397] "PUT http://localhost:19090/api/v1/admin/users/1799/password HTTP/1.1" from [::1]:59526 - 200 698B in 37.135918ms
2025/11/25 13:25:03 INFO {"audit_event":"disabled_otp","details":{"userId":1799}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000398] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59540 - 200 698B in 38.430454ms
--- PASS: TestAPIAccountOTPPut_Disable_SetsSessionFlag (0.21s)
=== RUN   TestAPIAccountOTPPut_Disable_NotEnabled
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000399] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-AsnjNubF&redirect_uri=https%3A%2F%2Fwww.districtsticky.net%2Fevolve%2Fwireless%2Fparadigms&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=GxIgjqQE&nonce=uGbjKhgY HTTP/1.1" from [::1]:59552 - 302 57B in 558.525Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000400] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59566 - 302 54B in 312.56Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000401] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59568 - 200 2949B in 376.161Âµs
2025/11/25 13:25:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":1800}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000402] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59568 - 302 0B in 35.724551ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000403] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59568 - 302 57B in 288.716Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000404] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59582 - 302 60B in 316.398Âµs
2025/11/25 13:25:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":4216,"userId":1800}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000405] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59586 - 302 56B in 1.35536ms
2025/11/25 13:25:03 INFO {"audit_event":"created_auth_code","details":{"clientId":4216,"codeId":852,"userId":1800}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000406] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59602 - 302 232B in 812.044Âµs
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":852}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000407] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59618 - 200 4338B in 14.605817ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000408] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59620 - 200 697B in 386.671Âµs
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4217}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000409] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59628 - 200 1156B in 4.013072ms
2025/11/25 13:25:03 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-iaZzxbXn","userId":1800}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000410] "PUT http://localhost:19090/api/v1/admin/users/1800/password HTTP/1.1" from [::1]:59640 - 200 697B in 36.367155ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000411] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59642 - 400 80B in 36.41696ms
--- PASS: TestAPIAccountOTPPut_Disable_NotEnabled (0.21s)
=== RUN   TestAPIAccountOTPPut_UnauthorizedAndScope
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000412] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59656 - 401 22B in 101.292Âµs
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4218}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000413] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59664 - 200 1165B in 4.037198ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000414] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59672 - 403 19B in 296.991Âµs
--- PASS: TestAPIAccountOTPPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPasswordPut_Success
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000415] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ySFoZpOP&redirect_uri=https%3A%2F%2Fwww.dynamicseamless.com%2Fintegrated%2Fcross-platform%2Fusers%2Fengineer&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=TkmGEtHN&nonce=hGhXavPR HTTP/1.1" from [::1]:59682 - 302 57B in 515.884Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000416] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59694 - 302 54B in 198.345Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000417] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59710 - 200 2949B in 332.108Âµs
2025/11/25 13:25:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":1801}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000418] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59710 - 302 0B in 36.111121ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000419] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59710 - 302 57B in 481.59Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000420] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59714 - 302 60B in 286.311Âµs
2025/11/25 13:25:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":4219,"userId":1801}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000421] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59722 - 302 56B in 1.294657ms
2025/11/25 13:25:03 INFO {"audit_event":"created_auth_code","details":{"clientId":4219,"codeId":853,"userId":1801}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000422] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59728 - 302 248B in 831.12Âµs
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":853}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000423] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59734 - 200 4328B in 12.36352ms
2025/11/25 13:25:03 INFO {"audit_event":"changed_password","details":{"loggedInUser":"fcba2f96-e942-49a5-95fa-965768d8bb77","userId":1801}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000424] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59740 - 200 696B in 72.219557ms
--- PASS: TestAPIAccountPasswordPut_Success (0.24s)
=== RUN   TestAPIAccountPasswordPut_WrongCurrentPassword
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000425] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-lYgrEJZn&redirect_uri=https%3A%2F%2Fwww.centralenterprise.name%2Fturn-key&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=dQvTjMbD&nonce=qinmjVLj HTTP/1.1" from [::1]:59748 - 302 57B in 636.312Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000426] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59754 - 302 54B in 174.37Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000427] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59764 - 200 2949B in 261.173Âµs
2025/11/25 13:25:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":1802}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000428] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59764 - 302 0B in 35.107354ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000429] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59764 - 302 57B in 347.917Âµs
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000430] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59768 - 302 60B in 315.426Âµs
2025/11/25 13:25:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":4220,"userId":1802}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000431] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59780 - 302 56B in 1.427467ms
2025/11/25 13:25:03 INFO {"audit_event":"created_auth_code","details":{"clientId":4220,"codeId":854,"userId":1802}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000432] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59788 - 302 219B in 814.57Âµs
2025/11/25 13:25:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":854}}
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000433] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59802 - 200 4346B in 13.767564ms
2025/11/25 13:25:03 [a357f2e3b56e/8P1BS7F7Qi-000434] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59810 - 400 121B in 35.456153ms
--- PASS: TestAPIAccountPasswordPut_WrongCurrentPassword (0.16s)
=== RUN   TestAPIAccountPasswordPut_ValidationErrors
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000435] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ivfTxmpC&redirect_uri=https%3A%2F%2Fwww.humanimpactful.biz%2Fmatrix&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=hbKpObNp&nonce=PKcHXWdJ HTTP/1.1" from [::1]:59812 - 302 57B in 510.434Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000436] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59822 - 302 54B in 180.561Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000437] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59838 - 200 2949B in 245.975Âµs
2025/11/25 13:25:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":1803}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000438] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59838 - 302 0B in 35.529082ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000439] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59838 - 302 57B in 670.567Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000440] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59848 - 302 60B in 453.417Âµs
2025/11/25 13:25:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":4221,"userId":1803}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000441] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59856 - 302 56B in 1.466331ms
2025/11/25 13:25:04 INFO {"audit_event":"created_auth_code","details":{"clientId":4221,"codeId":855,"userId":1803}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000442] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59862 - 302 213B in 969.703Âµs
2025/11/25 13:25:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":855}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000443] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59876 - 200 4314B in 13.504376ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000444] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59882 - 400 89B in 649.467Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000445] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59896 - 400 77B in 312.751Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000446] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59912 - 400 102B in 35.411218ms
--- PASS: TestAPIAccountPasswordPut_ValidationErrors (0.17s)
=== RUN   TestAPIAccountPasswordPut_UnauthorizedAndScope
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000447] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59918 - 401 22B in 128.182Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000448] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59920 - 401 22B in 455.841Âµs
2025/11/25 13:25:04 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4222}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000449] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59928 - 200 1165B in 4.43527ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000450] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59940 - 403 19B in 327.199Âµs
--- PASS: TestAPIAccountPasswordPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPasswordPut_InvalidRequestBody
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000451] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-SnyrXOXd&redirect_uri=http%3A%2F%2Fwww.internalb2b.biz%2Fstrategic%2Fseize%2Fweb-enabled%2Fe-markets&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=TFuyoyIM&nonce=xHPTbzde HTTP/1.1" from [::1]:59942 - 302 57B in 617.577Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000452] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59958 - 302 54B in 247.117Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000453] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59960 - 200 2949B in 272.204Âµs
2025/11/25 13:25:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":1804}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000454] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59960 - 302 0B in 35.590617ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000455] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59960 - 302 57B in 352.506Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000456] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59964 - 302 60B in 753.995Âµs
2025/11/25 13:25:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":4223,"userId":1804}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000457] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59978 - 302 56B in 1.796415ms
2025/11/25 13:25:04 INFO {"audit_event":"created_auth_code","details":{"clientId":4223,"codeId":856,"userId":1804}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000458] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59994 - 302 240B in 957.459Âµs
2025/11/25 13:25:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":856}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000459] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60008 - 200 4346B in 12.630545ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000460] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60020 - 400 75B in 346.274Âµs
--- PASS: TestAPIAccountPasswordPut_InvalidRequestBody (0.09s)
=== RUN   TestAPIAccountPhonePut_Success
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000461] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-nDzyUiNZ&redirect_uri=http%3A%2F%2Fwww.futuremarkets.biz%2Fe-business%2Fwireless&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=lQtadwix&nonce=JEYWufnf HTTP/1.1" from [::1]:60024 - 302 57B in 413.741Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000462] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60028 - 302 54B in 183.167Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000463] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60042 - 200 2949B in 270.882Âµs
2025/11/25 13:25:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":1805}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000464] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60042 - 302 0B in 35.596799ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000465] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60042 - 302 57B in 367.665Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000466] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60044 - 302 60B in 359.108Âµs
2025/11/25 13:25:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":4224,"userId":1805}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000467] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60052 - 302 56B in 1.438598ms
2025/11/25 13:25:04 INFO {"audit_event":"created_auth_code","details":{"clientId":4224,"codeId":857,"userId":1805}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000468] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60058 - 302 224B in 798.309Âµs
2025/11/25 13:25:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":857}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000469] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60074 - 200 4320B in 13.461696ms
2025/11/25 13:25:04 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"46054852-966a-4ce4-8b82-5ec5bd39ece5","userId":1805}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000470] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36380 - 200 712B in 130.88817ms
--- PASS: TestAPIAccountPhonePut_Success (0.22s)
=== RUN   TestAPIAccountPhonePut_ClearPhone
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000471] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-SroaMbZT&redirect_uri=http%3A%2F%2Fwww.internalmodels.info%2Futilize%2Fenable%2Frobust&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=BvRXPeoZ&nonce=dGgxFePh HTTP/1.1" from [::1]:36382 - 302 57B in 590.316Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000472] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36390 - 302 54B in 194.578Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000473] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36396 - 200 2949B in 773.571Âµs
2025/11/25 13:25:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":1806}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000474] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36396 - 302 0B in 37.101692ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000475] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36396 - 302 57B in 968.23Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000476] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36398 - 302 60B in 359.659Âµs
2025/11/25 13:25:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":4225,"userId":1806}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000477] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36406 - 302 56B in 1.507308ms
2025/11/25 13:25:04 INFO {"audit_event":"created_auth_code","details":{"clientId":4225,"codeId":858,"userId":1806}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000478] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36412 - 302 228B in 1.012283ms
2025/11/25 13:25:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":858}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000479] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36422 - 200 4330B in 12.422301ms
2025/11/25 13:25:04 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"3b151548-95ab-4d55-975a-fcf2b6650dde","userId":1806}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000480] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36434 - 200 716B in 128.150408ms
2025/11/25 13:25:04 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"3b151548-95ab-4d55-975a-fcf2b6650dde","userId":1806}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000481] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36436 - 200 697B in 2.023413ms
--- PASS: TestAPIAccountPhonePut_ClearPhone (0.23s)
=== RUN   TestAPIAccountPhonePut_ValidationErrors
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000482] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-siXNpmVO&redirect_uri=http%3A%2F%2Fwww.districtintegrate.net%2Frepurpose&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=Xpmshksw&nonce=SiPpBydR HTTP/1.1" from [::1]:36446 - 302 57B in 651.26Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000483] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36456 - 302 54B in 406.919Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000484] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36466 - 200 2949B in 308.532Âµs
2025/11/25 13:25:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":1807}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000485] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36466 - 302 0B in 35.959525ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000486] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36466 - 302 57B in 488.313Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000487] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36474 - 302 60B in 480.308Âµs
2025/11/25 13:25:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":4226,"userId":1807}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000488] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36488 - 302 56B in 1.536574ms
2025/11/25 13:25:04 INFO {"audit_event":"created_auth_code","details":{"clientId":4226,"codeId":859,"userId":1807}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000489] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36504 - 302 218B in 1.02147ms
2025/11/25 13:25:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":859}}
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000490] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36508 - 200 4320B in 14.589426ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000491] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36510 - 400 99B in 451.333Âµs
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000492] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36524 - 400 266B in 62.44028ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000493] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36538 - 400 99B in 59.244251ms
2025/11/25 13:25:04 [a357f2e3b56e/8P1BS7F7Qi-000494] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36544 - 400 114B in 65.493228ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000495] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36558 - 400 174B in 64.962676ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000496] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36572 - 400 76B in 65.76405ms
--- PASS: TestAPIAccountPhonePut_ValidationErrors (0.42s)
=== RUN   TestAPIAccountPhonePut_UnauthorizedAndScope
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000497] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36578 - 401 22B in 152.899Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000498] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36588 - 401 22B in 529.069Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4227}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000499] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36604 - 200 1165B in 4.635669ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000500] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36614 - 403 19B in 505.586Âµs
--- PASS: TestAPIAccountPhonePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPhonePut_InvalidRequestBody
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000501] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-tlwFZDGy&redirect_uri=http%3A%2F%2Fwww.chiefintegrate.com%2Freinvent%2Fseize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ylqoeVuH&nonce=eijXRVIH HTTP/1.1" from [::1]:36618 - 302 57B in 667.642Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000502] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36624 - 302 54B in 391.069Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000503] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36626 - 200 2949B in 453.117Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1808}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000504] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36626 - 302 0B in 36.14755ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000505] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36626 - 302 57B in 433.009Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000506] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36638 - 302 60B in 447.605Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4228,"userId":1808}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000507] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36654 - 302 56B in 1.508821ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4228,"codeId":860,"userId":1808}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000508] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36660 - 302 220B in 890.793Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":860}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000509] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36672 - 200 4322B in 12.692211ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000510] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:36676 - 400 75B in 701.907Âµs
--- PASS: TestAPIAccountPhonePut_InvalidRequestBody (0.10s)
=== RUN   TestAPIAccountProfileGet_Success
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000511] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-kqiSrgSW&redirect_uri=https%3A%2F%2Fwww.regionalcustomized.com%2Fharness%2Fgrow%2F24-365%2Fredefine&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=hyxjeXkl&nonce=tbgKzkWe HTTP/1.1" from [::1]:36686 - 302 57B in 877.929Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000512] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36692 - 302 54B in 430.433Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000513] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36698 - 200 2949B in 356.003Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1809}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000514] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36698 - 302 0B in 37.070704ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000515] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36698 - 302 57B in 355.221Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000516] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36706 - 302 60B in 474.267Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4229,"userId":1809}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000517] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36710 - 302 56B in 1.495216ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4229,"codeId":861,"userId":1809}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000518] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36714 - 302 239B in 819.749Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":861}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000519] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36718 - 200 4330B in 12.314087ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000520] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36724 - 200 694B in 377.122Âµs
--- PASS: TestAPIAccountProfileGet_Success (0.10s)
=== RUN   TestAPIAccountProfileGet_UnauthorizedAndScope
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000521] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36732 - 401 22B in 51.367Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000522] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36746 - 401 22B in 272.705Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4230}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000523] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36752 - 200 1165B in 4.288563ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000524] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36758 - 403 19B in 306.379Âµs
--- PASS: TestAPIAccountProfileGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountProfilePut_Success
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000525] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-rujwpYYb&redirect_uri=http%3A%2F%2Fwww.globalapplications.com%2Fholistic%2Fvortals&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=apzHEzxj&nonce=DHBclqup HTTP/1.1" from [::1]:36762 - 302 57B in 498.342Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000526] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36764 - 302 54B in 224.905Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000527] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36768 - 200 2949B in 256.405Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1810}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000528] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36768 - 302 0B in 35.128414ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000529] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36768 - 302 57B in 338.69Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000530] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36784 - 302 60B in 374.488Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4231,"userId":1810}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000531] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36794 - 302 56B in 1.87865ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4231,"codeId":862,"userId":1810}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000532] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36798 - 302 226B in 796.525Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":862}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000533] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36808 - 200 4334B in 12.178972ms
2025/11/25 13:25:05 INFO {"audit_event":"updated_own_profile","details":{"loggedInUser":"e97203d8-beaf-46ce-8fc9-0660a0f06523","userId":1810}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000534] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36818 - 200 799B in 2.373225ms
--- PASS: TestAPIAccountProfilePut_Success (0.10s)
=== RUN   TestAPIAccountProfilePut_ValidationErrors
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000535] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-NoEWVJkw&redirect_uri=http%3A%2F%2Fwww.forwarddisintermediate.org%2Fgrow%2Fportals%2Fseize%2Fdrive&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=fMMYUzUb&nonce=LRMUyBFC HTTP/1.1" from [::1]:36820 - 302 57B in 669.706Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000536] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36824 - 302 54B in 162.437Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000537] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36840 - 200 2949B in 285.851Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1811}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000538] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36840 - 302 0B in 35.174702ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000539] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36840 - 302 57B in 453.727Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000540] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36850 - 302 60B in 266.093Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4232,"userId":1811}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000541] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36860 - 302 56B in 1.382662ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4232,"codeId":863,"userId":1811}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000542] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36876 - 302 238B in 929.887Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":863}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000543] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36888 - 200 4322B in 12.437049ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000544] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36894 - 400 69B in 1.795673ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000545] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36898 - 400 114B in 1.151306ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000546] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36908 - 400 76B in 1.040005ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000547] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36914 - 400 73B in 1.450771ms
--- PASS: TestAPIAccountProfilePut_ValidationErrors (0.10s)
=== RUN   TestAPIAccountProfilePut_UnauthorizedAndScope
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000548] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36916 - 401 22B in 78.007Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4233}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000549] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36922 - 200 1165B in 4.081412ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000550] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:36936 - 403 19B in 275.901Âµs
--- PASS: TestAPIAccountProfilePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountSessionsGet_Success_IncludesIsCurrent
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000551] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-oBLxcHBJ&redirect_uri=https%3A%2F%2Fwww.customerreal-time.biz%2Ffunctionalities%2Fwhiteboard&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=vGLSaZtY&nonce=IylnsnAt HTTP/1.1" from [::1]:36946 - 302 57B in 487.131Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000552] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:36948 - 302 54B in 186.051Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000553] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36958 - 200 2949B in 979.15Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1812}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000554] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:36958 - 302 0B in 36.255995ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000555] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:36958 - 302 57B in 255.593Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000556] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:36968 - 302 60B in 410.315Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4234,"userId":1812}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000557] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:36982 - 302 56B in 1.35476ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4234,"codeId":864,"userId":1812}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000558] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:36990 - 302 236B in 819.238Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":864}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000559] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36996 - 200 4328B in 12.080947ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000560] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:37008 - 200 2174B in 753.373Âµs
--- PASS: TestAPIAccountSessionsGet_Success_IncludesIsCurrent (0.10s)
=== RUN   TestAPIAccountSessionsGet_OnlyValidSessions
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000561] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-zKQGRcYe&redirect_uri=http%3A%2F%2Fwww.nationalplatforms.org%2Fsynergize%2F24-365&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JeSgYNsh&nonce=AVteGoTW HTTP/1.1" from [::1]:37020 - 302 57B in 422.599Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000562] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:37032 - 302 54B in 203.775Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000563] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37040 - 200 2949B in 277.595Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1813}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000564] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37040 - 302 0B in 36.016062ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000565] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:37040 - 302 57B in 494.764Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000566] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:37046 - 302 60B in 373.035Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4236,"userId":1813}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000567] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:37058 - 302 56B in 1.474396ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4236,"codeId":865,"userId":1813}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000568] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:37074 - 302 225B in 879.071Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":865}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000569] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37086 - 200 4326B in 12.944338ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000570] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:37102 - 200 1436B in 603.54Âµs
--- PASS: TestAPIAccountSessionsGet_OnlyValidSessions (0.10s)
=== RUN   TestAPIAccountSessionDelete_Success
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000571] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-NGYKHGkn&redirect_uri=http%3A%2F%2Fwww.regionalvortals.net%2Ftransform&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=AKHNFkMD&nonce=bXFHCtAB HTTP/1.1" from [::1]:37112 - 302 57B in 465.109Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000572] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:37128 - 302 54B in 163.569Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000573] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37138 - 200 2949B in 281.462Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1814}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000574] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37138 - 302 0B in 35.35888ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000575] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:37138 - 302 57B in 406.278Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000576] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:37152 - 302 60B in 260.833Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4237,"userId":1814}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000577] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:37162 - 302 56B in 1.274698ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4237,"codeId":866,"userId":1814}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000578] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:37172 - 302 216B in 761.479Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":866}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000579] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37178 - 200 4334B in 11.984234ms
2025/11/25 13:25:05 INFO {"audit_event":"deleted_user_session","details":{"loggedInUser":"","userSessionId":1788}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000580] "DELETE http://localhost:19090/api/v1/account/sessions/1788 HTTP/1.1" from [::1]:37190 - 200 17B in 976.816Âµs
--- PASS: TestAPIAccountSessionDelete_Success (0.09s)
=== RUN   TestAPIAccountSessionDelete_ForbiddenOnOtherUsersSession
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000581] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-fYSFBsYM&redirect_uri=https%3A%2F%2Fwww.internalextensible.name%2Finnovative%2Ftransform%2Fdisintermediate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ZQRuOGba&nonce=gSpBYFcs HTTP/1.1" from [::1]:37192 - 302 57B in 587.15Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000582] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:37202 - 302 54B in 145.545Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000583] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37206 - 200 2949B in 259.45Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1815}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000584] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37206 - 302 0B in 35.667232ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000585] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:37206 - 302 57B in 346.595Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000586] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:37222 - 302 60B in 266.163Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4238,"userId":1815}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000587] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:37234 - 302 56B in 1.373435ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4238,"codeId":867,"userId":1815}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000588] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:37248 - 302 248B in 1.519431ms
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":867}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000589] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37252 - 200 4352B in 12.715346ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000590] "DELETE http://localhost:19090/api/v1/account/sessions/1790 HTTP/1.1" from [::1]:37268 - 403 53B in 453.016Âµs
--- PASS: TestAPIAccountSessionDelete_ForbiddenOnOtherUsersSession (0.10s)
=== RUN   TestAPIAccountSessions_UnauthorizedAndScope
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000591] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:37272 - 401 22B in 66.525Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000592] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:37278 - 401 22B in 154.813Âµs
2025/11/25 13:25:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4239}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000593] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37294 - 200 1165B in 4.015738ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000594] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:37298 - 403 19B in 235.685Âµs
--- PASS: TestAPIAccountSessions_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountSessionDelete_UnauthorizedAndInvalidId
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000595] "DELETE http://localhost:19090/api/v1/account/sessions/123 HTTP/1.1" from [::1]:37302 - 401 22B in 47.119Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000596] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-iikzPqjY&redirect_uri=http%3A%2F%2Fwww.centralroi.info%2Fwireless%2Fintuitive%2Fcompelling%2Frich&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=TxkUaell&nonce=JDEeHknG HTTP/1.1" from [::1]:37306 - 302 57B in 567.773Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000597] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:37322 - 302 54B in 197.634Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000598] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37326 - 200 2949B in 278.386Âµs
2025/11/25 13:25:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":1817}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000599] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37326 - 302 0B in 35.091935ms
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000600] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:37326 - 302 57B in 279.739Âµs
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000601] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:37342 - 302 60B in 350.262Âµs
2025/11/25 13:25:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":4240,"userId":1817}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000602] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:37352 - 302 56B in 1.367344ms
2025/11/25 13:25:05 INFO {"audit_event":"created_auth_code","details":{"clientId":4240,"codeId":868,"userId":1817}}
2025/11/25 13:25:05 [a357f2e3b56e/8P1BS7F7Qi-000603] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:37360 - 302 237B in 839.416Âµs
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":868}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000604] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37372 - 200 4326B in 12.246569ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000605] "DELETE http://localhost:19090/api/v1/account/sessions/abc HTTP/1.1" from [::1]:37388 - 400 86B in 497.76Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000606] "DELETE http://localhost:19090/api/v1/account/sessions/-1 HTTP/1.1" from [::1]:37402 - 400 86B in 246.666Âµs
--- PASS: TestAPIAccountSessionDelete_UnauthorizedAndInvalidId (0.09s)
=== RUN   TestAPIAccountSessionDelete_NotFound
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000607] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-GlRGKMlf&redirect_uri=https%3A%2F%2Fwww.chiefe-business.net%2Fout-of-the-box%2Fportals%2Fexpedite%2Fevolve&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=YOakSkjK&nonce=QDUKmBFO HTTP/1.1" from [::1]:37418 - 302 57B in 715.131Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000608] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:37422 - 302 54B in 209.085Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000609] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37438 - 200 2949B in 244.893Âµs
2025/11/25 13:25:06 INFO {"audit_event":"auth_success_pwd","details":{"userId":1818}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000610] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37438 - 302 0B in 35.114919ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000611] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:37438 - 302 57B in 392.682Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000612] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:37450 - 302 60B in 467.123Âµs
2025/11/25 13:25:06 INFO {"audit_event":"started_new_user_session","details":{"clientId":4241,"userId":1818}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000613] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:37456 - 302 56B in 1.881315ms
2025/11/25 13:25:06 INFO {"audit_event":"created_auth_code","details":{"clientId":4241,"codeId":869,"userId":1818}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000614] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:37462 - 302 246B in 873.881Âµs
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":869}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000615] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37470 - 200 4330B in 12.099372ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000616] "DELETE http://localhost:19090/api/v1/account/sessions/99999999 HTTP/1.1" from [::1]:37474 - 404 79B in 523.218Âµs
--- PASS: TestAPIAccountSessionDelete_NotFound (0.09s)
=== RUN   TestAPIClientPermissions_Get_Success
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4242}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000617] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37490 - 200 1156B in 3.96433ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000618] "GET http://localhost:19090/api/v1/admin/clients/4243/permissions HTTP/1.1" from [::1]:37492 - 200 730B in 457.264Âµs
--- PASS: TestAPIClientPermissions_Get_Success (0.01s)
=== RUN   TestAPIClientPermissions_Get_Errors
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4244}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000619] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37506 - 200 1156B in 3.945174ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000620] "GET http://localhost:19090/api/v1/admin/clients/abc/permissions HTTP/1.1" from [::1]:37512 - 400 75B in 242.128Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000621] "GET http://localhost:19090/api/v1/admin/clients/9999999/permissions HTTP/1.1" from [::1]:37528 - 404 60B in 268.368Âµs
--- PASS: TestAPIClientPermissions_Get_Errors (0.01s)
=== RUN   TestAPIClientPermissions_Put_AddRemove
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4245}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000622] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37540 - 200 1156B in 3.922481ms
2025/11/25 13:25:06 INFO {"audit_event":"updated_client_permissions","details":{"clientId":4246,"loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000623] "PUT http://localhost:19090/api/v1/admin/clients/4246/permissions HTTP/1.1" from [::1]:37546 - 200 17B in 1.133572ms
2025/11/25 13:25:06 INFO {"audit_event":"updated_client_permissions","details":{"clientId":4246,"loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000624] "PUT http://localhost:19090/api/v1/admin/clients/4246/permissions HTTP/1.1" from [::1]:37554 - 200 17B in 1.581619ms
--- PASS: TestAPIClientPermissions_Put_AddRemove (0.01s)
=== RUN   TestAPIClientPermissions_Put_Idempotent
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4247}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000625] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37566 - 200 1156B in 3.949012ms
2025/11/25 13:25:06 INFO {"audit_event":"updated_client_permissions","details":{"clientId":4248,"loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000626] "PUT http://localhost:19090/api/v1/admin/clients/4248/permissions HTTP/1.1" from [::1]:37574 - 200 17B in 1.040356ms
2025/11/25 13:25:06 INFO {"audit_event":"updated_client_permissions","details":{"clientId":4248,"loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000627] "PUT http://localhost:19090/api/v1/admin/clients/4248/permissions HTTP/1.1" from [::1]:37578 - 200 17B in 415.495Âµs
--- PASS: TestAPIClientPermissions_Put_Idempotent (0.01s)
=== RUN   TestAPIClientPermissions_Unauthorized
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000628] "GET http://localhost:19090/api/v1/admin/clients/4249/permissions HTTP/1.1" from [::1]:37584 - 401 22B in 58.421Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000629] "PUT http://localhost:19090/api/v1/admin/clients/4249/permissions HTTP/1.1" from [::1]:37584 - 401 22B in 51.116Âµs
--- PASS: TestAPIClientPermissions_Unauthorized (0.00s)
=== RUN   TestAPIClientPermissions_Put_ClientCredentialsDisabled
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4250}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000630] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37590 - 200 1156B in 3.983487ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000631] "PUT http://localhost:19090/api/v1/admin/clients/4251/permissions HTTP/1.1" from [::1]:37594 - 400 132B in 288.054Âµs
--- PASS: TestAPIClientPermissions_Put_ClientCredentialsDisabled (0.01s)
=== RUN   TestAPIClientPermissions_Put_SystemLevelRejected
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4252}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000632] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37600 - 200 1156B in 3.952759ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000633] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37616 - 200 2258507B in 233.366039ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000634] "PUT http://localhost:19090/api/v1/admin/clients/1/permissions HTTP/1.1" from [::1]:37630 - 400 87B in 617.908Âµs
--- PASS: TestAPIClientPermissions_Put_SystemLevelRejected (0.25s)
=== RUN   TestAPIClientPermissions_Put_PermissionNotFound
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4253}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000635] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37640 - 200 1156B in 4.190949ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000636] "PUT http://localhost:19090/api/v1/admin/clients/4254/permissions HTTP/1.1" from [::1]:37656 - 404 64B in 457.384Âµs
--- PASS: TestAPIClientPermissions_Put_PermissionNotFound (0.01s)
=== RUN   TestAPIClientPermissions_Put_InsufficientScope
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4255}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000637] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37658 - 200 1160B in 4.007162ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000638] "PUT http://localhost:19090/api/v1/admin/clients/4256/permissions HTTP/1.1" from [::1]:37674 - 403 19B in 391.189Âµs
--- PASS: TestAPIClientPermissions_Put_InsufficientScope (0.01s)
=== RUN   TestAPIClientAuthenticationPut_ConfidentialToPublic_Success
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4257}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000639] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37684 - 200 1156B in 3.955273ms
2025/11/25 13:25:06 INFO {"audit_event":"updated_client_authentication","details":{"clientId":4258,"loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000640] "PUT http://localhost:19090/api/v1/admin/clients/4258/authentication HTTP/1.1" from [::1]:37700 - 200 559B in 1.119065ms
--- PASS: TestAPIClientAuthenticationPut_ConfidentialToPublic_Success (0.01s)
=== RUN   TestAPIClientAuthenticationPut_PublicToConfidential_Success
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4259}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000641] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37704 - 200 1156B in 3.963489ms
2025/11/25 13:25:06 INFO {"audit_event":"updated_client_authentication","details":{"clientId":4260,"loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000642] "PUT http://localhost:19090/api/v1/admin/clients/4260/authentication HTTP/1.1" from [::1]:37710 - 200 558B in 1.036949ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000643] "GET http://localhost:19090/api/v1/admin/clients/4260 HTTP/1.1" from [::1]:37712 - 200 633B in 390.948Âµs
--- PASS: TestAPIClientAuthenticationPut_PublicToConfidential_Success (0.01s)
=== RUN   TestAPIClientAuthenticationPut_InvalidSecret_TooShort
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4261}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000644] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37724 - 200 1156B in 3.996932ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000645] "PUT http://localhost:19090/api/v1/admin/clients/4262/authentication HTTP/1.1" from [::1]:37738 - 400 100B in 387.532Âµs
--- PASS: TestAPIClientAuthenticationPut_InvalidSecret_TooShort (0.01s)
=== RUN   TestAPIClientAuthenticationPut_InvalidSecret_BadChars
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4263}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000646] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37746 - 200 1156B in 3.946407ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000647] "PUT http://localhost:19090/api/v1/admin/clients/4264/authentication HTTP/1.1" from [::1]:37756 - 400 100B in 433.869Âµs
--- PASS: TestAPIClientAuthenticationPut_InvalidSecret_BadChars (0.01s)
=== RUN   TestAPIClientAuthenticationPut_NotFoundAndInvalidId
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4265}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000648] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37770 - 200 1156B in 4.017711ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000649] "PUT http://localhost:19090/api/v1/admin/clients/999999/authentication HTTP/1.1" from [::1]:37774 - 404 60B in 290.96Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000650] "PUT http://localhost:19090/api/v1/admin/clients/abc/authentication HTTP/1.1" from [::1]:37788 - 400 68B in 243.009Âµs
--- PASS: TestAPIClientAuthenticationPut_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientAuthenticationPut_SystemLevelClientRejected
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4266}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000651] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37796 - 200 1156B in 3.959642ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000652] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37810 - 200 2262344B in 222.222545ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000653] "PUT http://localhost:19090/api/v1/admin/clients/1/authentication HTTP/1.1" from [::1]:37818 - 400 87B in 851.048Âµs
--- PASS: TestAPIClientAuthenticationPut_SystemLevelClientRejected (0.24s)
=== RUN   TestAPIClientAuthenticationPut_InsufficientScope
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4267}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000654] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37830 - 200 1154B in 4.900419ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000655] "PUT http://localhost:19090/api/v1/admin/clients/4268/authentication HTTP/1.1" from [::1]:37832 - 403 19B in 333.981Âµs
--- PASS: TestAPIClientAuthenticationPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientCreate_Success
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4269}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000656] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37836 - 200 1156B in 4.094597ms
2025/11/25 13:25:06 INFO {"audit_event":"created_client","details":{"clientId":4270,"clientIdentifier":"client-ckiqyyzn","loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000657] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37840 - 201 601B in 1.25434ms
--- PASS: TestAPIClientCreate_Success (0.01s)
=== RUN   TestAPIClientCreate_Validation
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4271}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000658] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37856 - 200 1156B in 3.969861ms
=== RUN   TestAPIClientCreate_Validation/Empty_client_identifier
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000659] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37858 - 400 81B in 294.987Âµs
=== RUN   TestAPIClientCreate_Validation/Client_identifier_too_short
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000660] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37872 - 400 101B in 253.098Âµs
=== RUN   TestAPIClientCreate_Validation/Client_identifier_too_long
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000661] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37884 - 400 114B in 219.204Âµs
=== RUN   TestAPIClientCreate_Validation/Invalid_client_identifier_characters
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000662] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37896 - 400 250B in 377.944Âµs
=== RUN   TestAPIClientCreate_Validation/Description_too_long
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000663] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37912 - 400 116B in 224.976Âµs
--- PASS: TestAPIClientCreate_Validation (0.01s)
    --- PASS: TestAPIClientCreate_Validation/Empty_client_identifier (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Client_identifier_too_short (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Client_identifier_too_long (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Invalid_client_identifier_characters (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Description_too_long (0.00s)
=== RUN   TestAPIClientCreate_Duplicate
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4272}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000664] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37924 - 200 1156B in 4.000459ms
2025/11/25 13:25:06 INFO {"audit_event":"created_client","details":{"clientId":4273,"clientIdentifier":"client-utmivovw","loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000665] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37932 - 201 596B in 1.03723ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000666] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37948 - 400 91B in 417.739Âµs
--- PASS: TestAPIClientCreate_Duplicate (0.01s)
=== RUN   TestAPIClientCreate_Unauthorized
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000667] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37956 - 401 22B in 74.05Âµs
--- PASS: TestAPIClientCreate_Unauthorized (0.00s)
=== RUN   TestAPIClientCreate_InsufficientScope
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4274}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000668] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37964 - 200 1157B in 3.922321ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000669] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37978 - 403 19B in 299.626Âµs
--- PASS: TestAPIClientCreate_InsufficientScope (0.01s)
=== RUN   TestAPIClientDelete_Success
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4275}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000670] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37980 - 200 1156B in 4.058819ms
2025/11/25 13:25:06 INFO {"audit_event":"deleted_client","details":{"clientId":4276,"clientIdentifier":"del-client-wetJivta","loggedInUser":""}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000671] "DELETE http://localhost:19090/api/v1/admin/clients/4276 HTTP/1.1" from [::1]:37988 - 200 17B in 1.157678ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000672] "GET http://localhost:19090/api/v1/admin/clients/4276 HTTP/1.1" from [::1]:37990 - 404 60B in 312.521Âµs
--- PASS: TestAPIClientDelete_Success (0.01s)
=== RUN   TestAPIClientDelete_SystemLevelRejected
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4277}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000673] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37994 - 200 1156B in 4.573822ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000674] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:37998 - 200 2266796B in 218.255719ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000675] "DELETE http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:38004 - 400 89B in 542.145Âµs
--- PASS: TestAPIClientDelete_SystemLevelRejected (0.24s)
=== RUN   TestAPIClientDelete_NotFoundAndInvalidId
2025/11/25 13:25:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4278}}
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000676] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38020 - 200 1156B in 4.339699ms
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000677] "DELETE http://localhost:19090/api/v1/admin/clients/9999999 HTTP/1.1" from [::1]:38024 - 404 60B in 463.245Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000678] "DELETE http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:38034 - 400 68B in 233.111Âµs
2025/11/25 13:25:06 [a357f2e3b56e/8P1BS7F7Qi-000679] "DELETE http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:38040 - 401 22B in 44.454Âµs
--- PASS: TestAPIClientDelete_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientGetPermissions_IncludesPermissions
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4279}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000680] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38050 - 200 1156B in 4.030635ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000681] "GET http://localhost:19090/api/v1/admin/clients/4280/permissions HTTP/1.1" from [::1]:38054 - 200 731B in 471.902Âµs
--- PASS: TestAPIClientGetPermissions_IncludesPermissions (0.01s)
=== RUN   TestAPIClientDelete_InsufficientScope
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4281}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000682] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38070 - 200 1157B in 3.934163ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000683] "DELETE http://localhost:19090/api/v1/admin/clients/4282 HTTP/1.1" from [::1]:38084 - 403 19B in 244.352Âµs
--- PASS: TestAPIClientDelete_InsufficientScope (0.01s)
=== RUN   TestAPIClientDelete_CascadesLinkedData
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4283}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000684] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38092 - 200 1156B in 3.987824ms
2025/11/25 13:25:07 INFO {"audit_event":"deleted_client","details":{"clientId":4284,"clientIdentifier":"cascade-client-QEOcoY","loggedInUser":""}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000685] "DELETE http://localhost:19090/api/v1/admin/clients/4284 HTTP/1.1" from [::1]:38108 - 200 17B in 1.600233ms
--- PASS: TestAPIClientDelete_CascadesLinkedData (0.01s)
=== RUN   TestAPIClientGet_ConfidentialIncludesSecretInDetailButNotList
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4285}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000686] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38110 - 200 1156B in 4.322707ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000687] "GET http://localhost:19090/api/v1/admin/clients/4286 HTTP/1.1" from [::1]:38114 - 200 606B in 587.349Âµs
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000688] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:38126 - 200 2269537B in 225.58108ms
--- PASS: TestAPIClientGet_ConfidentialIncludesSecretInDetailButNotList (0.25s)
=== RUN   TestAPIClientOAuth2FlowsPut_Success_PublicClient_ForcesNoClientCredentials
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4287}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000689] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38138 - 200 1156B in 4.242006ms
2025/11/25 13:25:07 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":4288,"loggedInUser":""}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000690] "PUT http://localhost:19090/api/v1/admin/clients/4288/oauth2-flows HTTP/1.1" from [::1]:38140 - 200 556B in 1.118824ms
--- PASS: TestAPIClientOAuth2FlowsPut_Success_PublicClient_ForcesNoClientCredentials (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_Success_ConfidentialClient_ToggleBoth
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4289}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000691] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38148 - 200 1156B in 4.07001ms
2025/11/25 13:25:07 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":4290,"loggedInUser":""}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000692] "PUT http://localhost:19090/api/v1/admin/clients/4290/oauth2-flows HTTP/1.1" from [::1]:38162 - 200 556B in 1.039474ms
--- PASS: TestAPIClientOAuth2FlowsPut_Success_ConfidentialClient_ToggleBoth (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_SystemLevelClientRejected
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4291}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000693] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38170 - 200 1156B in 4.01681ms
2025/11/25 13:25:07 INFO worker task started
2025/11/25 13:25:07 INFO deleted expired or revoked refresh tokens
2025/11/25 13:25:07 INFO deleted used codes without refresh tokens
2025/11/25 13:25:07 INFO deleted idle sessions (idle timeout: 3600 seconds)
2025/11/25 13:25:07 INFO deleted expired sessions (max lifetime: 7200 seconds)
2025/11/25 13:25:07 INFO worker task completed
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000694] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:38186 - 200 2270637B in 223.506089ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000695] "PUT http://localhost:19090/api/v1/admin/clients/1/oauth2-flows HTTP/1.1" from [::1]:38202 - 400 87B in 1.542374ms
--- PASS: TestAPIClientOAuth2FlowsPut_SystemLevelClientRejected (0.24s)
=== RUN   TestAPIClientOAuth2FlowsPut_NotFoundAndInvalidId
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4292}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000696] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38204 - 200 1156B in 4.931238ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000697] "PUT http://localhost:19090/api/v1/admin/clients/999999/oauth2-flows HTTP/1.1" from [::1]:38214 - 404 60B in 507.018Âµs
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000698] "PUT http://localhost:19090/api/v1/admin/clients/abc/oauth2-flows HTTP/1.1" from [::1]:38226 - 400 68B in 438.93Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_NotFoundAndInvalidId (0.02s)
=== RUN   TestAPIClientOAuth2FlowsPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4293}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000699] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38232 - 200 1156B in 4.172764ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000700] "PUT http://localhost:19090/api/v1/admin/clients/4294/oauth2-flows HTTP/1.1" from [::1]:38242 - 400 70B in 739.397Âµs
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000701] "PUT http://localhost:19090/api/v1/admin/clients/4294/oauth2-flows HTTP/1.1" from [::1]:38242 - 401 22B in 93.376Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_InvalidRequestBodyAndUnauthorized (0.02s)
=== RUN   TestAPIClientOAuth2FlowsPut_InsufficientScope
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4295}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000702] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38244 - 200 1156B in 4.532254ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000703] "PUT http://localhost:19090/api/v1/admin/clients/4296/oauth2-flows HTTP/1.1" from [::1]:38254 - 403 19B in 455.882Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_BothDisabledAllowed
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4297}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000704] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38270 - 200 1156B in 4.482039ms
2025/11/25 13:25:07 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":4298,"loggedInUser":""}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000705] "PUT http://localhost:19090/api/v1/admin/clients/4298/oauth2-flows HTTP/1.1" from [::1]:38278 - 200 560B in 1.450471ms
--- PASS: TestAPIClientOAuth2FlowsPut_BothDisabledAllowed (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_Success_AddRemoveAndTrim
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4299}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000706] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38292 - 200 1156B in 4.214363ms
2025/11/25 13:25:07 INFO {"audit_event":"updated_redirect_uris","details":{"clientId":4300,"loggedInUser":""}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000707] "PUT http://localhost:19090/api/v1/admin/clients/4300/redirect-uris HTTP/1.1" from [::1]:38308 - 200 811B in 1.895381ms
--- PASS: TestAPIClientRedirectURIsPut_Success_AddRemoveAndTrim (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_AuthCodeDisabledRejected
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4301}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000708] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38324 - 200 1156B in 4.20172ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000709] "PUT http://localhost:19090/api/v1/admin/clients/4302/redirect-uris HTTP/1.1" from [::1]:38338 - 400 103B in 403.492Âµs
--- PASS: TestAPIClientRedirectURIsPut_AuthCodeDisabledRejected (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_SystemLevelClientRejected
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4303}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000710] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38352 - 200 1156B in 4.446863ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000711] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:38356 - 200 2273929B in 222.673656ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000712] "PUT http://localhost:19090/api/v1/admin/clients/1/redirect-uris HTTP/1.1" from [::1]:38360 - 400 87B in 722.004Âµs
--- PASS: TestAPIClientRedirectURIsPut_SystemLevelClientRejected (0.24s)
=== RUN   TestAPIClientRedirectURIsPut_DuplicateAndInvalidURLs
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4304}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000713] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38372 - 200 1156B in 4.5938ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000714] "PUT http://localhost:19090/api/v1/admin/clients/4305/redirect-uris HTTP/1.1" from [::1]:38374 - 400 90B in 530.292Âµs
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000715] "PUT http://localhost:19090/api/v1/admin/clients/4305/redirect-uris HTTP/1.1" from [::1]:38382 - 400 82B in 607.278Âµs
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000716] "PUT http://localhost:19090/api/v1/admin/clients/4305/redirect-uris HTTP/1.1" from [::1]:38390 - 400 79B in 526.294Âµs
--- PASS: TestAPIClientRedirectURIsPut_DuplicateAndInvalidURLs (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_NotFound_InvalidId_InvalidBody_Unauthorized
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4306}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000717] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38404 - 200 1156B in 4.380937ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000718] "PUT http://localhost:19090/api/v1/admin/clients/999999/redirect-uris HTTP/1.1" from [::1]:38406 - 404 60B in 346.144Âµs
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000719] "PUT http://localhost:19090/api/v1/admin/clients/abc/redirect-uris HTTP/1.1" from [::1]:38410 - 400 68B in 291.471Âµs
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000720] "PUT http://localhost:19090/api/v1/admin/clients/4307/redirect-uris HTTP/1.1" from [::1]:38424 - 400 70B in 286.812Âµs
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000721] "PUT http://localhost:19090/api/v1/admin/clients/4307/redirect-uris HTTP/1.1" from [::1]:38424 - 401 22B in 37.862Âµs
--- PASS: TestAPIClientRedirectURIsPut_NotFound_InvalidId_InvalidBody_Unauthorized (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_InsufficientScope
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4308}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000722] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38426 - 200 1156B in 3.999687ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000723] "PUT http://localhost:19090/api/v1/admin/clients/4309/redirect-uris HTTP/1.1" from [::1]:38430 - 403 19B in 268.687Âµs
--- PASS: TestAPIClientRedirectURIsPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientSessionsGet_Success
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4310}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000724] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38444 - 200 1156B in 4.187923ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000725] "GET http://localhost:19090/api/v1/admin/clients/4311/sessions HTTP/1.1" from [::1]:38456 - 200 1462B in 1.366552ms
--- PASS: TestAPIClientSessionsGet_Success (0.01s)
=== RUN   TestAPIClientSessionsGet_EmptySessions
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4312}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000726] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38470 - 200 1156B in 4.04365ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000727] "GET http://localhost:19090/api/v1/admin/clients/4313/sessions HTTP/1.1" from [::1]:38478 - 200 16B in 508.781Âµs
--- PASS: TestAPIClientSessionsGet_EmptySessions (0.01s)
=== RUN   TestAPIClientSessionsGet_ClientNotFound
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4314}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000728] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38492 - 200 1156B in 4.070672ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000729] "GET http://localhost:19090/api/v1/admin/clients/999999/sessions HTTP/1.1" from [::1]:38494 - 404 67B in 296.942Âµs
--- PASS: TestAPIClientSessionsGet_ClientNotFound (0.01s)
=== RUN   TestAPIClientSessionsGet_InvalidId
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4315}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000730] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38498 - 200 1156B in 4.626742ms
=== RUN   TestAPIClientSessionsGet_InvalidId/non-numeric
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000731] "GET http://localhost:19090/api/v1/admin/clients/abc/sessions HTTP/1.1" from [::1]:38512 - 400 76B in 283.145Âµs
=== RUN   TestAPIClientSessionsGet_InvalidId/negative
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000732] "GET http://localhost:19090/api/v1/admin/clients/-1/sessions HTTP/1.1" from [::1]:38526 - 404 67B in 277.865Âµs
--- PASS: TestAPIClientSessionsGet_InvalidId (0.01s)
    --- PASS: TestAPIClientSessionsGet_InvalidId/non-numeric (0.00s)
    --- PASS: TestAPIClientSessionsGet_InvalidId/negative (0.00s)
=== RUN   TestAPIClientSessionsGet_Unauthorized
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000733] "GET http://localhost:19090/api/v1/admin/clients/4316/sessions HTTP/1.1" from [::1]:38540 - 401 22B in 90.291Âµs
--- PASS: TestAPIClientSessionsGet_Unauthorized (0.00s)
=== RUN   TestAPIClientSessionsGet_OnlyValidSessions
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4317}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000734] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38556 - 200 1156B in 4.163647ms
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000735] "GET http://localhost:19090/api/v1/admin/clients/4318/sessions HTTP/1.1" from [::1]:38558 - 200 745B in 570.698Âµs
--- PASS: TestAPIClientSessionsGet_OnlyValidSessions (0.01s)
=== RUN   TestAPIClientSessionsGet_PaginationDefaultAndCap
2025/11/25 13:25:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4319}}
2025/11/25 13:25:07 [a357f2e3b56e/8P1BS7F7Qi-000736] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38562 - 200 1156B in 4.141666ms
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000737] "GET http://localhost:19090/api/v1/admin/clients/4320/sessions HTTP/1.1" from [::1]:38576 - 200 36053B in 3.277834ms
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000738] "GET http://localhost:19090/api/v1/admin/clients/4320/sessions?size=200 HTTP/1.1" from [::1]:38590 - 200 72095B in 4.53606ms
--- PASS: TestAPIClientSessionsGet_PaginationDefaultAndCap (0.20s)
=== RUN   TestAPIClientsGet_Success
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4321}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000739] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38606 - 200 1156B in 4.380516ms
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000740] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:38608 - 200 2278868B in 235.161462ms
--- PASS: TestAPIClientsGet_Success (0.25s)
=== RUN   TestAPIClientsGet_Unauthorized
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000741] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:38622 - 401 22B in 239.121Âµs
--- PASS: TestAPIClientsGet_Unauthorized (0.00s)
=== RUN   TestAPIClientGet_Success
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4322}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000742] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38632 - 200 1156B in 4.219403ms
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000743] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:38636 - 200 2279417B in 227.798259ms
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000744] "GET http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:38650 - 200 935B in 726.844Âµs
--- PASS: TestAPIClientGet_Success (0.25s)
=== RUN   TestAPIClientGet_NotFound
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4323}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000745] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38664 - 200 1156B in 4.198994ms
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000746] "GET http://localhost:19090/api/v1/admin/clients/99999 HTTP/1.1" from [::1]:38666 - 404 60B in 335.894Âµs
--- PASS: TestAPIClientGet_NotFound (0.01s)
=== RUN   TestAPIClientGet_InvalidId
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4324}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000747] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38682 - 200 1156B in 4.034403ms
=== RUN   TestAPIClientGet_InvalidId/non-numeric_ID
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000748] "GET http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:38696 - 400 68B in 319.173Âµs
=== RUN   TestAPIClientGet_InvalidId/negative_ID
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000749] "GET http://localhost:19090/api/v1/admin/clients/-1 HTTP/1.1" from [::1]:38706 - 404 60B in 375.72Âµs
--- PASS: TestAPIClientGet_InvalidId (0.01s)
    --- PASS: TestAPIClientGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIClientGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIClientGet_EmptyId
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4325}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000750] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38714 - 200 1156B in 4.154109ms
--- PASS: TestAPIClientGet_EmptyId (0.23s)
=== RUN   TestAPIClientGet_Unauthorized
2025/11/25 13:25:08 ERROR write tcp [::1]:19090->[::1]:38720: write: connection reset by peer
request-id: a357f2e3b56e/8P1BS7F7Qi-000751
2025/11/25 13:25:08 ERROR write tcp [::1]:19090->[::1]:38720: write: connection reset by peer
request-id: a357f2e3b56e/8P1BS7F7Qi-000751
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000751] "GET http://localhost:19090/api/v1/admin/clients/ HTTP/1.1" from [::1]:38720 - 200 1642358B in 228.695374ms
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000752] "GET http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:38730 - 401 22B in 131.558Âµs
--- PASS: TestAPIClientGet_Unauthorized (0.00s)
=== RUN   TestAPIClientTokensPut_Success
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4326}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000753] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38742 - 200 1156B in 4.154841ms
2025/11/25 13:25:08 INFO {"audit_event":"updated_client_tokens","details":{"clientId":4327,"loggedInUser":""}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000754] "PUT http://localhost:19090/api/v1/admin/clients/4327/tokens HTTP/1.1" from [::1]:38758 - 200 608B in 1.113875ms
--- PASS: TestAPIClientTokensPut_Success (0.01s)
=== RUN   TestAPIClientTokensPut_ValidationErrors
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4328}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000755] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38764 - 200 1156B in 4.048209ms
=== RUN   TestAPIClientTokensPut_ValidationErrors/token_exp_too_large
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000756] "PUT http://localhost:19090/api/v1/admin/clients/4329/tokens HTTP/1.1" from [::1]:38780 - 400 111B in 360.27Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/idle_too_large
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000757] "PUT http://localhost:19090/api/v1/admin/clients/4329/tokens HTTP/1.1" from [::1]:38792 - 400 131B in 262.606Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/maxlife_too_large
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000758] "PUT http://localhost:19090/api/v1/admin/clients/4329/tokens HTTP/1.1" from [::1]:38806 - 400 131B in 281.662Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/idle_gt_maxlife
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000759] "PUT http://localhost:19090/api/v1/admin/clients/4329/tokens HTTP/1.1" from [::1]:38818 - 400 124B in 285.88Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/invalid_three_state
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000760] "PUT http://localhost:19090/api/v1/admin/clients/4329/tokens HTTP/1.1" from [::1]:38824 - 400 109B in 243.52Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/negatives_rejected
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000761] "PUT http://localhost:19090/api/v1/admin/clients/4329/tokens HTTP/1.1" from [::1]:38832 - 400 111B in 280.019Âµs
--- PASS: TestAPIClientTokensPut_ValidationErrors (0.01s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/token_exp_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/idle_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/maxlife_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/idle_gt_maxlife (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/invalid_three_state (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/negatives_rejected (0.00s)
=== RUN   TestAPIClientTokensPut_NotFoundAndInvalidId
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4330}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000762] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38836 - 200 1156B in 4.595282ms
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000763] "PUT http://localhost:19090/api/v1/admin/clients/999999/tokens HTTP/1.1" from [::1]:38852 - 404 60B in 522.608Âµs
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000764] "PUT http://localhost:19090/api/v1/admin/clients/abc/tokens HTTP/1.1" from [::1]:38860 - 400 68B in 284.627Âµs
--- PASS: TestAPIClientTokensPut_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientTokensPut_SystemLevelClientRejected
2025/11/25 13:25:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4331}}
2025/11/25 13:25:08 [a357f2e3b56e/8P1BS7F7Qi-000765] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38864 - 200 1156B in 4.169137ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000766] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:38874 - 200 2283260B in 223.093219ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000767] "PUT http://localhost:19090/api/v1/admin/clients/1/tokens HTTP/1.1" from [::1]:38880 - 400 87B in 461.131Âµs
--- PASS: TestAPIClientTokensPut_SystemLevelClientRejected (0.24s)
=== RUN   TestAPIClientTokensPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4332}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000768] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38886 - 200 1156B in 4.2023ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000769] "PUT http://localhost:19090/api/v1/admin/clients/4333/tokens HTTP/1.1" from [::1]:38892 - 400 70B in 495.146Âµs
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000770] "PUT http://localhost:19090/api/v1/admin/clients/4333/tokens HTTP/1.1" from [::1]:38892 - 401 22B in 53.12Âµs
--- PASS: TestAPIClientTokensPut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPIClientTokensPut_InsufficientScope
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4334}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000771] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38898 - 200 1157B in 4.067375ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000772] "PUT http://localhost:19090/api/v1/admin/clients/4335/tokens HTTP/1.1" from [::1]:38906 - 403 19B in 292.222Âµs
--- PASS: TestAPIClientTokensPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientUpdatePut_Success
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4336}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000773] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38918 - 200 1156B in 3.96442ms
2025/11/25 13:25:09 INFO {"audit_event":"updated_client_settings","details":{"clientId":4337,"loggedInUser":""}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000774] "PUT http://localhost:19090/api/v1/admin/clients/4337 HTTP/1.1" from [::1]:38934 - 200 600B in 1.123333ms
--- PASS: TestAPIClientUpdatePut_Success (0.01s)
=== RUN   TestAPIClientUpdatePut_ValidationErrors
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4338}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000775] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38938 - 200 1156B in 4.012481ms
=== RUN   TestAPIClientUpdatePut_ValidationErrors/empty_identifier
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000776] "PUT http://localhost:19090/api/v1/admin/clients/4339 HTTP/1.1" from [::1]:38942 - 400 81B in 353.388Âµs
=== RUN   TestAPIClientUpdatePut_ValidationErrors/desc_too_long
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000777] "PUT http://localhost:19090/api/v1/admin/clients/4339 HTTP/1.1" from [::1]:38952 - 400 116B in 316.218Âµs
=== RUN   TestAPIClientUpdatePut_ValidationErrors/invalid_identifier_format
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000778] "PUT http://localhost:19090/api/v1/admin/clients/4339 HTTP/1.1" from [::1]:38968 - 400 250B in 298.805Âµs
--- PASS: TestAPIClientUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/empty_identifier (0.00s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/desc_too_long (0.00s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIClientUpdatePut_DuplicateIdentifier
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4340}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000779] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38970 - 200 1156B in 4.012742ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000780] "PUT http://localhost:19090/api/v1/admin/clients/4342 HTTP/1.1" from [::1]:38978 - 400 91B in 344.251Âµs
--- PASS: TestAPIClientUpdatePut_DuplicateIdentifier (0.01s)
=== RUN   TestAPIClientUpdatePut_SameIdentifierAllowed
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4343}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000781] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:38986 - 200 1156B in 4.047698ms
2025/11/25 13:25:09 INFO {"audit_event":"updated_client_settings","details":{"clientId":4344,"loggedInUser":""}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000782] "PUT http://localhost:19090/api/v1/admin/clients/4344 HTTP/1.1" from [::1]:39000 - 200 591B in 1.059181ms
--- PASS: TestAPIClientUpdatePut_SameIdentifierAllowed (0.01s)
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4345}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000783] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39016 - 200 1156B in 4.025846ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000784] "PUT http://localhost:19090/api/v1/admin/clients/99999 HTTP/1.1" from [::1]:39020 - 404 60B in 285.009Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/non-numeric
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000785] "PUT http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:39022 - 400 68B in 257.777Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/empty
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000786] "PUT http://localhost:19090/api/v1/admin/clients/ HTTP/1.1" from [::1]:39034 - 405 0B in 303.614Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/negative
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000787] "PUT http://localhost:19090/api/v1/admin/clients/-1 HTTP/1.1" from [::1]:39038 - 404 60B in 330.574Âµs
--- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId (0.01s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/non-numeric (0.00s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/empty (0.00s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/negative (0.00s)
=== RUN   TestAPIClientUpdatePut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4346}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000788] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39042 - 200 1156B in 4.043791ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000789] "PUT http://localhost:19090/api/v1/admin/clients/4347 HTTP/1.1" from [::1]:39056 - 400 70B in 330.244Âµs
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000790] "PUT http://localhost:19090/api/v1/admin/clients/4347 HTTP/1.1" from [::1]:39056 - 401 22B in 40.357Âµs
--- PASS: TestAPIClientUpdatePut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPIClientUpdatePut_ACRRuleEnforcement
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4348}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000791] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39068 - 200 1156B in 3.935516ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000792] "PUT http://localhost:19090/api/v1/admin/clients/4349 HTTP/1.1" from [::1]:39072 - 400 128B in 326.998Âµs
--- PASS: TestAPIClientUpdatePut_ACRRuleEnforcement (0.01s)
=== RUN   TestAPIClientUpdatePut_WhitespaceHandling
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4350}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000793] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39076 - 200 1156B in 4.157235ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000794] "PUT http://localhost:19090/api/v1/admin/clients/4351 HTTP/1.1" from [::1]:39092 - 400 250B in 323.08Âµs
2025/11/25 13:25:09 INFO {"audit_event":"updated_client_settings","details":{"clientId":4351,"loggedInUser":""}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000795] "PUT http://localhost:19090/api/v1/admin/clients/4351 HTTP/1.1" from [::1]:39106 - 200 598B in 1.260231ms
--- PASS: TestAPIClientUpdatePut_WhitespaceHandling (0.01s)
=== RUN   TestAPIClientUpdatePut_SystemLevelClientRejected
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4352}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000796] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39122 - 200 1156B in 3.966384ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000797] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:39130 - 200 2288750B in 225.121001ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000798] "PUT http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:39134 - 400 87B in 639.779Âµs
--- PASS: TestAPIClientUpdatePut_SystemLevelClientRejected (0.24s)
=== RUN   TestAPIClientUpdatePut_InvalidDefaultAcrLevelValue
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4353}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000799] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39144 - 200 1156B in 4.184226ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000800] "PUT http://localhost:19090/api/v1/admin/clients/4354 HTTP/1.1" from [::1]:39158 - 400 76B in 411.187Âµs
--- PASS: TestAPIClientUpdatePut_InvalidDefaultAcrLevelValue (0.01s)
=== RUN   TestAPIClientUpdatePut_InsufficientScope
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4355}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000801] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39172 - 200 1157B in 4.054401ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000802] "PUT http://localhost:19090/api/v1/admin/clients/4356 HTTP/1.1" from [::1]:39176 - 403 19B in 285.719Âµs
--- PASS: TestAPIClientUpdatePut_InsufficientScope (0.01s)
=== RUN   TestAPIClientWebOriginsPut_Success_AddRemoveAndNormalize
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4357}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000803] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39184 - 200 1156B in 4.062206ms
2025/11/25 13:25:09 INFO {"audit_event":"updated_web_origins","details":{"clientId":4358,"loggedInUser":""}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000804] "PUT http://localhost:19090/api/v1/admin/clients/4358/web-origins HTTP/1.1" from [::1]:39188 - 200 798B in 1.718898ms
--- PASS: TestAPIClientWebOriginsPut_Success_AddRemoveAndNormalize (0.01s)
=== RUN   TestAPIClientWebOriginsPut_AuthCodeDisabledRejected
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4359}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000805] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39198 - 200 1156B in 4.20198ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000806] "PUT http://localhost:19090/api/v1/admin/clients/4360/web-origins HTTP/1.1" from [::1]:39204 - 400 103B in 383.064Âµs
--- PASS: TestAPIClientWebOriginsPut_AuthCodeDisabledRejected (0.01s)
=== RUN   TestAPIClientWebOriginsPut_SystemLevelClientRejected
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4361}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000807] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39206 - 200 1156B in 3.999688ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000808] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:39208 - 200 2290946B in 219.742799ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000809] "PUT http://localhost:19090/api/v1/admin/clients/1/web-origins HTTP/1.1" from [::1]:39222 - 400 87B in 898.497Âµs
--- PASS: TestAPIClientWebOriginsPut_SystemLevelClientRejected (0.24s)
=== RUN   TestAPIClientWebOriginsPut_DuplicateInvalidWrongSchemeAndEmpty
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4362}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000810] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39238 - 200 1156B in 4.63131ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000811] "PUT http://localhost:19090/api/v1/admin/clients/4363/web-origins HTTP/1.1" from [::1]:39254 - 400 88B in 489.505Âµs
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000812] "PUT http://localhost:19090/api/v1/admin/clients/4363/web-origins HTTP/1.1" from [::1]:39264 - 400 80B in 653.024Âµs
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000813] "PUT http://localhost:19090/api/v1/admin/clients/4363/web-origins HTTP/1.1" from [::1]:39274 - 400 91B in 417.338Âµs
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000814] "PUT http://localhost:19090/api/v1/admin/clients/4363/web-origins HTTP/1.1" from [::1]:39282 - 400 77B in 316.878Âµs
--- PASS: TestAPIClientWebOriginsPut_DuplicateInvalidWrongSchemeAndEmpty (0.01s)
=== RUN   TestAPIClientWebOriginsPut_NotFound_InvalidId_InvalidBody_Unauthorized
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4364}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000815] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39284 - 200 1156B in 4.550869ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000816] "PUT http://localhost:19090/api/v1/admin/clients/999999/web-origins HTTP/1.1" from [::1]:39292 - 404 60B in 288.044Âµs
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000817] "PUT http://localhost:19090/api/v1/admin/clients/abc/web-origins HTTP/1.1" from [::1]:39300 - 400 68B in 252.507Âµs
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000818] "PUT http://localhost:19090/api/v1/admin/clients/4365/web-origins HTTP/1.1" from [::1]:39316 - 400 70B in 286.761Âµs
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000819] "PUT http://localhost:19090/api/v1/admin/clients/4365/web-origins HTTP/1.1" from [::1]:39316 - 401 22B in 45.626Âµs
--- PASS: TestAPIClientWebOriginsPut_NotFound_InvalidId_InvalidBody_Unauthorized (0.01s)
=== RUN   TestAPIClientWebOriginsPut_InsufficientScope
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4366}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000820] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39332 - 200 1158B in 4.20201ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000821] "PUT http://localhost:19090/api/v1/admin/clients/4367/web-origins HTTP/1.1" from [::1]:39336 - 403 19B in 502.009Âµs
--- PASS: TestAPIClientWebOriginsPut_InsufficientScope (0.01s)
=== RUN   TestAPIGroupMembersGet_Success
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4368}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000822] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39348 - 200 1156B in 4.176652ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000823] "GET http://localhost:19090/api/v1/admin/groups/526/members HTTP/1.1" from [::1]:39362 - 200 1419B in 1.472643ms
--- PASS: TestAPIGroupMembersGet_Success (0.01s)
=== RUN   TestAPIGroupMembersGet_EmptyGroup
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4369}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000824] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39372 - 200 1156B in 3.976944ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000825] "GET http://localhost:19090/api/v1/admin/groups/527/members HTTP/1.1" from [::1]:39376 - 200 46B in 514.703Âµs
--- PASS: TestAPIGroupMembersGet_EmptyGroup (0.01s)
=== RUN   TestAPIGroupMembersGet_Pagination
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4370}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000826] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39390 - 200 1156B in 4.396878ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000827] "GET http://localhost:19090/api/v1/admin/groups/528/members?page=1&size=2 HTTP/1.1" from [::1]:39400 - 200 1422B in 592.76Âµs
--- PASS: TestAPIGroupMembersGet_Pagination (0.01s)
=== RUN   TestAPIGroupMembersGet_GroupNotFound
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4371}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000828] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39408 - 200 1156B in 4.017852ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000829] "GET http://localhost:19090/api/v1/admin/groups/99999/members HTTP/1.1" from [::1]:39420 - 404 59B in 284.338Âµs
--- PASS: TestAPIGroupMembersGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMembersGet_InvalidGroupId
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4372}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000830] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39426 - 200 1156B in 3.972396ms
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/non-numeric_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000831] "GET http://localhost:19090/api/v1/admin/groups/abc/members HTTP/1.1" from [::1]:39430 - 400 67B in 635.06Âµs
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/empty_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000832] "GET http://localhost:19090/api/v1/admin/groups//members HTTP/1.1" from [::1]:39432 - 400 71B in 548.406Âµs
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/negative_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000833] "GET http://localhost:19090/api/v1/admin/groups/-1/members HTTP/1.1" from [::1]:39436 - 404 59B in 385.969Âµs
--- PASS: TestAPIGroupMembersGet_InvalidGroupId (0.01s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/empty_ID (0.00s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/negative_ID (0.00s)
=== RUN   TestAPIGroupMemberAdd_Success
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4373}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000834] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39438 - 200 1156B in 4.096451ms
2025/11/25 13:25:09 INFO {"audit_event":"user_added_to_group","details":{"groupId":529,"loggedInUser":"","userId":1828}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000835] "POST http://localhost:19090/api/v1/admin/groups/529/members HTTP/1.1" from [::1]:39440 - 201 17B in 1.261954ms
--- PASS: TestAPIGroupMemberAdd_Success (0.01s)
=== RUN   TestAPIGroupMemberAdd_UserAlreadyInGroup
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4374}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000836] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39442 - 200 1156B in 4.072626ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000837] "POST http://localhost:19090/api/v1/admin/groups/530/members HTTP/1.1" from [::1]:39454 - 400 89B in 409.253Âµs
--- PASS: TestAPIGroupMemberAdd_UserAlreadyInGroup (0.01s)
=== RUN   TestAPIGroupMemberAdd_UserNotFound
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4375}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000838] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39458 - 200 1156B in 4.024394ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000839] "POST http://localhost:19090/api/v1/admin/groups/531/members HTTP/1.1" from [::1]:39468 - 404 63B in 403.482Âµs
--- PASS: TestAPIGroupMemberAdd_UserNotFound (0.01s)
=== RUN   TestAPIGroupMemberAdd_GroupNotFound
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4376}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000840] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39480 - 200 1156B in 4.048329ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000841] "POST http://localhost:19090/api/v1/admin/groups/99999/members HTTP/1.1" from [::1]:39482 - 404 59B in 354.379Âµs
--- PASS: TestAPIGroupMemberAdd_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMemberAdd_InvalidRequestBody
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4377}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000842] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39488 - 200 1156B in 3.987765ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000843] "POST http://localhost:19090/api/v1/admin/groups/532/members HTTP/1.1" from [::1]:39492 - 400 70B in 322.329Âµs
--- PASS: TestAPIGroupMemberAdd_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupMemberRemove_Success
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4378}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000844] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39498 - 200 1156B in 3.991612ms
2025/11/25 13:25:09 INFO {"audit_event":"user_removed_from_group","details":{"groupId":533,"loggedInUser":"","userId":1830}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000845] "DELETE http://localhost:19090/api/v1/admin/groups/533/members/1830 HTTP/1.1" from [::1]:39514 - 200 17B in 1.004197ms
--- PASS: TestAPIGroupMemberRemove_Success (0.01s)
=== RUN   TestAPIGroupMemberRemove_UserNotInGroup
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4379}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000846] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39520 - 200 1156B in 4.026338ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000847] "DELETE http://localhost:19090/api/v1/admin/groups/534/members/1831 HTTP/1.1" from [::1]:39528 - 400 85B in 431.656Âµs
--- PASS: TestAPIGroupMemberRemove_UserNotInGroup (0.01s)
=== RUN   TestAPIGroupMemberRemove_UserNotFound
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4380}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000848] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39532 - 200 1156B in 3.984678ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000849] "DELETE http://localhost:19090/api/v1/admin/groups/535/members/99999 HTTP/1.1" from [::1]:39534 - 404 63B in 411.677Âµs
--- PASS: TestAPIGroupMemberRemove_UserNotFound (0.01s)
=== RUN   TestAPIGroupMemberRemove_GroupNotFound
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4381}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000850] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39538 - 200 1156B in 3.993175ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000851] "DELETE http://localhost:19090/api/v1/admin/groups/99999/members/1 HTTP/1.1" from [::1]:39544 - 404 59B in 342.948Âµs
--- PASS: TestAPIGroupMemberRemove_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMemberRemove_InvalidIds
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4382}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000852] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39548 - 200 1156B in 3.978647ms
=== RUN   TestAPIGroupMemberRemove_InvalidIds/non-numeric_group_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000853] "DELETE http://localhost:19090/api/v1/admin/groups/abc/members/1 HTTP/1.1" from [::1]:39552 - 400 67B in 272.445Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/non-numeric_user_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000854] "DELETE http://localhost:19090/api/v1/admin/groups/1/members/abc HTTP/1.1" from [::1]:39560 - 400 66B in 218.734Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/negative_group_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000855] "DELETE http://localhost:19090/api/v1/admin/groups/-1/members/1 HTTP/1.1" from [::1]:39574 - 404 59B in 242.388Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/negative_user_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000856] "DELETE http://localhost:19090/api/v1/admin/groups/1/members/-1 HTTP/1.1" from [::1]:39586 - 404 59B in 231.427Âµs
--- PASS: TestAPIGroupMemberRemove_InvalidIds (0.01s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/non-numeric_group_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/non-numeric_user_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/negative_group_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/negative_user_ID (0.00s)
=== RUN   TestAPIGroupMembers_Unauthorized
=== RUN   TestAPIGroupMembers_Unauthorized/GET_members
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000857] "GET http://localhost:19090/api/v1/admin/groups/536/members HTTP/1.1" from [::1]:39600 - 401 22B in 84.119Âµs
=== RUN   TestAPIGroupMembers_Unauthorized/POST_add_member
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000858] "POST http://localhost:19090/api/v1/admin/groups/536/members HTTP/1.1" from [::1]:39606 - 401 22B in 76.564Âµs
=== RUN   TestAPIGroupMembers_Unauthorized/DELETE_remove_member
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000859] "DELETE http://localhost:19090/api/v1/admin/groups/536/members/1 HTTP/1.1" from [::1]:39618 - 401 22B in 53.671Âµs
--- PASS: TestAPIGroupMembers_Unauthorized (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/GET_members (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/POST_add_member (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/DELETE_remove_member (0.00s)
=== RUN   TestAPIGroupAttributesGet_Success
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4383}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000860] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39626 - 200 1156B in 4.076573ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000861] "GET http://localhost:19090/api/v1/admin/groups/537/attributes HTTP/1.1" from [::1]:39636 - 200 413B in 491.96Âµs
--- PASS: TestAPIGroupAttributesGet_Success (0.01s)
=== RUN   TestAPIGroupAttributesGet_EmptyAttributes
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4384}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000862] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39646 - 200 1156B in 3.950654ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000863] "GET http://localhost:19090/api/v1/admin/groups/538/attributes HTTP/1.1" from [::1]:39654 - 200 18B in 287.383Âµs
--- PASS: TestAPIGroupAttributesGet_EmptyAttributes (0.01s)
=== RUN   TestAPIGroupAttributesGet_GroupNotFound
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4385}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000864] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39658 - 200 1156B in 4.015718ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000865] "GET http://localhost:19090/api/v1/admin/groups/99999/attributes HTTP/1.1" from [::1]:39668 - 404 59B in 314.584Âµs
--- PASS: TestAPIGroupAttributesGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupAttributesGet_InvalidId
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4386}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000866] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39672 - 200 1156B in 4.01168ms
=== RUN   TestAPIGroupAttributesGet_InvalidId/non-numeric_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000867] "GET http://localhost:19090/api/v1/admin/groups/abc/attributes HTTP/1.1" from [::1]:39678 - 400 67B in 311.118Âµs
=== RUN   TestAPIGroupAttributesGet_InvalidId/empty_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000868] "GET http://localhost:19090/api/v1/admin/groups//attributes HTTP/1.1" from [::1]:39690 - 400 71B in 320.386Âµs
=== RUN   TestAPIGroupAttributesGet_InvalidId/negative_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000869] "GET http://localhost:19090/api/v1/admin/groups/-1/attributes HTTP/1.1" from [::1]:39694 - 404 59B in 253.388Âµs
--- PASS: TestAPIGroupAttributesGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributesGet_Unauthorized
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000870] "GET http://localhost:19090/api/v1/admin/groups/539/attributes HTTP/1.1" from [::1]:39706 - 401 22B in 76.565Âµs
--- PASS: TestAPIGroupAttributesGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeGet_Success
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4387}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000871] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39718 - 200 1156B in 4.025837ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000872] "GET http://localhost:19090/api/v1/admin/group-attributes/80 HTTP/1.1" from [::1]:39734 - 200 206B in 358.217Âµs
--- PASS: TestAPIGroupAttributeGet_Success (0.01s)
=== RUN   TestAPIGroupAttributeGet_NotFound
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4388}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000873] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39744 - 200 1156B in 3.976544ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000874] "GET http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:39746 - 404 69B in 296.319Âµs
--- PASS: TestAPIGroupAttributeGet_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeGet_InvalidId
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4389}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000875] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39756 - 200 1156B in 4.009627ms
=== RUN   TestAPIGroupAttributeGet_InvalidId/non-numeric_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000876] "GET http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:39768 - 400 77B in 242.258Âµs
=== RUN   TestAPIGroupAttributeGet_InvalidId/empty_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000877] "GET http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:39784 - 405 0B in 217.461Âµs
=== RUN   TestAPIGroupAttributeGet_InvalidId/negative_ID
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000878] "GET http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:39800 - 404 69B in 294.346Âµs
--- PASS: TestAPIGroupAttributeGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeGet_Unauthorized
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000879] "GET http://localhost:19090/api/v1/admin/group-attributes/81 HTTP/1.1" from [::1]:39812 - 401 22B in 104.247Âµs
--- PASS: TestAPIGroupAttributeGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeCreatePost_Success
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4390}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000880] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39818 - 200 1156B in 3.985741ms
2025/11/25 13:25:09 INFO {"audit_event":"added_group_attribute","details":{"groupAttributeId":82,"groupId":542,"groupIdentifier":"test-group-52870312","loggedInUser":""}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000881] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:39820 - 201 221B in 1.051176ms
--- PASS: TestAPIGroupAttributeCreatePost_Success (0.01s)
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4391}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000882] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39828 - 200 1156B in 4.003234ms
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/missing_key
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000883] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:39836 - 400 76B in 307.43Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/empty_key
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000884] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:39846 - 400 76B in 316.498Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/value_too_long
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000885] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:39850 - 400 119B in 296.51Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/invalid_key_format
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000886] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:39854 - 400 250B in 315.677Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/group_not_found
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000887] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:39870 - 404 59B in 257.346Âµs
--- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/invalid_key_format (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/group_not_found (0.00s)
=== RUN   TestAPIGroupAttributeCreatePost_InvalidRequestBody
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4392}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000888] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39882 - 200 1156B in 3.95881ms
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000889] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:39898 - 400 70B in 285.639Âµs
--- PASS: TestAPIGroupAttributeCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupAttributeCreatePost_Unauthorized
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000890] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:39908 - 401 22B in 49.193Âµs
--- PASS: TestAPIGroupAttributeCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_Success
2025/11/25 13:25:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4393}}
2025/11/25 13:25:09 [a357f2e3b56e/8P1BS7F7Qi-000891] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39920 - 200 1156B in 3.97975ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_group_attribute","details":{"groupAttributeId":83,"groupId":544,"groupIdentifier":"test-group-e2474317","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000892] "PUT http://localhost:19090/api/v1/admin/group-attributes/83 HTTP/1.1" from [::1]:39922 - 200 211B in 979.52Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_Success (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_NotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4394}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000893] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39926 - 200 1156B in 4.047748ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000894] "PUT http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:39936 - 404 69B in 318.331Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4395}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000895] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39944 - 200 1156B in 3.952108ms
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/missing_key
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000896] "PUT http://localhost:19090/api/v1/admin/group-attributes/84 HTTP/1.1" from [::1]:39946 - 400 76B in 318.291Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/empty_key
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000897] "PUT http://localhost:19090/api/v1/admin/group-attributes/84 HTTP/1.1" from [::1]:39948 - 400 76B in 286.601Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/value_too_long
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000898] "PUT http://localhost:19090/api/v1/admin/group-attributes/84 HTTP/1.1" from [::1]:39958 - 400 119B in 391.791Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/invalid_key_format
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000899] "PUT http://localhost:19090/api/v1/admin/group-attributes/84 HTTP/1.1" from [::1]:39970 - 400 250B in 1.027471ms
--- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/invalid_key_format (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4396}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000900] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:39974 - 200 1156B in 4.090128ms
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000901] "PUT http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:39990 - 400 77B in 254.12Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/empty_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000902] "PUT http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:40006 - 405 0B in 298.584Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/negative_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000903] "PUT http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:40014 - 404 69B in 281.472Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidRequestBody
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4397}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000904] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40026 - 200 1156B in 3.967897ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000905] "PUT http://localhost:19090/api/v1/admin/group-attributes/85 HTTP/1.1" from [::1]:40038 - 400 70B in 292.613Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000906] "PUT http://localhost:19090/api/v1/admin/group-attributes/86 HTTP/1.1" from [::1]:40040 - 401 22B in 60.574Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeDelete_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4398}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000907] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40044 - 200 1156B in 4.003335ms
2025/11/25 13:25:10 INFO {"audit_event":"deleted_group_attribute","details":{"groupAttributeId":87,"groupId":548,"groupIdentifier":"test-group-26a0a4b1","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000908] "DELETE http://localhost:19090/api/v1/admin/group-attributes/87 HTTP/1.1" from [::1]:40056 - 200 17B in 881.205Âµs
--- PASS: TestAPIGroupAttributeDelete_Success (0.01s)
=== RUN   TestAPIGroupAttributeDelete_NotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4399}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000909] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40064 - 200 1156B in 3.958449ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000910] "DELETE http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:40072 - 404 69B in 283.686Âµs
--- PASS: TestAPIGroupAttributeDelete_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeDelete_InvalidId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4400}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000911] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40076 - 200 1156B in 4.182012ms
=== RUN   TestAPIGroupAttributeDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000912] "DELETE http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:40088 - 400 77B in 312.15Âµs
=== RUN   TestAPIGroupAttributeDelete_InvalidId/empty_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000913] "DELETE http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:40092 - 405 0B in 220.867Âµs
=== RUN   TestAPIGroupAttributeDelete_InvalidId/negative_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000914] "DELETE http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:40106 - 404 69B in 252.978Âµs
--- PASS: TestAPIGroupAttributeDelete_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeDelete_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000915] "DELETE http://localhost:19090/api/v1/admin/group-attributes/88 HTTP/1.1" from [::1]:40118 - 401 22B in 63.45Âµs
--- PASS: TestAPIGroupAttributeDelete_Unauthorized (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4401}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000916] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40132 - 200 1156B in 4.002844ms
2025/11/25 13:25:10 INFO {"audit_event":"created_group","details":{"groupId":550,"groupIdentifier":"test-group-HTtVsH","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000917] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40148 - 201 257B in 1.067237ms
--- PASS: TestHandleAPIGroupCreatePost_Success (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4402}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000918] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40162 - 200 1156B in 3.933683ms
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Empty_group_identifier
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000919] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40164 - 400 79B in 312.601Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_short
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000920] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40178 - 400 101B in 309.034Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_long
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000921] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40190 - 400 114B in 267.025Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Invalid_group_identifier_characters
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000922] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40200 - 400 250B in 233.741Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Description_too_long
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000923] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40202 - 400 115B in 219.014Âµs
--- PASS: TestHandleAPIGroupCreatePost_ValidationErrors (0.01s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Empty_group_identifier (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_short (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_long (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Invalid_group_identifier_characters (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Description_too_long (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_DuplicateGroupIdentifier
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4403}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000924] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40210 - 200 1156B in 3.992493ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000925] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40222 - 400 89B in 355.973Âµs
--- PASS: TestHandleAPIGroupCreatePost_DuplicateGroupIdentifier (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_InputSanitization
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4404}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000926] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40226 - 200 1156B in 4.036346ms
2025/11/25 13:25:10 INFO {"audit_event":"created_group","details":{"groupId":552,"groupIdentifier":"test-group-AxRilH","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000927] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40240 - 201 251B in 969.382Âµs
--- PASS: TestHandleAPIGroupCreatePost_InputSanitization (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000928] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40256 - 401 22B in 109.577Âµs
--- PASS: TestHandleAPIGroupCreatePost_Unauthorized (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_InvalidJSON
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4405}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000929] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40262 - 200 1156B in 3.981974ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000930] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40272 - 400 70B in 274.168Âµs
--- PASS: TestHandleAPIGroupCreatePost_InvalidJSON (0.01s)
=== RUN   TestAPIGroupDelete_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4406}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000931] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40274 - 200 1156B in 3.926569ms
2025/11/25 13:25:10 INFO {"audit_event":"deleted_group","details":{"groupId":553,"groupIdentifier":"test-group-50b92ccd","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000932] "DELETE http://localhost:19090/api/v1/admin/groups/553 HTTP/1.1" from [::1]:40288 - 200 17B in 992.585Âµs
--- PASS: TestAPIGroupDelete_Success (0.01s)
=== RUN   TestAPIGroupDelete_SuccessWithMembers
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4407}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000933] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40300 - 200 1156B in 3.941377ms
2025/11/25 13:25:10 INFO {"audit_event":"deleted_group","details":{"groupId":554,"groupIdentifier":"test-group-e3b4cd59","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000934] "DELETE http://localhost:19090/api/v1/admin/groups/554 HTTP/1.1" from [::1]:40316 - 200 17B in 850.817Âµs
--- PASS: TestAPIGroupDelete_SuccessWithMembers (0.01s)
=== RUN   TestAPIGroupDelete_NotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4408}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000935] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40322 - 200 1156B in 3.927901ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000936] "DELETE http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:40338 - 404 59B in 328.752Âµs
--- PASS: TestAPIGroupDelete_NotFound (0.01s)
=== RUN   TestAPIGroupDelete_InvalidId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4409}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000937] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40352 - 200 1156B in 3.978968ms
=== RUN   TestAPIGroupDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000938] "DELETE http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:40356 - 400 67B in 259.851Âµs
=== RUN   TestAPIGroupDelete_InvalidId/empty_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000939] "DELETE http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:40372 - 405 0B in 287.022Âµs
=== RUN   TestAPIGroupDelete_InvalidId/negative_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000940] "DELETE http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:40378 - 404 59B in 290.458Âµs
--- PASS: TestAPIGroupDelete_InvalidId (0.01s)
    --- PASS: TestAPIGroupDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupDelete_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000941] "DELETE http://localhost:19090/api/v1/admin/groups/555 HTTP/1.1" from [::1]:40394 - 401 22B in 61.476Âµs
--- PASS: TestAPIGroupDelete_Unauthorized (0.00s)
=== RUN   TestAPIGroupDelete_InvalidToken
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000942] "DELETE http://localhost:19090/api/v1/admin/groups/556 HTTP/1.1" from [::1]:40398 - 401 22B in 219.855Âµs
--- PASS: TestAPIGroupDelete_InvalidToken (0.00s)
=== RUN   TestAPIGroupDelete_WithGroupPermissions
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4410}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000943] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40414 - 200 1156B in 4.003394ms
2025/11/25 13:25:10 INFO {"audit_event":"deleted_group","details":{"groupId":557,"groupIdentifier":"test-group-b0ac812d","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000944] "DELETE http://localhost:19090/api/v1/admin/groups/557 HTTP/1.1" from [::1]:40426 - 200 17B in 908.677Âµs
--- PASS: TestAPIGroupDelete_WithGroupPermissions (0.01s)
=== RUN   TestAPIGroupDelete_ResponseStructure
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4411}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000945] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40442 - 200 1156B in 3.980611ms
2025/11/25 13:25:10 INFO {"audit_event":"deleted_group","details":{"groupId":558,"groupIdentifier":"test-group-f8967c74","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000946] "DELETE http://localhost:19090/api/v1/admin/groups/558 HTTP/1.1" from [::1]:40444 - 200 17B in 889Âµs
--- PASS: TestAPIGroupDelete_ResponseStructure (0.01s)
=== RUN   TestAPIGroupsGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4412}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000947] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40450 - 200 1156B in 3.947909ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000948] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40458 - 200 465B in 383.916Âµs
--- PASS: TestAPIGroupsGet_Success (0.01s)
=== RUN   TestAPIGroupsGet_EmptyGroups
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4413}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000949] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40464 - 200 1156B in 3.951947ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000950] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40468 - 200 14B in 284.247Âµs
    api_groups_get_test.go:113: Raw response body: {"groups":[]}
    api_groups_get_test.go:121: Response Groups: []
    api_groups_get_test.go:122: Groups is nil: false
    api_groups_get_test.go:123: Groups length: 0
    api_groups_get_test.go:129: Raw map parsing - groups value: []
    api_groups_get_test.go:130: Raw map parsing - groups type: []interface {}
--- PASS: TestAPIGroupsGet_EmptyGroups (0.01s)
=== RUN   TestAPIGroupsGet_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000951] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40484 - 401 22B in 67.076Âµs
--- PASS: TestAPIGroupsGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupsGet_InvalidToken
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000952] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40494 - 401 22B in 162.056Âµs
--- PASS: TestAPIGroupsGet_InvalidToken (0.00s)
=== RUN   TestAPIGroupsGet_EnhancedResponseStructure
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4414}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000953] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40508 - 200 1156B in 3.96382ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000954] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40522 - 200 252B in 347.366Âµs
--- PASS: TestAPIGroupsGet_EnhancedResponseStructure (0.01s)
=== RUN   TestAPIGroupsGet_MixedTokenInclusion
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4415}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000955] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40524 - 200 1156B in 4.433758ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000956] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40526 - 200 985B in 578.282Âµs
--- PASS: TestAPIGroupsGet_MixedTokenInclusion (0.01s)
=== RUN   TestAPIGroupsGet_MemberCountAccuracy
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4416}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000957] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40540 - 200 1156B in 4.226115ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000958] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40548 - 200 244B in 774.844Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000959] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:40560 - 200 244B in 452.906Âµs
--- PASS: TestAPIGroupsGet_MemberCountAccuracy (0.01s)
=== RUN   TestAPIGroupPermissionsGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4417}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000960] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40574 - 200 1156B in 4.282171ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000961] "GET http://localhost:19090/api/v1/admin/groups/567/permissions HTTP/1.1" from [::1]:40590 - 200 641B in 1.018174ms
--- PASS: TestAPIGroupPermissionsGet_Success (0.01s)
=== RUN   TestAPIGroupPermissionsGet_GroupNotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4418}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000962] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40606 - 200 1156B in 4.666016ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000963] "GET http://localhost:19090/api/v1/admin/groups/99999/permissions HTTP/1.1" from [::1]:40618 - 404 59B in 528.359Âµs
--- PASS: TestAPIGroupPermissionsGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsGet_InvalidGroupId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4419}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000964] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40624 - 200 1156B in 4.174938ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000965] "GET http://localhost:19090/api/v1/admin/groups/invalid/permissions HTTP/1.1" from [::1]:40632 - 400 74B in 424.412Âµs
--- PASS: TestAPIGroupPermissionsGet_InvalidGroupId (0.01s)
=== RUN   TestAPIGroupPermissionsGet_NoPermissions
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4420}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000966] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40644 - 200 1156B in 4.322978ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000967] "GET http://localhost:19090/api/v1/admin/groups/568/permissions HTTP/1.1" from [::1]:40648 - 200 258B in 513.811Âµs
--- PASS: TestAPIGroupPermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIGroupPermissionsGet_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000968] "GET http://localhost:19090/api/v1/admin/groups/569/permissions HTTP/1.1" from [::1]:40658 - 401 22B in 92.765Âµs
--- PASS: TestAPIGroupPermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupPermissionsPut_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4421}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000969] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40672 - 200 1156B in 4.847269ms
2025/11/25 13:25:10 INFO {"audit_event":"added_group_permission","details":{"groupId":570,"loggedInUser":"","permissionId":674}}
2025/11/25 13:25:10 INFO {"audit_event":"added_group_permission","details":{"groupId":570,"loggedInUser":"","permissionId":675}}
2025/11/25 13:25:10 INFO {"audit_event":"deleted_group_permission","details":{"groupId":570,"loggedInUser":"","permissionId":673}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000970] "PUT http://localhost:19090/api/v1/admin/groups/570/permissions HTTP/1.1" from [::1]:40688 - 200 17B in 2.689442ms
--- PASS: TestAPIGroupPermissionsPut_Success (0.02s)
=== RUN   TestAPIGroupPermissionsPut_RemoveAllPermissions
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4422}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000971] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40700 - 200 1156B in 4.603448ms
2025/11/25 13:25:10 INFO {"audit_event":"deleted_group_permission","details":{"groupId":571,"loggedInUser":"","permissionId":676}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000972] "PUT http://localhost:19090/api/v1/admin/groups/571/permissions HTTP/1.1" from [::1]:40708 - 200 17B in 852.801Âµs
--- PASS: TestAPIGroupPermissionsPut_RemoveAllPermissions (0.01s)
=== RUN   TestAPIGroupPermissionsPut_AddPermissionsToEmptyGroup
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4423}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000973] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40714 - 200 1156B in 4.41398ms
2025/11/25 13:25:10 INFO {"audit_event":"added_group_permission","details":{"groupId":572,"loggedInUser":"","permissionId":677}}
2025/11/25 13:25:10 INFO {"audit_event":"added_group_permission","details":{"groupId":572,"loggedInUser":"","permissionId":678}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000974] "PUT http://localhost:19090/api/v1/admin/groups/572/permissions HTTP/1.1" from [::1]:40724 - 200 17B in 1.532405ms
--- PASS: TestAPIGroupPermissionsPut_AddPermissionsToEmptyGroup (0.01s)
=== RUN   TestAPIGroupPermissionsPut_GroupNotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4424}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000975] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40736 - 200 1156B in 4.087343ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000976] "PUT http://localhost:19090/api/v1/admin/groups/99999/permissions HTTP/1.1" from [::1]:40752 - 404 59B in 543.657Âµs
--- PASS: TestAPIGroupPermissionsPut_GroupNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsPut_PermissionNotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4425}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000977] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40760 - 200 1156B in 3.992103ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000978] "PUT http://localhost:19090/api/v1/admin/groups/573/permissions HTTP/1.1" from [::1]:40776 - 404 64B in 491.218Âµs
--- PASS: TestAPIGroupPermissionsPut_PermissionNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsPut_InvalidRequestBody
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4426}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000979] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40786 - 200 1156B in 4.007723ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000980] "PUT http://localhost:19090/api/v1/admin/groups/574/permissions HTTP/1.1" from [::1]:40794 - 400 71B in 270.21Âµs
--- PASS: TestAPIGroupPermissionsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4427}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000981] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40806 - 200 1156B in 3.951507ms
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/non-numeric_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000982] "PUT http://localhost:19090/api/v1/admin/groups/abc/permissions HTTP/1.1" from [::1]:40814 - 400 74B in 276.702Âµs
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/negative_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000983] "PUT http://localhost:19090/api/v1/admin/groups/-1/permissions HTTP/1.1" from [::1]:40822 - 404 59B in 323.011Âµs
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/zero_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000984] "PUT http://localhost:19090/api/v1/admin/groups/0/permissions HTTP/1.1" from [::1]:40836 - 404 59B in 280.32Âµs
--- PASS: TestAPIGroupPermissionsPut_InvalidGroupId (0.01s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/negative_ID (0.00s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/zero_ID (0.00s)
=== RUN   TestAPIGroupPermissionsPut_DuplicatePermissionIds
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4428}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000985] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40842 - 200 1156B in 3.957859ms
2025/11/25 13:25:10 INFO {"audit_event":"added_group_permission","details":{"groupId":575,"loggedInUser":"","permissionId":679}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000986] "PUT http://localhost:19090/api/v1/admin/groups/575/permissions HTTP/1.1" from [::1]:40856 - 200 17B in 933.554Âµs
--- PASS: TestAPIGroupPermissionsPut_DuplicatePermissionIds (0.01s)
=== RUN   TestAPIGroupPermissionsPut_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000987] "PUT http://localhost:19090/api/v1/admin/groups/576/permissions HTTP/1.1" from [::1]:40862 - 401 22B in 62.498Âµs
--- PASS: TestAPIGroupPermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIGroupPermissionsPut_ComplexScenario
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4429}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000988] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40866 - 200 1156B in 3.983316ms
2025/11/25 13:25:10 INFO {"audit_event":"added_group_permission","details":{"groupId":577,"loggedInUser":"","permissionId":683}}
2025/11/25 13:25:10 INFO {"audit_event":"deleted_group_permission","details":{"groupId":577,"loggedInUser":"","permissionId":680}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000989] "PUT http://localhost:19090/api/v1/admin/groups/577/permissions HTTP/1.1" from [::1]:40870 - 200 17B in 1.718687ms
--- PASS: TestAPIGroupPermissionsPut_ComplexScenario (0.02s)
=== RUN   TestAPIGroupsSearch_Annotated_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4430}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000990] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40876 - 200 1156B in 3.987054ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000991] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=684&page=1&size=200 HTTP/1.1" from [::1]:40878 - 200 800B in 731.963Âµs
--- PASS: TestAPIGroupsSearch_Annotated_Success (0.01s)
=== RUN   TestAPIGroupsSearch_MissingAnnotateParam
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4431}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000992] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40882 - 200 1156B in 4.029493ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000993] "GET http://localhost:19090/api/v1/admin/groups/search?page=1&size=10 HTTP/1.1" from [::1]:40884 - 400 83B in 320.696Âµs
--- PASS: TestAPIGroupsSearch_MissingAnnotateParam (0.01s)
=== RUN   TestAPIGroupsSearch_InvalidAnnotateParam
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4432}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000994] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40886 - 200 1156B in 3.966905ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000995] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=abc&page=1&size=10 HTTP/1.1" from [::1]:40898 - 400 79B in 306.198Âµs
--- PASS: TestAPIGroupsSearch_InvalidAnnotateParam (0.01s)
=== RUN   TestAPIGroupsSearch_PermissionNotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4433}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000996] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40910 - 200 1156B in 3.949352ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000997] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=9820908 HTTP/1.1" from [::1]:40918 - 404 64B in 327.779Âµs
--- PASS: TestAPIGroupsSearch_PermissionNotFound (0.01s)
=== RUN   TestAPIGroupsSearch_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000998] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=685 HTTP/1.1" from [::1]:40934 - 401 22B in 65.854Âµs
--- PASS: TestAPIGroupsSearch_Unauthorized (0.00s)
=== RUN   TestAPIGroupGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4434}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-000999] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40938 - 200 1156B in 3.987454ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001000] "GET http://localhost:19090/api/v1/admin/groups/581 HTTP/1.1" from [::1]:40942 - 200 241B in 313.793Âµs
--- PASS: TestAPIGroupGet_Success (0.01s)
=== RUN   TestAPIGroupGet_NotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4435}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001001] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40944 - 200 1156B in 3.945855ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001002] "GET http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:40956 - 404 59B in 258.919Âµs
--- PASS: TestAPIGroupGet_NotFound (0.01s)
=== RUN   TestAPIGroupGet_InvalidId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4436}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001003] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:40972 - 200 1156B in 3.930387ms
=== RUN   TestAPIGroupGet_InvalidId/non-numeric_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001004] "GET http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:40984 - 400 67B in 319.253Âµs
=== RUN   TestAPIGroupGet_InvalidId/empty_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001005] "GET http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:40996 - 200 14B in 313.292Âµs
=== RUN   TestAPIGroupGet_InvalidId/negative_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001006] "GET http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:41008 - 404 59B in 283.416Âµs
--- PASS: TestAPIGroupGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupGet_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001007] "GET http://localhost:19090/api/v1/admin/groups/582 HTTP/1.1" from [::1]:41020 - 401 22B in 78.448Âµs
--- PASS: TestAPIGroupGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupGet_MemberCountAccuracy
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4437}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001008] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41022 - 200 1156B in 4.081321ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001009] "GET http://localhost:19090/api/v1/admin/groups/583 HTTP/1.1" from [::1]:41028 - 200 241B in 328.601Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001010] "GET http://localhost:19090/api/v1/admin/groups/583 HTTP/1.1" from [::1]:41036 - 200 241B in 279.869Âµs
--- PASS: TestAPIGroupGet_MemberCountAccuracy (0.01s)
=== RUN   TestAPIGroupUpdatePut_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4438}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001011] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41052 - 200 1156B in 4.087322ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_group","details":{"groupId":584,"groupIdentifier":"updated-group-jJkUmT","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001012] "PUT http://localhost:19090/api/v1/admin/groups/584 HTTP/1.1" from [::1]:41054 - 200 260B in 1.080241ms
--- PASS: TestAPIGroupUpdatePut_Success (0.01s)
=== RUN   TestAPIGroupUpdatePut_ValidationErrors
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4439}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001013] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41068 - 200 1156B in 3.956236ms
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/empty_group_identifier
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001014] "PUT http://localhost:19090/api/v1/admin/groups/585 HTTP/1.1" from [::1]:41074 - 400 79B in 284.568Âµs
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/description_too_long
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001015] "PUT http://localhost:19090/api/v1/admin/groups/585 HTTP/1.1" from [::1]:41076 - 400 115B in 252.087Âµs
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/invalid_identifier_format
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001016] "PUT http://localhost:19090/api/v1/admin/groups/585 HTTP/1.1" from [::1]:41082 - 400 250B in 268.387Âµs
--- PASS: TestAPIGroupUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/empty_group_identifier (0.00s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/description_too_long (0.00s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIGroupUpdatePut_DuplicateIdentifier
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4440}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001017] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41096 - 200 1156B in 3.925427ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001018] "PUT http://localhost:19090/api/v1/admin/groups/587 HTTP/1.1" from [::1]:41098 - 400 89B in 397.08Âµs
--- PASS: TestAPIGroupUpdatePut_DuplicateIdentifier (0.01s)
=== RUN   TestAPIGroupUpdatePut_SameIdentifier
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4441}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001019] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41100 - 200 1156B in 3.950405ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_group","details":{"groupId":588,"groupIdentifier":"test-group-65edaa25","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001020] "PUT http://localhost:19090/api/v1/admin/groups/588 HTTP/1.1" from [::1]:41114 - 200 252B in 957.82Âµs
--- PASS: TestAPIGroupUpdatePut_SameIdentifier (0.01s)
=== RUN   TestAPIGroupUpdatePut_NotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4442}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001021] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41116 - 200 1156B in 4.055623ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001022] "PUT http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:41126 - 404 59B in 329.582Âµs
--- PASS: TestAPIGroupUpdatePut_NotFound (0.01s)
=== RUN   TestAPIGroupUpdatePut_InvalidId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4443}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001023] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41140 - 200 1156B in 4.003735ms
=== RUN   TestAPIGroupUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001024] "PUT http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:41142 - 400 67B in 264.2Âµs
=== RUN   TestAPIGroupUpdatePut_InvalidId/empty_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001025] "PUT http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:41146 - 405 0B in 277.184Âµs
=== RUN   TestAPIGroupUpdatePut_InvalidId/negative_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001026] "PUT http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:41156 - 404 59B in 291.952Âµs
--- PASS: TestAPIGroupUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupUpdatePut_InvalidRequestBody
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4444}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001027] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41162 - 200 1156B in 3.982285ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001028] "PUT http://localhost:19090/api/v1/admin/groups/589 HTTP/1.1" from [::1]:41164 - 400 70B in 289.256Âµs
--- PASS: TestAPIGroupUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupUpdatePut_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001029] "PUT http://localhost:19090/api/v1/admin/groups/590 HTTP/1.1" from [::1]:41170 - 401 22B in 65.814Âµs
--- PASS: TestAPIGroupUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIGroupUpdatePut_WhitespaceHandling
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4445}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001030] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41172 - 200 1156B in 4.014525ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001031] "PUT http://localhost:19090/api/v1/admin/groups/591 HTTP/1.1" from [::1]:41184 - 400 250B in 314.143Âµs
2025/11/25 13:25:10 INFO {"audit_event":"updated_group","details":{"groupId":591,"groupIdentifier":"whitespace-identifier-yQcx","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001032] "PUT http://localhost:19090/api/v1/admin/groups/591 HTTP/1.1" from [::1]:41186 - 200 263B in 911.592Âµs
--- PASS: TestAPIGroupUpdatePut_WhitespaceHandling (0.01s)
=== RUN   TestAPIGroupUpdatePut_BooleanFlags
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4446}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001033] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41190 - 200 1156B in 3.9428ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/both_false
2025/11/25 13:25:10 INFO {"audit_event":"updated_group","details":{"groupId":592,"groupIdentifier":"test-bool-group-QcObvQpX","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001034] "PUT http://localhost:19090/api/v1/admin/groups/592 HTTP/1.1" from [::1]:41194 - 200 262B in 941.709Âµs
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/id_token_only
2025/11/25 13:25:10 INFO {"audit_event":"updated_group","details":{"groupId":592,"groupIdentifier":"test-bool-group-QcObvQpX","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001035] "PUT http://localhost:19090/api/v1/admin/groups/592 HTTP/1.1" from [::1]:41210 - 200 264B in 921.692Âµs
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/access_token_only
2025/11/25 13:25:10 INFO {"audit_event":"updated_group","details":{"groupId":592,"groupIdentifier":"test-bool-group-QcObvQpX","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001036] "PUT http://localhost:19090/api/v1/admin/groups/592 HTTP/1.1" from [::1]:41226 - 200 268B in 922.994Âµs
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/both_true
2025/11/25 13:25:10 INFO {"audit_event":"updated_group","details":{"groupId":592,"groupIdentifier":"test-bool-group-QcObvQpX","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001037] "PUT http://localhost:19090/api/v1/admin/groups/592 HTTP/1.1" from [::1]:41242 - 200 259B in 923.244Âµs
--- PASS: TestAPIGroupUpdatePut_BooleanFlags (0.01s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/both_false (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/id_token_only (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/access_token_only (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/both_true (0.00s)
=== RUN   TestAPIGroupUpdatePut_MemberCountInResponse
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4447}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001038] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41256 - 200 1156B in 4.480906ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_group","details":{"groupId":593,"groupIdentifier":"test-group-b87bcf42-updated","loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001039] "PUT http://localhost:19090/api/v1/admin/groups/593 HTTP/1.1" from [::1]:41264 - 200 261B in 1.269198ms
--- PASS: TestAPIGroupUpdatePut_MemberCountInResponse (0.01s)
=== RUN   TestAPIPermissionUsersGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4448}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001040] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41274 - 200 1156B in 4.267904ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001041] "GET http://localhost:19090/api/v1/admin/permissions/686/users?page=1&size=200 HTTP/1.1" from [::1]:41284 - 200 1452B in 1.127761ms
--- PASS: TestAPIPermissionUsersGet_Success (0.01s)
=== RUN   TestAPIPermissionUsersGet_InvalidPermissionId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4449}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001042] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41286 - 200 1156B in 4.098363ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001043] "GET http://localhost:19090/api/v1/admin/permissions/invalid/users HTTP/1.1" from [::1]:41290 - 400 79B in 287.994Âµs
--- PASS: TestAPIPermissionUsersGet_InvalidPermissionId (0.01s)
=== RUN   TestAPIPermissionUsersGet_PermissionNotFound
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4450}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001044] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41302 - 200 1156B in 3.998956ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001045] "GET http://localhost:19090/api/v1/admin/permissions/7181462/users HTTP/1.1" from [::1]:41318 - 404 64B in 261.945Âµs
--- PASS: TestAPIPermissionUsersGet_PermissionNotFound (0.01s)
=== RUN   TestAPIPermissionUsersGet_UserinfoForbidden
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4451}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001046] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41332 - 200 1156B in 4.038852ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001047] "GET http://localhost:19090/api/v1/admin/permissions/1/users HTTP/1.1" from [::1]:41340 - 400 96B in 357.456Âµs
--- PASS: TestAPIPermissionUsersGet_UserinfoForbidden (0.01s)
=== RUN   TestAPIPermissionUsersGet_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001048] "GET http://localhost:19090/api/v1/admin/permissions/687/users HTTP/1.1" from [::1]:41356 - 401 22B in 81.835Âµs
--- PASS: TestAPIPermissionUsersGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcePermissionsGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4452}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001049] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41358 - 200 1156B in 4.004296ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001050] "GET http://localhost:19090/api/v1/admin/resources/621/permissions HTTP/1.1" from [::1]:41372 - 200 652B in 401.899Âµs
--- PASS: TestAPIResourcePermissionsGet_Success (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NoPermissions
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4453}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001051] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41384 - 200 1156B in 4.072135ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001052] "GET http://localhost:19090/api/v1/admin/resources/622/permissions HTTP/1.1" from [::1]:41386 - 200 19B in 344.742Âµs
--- PASS: TestAPIResourcePermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NonExistentResource
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4454}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001053] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41394 - 200 1156B in 3.96399ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001054] "GET http://localhost:19090/api/v1/admin/resources/99999/permissions HTTP/1.1" from [::1]:41400 - 200 19B in 278.476Âµs
--- PASS: TestAPIResourcePermissionsGet_NonExistentResource (0.01s)
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4455}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001055] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41416 - 200 1156B in 3.969641ms
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/non-numeric_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001056] "GET http://localhost:19090/api/v1/admin/resources/abc/permissions HTTP/1.1" from [::1]:41430 - 400 77B in 286.832Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/empty_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001057] "GET http://localhost:19090/api/v1/admin/resources//permissions HTTP/1.1" from [::1]:41442 - 400 74B in 261.815Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/negative_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001058] "GET http://localhost:19090/api/v1/admin/resources/-1/permissions HTTP/1.1" from [::1]:41450 - 200 19B in 245.654Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/zero_ID
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001059] "GET http://localhost:19090/api/v1/admin/resources/0/permissions HTTP/1.1" from [::1]:41460 - 200 19B in 273.787Âµs
--- PASS: TestAPIResourcePermissionsGet_InvalidResourceId (0.01s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/non-numeric_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/empty_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/negative_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/zero_ID (0.00s)
=== RUN   TestAPIResourcePermissionsGet_AuthServerResourceFiltersUserinfo
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4456}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001060] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41470 - 200 1156B in 3.949963ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001061] "GET http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:41474 - 200 491B in 336.967Âµs
--- PASS: TestAPIResourcePermissionsGet_AuthServerResourceFiltersUserinfo (0.01s)
=== RUN   TestAPIResourcePermissionsGet_AuthServerResourceIncludesOtherPermissions
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4457}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001062] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41486 - 200 1156B in 3.94296ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001063] "GET http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:41488 - 200 700B in 399.675Âµs
--- PASS: TestAPIResourcePermissionsGet_AuthServerResourceIncludesOtherPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NonAuthServerResourceIncludesAllPermissions
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4458}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001064] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41500 - 200 1156B in 4.089407ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001065] "GET http://localhost:19090/api/v1/admin/resources/623/permissions HTTP/1.1" from [::1]:41506 - 200 460B in 422.859Âµs
--- PASS: TestAPIResourcePermissionsGet_NonAuthServerResourceIncludesAllPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001066] "GET http://localhost:19090/api/v1/admin/resources/624/permissions HTTP/1.1" from [::1]:41512 - 401 22B in 62.177Âµs
--- PASS: TestAPIResourcePermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcePermissionsGet_InvalidAccessToken
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001067] "GET http://localhost:19090/api/v1/admin/resources/625/permissions HTTP/1.1" from [::1]:41526 - 401 22B in 164.661Âµs
--- PASS: TestAPIResourcePermissionsGet_InvalidAccessToken (0.00s)
=== RUN   TestAPIResourcePermissionsGet_LargeNumberOfPermissions
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4459}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001068] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41536 - 200 1156B in 3.993887ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001069] "GET http://localhost:19090/api/v1/admin/resources/626/permissions HTTP/1.1" from [::1]:41552 - 200 2348B in 400.627Âµs
--- PASS: TestAPIResourcePermissionsGet_LargeNumberOfPermissions (0.02s)
=== RUN   TestAPIResourcePermissionsPut_Success_CreateUpdateDelete
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4460}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001070] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41564 - 200 1156B in 3.946147ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_resource_permissions","details":{"loggedInUser":"","resourceId":627}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001071] "PUT http://localhost:19090/api/v1/admin/resources/627/permissions HTTP/1.1" from [::1]:41566 - 200 17B in 2.948471ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001072] "GET http://localhost:19090/api/v1/admin/resources/627/permissions HTTP/1.1" from [::1]:41568 - 200 548B in 356.974Âµs
--- PASS: TestAPIResourcePermissionsPut_Success_CreateUpdateDelete (0.01s)
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4461}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001073] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41572 - 200 1156B in 3.959311ms
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/empty_identifier
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001074] "PUT http://localhost:19090/api/v1/admin/resources/628/permissions HTTP/1.1" from [::1]:41576 - 400 84B in 345.603Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/invalid_format
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001075] "PUT http://localhost:19090/api/v1/admin/resources/628/permissions HTTP/1.1" from [::1]:41590 - 400 250B in 283.776Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/html_in_description
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001076] "PUT http://localhost:19090/api/v1/admin/resources/628/permissions HTTP/1.1" from [::1]:41594 - 400 151B in 270.762Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/too_long_description
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001077] "PUT http://localhost:19090/api/v1/admin/resources/628/permissions HTTP/1.1" from [::1]:41610 - 400 116B in 262.626Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/duplicate_identifiers
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001078] "PUT http://localhost:19090/api/v1/admin/resources/628/permissions HTTP/1.1" from [::1]:41624 - 400 80B in 271.823Âµs
--- PASS: TestAPIResourcePermissionsPut_ValidationErrors (0.01s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/empty_identifier (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/invalid_format (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/html_in_description (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/too_long_description (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/duplicate_identifiers (0.00s)
=== RUN   TestAPIResourcePermissionsPut_UpdateConflict
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4462}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001079] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41630 - 200 1156B in 3.983216ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001080] "PUT http://localhost:19090/api/v1/admin/resources/629/permissions HTTP/1.1" from [::1]:41642 - 400 95B in 321.347Âµs
--- PASS: TestAPIResourcePermissionsPut_UpdateConflict (0.01s)
=== RUN   TestAPIResourcePermissionsPut_SystemResourceDenied
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4463}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001081] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41656 - 200 1156B in 4.061353ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001082] "PUT http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:41664 - 400 92B in 317.51Âµs
--- PASS: TestAPIResourcePermissionsPut_SystemResourceDenied (0.01s)
=== RUN   TestAPIResourcePermissionsPut_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001083] "PUT http://localhost:19090/api/v1/admin/resources/630/permissions HTTP/1.1" from [::1]:41666 - 401 22B in 78.819Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001084] "PUT http://localhost:19090/api/v1/admin/resources/630/permissions HTTP/1.1" from [::1]:41678 - 401 22B in 166.584Âµs
--- PASS: TestAPIResourcePermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIResourcesCreate_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4464}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001085] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41686 - 200 1156B in 3.991662ms
2025/11/25 13:25:10 INFO {"audit_event":"created_resource","details":{"loggedInUser":"","resourceId":631,"resourceIdentifier":"api-test-create-resource-LRMlfdPw"}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001086] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41702 - 201 113B in 881.506Âµs
--- PASS: TestAPIResourcesCreate_Success (0.01s)
=== RUN   TestAPIResourcesCreate_ValidationErrors
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4465}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001087] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41718 - 200 1156B in 3.972896ms
=== RUN   TestAPIResourcesCreate_ValidationErrors/missing_identifier
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001088] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41720 - 400 82B in 260.382Âµs
=== RUN   TestAPIResourcesCreate_ValidationErrors/too_long_description
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001089] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41736 - 400 115B in 245.775Âµs
=== RUN   TestAPIResourcesCreate_ValidationErrors/invalid_identifier_format
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001090] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41746 - 400 250B in 246.326Âµs
--- PASS: TestAPIResourcesCreate_ValidationErrors (0.01s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/missing_identifier (0.00s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/too_long_description (0.00s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIResourcesCreate_DuplicateIdentifier
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4466}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001091] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41754 - 200 1156B in 3.952017ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001092] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41756 - 400 92B in 280.951Âµs
--- PASS: TestAPIResourcesCreate_DuplicateIdentifier (0.01s)
=== RUN   TestAPIResourcesCreate_InvalidRequestBody
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4467}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001093] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41766 - 200 1156B in 3.938913ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001094] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41782 - 400 70B in 234.714Âµs
--- PASS: TestAPIResourcesCreate_InvalidRequestBody (0.01s)
=== RUN   TestAPIResourcesCreate_UnauthorizedAndScope
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001095] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41786 - 401 22B in 52.369Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001096] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41800 - 401 22B in 179.268Âµs
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4468}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001097] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41816 - 200 1165B in 4.087013ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001098] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:41824 - 403 19B in 268.768Âµs
--- PASS: TestAPIResourcesCreate_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceDelete_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4469}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001099] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41828 - 200 1156B in 4.047298ms
2025/11/25 13:25:10 INFO {"audit_event":"deleted_resource","details":{"loggedInUser":"","resourceId":633,"resourceIdentifier":"api-test-del-resource-FsfFuX"}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001100] "DELETE http://localhost:19090/api/v1/admin/resources/633 HTTP/1.1" from [::1]:41834 - 200 17B in 877.578Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001101] "GET http://localhost:19090/api/v1/admin/resources/633 HTTP/1.1" from [::1]:41844 - 404 62B in 276.192Âµs
--- PASS: TestAPIResourceDelete_Success (0.01s)
=== RUN   TestAPIResourceDelete_NotFoundAndInvalidId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4470}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001102] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41850 - 200 1156B in 3.988296ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001103] "DELETE http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:41852 - 404 62B in 293.094Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001104] "DELETE http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:41854 - 400 70B in 266.573Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001105] "DELETE http://localhost:19090/api/v1/admin/resources/-1 HTTP/1.1" from [::1]:41860 - 404 62B in 296.511Âµs
--- PASS: TestAPIResourceDelete_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIResourceDelete_SystemLevelResource
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4471}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001106] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41872 - 200 1156B in 4.229972ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001107] "DELETE http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:41888 - 400 91B in 401.057Âµs
--- PASS: TestAPIResourceDelete_SystemLevelResource (0.01s)
=== RUN   TestAPIResourceDelete_UnauthorizedAndScope
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001108] "DELETE http://localhost:19090/api/v1/admin/resources/634 HTTP/1.1" from [::1]:41892 - 401 22B in 114.726Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001109] "DELETE http://localhost:19090/api/v1/admin/resources/634 HTTP/1.1" from [::1]:41908 - 401 22B in 203.535Âµs
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4472}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001110] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41914 - 200 1165B in 5.19713ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001111] "DELETE http://localhost:19090/api/v1/admin/resources/634 HTTP/1.1" from [::1]:41916 - 403 19B in 314.454Âµs
--- PASS: TestAPIResourceDelete_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4473}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001112] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41930 - 200 1156B in 5.306467ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001113] "GET http://localhost:19090/api/v1/admin/resources/635 HTTP/1.1" from [::1]:41942 - 200 105B in 398.292Âµs
--- PASS: TestAPIResourceGet_Success (0.01s)
=== RUN   TestAPIResourceGet_NotFoundAndInvalidId
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4474}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001114] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41950 - 200 1156B in 4.051315ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001115] "GET http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:41960 - 404 62B in 283.766Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001116] "GET http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:41968 - 400 70B in 264.58Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001117] "GET http://localhost:19090/api/v1/admin/resources/-1 HTTP/1.1" from [::1]:41982 - 404 62B in 238.481Âµs
--- PASS: TestAPIResourceGet_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIResourceGet_UnauthorizedAndScope
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001118] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:41990 - 401 22B in 51.527Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001119] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:41992 - 401 22B in 183.757Âµs
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4475}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001120] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41998 - 200 1165B in 3.966374ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001121] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:42012 - 403 19B in 454.689Âµs
--- PASS: TestAPIResourceGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceUpdatePut_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4476}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001122] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42022 - 200 1156B in 4.254028ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_resource","details":{"loggedInUser":"","resourceId":636,"resourceIdentifier":"updated-resource-amQmbE"}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001123] "PUT http://localhost:19090/api/v1/admin/resources/636 HTTP/1.1" from [::1]:42034 - 200 100B in 1.154151ms
--- PASS: TestAPIResourceUpdatePut_Success (0.01s)
=== RUN   TestAPIResourceUpdatePut_ValidationErrors
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4477}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001124] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42042 - 200 1156B in 4.16482ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001125] "PUT http://localhost:19090/api/v1/admin/resources/637 HTTP/1.1" from [::1]:42058 - 400 82B in 405.075Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001126] "PUT http://localhost:19090/api/v1/admin/resources/637 HTTP/1.1" from [::1]:42066 - 400 115B in 275.55Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001127] "PUT http://localhost:19090/api/v1/admin/resources/637 HTTP/1.1" from [::1]:42074 - 400 250B in 280.38Âµs
--- PASS: TestAPIResourceUpdatePut_ValidationErrors (0.01s)
=== RUN   TestAPIResourceUpdatePut_DuplicateIdentifier
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4478}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001128] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42086 - 200 1156B in 4.150923ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001129] "PUT http://localhost:19090/api/v1/admin/resources/639 HTTP/1.1" from [::1]:42102 - 400 92B in 565.799Âµs
--- PASS: TestAPIResourceUpdatePut_DuplicateIdentifier (0.01s)
=== RUN   TestAPIResourceUpdatePut_SystemLevelResource
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4479}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001130] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42116 - 200 1156B in 4.887886ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001131] "PUT http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:42130 - 400 101B in 618.659Âµs
--- PASS: TestAPIResourceUpdatePut_SystemLevelResource (0.01s)
=== RUN   TestAPIResourceUpdatePut_InvalidIdAndBody
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4480}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001132] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42134 - 200 1156B in 4.420342ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001133] "PUT http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:42142 - 400 70B in 509.233Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001134] "PUT http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:42146 - 404 62B in 398.633Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001135] "PUT http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:42154 - 400 101B in 508.952Âµs
--- PASS: TestAPIResourceUpdatePut_InvalidIdAndBody (0.01s)
=== RUN   TestAPIResourceUpdatePut_UnauthorizedAndScope
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001136] "PUT http://localhost:19090/api/v1/admin/resources/640 HTTP/1.1" from [::1]:42160 - 401 22B in 131.669Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001137] "PUT http://localhost:19090/api/v1/admin/resources/640 HTTP/1.1" from [::1]:42170 - 401 22B in 287.714Âµs
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4481}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001138] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42178 - 200 1165B in 4.427856ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001139] "PUT http://localhost:19090/api/v1/admin/resources/640 HTTP/1.1" from [::1]:42192 - 403 19B in 503.131Âµs
--- PASS: TestAPIResourceUpdatePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourcesGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4482}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001140] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42196 - 200 1156B in 5.38771ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001141] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:42212 - 200 24823B in 819.669Âµs
--- PASS: TestAPIResourcesGet_Success (0.01s)
=== RUN   TestAPIResourcesGet_EmptyDatabase
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4483}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001142] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42216 - 200 1156B in 4.389103ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001143] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:42226 - 200 24643B in 1.158439ms
--- PASS: TestAPIResourcesGet_EmptyDatabase (0.01s)
=== RUN   TestAPIResourcesGet_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001144] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:42234 - 401 22B in 161.986Âµs
--- PASS: TestAPIResourcesGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcesGet_InvalidToken
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001145] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:42242 - 401 22B in 392.331Âµs
--- PASS: TestAPIResourcesGet_InvalidToken (0.00s)
=== RUN   TestAPIResourcesGet_InsufficientScope
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4484}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001146] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42258 - 200 1165B in 4.306567ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001147] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:42260 - 403 19B in 497.981Âµs
--- PASS: TestAPIResourcesGet_InsufficientScope (0.01s)
=== RUN   TestAPIResourcesGet_ManyResources
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4485}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001148] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42262 - 200 1156B in 4.839574ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001149] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:42270 - 200 24929B in 782.879Âµs
--- PASS: TestAPIResourcesGet_ManyResources (0.01s)
=== RUN   TestAPISettingsEmailGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4486}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001150] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42282 - 200 1156B in 4.475036ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001151] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42286 - 200 190B in 408.602Âµs
--- PASS: TestAPISettingsEmailGet_Success (0.01s)
=== RUN   TestAPISettingsEmailPut_EnableSuccess
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4487}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001152] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42294 - 200 1156B in 4.829064ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001153] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42310 - 200 190B in 2.419792ms
--- PASS: TestAPISettingsEmailPut_EnableSuccess (0.01s)
=== RUN   TestAPISettingsEmailPut_DisableResetsFields
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4488}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001154] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42326 - 200 1156B in 4.380146ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001155] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42336 - 200 192B in 1.582731ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001156] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42350 - 200 152B in 1.173007ms
--- PASS: TestAPISettingsEmailPut_DisableResetsFields (0.01s)
=== RUN   TestAPISettingsEmailPut_ValidationErrors
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4489}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001157] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42356 - 200 1156B in 4.877586ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001158] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42370 - 400 73B in 378.986Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001159] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42384 - 400 73B in 313.633Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001160] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42396 - 400 89B in 266.263Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001161] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42398 - 400 94B in 252.798Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001162] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42406 - 400 75B in 440.763Âµs
--- PASS: TestAPISettingsEmailPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsEmailPut_TCPConnectionFailure
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4490}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001163] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42412 - 200 1156B in 4.111498ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001164] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42416 - 400 142B in 313.142Âµs
--- PASS: TestAPISettingsEmailPut_TCPConnectionFailure (0.01s)
=== RUN   TestAPISettingsEmailPut_PasswordLifecycle
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4491}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001165] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42424 - 200 1156B in 4.08555ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001166] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42430 - 200 180B in 1.161134ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001167] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42434 - 200 180B in 298.163Âµs
2025/11/25 13:25:10 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001168] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42438 - 200 181B in 999.909Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001169] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42442 - 200 181B in 274.198Âµs
--- PASS: TestAPISettingsEmailPut_PasswordLifecycle (0.01s)
=== RUN   TestAPISettingsEmailSendTest_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4492}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001170] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42448 - 200 1156B in 4.036246ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001171] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42452 - 200 181B in 1.078598ms
2025/11/25 13:25:10 INFO {"audit_event":"sent_test_email","details":{"loggedInUser":"","to":"someone@example.com"}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001172] "POST http://localhost:19090/api/v1/admin/settings/email/send-test HTTP/1.1" from [::1]:42460 - 200 17B in 737.193Âµs
--- PASS: TestAPISettingsEmailSendTest_Success (0.01s)
=== RUN   TestAPISettingsEmailSendTest_SMTPDisabled
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4493}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001173] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42464 - 200 1156B in 4.071072ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001174] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42468 - 200 152B in 800.462Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001175] "POST http://localhost:19090/api/v1/admin/settings/email/send-test HTTP/1.1" from [::1]:42474 - 400 70B in 433.55Âµs
--- PASS: TestAPISettingsEmailSendTest_SMTPDisabled (0.01s)
=== RUN   TestAPISettingsEmail_Unauthorized
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001176] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42478 - 401 22B in 95.73Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001177] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:42478 - 401 22B in 58.881Âµs
--- PASS: TestAPISettingsEmail_Unauthorized (0.00s)
=== RUN   TestAPISettingsGeneralGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4494}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001178] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42486 - 200 1156B in 4.165871ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001179] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42488 - 200 211B in 293.204Âµs
--- PASS: TestAPISettingsGeneralGet_Success (0.01s)
=== RUN   TestAPISettingsGeneralPut_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4495}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001180] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42490 - 200 1156B in 3.983316ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001181] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42492 - 200 221B in 837.693Âµs
--- PASS: TestAPISettingsGeneralPut_Success (0.01s)
=== RUN   TestAPISettingsGeneralPut_DisableSelfRegForcesVerificationFalse
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4496}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001182] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42498 - 200 1164B in 4.000559ms
2025/11/25 13:25:10 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001183] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42504 - 200 210B in 830.95Âµs
2025/11/25 13:25:10 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001184] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42514 - 200 212B in 1.315034ms
--- PASS: TestAPISettingsGeneralPut_DisableSelfRegForcesVerificationFalse (0.01s)
=== RUN   TestAPISettingsGeneralPut_ValidationErrors
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4497}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001185] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42520 - 200 1156B in 4.563522ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001186] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42526 - 400 109B in 457.575Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001187] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42534 - 400 92B in 296.941Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001188] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42540 - 400 239B in 327.078Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001189] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42548 - 400 239B in 300.618Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001190] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42554 - 400 107B in 253.048Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001191] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42556 - 400 107B in 246.887Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001192] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42568 - 400 74B in 318.121Âµs
--- PASS: TestAPISettingsGeneralPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsGeneral_UnauthorizedAndScope
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001193] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42576 - 401 22B in 65.073Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001194] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42578 - 401 22B in 168.979Âµs
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4498}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001195] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42584 - 200 1165B in 4.025706ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001196] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42596 - 403 19B in 278.066Âµs
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001197] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:42576 - 401 22B in 39.645Âµs
--- PASS: TestAPISettingsGeneral_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsKeysGet_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4499}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001198] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42612 - 200 1156B in 4.153448ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001199] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42622 - 200 5237B in 333.43Âµs
--- PASS: TestAPISettingsKeysGet_Success (0.01s)
=== RUN   TestAPISettingsKeysRotatePost_Success
2025/11/25 13:25:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4500}}
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001200] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42634 - 200 1156B in 4.073527ms
2025/11/25 13:25:10 [a357f2e3b56e/8P1BS7F7Qi-001201] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42644 - 200 5237B in 369.128Âµs
2025/11/25 13:25:11 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:25:11 [a357f2e3b56e/8P1BS7F7Qi-001202] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:42652 - 200 17B in 568.223434ms
2025/11/25 13:25:11 [a357f2e3b56e/8P1BS7F7Qi-001203] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42654 - 200 7853B in 692.048Âµs
--- PASS: TestAPISettingsKeysRotatePost_Success (0.58s)
=== RUN   TestAPISettingsKeysRotatePost_DeletesPrevious
2025/11/25 13:25:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4501}}
2025/11/25 13:25:11 [a357f2e3b56e/8P1BS7F7Qi-001204] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42658 - 200 1156B in 4.195788ms
2025/11/25 13:25:11 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:25:11 [a357f2e3b56e/8P1BS7F7Qi-001205] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:42672 - 200 17B in 451.815654ms
2025/11/25 13:25:11 [a357f2e3b56e/8P1BS7F7Qi-001206] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42676 - 200 7854B in 686.708Âµs
2025/11/25 13:25:12 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001207] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:42682 - 200 17B in 109.230017ms
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4502}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001208] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42692 - 200 1156B in 4.520842ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001209] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42700 - 200 7854B in 357.174Âµs
--- PASS: TestAPISettingsKeysRotatePost_DeletesPrevious (0.58s)
=== RUN   TestAPISettingsKeyDelete_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4503}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001210] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42714 - 200 1156B in 4.01187ms
2025/11/25 13:25:12 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001211] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:42718 - 200 17B in 419.802166ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001212] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42724 - 200 7854B in 923.976Âµs
2025/11/25 13:25:12 INFO {"audit_event":"revoked_key","details":{"keyId":"5eb50a36-172f-434a-92c4-c022f0ae0853","loggedInUser":""}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001213] "DELETE http://localhost:19090/api/v1/admin/settings/keys/32 HTTP/1.1" from [::1]:42728 - 200 17B in 1.189838ms
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4504}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001214] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42734 - 200 1156B in 4.11205ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001215] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42740 - 200 5238B in 377.273Âµs
--- PASS: TestAPISettingsKeyDelete_Success (0.43s)
=== RUN   TestAPISettingsKeyDelete_ValidationAndUnauthorized
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4505}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001216] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42756 - 200 1156B in 3.961726ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001217] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42758 - 200 5238B in 314.925Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001218] "DELETE http://localhost:19090/api/v1/admin/settings/keys/33 HTTP/1.1" from [::1]:42764 - 400 85B in 372.955Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001219] "DELETE http://localhost:19090/api/v1/admin/settings/keys/99999999 HTTP/1.1" from [::1]:42778 - 400 64B in 287.283Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001220] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:42780 - 401 22B in 59.132Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001221] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:42780 - 401 22B in 42.31Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001222] "DELETE http://localhost:19090/api/v1/admin/settings/keys/1 HTTP/1.1" from [::1]:42790 - 401 22B in 46.298Âµs
--- PASS: TestAPISettingsKeyDelete_ValidationAndUnauthorized (0.01s)
=== RUN   TestAPISettingsSessionsGet_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4506}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001223] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42804 - 200 1156B in 3.973868ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001224] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42816 - 200 80B in 241.868Âµs
--- PASS: TestAPISettingsSessionsGet_Success (0.01s)
=== RUN   TestAPISettingsSessionsPut_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4507}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001225] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42824 - 200 1156B in 4.05404ms
2025/11/25 13:25:12 INFO {"audit_event":"updated_sessions_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001226] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42836 - 200 80B in 860.836Âµs
--- PASS: TestAPISettingsSessionsPut_Success (0.01s)
=== RUN   TestAPISettingsSessionsPut_ValidationErrors
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4508}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001227] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42852 - 200 1156B in 4.030125ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001228] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42854 - 400 116B in 275.321Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001229] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42866 - 400 116B in 253.559Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001230] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42876 - 400 123B in 248.158Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001231] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42882 - 400 123B in 251.565Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001232] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42898 - 400 123B in 229.323Âµs
--- PASS: TestAPISettingsSessionsPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsSessionsPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4509}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001233] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42906 - 200 1156B in 3.926509ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001234] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42918 - 400 70B in 239.312Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001235] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42918 - 401 22B in 35.707Âµs
--- PASS: TestAPISettingsSessionsPut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsSessions_UnauthorizedAndScope
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001236] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42924 - 401 22B in 64.552Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001237] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42932 - 401 22B in 153.891Âµs
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4510}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001238] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42934 - 200 1165B in 3.957778ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001239] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:42950 - 403 19B in 261.214Âµs
--- PASS: TestAPISettingsSessions_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsTokensGet_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4511}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001240] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42954 - 200 1156B in 3.970422ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001241] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:42956 - 200 174B in 281.652Âµs
--- PASS: TestAPISettingsTokensGet_Success (0.01s)
=== RUN   TestAPISettingsTokensPut_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4512}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42964 - 200 1156B in 4.065271ms
2025/11/25 13:25:12 INFO {"audit_event":"updated_tokens_settings","details":{"loggedInUser":"","new":{"includeOpenIDConnectClaimsInAccessToken":true,"refreshTokenOfflineIdleTimeoutInSeconds":3600,"refreshTokenOfflineMaxLifetimeInSeconds":7200,"tokenExpirationInSeconds":600},"old":{"includeOpenIDConnectClaimsInAccessToken":true,"refreshTokenOfflineIdleTimeoutInSeconds":3600,"refreshTokenOfflineMaxLifetimeInSeconds":7200,"tokenExpirationInSeconds":600}}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001243] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:42980 - 200 174B in 1.019256ms
--- PASS: TestAPISettingsTokensPut_Success (0.01s)
=== RUN   TestAPISettingsTokensPut_ValidationErrors
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4513}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001244] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42988 - 200 1156B in 4.044021ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001245] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43000 - 400 105B in 313.171Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001246] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43008 - 400 112B in 242.568Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001247] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43020 - 400 125B in 269.92Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001248] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43030 - 400 132B in 280.851Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001249] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43042 - 400 125B in 250.213Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001250] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43046 - 400 132B in 247.949Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001251] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43062 - 400 124B in 237.008Âµs
--- PASS: TestAPISettingsTokensPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsTokens_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4514}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001252] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43068 - 200 1156B in 4.067615ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001253] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43072 - 400 70B in 233.01Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001254] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43072 - 401 22B in 55.776Âµs
--- PASS: TestAPISettingsTokens_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsTokens_UnauthorizedAndScope
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001255] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43088 - 401 22B in 48.872Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001256] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43094 - 401 22B in 179.378Âµs
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4515}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001257] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43106 - 200 1165B in 3.96388ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001258] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:43110 - 403 19B in 249.531Âµs
--- PASS: TestAPISettingsTokens_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsUIThemeGet_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4516}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001259] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43112 - 200 1156B in 4.078045ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001260] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43124 - 200 333B in 286.942Âµs
--- PASS: TestAPISettingsUIThemeGet_Success (0.01s)
=== RUN   TestAPISettingsUIThemePut_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4517}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001261] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43132 - 200 1156B in 4.024995ms
2025/11/25 13:25:12 INFO {"audit_event":"updated_ui_theme_settings","details":{"loggedInUser":"","newUITheme":"light","oldUITheme":""}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001262] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43138 - 200 338B in 812.445Âµs
2025/11/25 13:25:12 INFO {"audit_event":"updated_ui_theme_settings","details":{"loggedInUser":"","newUITheme":"","oldUITheme":"light"}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001263] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43152 - 200 333B in 1.037902ms
--- PASS: TestAPISettingsUIThemePut_Success (0.01s)
=== RUN   TestAPISettingsUIThemePut_ValidationErrors
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4518}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001264] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43160 - 200 1156B in 4.325493ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001265] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43176 - 400 65B in 322.129Âµs
--- PASS: TestAPISettingsUIThemePut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsUITheme_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4519}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001266] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43188 - 200 1156B in 4.131918ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001267] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43196 - 400 70B in 266.624Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001268] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43196 - 401 22B in 38.684Âµs
--- PASS: TestAPISettingsUITheme_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsUITheme_UnauthorizedAndScope
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001269] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43202 - 401 22B in 51.838Âµs
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001270] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43206 - 401 22B in 182.214Âµs
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4520}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001271] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43222 - 200 1165B in 3.997764ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001272] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:43238 - 403 19B in 248.65Âµs
--- PASS: TestAPISettingsUITheme_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIUserGroupsGet_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4521}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001273] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43246 - 200 1156B in 4.039883ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001274] "GET http://localhost:19090/api/v1/admin/users/1840/groups HTTP/1.1" from [::1]:43256 - 200 1244B in 701.746Âµs
--- PASS: TestAPIUserGroupsGet_Success (0.01s)
=== RUN   TestAPIUserGroupsGet_NoGroups
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4522}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43266 - 200 1156B in 4.00647ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001276] "GET http://localhost:19090/api/v1/admin/users/1841/groups HTTP/1.1" from [::1]:43274 - 200 714B in 441.254Âµs
--- PASS: TestAPIUserGroupsGet_NoGroups (0.01s)
=== RUN   TestAPIUserGroupsGet_UserNotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4523}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001277] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43288 - 200 1156B in 4.041496ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001278] "GET http://localhost:19090/api/v1/admin/users/99999/groups HTTP/1.1" from [::1]:43300 - 404 63B in 546.844Âµs
--- PASS: TestAPIUserGroupsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserGroupsGet_InvalidId
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4524}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43304 - 200 1156B in 3.959912ms
=== RUN   TestAPIUserGroupsGet_InvalidId/non-numeric_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001280] "GET http://localhost:19090/api/v1/admin/users/abc/groups HTTP/1.1" from [::1]:43312 - 400 65B in 226.207Âµs
=== RUN   TestAPIUserGroupsGet_InvalidId/empty_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001281] "GET http://localhost:19090/api/v1/admin/users//groups HTTP/1.1" from [::1]:43320 - 400 69B in 207.182Âµs
=== RUN   TestAPIUserGroupsGet_InvalidId/negative_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001282] "GET http://localhost:19090/api/v1/admin/users/-1/groups HTTP/1.1" from [::1]:43322 - 404 63B in 345.553Âµs
--- PASS: TestAPIUserGroupsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGroupsGet_Unauthorized
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001283] "GET http://localhost:19090/api/v1/admin/users/1842/groups HTTP/1.1" from [::1]:43332 - 401 22B in 62.148Âµs
--- PASS: TestAPIUserGroupsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserGroupsPut_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4525}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001284] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43348 - 200 1156B in 4.015567ms
2025/11/25 13:25:12 INFO {"audit_event":"user_added_to_group","details":{"groupId":598,"loggedInUser":"","userId":1843}}
2025/11/25 13:25:12 INFO {"audit_event":"user_removed_from_group","details":{"groupId":596,"loggedInUser":"","userId":1843}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001285] "PUT http://localhost:19090/api/v1/admin/users/1843/groups HTTP/1.1" from [::1]:43354 - 200 1797B in 1.855116ms
--- PASS: TestAPIUserGroupsPut_Success (0.01s)
=== RUN   TestAPIUserGroupsPut_EmptyGroups
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4526}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001286] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43360 - 200 1156B in 3.967276ms
2025/11/25 13:25:12 INFO {"audit_event":"user_removed_from_group","details":{"groupId":599,"loggedInUser":"","userId":1844}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001287] "PUT http://localhost:19090/api/v1/admin/users/1844/groups HTTP/1.1" from [::1]:43362 - 200 717B in 1.086132ms
--- PASS: TestAPIUserGroupsPut_EmptyGroups (0.01s)
=== RUN   TestAPIUserGroupsPut_NonExistentGroup
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4527}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001288] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43376 - 200 1156B in 4.205265ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001289] "PUT http://localhost:19090/api/v1/admin/users/1845/groups HTTP/1.1" from [::1]:43382 - 400 79B in 415.895Âµs
--- PASS: TestAPIUserGroupsPut_NonExistentGroup (0.01s)
=== RUN   TestAPIUserGroupsPut_UserNotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4528}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001290] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43398 - 200 1156B in 3.941117ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001291] "PUT http://localhost:19090/api/v1/admin/users/99999/groups HTTP/1.1" from [::1]:43414 - 404 63B in 362.866Âµs
--- PASS: TestAPIUserGroupsPut_UserNotFound (0.01s)
=== RUN   TestAPIUserGroupsPut_InvalidId
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4529}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001292] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43416 - 200 1156B in 3.98509ms
=== RUN   TestAPIUserGroupsPut_InvalidId/non-numeric_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001293] "PUT http://localhost:19090/api/v1/admin/users/abc/groups HTTP/1.1" from [::1]:43426 - 400 65B in 264.901Âµs
=== RUN   TestAPIUserGroupsPut_InvalidId/empty_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001294] "PUT http://localhost:19090/api/v1/admin/users//groups HTTP/1.1" from [::1]:43430 - 400 69B in 242.649Âµs
=== RUN   TestAPIUserGroupsPut_InvalidId/negative_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001295] "PUT http://localhost:19090/api/v1/admin/users/-1/groups HTTP/1.1" from [::1]:43438 - 404 63B in 276.493Âµs
--- PASS: TestAPIUserGroupsPut_InvalidId (0.01s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGroupsPut_InvalidRequestBody
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4530}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001296] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43452 - 200 1156B in 4.097161ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001297] "PUT http://localhost:19090/api/v1/admin/users/1846/groups HTTP/1.1" from [::1]:43466 - 400 70B in 267.225Âµs
--- PASS: TestAPIUserGroupsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserGroupsPut_Unauthorized
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001298] "PUT http://localhost:19090/api/v1/admin/users/1847/groups HTTP/1.1" from [::1]:43474 - 401 22B in 70.854Âµs
--- PASS: TestAPIUserGroupsPut_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributesGet_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4531}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001299] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43480 - 200 1156B in 4.061795ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001300] "GET http://localhost:19090/api/v1/admin/users/1848/attributes HTTP/1.1" from [::1]:43488 - 200 413B in 537.325Âµs
--- PASS: TestAPIUserAttributesGet_Success (0.01s)
=== RUN   TestAPIUserAttributesGet_EmptyAttributes
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4532}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001301] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43490 - 200 1156B in 4.123461ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001302] "GET http://localhost:19090/api/v1/admin/users/1849/attributes HTTP/1.1" from [::1]:43496 - 200 20B in 632.014Âµs
--- PASS: TestAPIUserAttributesGet_EmptyAttributes (0.01s)
=== RUN   TestAPIUserAttributesGet_UserNotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4533}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001303] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43512 - 200 1156B in 4.420433ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001304] "GET http://localhost:19090/api/v1/admin/users/99999/attributes HTTP/1.1" from [::1]:43514 - 404 63B in 406.748Âµs
--- PASS: TestAPIUserAttributesGet_UserNotFound (0.01s)
=== RUN   TestAPIUserAttributesGet_InvalidId
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4534}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001305] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43526 - 200 1156B in 4.13877ms
=== RUN   TestAPIUserAttributesGet_InvalidId/non-numeric_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001306] "GET http://localhost:19090/api/v1/admin/users/abc/attributes HTTP/1.1" from [::1]:43542 - 400 65B in 313.412Âµs
=== RUN   TestAPIUserAttributesGet_InvalidId/empty_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001307] "GET http://localhost:19090/api/v1/admin/users//attributes HTTP/1.1" from [::1]:43552 - 400 70B in 280.189Âµs
=== RUN   TestAPIUserAttributesGet_InvalidId/negative_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001308] "GET http://localhost:19090/api/v1/admin/users/-1/attributes HTTP/1.1" from [::1]:43558 - 404 63B in 320.044Âµs
--- PASS: TestAPIUserAttributesGet_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributesGet_Unauthorized
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001309] "GET http://localhost:19090/api/v1/admin/users/1850/attributes HTTP/1.1" from [::1]:43568 - 401 22B in 68.459Âµs
--- PASS: TestAPIUserAttributesGet_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeGet_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4535}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001310] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43578 - 200 1156B in 4.127258ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001311] "GET http://localhost:19090/api/v1/admin/user-attributes/80 HTTP/1.1" from [::1]:43582 - 200 206B in 467.553Âµs
--- PASS: TestAPIUserAttributeGet_Success (0.01s)
=== RUN   TestAPIUserAttributeGet_NotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4536}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001312] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43586 - 200 1156B in 4.20759ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001313] "GET http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:43590 - 404 73B in 355.772Âµs
--- PASS: TestAPIUserAttributeGet_NotFound (0.01s)
=== RUN   TestAPIUserAttributeGet_InvalidId
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4537}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001314] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43604 - 200 1156B in 4.198823ms
=== RUN   TestAPIUserAttributeGet_InvalidId/non-numeric_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001315] "GET http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:43608 - 400 75B in 266.083Âµs
=== RUN   TestAPIUserAttributeGet_InvalidId/empty_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001316] "GET http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:43620 - 405 0B in 263.608Âµs
=== RUN   TestAPIUserAttributeGet_InvalidId/negative_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001317] "GET http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:43632 - 404 73B in 300.748Âµs
--- PASS: TestAPIUserAttributeGet_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeGet_Unauthorized
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001318] "GET http://localhost:19090/api/v1/admin/user-attributes/81 HTTP/1.1" from [::1]:43634 - 401 22B in 73.208Âµs
--- PASS: TestAPIUserAttributeGet_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeCreatePost_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4538}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001319] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43648 - 200 1156B in 4.103784ms
2025/11/25 13:25:12 INFO {"audit_event":"added_user_attribute","details":{"loggedInUser":"admin-test-client-wNNpLquF","userAttributeId":82,"userId":1853}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001320] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:43662 - 201 221B in 1.145705ms
--- PASS: TestAPIUserAttributeCreatePost_Success (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4539}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001321] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43674 - 200 1156B in 5.269146ms
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/missing_key
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001322] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:43690 - 400 72B in 420.585Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/empty_key
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001323] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:43706 - 400 72B in 292.212Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/value_too_long
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001324] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:43712 - 400 117B in 324.773Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/invalid_key_format
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001325] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:43724 - 400 250B in 328.751Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/user_not_found
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001326] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:43736 - 404 63B in 334.913Âµs
--- PASS: TestAPIUserAttributeCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/invalid_key_format (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/user_not_found (0.00s)
=== RUN   TestAPIUserAttributeCreatePost_InvalidRequestBody
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4540}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001327] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43738 - 200 1156B in 4.334559ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001328] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:43754 - 400 75B in 252.498Âµs
--- PASS: TestAPIUserAttributeCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_Unauthorized
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001329] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:43764 - 401 22B in 78.999Âµs
--- PASS: TestAPIUserAttributeCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4541}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43776 - 200 1156B in 4.057597ms
2025/11/25 13:25:12 INFO {"audit_event":"updated_user_attribute","details":{"loggedInUser":"admin-test-client-kLxwdmaD","userAttributeId":83,"userId":1855}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001331] "PUT http://localhost:19090/api/v1/admin/user-attributes/83 HTTP/1.1" from [::1]:43788 - 200 212B in 1.006562ms
--- PASS: TestAPIUserAttributeUpdatePut_Success (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_NotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4542}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001332] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43800 - 200 1156B in 3.959642ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001333] "PUT http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:43814 - 404 73B in 279.879Âµs
--- PASS: TestAPIUserAttributeUpdatePut_NotFound (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4543}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001334] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43828 - 200 1156B in 3.992263ms
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/missing_key
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001335] "PUT http://localhost:19090/api/v1/admin/user-attributes/84 HTTP/1.1" from [::1]:43834 - 400 72B in 328.671Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/empty_key
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001336] "PUT http://localhost:19090/api/v1/admin/user-attributes/84 HTTP/1.1" from [::1]:43850 - 400 72B in 344.591Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/value_too_long
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001337] "PUT http://localhost:19090/api/v1/admin/user-attributes/84 HTTP/1.1" from [::1]:43854 - 400 117B in 296.861Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/invalid_key_format
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001338] "PUT http://localhost:19090/api/v1/admin/user-attributes/84 HTTP/1.1" from [::1]:43856 - 400 250B in 251.184Âµs
--- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/invalid_key_format (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4544}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001339] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43862 - 200 1156B in 4.077635ms
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001340] "PUT http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:43872 - 400 75B in 278.786Âµs
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/empty_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001341] "PUT http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:43874 - 405 0B in 484.716Âµs
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/negative_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001342] "PUT http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:43890 - 404 73B in 289.747Âµs
--- PASS: TestAPIUserAttributeUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_InvalidRequestBody
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4545}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001343] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43896 - 200 1156B in 4.266131ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001344] "PUT http://localhost:19090/api/v1/admin/user-attributes/85 HTTP/1.1" from [::1]:43902 - 400 75B in 262.777Âµs
--- PASS: TestAPIUserAttributeUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_Unauthorized
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001345] "PUT http://localhost:19090/api/v1/admin/user-attributes/86 HTTP/1.1" from [::1]:43918 - 401 22B in 62.498Âµs
--- PASS: TestAPIUserAttributeUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeDelete_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4546}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001346] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43924 - 200 1156B in 4.123031ms
2025/11/25 13:25:12 INFO {"audit_event":"deleted_user_attribute","details":{"loggedInUser":"admin-test-client-LKyUcpEx","userAttributeId":87,"userId":1859}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001347] "DELETE http://localhost:19090/api/v1/admin/user-attributes/87 HTTP/1.1" from [::1]:43934 - 200 17B in 905.451Âµs
--- PASS: TestAPIUserAttributeDelete_Success (0.01s)
=== RUN   TestAPIUserAttributeDelete_NotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4547}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001348] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43942 - 200 1156B in 4.177363ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001349] "DELETE http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:43956 - 404 73B in 415.716Âµs
--- PASS: TestAPIUserAttributeDelete_NotFound (0.01s)
=== RUN   TestAPIUserAttributeDelete_InvalidId
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4548}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001350] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43966 - 200 1156B in 4.243828ms
=== RUN   TestAPIUserAttributeDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001351] "DELETE http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:43976 - 400 75B in 311.308Âµs
=== RUN   TestAPIUserAttributeDelete_InvalidId/empty_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001352] "DELETE http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:43980 - 405 0B in 232.609Âµs
=== RUN   TestAPIUserAttributeDelete_InvalidId/negative_ID
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001353] "DELETE http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:43992 - 404 73B in 366.081Âµs
--- PASS: TestAPIUserAttributeDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeDelete_Unauthorized
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001354] "DELETE http://localhost:19090/api/v1/admin/user-attributes/88 HTTP/1.1" from [::1]:44008 - 401 22B in 61.416Âµs
--- PASS: TestAPIUserAttributeDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserPasswordPut_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4549}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001355] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44018 - 200 1156B in 4.214363ms
2025/11/25 13:25:12 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-fskpCbeF","userId":1861}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001356] "PUT http://localhost:19090/api/v1/admin/users/1861/password HTTP/1.1" from [::1]:44030 - 200 700B in 36.664066ms
--- PASS: TestAPIUserPasswordPut_Success (0.08s)
=== RUN   TestAPIUserPasswordPut_ValidationError
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4550}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001357] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44044 - 200 1156B in 4.086581ms
=== RUN   TestAPIUserPasswordPut_ValidationError/empty_password
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001358] "PUT http://localhost:19090/api/v1/admin/users/1862/password HTTP/1.1" from [::1]:44060 - 400 76B in 350.442Âµs
=== RUN   TestAPIUserPasswordPut_ValidationError/too_short_password
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001359] "PUT http://localhost:19090/api/v1/admin/users/1862/password HTTP/1.1" from [::1]:44066 - 400 102B in 328.1Âµs
=== RUN   TestAPIUserPasswordPut_ValidationError/too_long_password
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001360] "PUT http://localhost:19090/api/v1/admin/users/1862/password HTTP/1.1" from [::1]:44068 - 400 103B in 321.648Âµs
--- PASS: TestAPIUserPasswordPut_ValidationError (0.01s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/empty_password (0.00s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/too_short_password (0.00s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/too_long_password (0.00s)
=== RUN   TestAPIUserPasswordPut_UserNotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4551}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001361] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44082 - 200 1156B in 3.969962ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001362] "PUT http://localhost:19090/api/v1/admin/users/99999/password HTTP/1.1" from [::1]:44088 - 404 63B in 325.855Âµs
--- PASS: TestAPIUserPasswordPut_UserNotFound (0.01s)
=== RUN   TestAPIUserPasswordPut_InvalidUserId
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4552}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001363] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44090 - 200 1156B in 3.973879ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001364] "PUT http://localhost:19090/api/v1/admin/users/invalid/password HTTP/1.1" from [::1]:44104 - 400 65B in 271.012Âµs
--- PASS: TestAPIUserPasswordPut_InvalidUserId (0.01s)
=== RUN   TestAPIUserOTPPut_DisableSuccess
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4553}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001365] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44120 - 200 1156B in 3.933342ms
2025/11/25 13:25:12 INFO {"audit_event":"disabled_otp","details":{"userId":1863}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001366] "PUT http://localhost:19090/api/v1/admin/users/1863/otp HTTP/1.1" from [::1]:44122 - 200 695B in 1.104757ms
--- PASS: TestAPIUserOTPPut_DisableSuccess (0.01s)
=== RUN   TestAPIUserOTPPut_EnableNotSupported
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4554}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001367] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44130 - 200 1156B in 4.064019ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001368] "PUT http://localhost:19090/api/v1/admin/users/1864/otp HTTP/1.1" from [::1]:44138 - 400 110B in 264.54Âµs
--- PASS: TestAPIUserOTPPut_EnableNotSupported (0.01s)
=== RUN   TestAPIUserOTPPut_UserNotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4555}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001369] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44148 - 200 1156B in 4.009556ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001370] "PUT http://localhost:19090/api/v1/admin/users/99999/otp HTTP/1.1" from [::1]:44152 - 404 63B in 364.008Âµs
--- PASS: TestAPIUserOTPPut_UserNotFound (0.01s)
=== RUN   TestAPIUserOTPPut_OTPNotEnabled
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4556}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001371] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44164 - 200 1156B in 4.22331ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001372] "PUT http://localhost:19090/api/v1/admin/users/1865/otp HTTP/1.1" from [::1]:44180 - 400 80B in 810.111Âµs
--- PASS: TestAPIUserOTPPut_OTPNotEnabled (0.01s)
=== RUN   TestAPIUserSessionGet_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4557}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001373] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44188 - 200 1156B in 4.227338ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001374] "GET http://localhost:19090/api/v1/admin/user-sessions/758c0997-bf03-4ea5-868e-ba90e4a9e343 HTTP/1.1" from [::1]:44194 - 200 488B in 495.977Âµs
--- PASS: TestAPIUserSessionGet_Success (0.01s)
=== RUN   TestAPIUserSessionGet_NotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4558}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001375] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44204 - 200 1156B in 4.315404ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001376] "GET http://localhost:19090/api/v1/admin/user-sessions/nonexistent-session HTTP/1.1" from [::1]:44220 - 404 79B in 636.423Âµs
--- PASS: TestAPIUserSessionGet_NotFound (0.01s)
=== RUN   TestAPIUserSessionPut_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4559}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001377] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44224 - 200 1156B in 4.215796ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001378] "PUT http://localhost:19090/api/v1/admin/user-sessions/fa47e2b2-76c7-4605-a4cf-48994938936c HTTP/1.1" from [::1]:44238 - 200 487B in 2.215696ms
--- PASS: TestAPIUserSessionPut_Success (0.01s)
=== RUN   TestAPIUserSessionPut_NotFound
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4560}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001379] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44250 - 200 1156B in 4.26051ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001380] "PUT http://localhost:19090/api/v1/admin/user-sessions/nonexistent-session HTTP/1.1" from [::1]:44266 - 404 79B in 467.423Âµs
--- PASS: TestAPIUserSessionPut_NotFound (0.01s)
=== RUN   TestAPIUserSessionPut_NilUpdate
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4561}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001381] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44276 - 200 1156B in 4.211668ms
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001382] "PUT http://localhost:19090/api/v1/admin/user-sessions/fe3bb46e-bee6-439c-a28a-3a9a547ca3f2 HTTP/1.1" from [::1]:44292 - 200 488B in 1.879702ms
--- PASS: TestAPIUserSessionPut_NilUpdate (0.01s)
=== RUN   TestAPIUserConsentsGet_Success
2025/11/25 13:25:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4562}}
2025/11/25 13:25:12 [a357f2e3b56e/8P1BS7F7Qi-001383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44296 - 200 1156B in 4.078326ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001384] "GET http://localhost:19090/api/v1/admin/users/1869/consents HTTP/1.1" from [::1]:44302 - 200 575B in 705.513Âµs
--- PASS: TestAPIUserConsentsGet_Success (0.01s)
=== RUN   TestAPIUserConsentsGet_EmptyConsents
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4565}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001385] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44318 - 200 1156B in 4.275769ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001386] "GET http://localhost:19090/api/v1/admin/users/1870/consents HTTP/1.1" from [::1]:44332 - 200 18B in 362.826Âµs
--- PASS: TestAPIUserConsentsGet_EmptyConsents (0.01s)
=== RUN   TestAPIUserConsentsGet_UserNotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4566}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001387] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44346 - 200 1156B in 3.956145ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001388] "GET http://localhost:19090/api/v1/admin/users/99999/consents HTTP/1.1" from [::1]:44352 - 404 58B in 337.408Âµs
--- PASS: TestAPIUserConsentsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserConsentsGet_InvalidId
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4567}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001389] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44356 - 200 1156B in 3.929374ms
=== RUN   TestAPIUserConsentsGet_InvalidId/non-numeric_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001390] "GET http://localhost:19090/api/v1/admin/users/abc/consents HTTP/1.1" from [::1]:44368 - 400 73B in 300.107Âµs
=== RUN   TestAPIUserConsentsGet_InvalidId/empty_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001391] "GET http://localhost:19090/api/v1/admin/users//consents HTTP/1.1" from [::1]:44380 - 400 70B in 215.226Âµs
=== RUN   TestAPIUserConsentsGet_InvalidId/negative_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001392] "GET http://localhost:19090/api/v1/admin/users/-1/consents HTTP/1.1" from [::1]:44384 - 404 58B in 257.025Âµs
--- PASS: TestAPIUserConsentsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserConsentsGet_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001393] "GET http://localhost:19090/api/v1/admin/users/1871/consents HTTP/1.1" from [::1]:44394 - 401 22B in 58.811Âµs
--- PASS: TestAPIUserConsentsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserConsentDelete_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4568}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001394] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44406 - 200 1156B in 4.033451ms
2025/11/25 13:25:13 INFO {"audit_event":"deleted_user_consent","details":{"consentId":154,"loggedInUser":null,"userId":1872}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001395] "DELETE http://localhost:19090/api/v1/admin/user-consents/154 HTTP/1.1" from [::1]:44408 - 200 17B in 917.203Âµs
--- PASS: TestAPIUserConsentDelete_Success (0.01s)
=== RUN   TestAPIUserConsentDelete_NotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4570}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001396] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44416 - 200 1156B in 4.050162ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001397] "DELETE http://localhost:19090/api/v1/admin/user-consents/99999 HTTP/1.1" from [::1]:44432 - 404 61B in 375.419Âµs
--- PASS: TestAPIUserConsentDelete_NotFound (0.01s)
=== RUN   TestAPIUserConsentDelete_InvalidId
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4571}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001398] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44438 - 200 1156B in 3.974179ms
=== RUN   TestAPIUserConsentDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001399] "DELETE http://localhost:19090/api/v1/admin/user-consents/abc HTTP/1.1" from [::1]:44452 - 400 76B in 264.299Âµs
=== RUN   TestAPIUserConsentDelete_InvalidId/empty_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001400] "DELETE http://localhost:19090/api/v1/admin/user-consents/ HTTP/1.1" from [::1]:44458 - 404 2447B in 348.398Âµs
=== RUN   TestAPIUserConsentDelete_InvalidId/negative_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001401] "DELETE http://localhost:19090/api/v1/admin/user-consents/-1 HTTP/1.1" from [::1]:44462 - 404 61B in 307.481Âµs
--- PASS: TestAPIUserConsentDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserConsentDelete_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001402] "DELETE http://localhost:19090/api/v1/admin/user-consents/155 HTTP/1.1" from [::1]:44466 - 401 22B in 55.414Âµs
--- PASS: TestAPIUserConsentDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserConsentDelete_WithClientDetails
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4573}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001403] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44472 - 200 1156B in 3.986573ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001404] "GET http://localhost:19090/api/v1/admin/users/1874/consents HTTP/1.1" from [::1]:44480 - 200 331B in 431.655Âµs
2025/11/25 13:25:13 INFO {"audit_event":"deleted_user_consent","details":{"consentId":156,"loggedInUser":null,"userId":1874}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001405] "DELETE http://localhost:19090/api/v1/admin/user-consents/156 HTTP/1.1" from [::1]:44482 - 200 17B in 867.489Âµs
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001406] "GET http://localhost:19090/api/v1/admin/users/1874/consents HTTP/1.1" from [::1]:44498 - 200 18B in 409.294Âµs
--- PASS: TestAPIUserConsentDelete_WithClientDetails (0.01s)
=== RUN   TestAPIUserGet_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4575}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001407] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44500 - 200 1156B in 4.021709ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001408] "GET http://localhost:19090/api/v1/admin/users/1875 HTTP/1.1" from [::1]:44512 - 200 695B in 318.381Âµs
--- PASS: TestAPIUserGet_Success (0.01s)
=== RUN   TestAPIUserGet_NotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4576}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001409] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44526 - 200 1156B in 4.159418ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001410] "GET http://localhost:19090/api/v1/admin/users/99999 HTTP/1.1" from [::1]:44534 - 404 63B in 424.812Âµs
--- PASS: TestAPIUserGet_NotFound (0.01s)
=== RUN   TestAPIUserGet_InvalidId
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4577}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001411] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44538 - 200 1156B in 4.025697ms
=== RUN   TestAPIUserGet_InvalidId/non-numeric_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001412] "GET http://localhost:19090/api/v1/admin/users/abc HTTP/1.1" from [::1]:44540 - 400 65B in 278.376Âµs
=== RUN   TestAPIUserGet_InvalidId/empty_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001413] "GET http://localhost:19090/api/v1/admin/users/ HTTP/1.1" from [::1]:44546 - 404 2447B in 345.172Âµs
=== RUN   TestAPIUserGet_InvalidId/negative_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001414] "GET http://localhost:19090/api/v1/admin/users/-1 HTTP/1.1" from [::1]:44548 - 404 63B in 290.759Âµs
--- PASS: TestAPIUserGet_InvalidId (0.01s)
    --- PASS: TestAPIUserGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGet_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001415] "GET http://localhost:19090/api/v1/admin/users/1876 HTTP/1.1" from [::1]:44550 - 401 22B in 51.988Âµs
--- PASS: TestAPIUserGet_Unauthorized (0.00s)
=== RUN   TestAPIUserCreatePost_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4578}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001416] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44554 - 200 1156B in 4.093054ms
2025/11/25 13:25:13 INFO {"audit_event":"created_user","details":{"email":"newuser@create.test","loggedInUser":"admin-test-client-ZHIwFQOW"}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001417] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:44560 - 201 1137B in 38.195079ms
--- PASS: TestAPIUserCreatePost_Success (0.04s)
=== RUN   TestAPIUserCreatePost_DuplicateEmail
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4579}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001418] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44566 - 200 1156B in 4.122098ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001419] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:44578 - 409 95B in 406.478Âµs
--- PASS: TestAPIUserCreatePost_DuplicateEmail (0.01s)
=== RUN   TestAPIUserCreatePost_ValidationErrors
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4580}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001420] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44588 - 200 1156B in 5.002382ms
=== RUN   TestAPIUserCreatePost_ValidationErrors/missing_email
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001421] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:44590 - 400 66B in 326.597Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/invalid_email_format
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001422] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:44596 - 400 86B in 263.217Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/email_too_long
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001423] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:44608 - 400 114B in 288.014Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/missing_password_when_required
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001424] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:44616 - 400 72B in 956.668Âµs
--- PASS: TestAPIUserCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/missing_email (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/invalid_email_format (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/email_too_long (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/missing_password_when_required (0.00s)
=== RUN   TestAPIUserCreatePost_InvalidRequestBody
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4581}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001425] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44626 - 200 1156B in 4.019284ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001426] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:44642 - 400 75B in 238.921Âµs
--- PASS: TestAPIUserCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserCreatePost_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001427] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:44650 - 401 22B in 63.129Âµs
--- PASS: TestAPIUserCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIUserEnabledPut_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4582}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001428] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44666 - 200 1156B in 3.995429ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_details","details":{"loggedInUser":"admin-test-client-lOwkFQgI","userId":1879}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001429] "PUT http://localhost:19090/api/v1/admin/users/1879/enabled HTTP/1.1" from [::1]:44680 - 200 700B in 996.593Âµs
--- PASS: TestAPIUserEnabledPut_Success (0.01s)
=== RUN   TestAPIUserEnabledPut_EnableUser
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4583}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001430] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44692 - 200 1156B in 3.976343ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_details","details":{"loggedInUser":"admin-test-client-OmbaFRHK","userId":1880}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001431] "PUT http://localhost:19090/api/v1/admin/users/1880/enabled HTTP/1.1" from [::1]:44706 - 200 703B in 964.993Âµs
--- PASS: TestAPIUserEnabledPut_EnableUser (0.01s)
=== RUN   TestAPIUserEnabledPut_NotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4584}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001432] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44710 - 200 1156B in 3.940165ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001433] "PUT http://localhost:19090/api/v1/admin/users/99999/enabled HTTP/1.1" from [::1]:44712 - 404 63B in 270.411Âµs
--- PASS: TestAPIUserEnabledPut_NotFound (0.01s)
=== RUN   TestAPIUserEnabledPut_InvalidId
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4585}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001434] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44726 - 200 1156B in 3.970342ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001435] "PUT http://localhost:19090/api/v1/admin/users/invalid/enabled HTTP/1.1" from [::1]:44728 - 400 65B in 238.851Âµs
--- PASS: TestAPIUserEnabledPut_InvalidId (0.01s)
=== RUN   TestAPIUserEnabledPut_InvalidRequestBody
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4586}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001436] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44742 - 200 1156B in 3.936178ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001437] "PUT http://localhost:19090/api/v1/admin/users/1881/enabled HTTP/1.1" from [::1]:44750 - 400 75B in 255.533Âµs
--- PASS: TestAPIUserEnabledPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserDelete_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4587}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001438] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44756 - 200 1156B in 4.097642ms
2025/11/25 13:25:13 INFO {"audit_event":"deleted_user","details":{"loggedInUser":"admin-test-client-BNCXmppe","userId":1882}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001439] "DELETE http://localhost:19090/api/v1/admin/users/1882 HTTP/1.1" from [::1]:44762 - 200 17B in 1.134904ms
--- PASS: TestAPIUserDelete_Success (0.01s)
=== RUN   TestAPIUserDelete_NotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4588}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001440] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44774 - 200 1156B in 4.006571ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001441] "DELETE http://localhost:19090/api/v1/admin/users/99999 HTTP/1.1" from [::1]:44790 - 404 63B in 281.863Âµs
--- PASS: TestAPIUserDelete_NotFound (0.01s)
=== RUN   TestAPIUserDelete_InvalidId
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4589}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001442] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44794 - 200 1156B in 3.990971ms
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_invalid
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001443] "DELETE http://localhost:19090/api/v1/admin/users/invalid HTTP/1.1" from [::1]:44806 - 400 65B in 249.662Âµs
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_abc
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001444] "DELETE http://localhost:19090/api/v1/admin/users/abc HTTP/1.1" from [::1]:44808 - 400 65B in 246.516Âµs
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_-1
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001445] "DELETE http://localhost:19090/api/v1/admin/users/-1 HTTP/1.1" from [::1]:44824 - 404 63B in 255.943Âµs
--- PASS: TestAPIUserDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_invalid (0.00s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_abc (0.00s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_-1 (0.00s)
=== RUN   TestAPIUserDelete_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001446] "DELETE http://localhost:19090/api/v1/admin/users/1883 HTTP/1.1" from [::1]:44834 - 401 22B in 82.476Âµs
--- PASS: TestAPIUserDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserEmailPut_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4590}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001447] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44842 - 200 1156B in 4.091951ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-agTJEVrD","userId":1884}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001448] "PUT http://localhost:19090/api/v1/admin/users/1884/email HTTP/1.1" from [::1]:44846 - 200 700B in 1.250383ms
--- PASS: TestAPIUserEmailPut_Success (0.01s)
=== RUN   TestAPIUserEmailPut_EmailNormalization
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4591}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001449] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44862 - 200 1156B in 4.070932ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-Gqfowgdp","userId":1885}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001450] "PUT http://localhost:19090/api/v1/admin/users/1885/email HTTP/1.1" from [::1]:44866 - 200 703B in 1.19617ms
--- PASS: TestAPIUserEmailPut_EmailNormalization (0.01s)
=== RUN   TestAPIUserEmailPut_DuplicateEmail
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4592}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001451] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44878 - 200 1156B in 4.357423ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001452] "PUT http://localhost:19090/api/v1/admin/users/1887/email HTTP/1.1" from [::1]:44892 - 400 107B in 993.478Âµs
--- PASS: TestAPIUserEmailPut_DuplicateEmail (0.01s)
=== RUN   TestAPIUserEmailPut_InvalidEmail
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4593}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001453] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44902 - 200 1156B in 4.954551ms
=== RUN   TestAPIUserEmailPut_InvalidEmail/empty_email
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001454] "PUT http://localhost:19090/api/v1/admin/users/1888/email HTTP/1.1" from [::1]:44916 - 400 81B in 477.042Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/invalid_format
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001455] "PUT http://localhost:19090/api/v1/admin/users/1888/email HTTP/1.1" from [::1]:44920 - 400 86B in 1.51872ms
=== RUN   TestAPIUserEmailPut_InvalidEmail/missing_domain
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001456] "PUT http://localhost:19090/api/v1/admin/users/1888/email HTTP/1.1" from [::1]:44922 - 400 86B in 524.18Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/missing_username
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001457] "PUT http://localhost:19090/api/v1/admin/users/1888/email HTTP/1.1" from [::1]:44930 - 400 86B in 387.242Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/multiple_@
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001458] "PUT http://localhost:19090/api/v1/admin/users/1888/email HTTP/1.1" from [::1]:44938 - 400 86B in 363.126Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/spaces_in_middle
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001459] "PUT http://localhost:19090/api/v1/admin/users/1888/email HTTP/1.1" from [::1]:44940 - 400 86B in 1.190119ms
=== RUN   TestAPIUserEmailPut_InvalidEmail/special_chars
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001460] "PUT http://localhost:19090/api/v1/admin/users/1888/email HTTP/1.1" from [::1]:44948 - 400 86B in 447.195Âµs
--- PASS: TestAPIUserEmailPut_InvalidEmail (0.02s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/empty_email (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/invalid_format (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/missing_domain (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/missing_username (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/multiple_@ (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/spaces_in_middle (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/special_chars (0.00s)
=== RUN   TestAPIUserEmailPut_SetEmailVerified
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4594}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001461] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44964 - 200 1156B in 4.225834ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-pDXgcVvu","userId":1889}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001462] "PUT http://localhost:19090/api/v1/admin/users/1889/email HTTP/1.1" from [::1]:44980 - 200 702B in 1.530462ms
--- PASS: TestAPIUserEmailPut_SetEmailVerified (0.01s)
=== RUN   TestAPIUserEmailPut_UnsetEmailVerified
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4595}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001463] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44990 - 200 1156B in 4.60991ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-lafIwdAg","userId":1890}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001464] "PUT http://localhost:19090/api/v1/admin/users/1890/email HTTP/1.1" from [::1]:45000 - 200 705B in 1.272204ms
--- PASS: TestAPIUserEmailPut_UnsetEmailVerified (0.03s)
=== RUN   TestAPIUserEmailPut_UserNotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4596}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001465] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45014 - 200 1156B in 5.137577ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001466] "PUT http://localhost:19090/api/v1/admin/users/99999/email HTTP/1.1" from [::1]:45026 - 404 63B in 471.481Âµs
--- PASS: TestAPIUserEmailPut_UserNotFound (0.03s)
=== RUN   TestAPIUserEmailPut_InvalidId
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4597}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001467] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45030 - 200 1156B in 3.966815ms
=== RUN   TestAPIUserEmailPut_InvalidId/non-numeric_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001468] "PUT http://localhost:19090/api/v1/admin/users/abc/email HTTP/1.1" from [::1]:45036 - 400 65B in 254.932Âµs
=== RUN   TestAPIUserEmailPut_InvalidId/empty_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001469] "PUT http://localhost:19090/api/v1/admin/users//email HTTP/1.1" from [::1]:45048 - 400 70B in 232.68Âµs
=== RUN   TestAPIUserEmailPut_InvalidId/negative_ID
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001470] "PUT http://localhost:19090/api/v1/admin/users/-1/email HTTP/1.1" from [::1]:45050 - 404 63B in 269.81Âµs
--- PASS: TestAPIUserEmailPut_InvalidId (0.01s)
    --- PASS: TestAPIUserEmailPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserEmailPut_InvalidRequestBody
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4598}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001471] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45066 - 200 1156B in 4.515672ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001472] "PUT http://localhost:19090/api/v1/admin/users/1891/email HTTP/1.1" from [::1]:45082 - 400 75B in 408.752Âµs
--- PASS: TestAPIUserEmailPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserEmailPut_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001473] "PUT http://localhost:19090/api/v1/admin/users/1892/email HTTP/1.1" from [::1]:45094 - 401 22B in 84.69Âµs
--- PASS: TestAPIUserEmailPut_Unauthorized (0.00s)
=== RUN   TestAPIUserEmailPut_PartialUpdate
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4599}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001474] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45096 - 200 1156B in 4.068678ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-ZUHGKfUB","userId":1893}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001475] "PUT http://localhost:19090/api/v1/admin/users/1893/email HTTP/1.1" from [::1]:45102 - 200 701B in 1.253979ms
--- PASS: TestAPIUserEmailPut_PartialUpdate (0.01s)
=== RUN   TestAPIUserPermissionsGet_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4600}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001476] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45112 - 200 1156B in 4.062235ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001477] "GET http://localhost:19090/api/v1/admin/users/1894/permissions HTTP/1.1" from [::1]:45118 - 200 1948B in 603.02Âµs
--- PASS: TestAPIUserPermissionsGet_Success (0.01s)
=== RUN   TestAPIUserPermissionsGet_UserNotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4601}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001478] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45120 - 200 1156B in 3.995118ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001479] "GET http://localhost:19090/api/v1/admin/users/99999/permissions HTTP/1.1" from [::1]:45128 - 404 58B in 285.61Âµs
--- PASS: TestAPIUserPermissionsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserPermissionsGet_InvalidUserId
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4602}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001480] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45144 - 200 1156B in 3.993635ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001481] "GET http://localhost:19090/api/v1/admin/users/invalid/permissions HTTP/1.1" from [::1]:45150 - 400 73B in 312.26Âµs
--- PASS: TestAPIUserPermissionsGet_InvalidUserId (0.01s)
=== RUN   TestAPIUserPermissionsGet_NoPermissions
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4603}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001482] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45156 - 200 1156B in 3.97992ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001483] "GET http://localhost:19090/api/v1/admin/users/1895/permissions HTTP/1.1" from [::1]:45170 - 200 726B in 570.338Âµs
--- PASS: TestAPIUserPermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIUserPermissionsGet_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001484] "GET http://localhost:19090/api/v1/admin/users/1896/permissions HTTP/1.1" from [::1]:45178 - 401 22B in 167.577Âµs
--- PASS: TestAPIUserPermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserPermissionsPut_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4604}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001485] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45186 - 200 1156B in 4.573541ms
2025/11/25 13:25:13 INFO {"audit_event":"added_user_permission","details":{"loggedInUser":"","permissionId":713,"userId":1897}}
2025/11/25 13:25:13 INFO {"audit_event":"added_user_permission","details":{"loggedInUser":"","permissionId":714,"userId":1897}}
2025/11/25 13:25:13 INFO {"audit_event":"deleted_user_permission","details":{"loggedInUser":"","permissionId":712,"userId":1897}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001486] "PUT http://localhost:19090/api/v1/admin/users/1897/permissions HTTP/1.1" from [::1]:45188 - 200 17B in 2.500445ms
--- PASS: TestAPIUserPermissionsPut_Success (0.02s)
=== RUN   TestAPIUserPermissionsPut_RemoveAllPermissions
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4605}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001487] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45190 - 200 1156B in 4.121808ms
2025/11/25 13:25:13 INFO {"audit_event":"deleted_user_permission","details":{"loggedInUser":"","permissionId":715,"userId":1898}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001488] "PUT http://localhost:19090/api/v1/admin/users/1898/permissions HTTP/1.1" from [::1]:45206 - 200 17B in 982.376Âµs
--- PASS: TestAPIUserPermissionsPut_RemoveAllPermissions (0.01s)
=== RUN   TestAPIUserPermissionsPut_UserNotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4606}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001489] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45210 - 200 1156B in 4.110977ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001490] "PUT http://localhost:19090/api/v1/admin/users/99999/permissions HTTP/1.1" from [::1]:45226 - 404 58B in 291.28Âµs
--- PASS: TestAPIUserPermissionsPut_UserNotFound (0.01s)
=== RUN   TestAPIUserPermissionsPut_PermissionNotFound
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4607}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001491] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45238 - 200 1156B in 4.119423ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001492] "PUT http://localhost:19090/api/v1/admin/users/1899/permissions HTTP/1.1" from [::1]:45242 - 404 64B in 394.926Âµs
--- PASS: TestAPIUserPermissionsPut_PermissionNotFound (0.01s)
=== RUN   TestAPIUserPermissionsPut_InvalidRequestBody
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4608}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001493] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45254 - 200 1156B in 4.061684ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001494] "PUT http://localhost:19090/api/v1/admin/users/1900/permissions HTTP/1.1" from [::1]:45256 - 400 71B in 364.989Âµs
--- PASS: TestAPIUserPermissionsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserPermissionsPut_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001495] "PUT http://localhost:19090/api/v1/admin/users/1901/permissions HTTP/1.1" from [::1]:45258 - 401 22B in 56.126Âµs
--- PASS: TestAPIUserPermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIPhoneCountriesGet_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4609}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001496] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45268 - 200 1156B in 4.737952ms
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001497] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:45280 - 200 21243B in 60.565046ms
--- PASS: TestAPIPhoneCountriesGet_Success (0.07s)
=== RUN   TestAPIPhoneCountriesGet_Unauthorized
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001498] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:45284 - 401 22B in 313.583Âµs
--- PASS: TestAPIPhoneCountriesGet_Unauthorized (0.00s)
=== RUN   TestAPIPhoneCountriesGet_InvalidToken
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001499] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:45298 - 401 22B in 265.351Âµs
--- PASS: TestAPIPhoneCountriesGet_InvalidToken (0.00s)
=== RUN   TestAPIUserPhonePut_Success
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4610}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001500] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45310 - 200 1156B in 4.077725ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-iuvAMQpN","userId":1902}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001501] "PUT http://localhost:19090/api/v1/admin/users/1902/phone HTTP/1.1" from [::1]:45316 - 200 718B in 125.799926ms
--- PASS: TestAPIUserPhonePut_Success (0.13s)
=== RUN   TestAPIUserPhonePut_ClearPhoneNumber
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4611}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001502] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45326 - 200 1156B in 4.22855ms
2025/11/25 13:25:13 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-zZQykvqK","userId":1903}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001503] "PUT http://localhost:19090/api/v1/admin/users/1903/phone HTTP/1.1" from [::1]:45340 - 200 705B in 57.836641ms
--- PASS: TestAPIUserPhonePut_ClearPhoneNumber (0.07s)
=== RUN   TestAPIUserPhonePut_ValidationErrors
2025/11/25 13:25:13 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4612}}
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001504] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45356 - 200 1156B in 4.21794ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_without_country
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001505] "PUT http://localhost:19090/api/v1/admin/users/1904/phone HTTP/1.1" from [::1]:45360 - 400 99B in 402.991Âµs
=== RUN   TestAPIUserPhonePut_ValidationErrors/country_without_phone_number
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001506] "PUT http://localhost:19090/api/v1/admin/users/1904/phone HTTP/1.1" from [::1]:45362 - 400 266B in 58.837402ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_too_short
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001507] "PUT http://localhost:19090/api/v1/admin/users/1904/phone HTTP/1.1" from [::1]:45366 - 400 99B in 60.155372ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_too_long
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001508] "PUT http://localhost:19090/api/v1/admin/users/1904/phone HTTP/1.1" from [::1]:45374 - 400 114B in 60.626592ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/invalid_phone_number_characters
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001509] "PUT http://localhost:19090/api/v1/admin/users/1904/phone HTTP/1.1" from [::1]:45378 - 400 174B in 60.411526ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/invalid_country_id
2025/11/25 13:25:13 [a357f2e3b56e/8P1BS7F7Qi-001510] "PUT http://localhost:19090/api/v1/admin/users/1904/phone HTTP/1.1" from [::1]:45386 - 400 76B in 60.976103ms
--- PASS: TestAPIUserPhonePut_ValidationErrors (0.32s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_without_country (0.00s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/country_without_phone_number (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_too_short (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_too_long (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/invalid_phone_number_characters (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/invalid_country_id (0.06s)
=== RUN   TestAPIUserPhonePut_UserNotFound
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4613}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001511] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45388 - 200 1156B in 4.462391ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001512] "PUT http://localhost:19090/api/v1/admin/users/99999/phone HTTP/1.1" from [::1]:45390 - 404 63B in 453.487Âµs
--- PASS: TestAPIUserPhonePut_UserNotFound (0.01s)
=== RUN   TestAPIUserPhonePut_InvalidUserId
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4614}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001513] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45392 - 200 1156B in 4.596024ms
=== RUN   TestAPIUserPhonePut_InvalidUserId/non-numeric_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001514] "PUT http://localhost:19090/api/v1/admin/users/abc/phone HTTP/1.1" from [::1]:45406 - 400 65B in 337.357Âµs
=== RUN   TestAPIUserPhonePut_InvalidUserId/empty_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001515] "PUT http://localhost:19090/api/v1/admin/users//phone HTTP/1.1" from [::1]:45416 - 400 70B in 283.716Âµs
=== RUN   TestAPIUserPhonePut_InvalidUserId/negative_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001516] "PUT http://localhost:19090/api/v1/admin/users/-1/phone HTTP/1.1" from [::1]:45428 - 404 63B in 311.769Âµs
--- PASS: TestAPIUserPhonePut_InvalidUserId (0.01s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/empty_ID (0.00s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/negative_ID (0.00s)
=== RUN   TestAPIUserPhonePut_InvalidRequestBody
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4615}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001517] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45442 - 200 1156B in 4.009706ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001518] "PUT http://localhost:19090/api/v1/admin/users/1905/phone HTTP/1.1" from [::1]:45452 - 400 75B in 306.92Âµs
--- PASS: TestAPIUserPhonePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserPhonePut_Unauthorized
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001519] "PUT http://localhost:19090/api/v1/admin/users/1906/phone HTTP/1.1" from [::1]:45462 - 401 22B in 110.98Âµs
--- PASS: TestAPIUserPhonePut_Unauthorized (0.00s)
=== RUN   TestAPIUserPhonePut_PhoneNumberVerifiedAutoCleared
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4616}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001520] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45468 - 200 1156B in 4.34512ms
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-GBIRVMRJ","userId":1907}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001521] "PUT http://localhost:19090/api/v1/admin/users/1907/phone HTTP/1.1" from [::1]:45472 - 200 709B in 58.507288ms
--- PASS: TestAPIUserPhonePut_PhoneNumberVerifiedAutoCleared (0.07s)
=== RUN   TestAPIUserProfilePut_Success
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4617}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001522] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45476 - 200 1156B in 4.227497ms
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-PSvipcYZ","userId":1908}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001523] "PUT http://localhost:19090/api/v1/admin/users/1908/profile HTTP/1.1" from [::1]:45482 - 200 823B in 1.936018ms
--- PASS: TestAPIUserProfilePut_Success (0.01s)
=== RUN   TestAPIUserProfilePut_PartialUpdate
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4618}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001524] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45484 - 200 1156B in 4.012772ms
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-DVNbnnGq","userId":1909}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001525] "PUT http://localhost:19090/api/v1/admin/users/1909/profile HTTP/1.1" from [::1]:45492 - 200 710B in 1.666018ms
--- PASS: TestAPIUserProfilePut_PartialUpdate (0.01s)
=== RUN   TestAPIUserProfilePut_InvalidGender
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4619}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001526] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45496 - 200 1156B in 4.033782ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001527] "PUT http://localhost:19090/api/v1/admin/users/1910/profile HTTP/1.1" from [::1]:45512 - 400 69B in 1.570548ms
--- PASS: TestAPIUserProfilePut_InvalidGender (0.01s)
=== RUN   TestAPIUserProfilePut_ValidGender
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4620}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001528] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45522 - 200 1156B in 4.05924ms
=== RUN   TestAPIUserProfilePut_ValidGender/female
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-cbJiUPLA","userId":1911}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001529] "PUT http://localhost:19090/api/v1/admin/users/1911/profile HTTP/1.1" from [::1]:45534 - 200 713B in 1.55602ms
=== RUN   TestAPIUserProfilePut_ValidGender/male
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-cbJiUPLA","userId":1911}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001530] "PUT http://localhost:19090/api/v1/admin/users/1911/profile HTTP/1.1" from [::1]:45550 - 200 712B in 1.612898ms
=== RUN   TestAPIUserProfilePut_ValidGender/other
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-cbJiUPLA","userId":1911}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001531] "PUT http://localhost:19090/api/v1/admin/users/1911/profile HTTP/1.1" from [::1]:45562 - 200 713B in 2.166504ms
--- PASS: TestAPIUserProfilePut_ValidGender (0.01s)
    --- PASS: TestAPIUserProfilePut_ValidGender/female (0.00s)
    --- PASS: TestAPIUserProfilePut_ValidGender/male (0.00s)
    --- PASS: TestAPIUserProfilePut_ValidGender/other (0.00s)
=== RUN   TestAPIUserProfilePut_InvalidDateOfBirth
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4621}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001532] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45566 - 200 1156B in 4.02736ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001533] "PUT http://localhost:19090/api/v1/admin/users/1912/profile HTTP/1.1" from [::1]:45574 - 400 114B in 1.060604ms
--- PASS: TestAPIUserProfilePut_InvalidDateOfBirth (0.01s)
=== RUN   TestAPIUserProfilePut_UserNotFound
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4622}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001534] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45580 - 200 1156B in 4.158958ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001535] "PUT http://localhost:19090/api/v1/admin/users/99999/profile HTTP/1.1" from [::1]:45590 - 404 63B in 369.628Âµs
--- PASS: TestAPIUserProfilePut_UserNotFound (0.01s)
=== RUN   TestAPIUserProfilePut_InvalidId
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4623}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001536] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45598 - 200 1156B in 3.978528ms
=== RUN   TestAPIUserProfilePut_InvalidId/non-numeric_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001537] "PUT http://localhost:19090/api/v1/admin/users/abc/profile HTTP/1.1" from [::1]:45604 - 400 65B in 286.361Âµs
=== RUN   TestAPIUserProfilePut_InvalidId/empty_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001538] "PUT http://localhost:19090/api/v1/admin/users//profile HTTP/1.1" from [::1]:45614 - 400 70B in 255.763Âµs
=== RUN   TestAPIUserProfilePut_InvalidId/negative_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001539] "PUT http://localhost:19090/api/v1/admin/users/-1/profile HTTP/1.1" from [::1]:45618 - 404 63B in 293.154Âµs
--- PASS: TestAPIUserProfilePut_InvalidId (0.01s)
    --- PASS: TestAPIUserProfilePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserProfilePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserProfilePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserProfilePut_InvalidRequestBody
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4624}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001540] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45634 - 200 1156B in 4.008875ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001541] "PUT http://localhost:19090/api/v1/admin/users/1913/profile HTTP/1.1" from [::1]:45638 - 400 75B in 377.784Âµs
--- PASS: TestAPIUserProfilePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserProfilePut_Unauthorized
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001542] "PUT http://localhost:19090/api/v1/admin/users/1914/profile HTTP/1.1" from [::1]:45650 - 401 22B in 98.396Âµs
--- PASS: TestAPIUserProfilePut_Unauthorized (0.00s)
=== RUN   TestAPIUserAddressPut_Success
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4625}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001543] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45654 - 200 1156B in 4.245071ms
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-EhjGgmrO","userId":1915}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001544] "PUT http://localhost:19090/api/v1/admin/users/1915/address HTTP/1.1" from [::1]:45662 - 200 739B in 1.581999ms
--- PASS: TestAPIUserAddressPut_Success (0.01s)
=== RUN   TestAPIUserAddressPut_PartialAddress
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4626}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001545] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45676 - 200 1156B in 5.375918ms
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-IrmDPRiw","userId":1916}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001546] "PUT http://localhost:19090/api/v1/admin/users/1916/address HTTP/1.1" from [::1]:45688 - 200 727B in 1.278336ms
--- PASS: TestAPIUserAddressPut_PartialAddress (0.01s)
=== RUN   TestAPIUserAddressPut_ClearAllFields
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4627}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001547] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45698 - 200 1156B in 5.259949ms
2025/11/25 13:25:14 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-RfLGQkWZ","userId":1917}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001548] "PUT http://localhost:19090/api/v1/admin/users/1917/address HTTP/1.1" from [::1]:45702 - 200 706B in 1.22263ms
--- PASS: TestAPIUserAddressPut_ClearAllFields (0.01s)
=== RUN   TestAPIUserAddressPut_UserNotFound
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4628}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001549] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45708 - 200 1156B in 4.320694ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001550] "PUT http://localhost:19090/api/v1/admin/users/99999/address HTTP/1.1" from [::1]:45722 - 404 63B in 530.312Âµs
--- PASS: TestAPIUserAddressPut_UserNotFound (0.01s)
=== RUN   TestAPIUserAddressPut_InvalidId
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4629}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001551] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45734 - 200 1156B in 4.081442ms
=== RUN   TestAPIUserAddressPut_InvalidId/non-numeric_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001552] "PUT http://localhost:19090/api/v1/admin/users/abc/address HTTP/1.1" from [::1]:45746 - 400 65B in 505.264Âµs
=== RUN   TestAPIUserAddressPut_InvalidId/empty_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001553] "PUT http://localhost:19090/api/v1/admin/users//address HTTP/1.1" from [::1]:45758 - 400 70B in 274.579Âµs
=== RUN   TestAPIUserAddressPut_InvalidId/negative_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001554] "PUT http://localhost:19090/api/v1/admin/users/-1/address HTTP/1.1" from [::1]:45760 - 404 63B in 575.287Âµs
--- PASS: TestAPIUserAddressPut_InvalidId (0.01s)
    --- PASS: TestAPIUserAddressPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAddressPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAddressPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAddressPut_InvalidRequestBody
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4630}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001555] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45776 - 200 1156B in 4.087603ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001556] "PUT http://localhost:19090/api/v1/admin/users/1918/address HTTP/1.1" from [::1]:45792 - 400 75B in 322.79Âµs
--- PASS: TestAPIUserAddressPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAddressPut_Unauthorized
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001557] "PUT http://localhost:19090/api/v1/admin/users/1919/address HTTP/1.1" from [::1]:45802 - 401 22B in 61.746Âµs
--- PASS: TestAPIUserAddressPut_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_Success
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4631}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001558] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45814 - 200 1156B in 4.003755ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001559] "GET http://localhost:19090/api/v1/admin/users/search?query=annperm&annotatePermissionId=716&page=1&size=200 HTTP/1.1" from [::1]:45824 - 200 3008B in 1.40801ms
--- PASS: TestAPIUsersSearch_AnnotatePermission_Success (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_InvalidParam
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4632}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001560] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45834 - 200 1156B in 4.055442ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001561] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=abc HTTP/1.1" from [::1]:45844 - 400 85B in 559.117Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_InvalidParam (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_PermissionNotFound
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4633}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001562] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45856 - 200 1156B in 3.997413ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001563] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=8740839 HTTP/1.1" from [::1]:45858 - 404 64B in 496.838Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_PermissionNotFound (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_Unauthorized
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001564] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=717 HTTP/1.1" from [::1]:45874 - 401 22B in 74.11Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_ConflictWithGroupAnnotation
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4634}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001565] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45886 - 200 1156B in 3.997443ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001566] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=718&annotateGroupMembership=600 HTTP/1.1" from [::1]:45890 - 400 123B in 472.844Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_ConflictWithGroupAnnotation (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_UserinfoForbidden
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4635}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001567] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45906 - 200 1156B in 3.946046ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001568] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=1 HTTP/1.1" from [::1]:45908 - 400 96B in 461.993Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_UserinfoForbidden (0.01s)
=== RUN   TestAPIUsersSearch_Success
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4636}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001569] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45912 - 200 1156B in 3.968217ms
    api_users_search_test.go:31: Created 3 test users:
    api_users_search_test.go:33:   - john.doe@test.com 'AAA John' (ID: 1923, Enabled: true)
    api_users_search_test.go:33:   - jane.smith@test.com 'AAA Jane' (ID: 1924, Enabled: true)
    api_users_search_test.go:33:   - disabled@test.com 'AAA Disabled' (ID: 1925, Enabled: false)
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001570] "GET http://localhost:19090/api/v1/admin/users/search?page=1&size=50 HTTP/1.1" from [::1]:45916 - 200 34332B in 837.092Âµs
    api_users_search_test.go:64: Total users in database: 832
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001571] "GET http://localhost:19090/api/v1/admin/users/search?page=2&size=50 HTTP/1.1" from [::1]:45928 - 200 34277B in 1.020849ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001572] "GET http://localhost:19090/api/v1/admin/users/search?page=3&size=50 HTTP/1.1" from [::1]:45944 - 200 34332B in 625.882Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001573] "GET http://localhost:19090/api/v1/admin/users/search?page=4&size=50 HTTP/1.1" from [::1]:45958 - 200 34346B in 630.672Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001574] "GET http://localhost:19090/api/v1/admin/users/search?page=5&size=50 HTTP/1.1" from [::1]:45966 - 200 34364B in 581.979Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001575] "GET http://localhost:19090/api/v1/admin/users/search?page=6&size=50 HTTP/1.1" from [::1]:45978 - 200 34280B in 645.449Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001576] "GET http://localhost:19090/api/v1/admin/users/search?page=7&size=50 HTTP/1.1" from [::1]:45986 - 200 34332B in 609.733Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001577] "GET http://localhost:19090/api/v1/admin/users/search?page=8&size=50 HTTP/1.1" from [::1]:45990 - 200 34395B in 607.177Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001578] "GET http://localhost:19090/api/v1/admin/users/search?page=9&size=50 HTTP/1.1" from [::1]:46002 - 200 34305B in 578.453Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001579] "GET http://localhost:19090/api/v1/admin/users/search?page=10&size=50 HTTP/1.1" from [::1]:46004 - 200 34450B in 616.845Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001580] "GET http://localhost:19090/api/v1/admin/users/search?page=11&size=50 HTTP/1.1" from [::1]:46010 - 200 34304B in 626.563Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001581] "GET http://localhost:19090/api/v1/admin/users/search?page=12&size=50 HTTP/1.1" from [::1]:46020 - 200 34403B in 621.004Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001582] "GET http://localhost:19090/api/v1/admin/users/search?page=13&size=50 HTTP/1.1" from [::1]:46026 - 200 34344B in 596.477Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001583] "GET http://localhost:19090/api/v1/admin/users/search?page=14&size=50 HTTP/1.1" from [::1]:46036 - 200 34388B in 643.596Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001584] "GET http://localhost:19090/api/v1/admin/users/search?page=15&size=50 HTTP/1.1" from [::1]:46044 - 200 34331B in 726.463Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001585] "GET http://localhost:19090/api/v1/admin/users/search?page=16&size=50 HTTP/1.1" from [::1]:46048 - 200 34381B in 721.534Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001586] "GET http://localhost:19090/api/v1/admin/users/search?page=17&size=50 HTTP/1.1" from [::1]:46058 - 200 22841B in 576.82Âµs
    api_users_search_test.go:72: Found test user: disabled@test.com 'AAA Disabled' (ID: 1925, Enabled: false)
    api_users_search_test.go:72: Found test user: jane.smith@test.com 'AAA Jane' (ID: 1924, Enabled: true)
    api_users_search_test.go:72: Found test user: john.doe@test.com 'AAA John' (ID: 1923, Enabled: true)
--- PASS: TestAPIUsersSearch_Success (0.03s)
=== RUN   TestAPIUsersSearch_WithQuery
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4637}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001587] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46066 - 200 1156B in 4.041025ms
    api_users_search_test.go:126: Created test user: uniquejohnpNkBVTgm@searchtest.com 'UniqueJohn TestUser' (ID: 1926, Enabled: true)
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001588] "GET http://localhost:19090/api/v1/admin/users/search?query=uniquejohnpNkBVTgm HTTP/1.1" from [::1]:46082 - 200 782B in 659.155Âµs
    api_users_search_test.go:148: Search query: 'uniquejohnpNkBVTgm'
    api_users_search_test.go:149: Total results: 1
    api_users_search_test.go:150: Number of users returned: 1
    api_users_search_test.go:151: Search results:
    api_users_search_test.go:153:   [0] ID: 1926, Email: uniquejohnpNkBVTgm@searchtest.com, GivenName: UniqueJohn, FamilyName: TestUser, Enabled: true
--- PASS: TestAPIUsersSearch_WithQuery (0.01s)
=== RUN   TestAPIUsersSearch_WithPagination
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4638}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001589] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46084 - 200 1156B in 4.026618ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001590] "GET http://localhost:19090/api/v1/admin/users/search?page=1&size=2 HTTP/1.1" from [::1]:46092 - 200 1445B in 437.787Âµs
--- PASS: TestAPIUsersSearch_WithPagination (0.01s)
=== RUN   TestAPIUsersSearch_Unauthorized
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001591] "GET http://localhost:19090/api/v1/admin/users/search HTTP/1.1" from [::1]:46098 - 401 22B in 77.576Âµs
--- PASS: TestAPIUsersSearch_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_InvalidToken
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001592] "GET http://localhost:19090/api/v1/admin/users/search HTTP/1.1" from [::1]:46110 - 401 22B in 184.629Âµs
--- PASS: TestAPIUsersSearch_InvalidToken (0.00s)
=== RUN   TestAPIUsersSearch_InvalidParameters
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4639}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001593] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46124 - 200 1156B in 4.123802ms
=== RUN   TestAPIUsersSearch_InvalidParameters/negative_page
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001594] "GET http://localhost:19090/api/v1/admin/users/search?page=-1 HTTP/1.1" from [::1]:46134 - 200 6950B in 477.051Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/zero_page
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001595] "GET http://localhost:19090/api/v1/admin/users/search?page=0 HTTP/1.1" from [::1]:46136 - 200 6950B in 381.01Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/non-numeric_page
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001596] "GET http://localhost:19090/api/v1/admin/users/search?page=abc HTTP/1.1" from [::1]:46140 - 200 6950B in 412.419Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/negative_size
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001597] "GET http://localhost:19090/api/v1/admin/users/search?size=-1 HTTP/1.1" from [::1]:46156 - 200 6950B in 500.496Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/zero_size
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001598] "GET http://localhost:19090/api/v1/admin/users/search?size=0 HTTP/1.1" from [::1]:46166 - 200 6950B in 526.564Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/over-limit_size
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001599] "GET http://localhost:19090/api/v1/admin/users/search?size=300 HTTP/1.1" from [::1]:46174 - 200 6950B in 496.228Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/non-numeric_size
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001600] "GET http://localhost:19090/api/v1/admin/users/search?size=xyz HTTP/1.1" from [::1]:46182 - 200 6950B in 448.066Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/both_invalid
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001601] "GET http://localhost:19090/api/v1/admin/users/search?page=abc&size=xyz HTTP/1.1" from [::1]:46192 - 200 6950B in 469.376Âµs
--- PASS: TestAPIUsersSearch_InvalidParameters (0.02s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/negative_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/zero_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/non-numeric_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/negative_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/zero_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/over-limit_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/non-numeric_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/both_invalid (0.00s)
=== RUN   TestAPIUsersSearch_SizeLimit
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4640}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001602] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46202 - 200 1156B in 4.067776ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001603] "GET http://localhost:19090/api/v1/admin/users/search?size=200 HTTP/1.1" from [::1]:46208 - 200 137126B in 2.01089ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001604] "GET http://localhost:19090/api/v1/admin/users/search?size=201 HTTP/1.1" from [::1]:46222 - 200 6950B in 518.97Âµs
--- PASS: TestAPIUsersSearch_SizeLimit (0.01s)
=== RUN   TestAPIUsersSearch_NoResults
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4641}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001605] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46234 - 200 1156B in 4.587298ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001606] "GET http://localhost:19090/api/v1/admin/users/search?query=nonexistent-user-12345 HTTP/1.1" from [::1]:46248 - 200 77B in 907.334Âµs
--- PASS: TestAPIUsersSearch_NoResults (0.01s)
=== RUN   TestAPIUsersSearch_SpecialCharacters
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4642}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001607] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46260 - 200 1156B in 4.085068ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/empty_query
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001608] "GET http://localhost:19090/api/v1/admin/users/search?query= HTTP/1.1" from [::1]:45718 - 200 6950B in 550.48Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/space_query
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001609] "GET http://localhost:19090/api/v1/admin/users/search?query=%20 HTTP/1.1" from [::1]:45736 - 200 2131B in 712.526Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/at_symbol
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001610] "GET http://localhost:19090/api/v1/admin/users/search?query=john%40doe HTTP/1.1" from [::1]:45738 - 200 63B in 591.408Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/plus_symbol
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001611] "GET http://localhost:19090/api/v1/admin/users/search?query=john%2Bdoe HTTP/1.1" from [::1]:45742 - 200 63B in 602.749Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/special_chars
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001612] "GET http://localhost:19090/api/v1/admin/users/search?query=%21%40%23%24 HTTP/1.1" from [::1]:45752 - 200 59B in 542.655Âµs
--- PASS: TestAPIUsersSearch_SpecialCharacters (0.01s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/empty_query (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/space_query (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/at_symbol (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/plus_symbol (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/special_chars (0.00s)
=== RUN   TestAPIUsersSearch_MultiplePages
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4643}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001613] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45762 - 200 1156B in 4.174878ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001614] "GET http://localhost:19090/api/v1/admin/users/search?size=5&page=1 HTTP/1.1" from [::1]:45778 - 200 3520B in 468.185Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001615] "GET http://localhost:19090/api/v1/admin/users/search?size=5&page=2 HTTP/1.1" from [::1]:45780 - 200 3482B in 380.599Âµs
--- PASS: TestAPIUsersSearch_MultiplePages (0.02s)
=== RUN   TestAPIUserSessionsGet_Success
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4644}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001616] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45788 - 200 1156B in 3.976573ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001617] "GET http://localhost:19090/api/v1/admin/users/1950/sessions HTTP/1.1" from [::1]:45804 - 200 1467B in 684.033Âµs
--- PASS: TestAPIUserSessionsGet_Success (0.01s)
=== RUN   TestAPIUserSessionsGet_EmptySessions
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4646}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001618] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45808 - 200 1156B in 4.067295ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001619] "GET http://localhost:19090/api/v1/admin/users/1951/sessions HTTP/1.1" from [::1]:45816 - 200 16B in 381.131Âµs
--- PASS: TestAPIUserSessionsGet_EmptySessions (0.01s)
=== RUN   TestAPIUserSessionsGet_UserNotFound
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4647}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001620] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45828 - 200 1156B in 4.019806ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001621] "GET http://localhost:19090/api/v1/admin/users/99999/sessions HTTP/1.1" from [::1]:45836 - 404 63B in 347.807Âµs
--- PASS: TestAPIUserSessionsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserSessionsGet_InvalidId
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4648}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001622] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45848 - 200 1156B in 4.053008ms
=== RUN   TestAPIUserSessionsGet_InvalidId/non-numeric_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001623] "GET http://localhost:19090/api/v1/admin/users/abc/sessions HTTP/1.1" from [::1]:45860 - 400 72B in 295.849Âµs
=== RUN   TestAPIUserSessionsGet_InvalidId/empty_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001624] "GET http://localhost:19090/api/v1/admin/users//sessions HTTP/1.1" from [::1]:45872 - 400 70B in 267.425Âµs
=== RUN   TestAPIUserSessionsGet_InvalidId/negative_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001625] "GET http://localhost:19090/api/v1/admin/users/-1/sessions HTTP/1.1" from [::1]:45878 - 404 63B in 294.266Âµs
--- PASS: TestAPIUserSessionsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserSessionsGet_Unauthorized
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001626] "GET http://localhost:19090/api/v1/admin/users/1952/sessions HTTP/1.1" from [::1]:45888 - 401 22B in 75.363Âµs
--- PASS: TestAPIUserSessionsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserSessionsGet_SessionsWithNoClients
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4649}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001627] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45892 - 200 1156B in 3.970462ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001628] "GET http://localhost:19090/api/v1/admin/users/1953/sessions HTTP/1.1" from [::1]:45904 - 200 710B in 476.791Âµs
--- PASS: TestAPIUserSessionsGet_SessionsWithNoClients (0.01s)
=== RUN   TestAPIUserSessionDelete_Success
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4650}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001629] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45910 - 200 1156B in 4.119524ms
2025/11/25 13:25:14 INFO {"audit_event":"deleted_user_session","details":{"loggedInUser":"","userSessionId":1923}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001630] "DELETE http://localhost:19090/api/v1/admin/user-sessions/1923 HTTP/1.1" from [::1]:45914 - 200 17B in 1.033012ms
--- PASS: TestAPIUserSessionDelete_Success (0.01s)
=== RUN   TestAPIUserSessionDelete_NotFound
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4651}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001631] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45926 - 200 1156B in 3.928172ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001632] "DELETE http://localhost:19090/api/v1/admin/user-sessions/99999 HTTP/1.1" from [::1]:45942 - 404 79B in 346.294Âµs
--- PASS: TestAPIUserSessionDelete_NotFound (0.01s)
=== RUN   TestAPIUserSessionDelete_InvalidId
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4652}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001633] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45948 - 200 1156B in 4.109144ms
=== RUN   TestAPIUserSessionDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001634] "DELETE http://localhost:19090/api/v1/admin/user-sessions/abc HTTP/1.1" from [::1]:45952 - 400 88B in 324.182Âµs
=== RUN   TestAPIUserSessionDelete_InvalidId/empty_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001635] "DELETE http://localhost:19090/api/v1/admin/user-sessions/ HTTP/1.1" from [::1]:45964 - 404 2447B in 409.393Âµs
=== RUN   TestAPIUserSessionDelete_InvalidId/negative_ID
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001636] "DELETE http://localhost:19090/api/v1/admin/user-sessions/-1 HTTP/1.1" from [::1]:45968 - 404 79B in 338.028Âµs
--- PASS: TestAPIUserSessionDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserSessionDelete_Unauthorized
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001637] "DELETE http://localhost:19090/api/v1/admin/user-sessions/1924 HTTP/1.1" from [::1]:45980 - 401 22B in 62.578Âµs
--- PASS: TestAPIUserSessionDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserSessionDelete_InvalidToken
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001638] "DELETE http://localhost:19090/api/v1/admin/user-sessions/1925 HTTP/1.1" from [::1]:45992 - 401 22B in 212.672Âµs
--- PASS: TestAPIUserSessionDelete_InvalidToken (0.00s)
=== RUN   TestAPIUserSessionsGet_OnlyValidSessions
2025/11/25 13:25:14 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4653}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001639] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45998 - 200 1156B in 3.989098ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001640] "GET http://localhost:19090/api/v1/admin/users/1957/sessions HTTP/1.1" from [::1]:46006 - 200 717B in 447.977Âµs
--- PASS: TestAPIUserSessionsGet_OnlyValidSessions (0.01s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientIdIsMissing
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001641] "GET http://localhost:19090/auth/authorize/ HTTP/1.1" from [::1]:46008 - 200 2129B in 295.939Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientIdIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotExist
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001642] "GET http://localhost:19090/auth/authorize/?client_id=does_not_exist HTTP/1.1" from [::1]:46014 - 200 2149B in 256.795Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotExist (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientIsDisabled
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001643] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ndvTLAhu HTTP/1.1" from [::1]:46022 - 200 2146B in 247.769Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientIsDisabled (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotSupportTheAuthorizationCodeFlow
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001644] "GET http://localhost:19090/auth/authorize/?client_id=test-client-REYhFgom HTTP/1.1" from [::1]:46024 - 200 2179B in 219.625Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotSupportTheAuthorizationCodeFlow (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_RedirectURIIsMissing
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001645] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JEEGbUgh HTTP/1.1" from [::1]:46038 - 200 2132B in 168.047Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_RedirectURIIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotHaveRedirectURI
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001646] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JpfbDCmh&redirect_uri=https://www.nationalvirtual.biz/cutting-edge/solutions HTTP/1.1" from [::1]:46042 - 200 2180B in 239.092Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotHaveRedirectURI (0.00s)
=== RUN   TestAuthorize_ValidateRequest_ResponseTypeIsMissing
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001647] "GET http://localhost:19090/auth/authorize/?client_id=test-client-APofNAZy&redirect_uri=https://www.corporateviral.org/enhance/solutions/incentivize HTTP/1.1" from [::1]:46056 - 302 205B in 241.587Âµs
--- PASS: TestAuthorize_ValidateRequest_ResponseTypeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_ResponseTypeIsInvalid
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001648] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xpdYMmBp&redirect_uri=https://www.customercutting-edge.info/schemas/architectures&response_type=invalid HTTP/1.1" from [::1]:46058 - 302 204B in 232.73Âµs
--- PASS: TestAuthorize_ValidateRequest_ResponseTypeIsInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeMethodIsMissing
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001649] "GET http://localhost:19090/auth/authorize/?client_id=test-client-OZiVyHHW&redirect_uri=https://www.productreal-time.biz/cross-platform&response_type=code HTTP/1.1" from [::1]:46068 - 302 183B in 235.615Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeMethodIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeMethodIsInvalid
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001650] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ABoYKZGp&redirect_uri=https://www.regionalrevolutionize.net/24-365/engineer&response_type=code&code_challenge_method=invalid HTTP/1.1" from [::1]:46086 - 302 189B in 264.129Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeMethodIsInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeIsMissing
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001651] "GET http://localhost:19090/auth/authorize/?client_id=test-client-HNTbYDAH&redirect_uri=https://www.principalmonetize.org/incubate/front-end&response_type=code&code_challenge_method=S256 HTTP/1.1" from [::1]:46094 - 302 220B in 267.485Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeInvalid
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001652] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XHnbKwqG&redirect_uri=https://www.senioroptimize.net/granular&response_type=code&code_challenge_method=S256&code_challenge=xQPfeRflFsvsOsgxKCOilBoldTxcRKTEjJDwHoMuPM HTTP/1.1" from [::1]:46104 - 302 207B in 246.275Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001653] "GET http://localhost:19090/auth/authorize/?client_id=test-client-QNqSuzcq&redirect_uri=https://www.principalvortals.com/matrix/vortals/methodologies&response_type=code&code_challenge_method=S256&code_challenge=aVirhitSFapPTDESmTpioXwHbpgmOmRruNtcxAlHeKSAXvgXmWlYQWINUssVZvyuxzJdMvkzUHgXQjQQxkLDFSVhHIZEUthXIteOkADqpfOTyZvjegdnWARbARPECZdjU HTTP/1.1" from [::1]:46116 - 302 229B in 242.579Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_InvalidResponseMode
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001654] "GET http://localhost:19090/auth/authorize/?client_id=test-client-CiUozIPo&redirect_uri=https://www.investorincentivize.name/platforms/redefine/unleash/revolutionary&response_type=code&code_challenge_method=S256&code_challenge=sIXYIymTFcObBbuqMcFCCMDvRqsnSETdbhCrMMzxRAE&response_mode=invalid HTTP/1.1" from [::1]:46118 - 302 233B in 305.678Âµs
--- PASS: TestAuthorize_ValidateRequest_InvalidResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_QueryResponseMode
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001655] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XHDioSHO&redirect_uri=https://www.customersynergize.com/technologies/convergence/b2b/holistic&response_type=code&code_challenge_method=S256&code_challenge=GurwLflGvdNfDrbFOaXzqEzImkQwUHHkhNXcQXOGiDf&response_mode=query&scope=invalid_scope HTTP/1.1" from [::1]:46120 - 302 309B in 702.968Âµs
--- PASS: TestAuthorize_ValidateRequest_QueryResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_FragmentResponseMode
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001656] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kzCWKRIi&redirect_uri=http://www.internationalkiller.org/morph&response_type=code&code_challenge_method=S256&code_challenge=EeSGzuocoDLEuzqUrgKPPVAceyRiMcVzNCMprFXnwIE&response_mode=fragment&scope=invalid_scope HTTP/1.1" from [::1]:46138 - 302 278B in 335.825Âµs
--- PASS: TestAuthorize_ValidateRequest_FragmentResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_FormPostResponseMode
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001657] "GET http://localhost:19090/auth/authorize/?client_id=test-client-UiaPrGly&redirect_uri=https://www.centralkiller.org/eyeballs/integrated/expedite&response_type=code&code_challenge_method=S256&code_challenge=dHwFpXgflcXoWBebUygjYdjZPCznWFcQMgXdjyjLygO&response_mode=form_post&scope=invalid_scope HTTP/1.1" from [::1]:46142 - 200 681B in 274.779Âµs
--- PASS: TestAuthorize_ValidateRequest_FormPostResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ScopeIsMissing
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001658] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XXwbYOTR&redirect_uri=https://www.chiefstreamline.biz/cutting-edge/iterate/leverage/reintermediate&response_type=code&code_challenge_method=S256&code_challenge=DhwFgqgGCozoVTZMFfhvuaBzmHXgxsBteoTfPjZmCgS HTTP/1.1" from [::1]:46148 - 302 340B in 207.682Âµs
--- PASS: TestAuthorize_ValidateScopes_ScopeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateScopes_UserInfoShouldNotBeIncluded
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001659] "GET http://localhost:19090/auth/authorize/?client_id=test-client-yUPXHICl&code_challenge=HQyYedZfyIOrGcQvkqhBTnnQipQgfcYGumzPREeGeaA&code_challenge_method=S256&redirect_uri=http%3A%2F%2Fwww.directnetworks.io%2Fstreamline%2Fvirtual%2Farchitect&response_type=code&scope=openid+profile+authserver%3Auserinfo HTTP/1.1" from [::1]:46152 - 302 327B in 209.275Âµs
--- PASS: TestAuthorize_ValidateScopes_UserInfoShouldNotBeIncluded (0.00s)
=== RUN   TestAuthorize_ValidateScopes_InvalidScope
=== RUN   TestAuthorize_ValidateScopes_InvalidScope/Invalid_single_scope
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001660] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qDEqGwjR&redirect_uri=https%3A%2F%2Fwww.forwardseamless.info%2Foptimize%2Fe-business%2Fcommunities%2Fe-services&response_type=code&code_challenge_method=S256&code_challenge=kLbusyJfSlQeVKTXSMFKsDbCCKZgJrpmdrnwuZNsCaJ&scope=my_scope HTTP/1.1" from [::1]:46160 - 302 308B in 223.743Âµs
=== RUN   TestAuthorize_ValidateScopes_InvalidScope/Invalid_complex_scope
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001661] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qDEqGwjR&redirect_uri=https%3A%2F%2Fwww.forwardseamless.info%2Foptimize%2Fe-business%2Fcommunities%2Fe-services&response_type=code&code_challenge_method=S256&code_challenge=hyEvnHPGVusBQJOFZXWcywaiyGIwIStDIjBfBIakZqB&scope=my_resource%3Amy_scope%3Asomething HTTP/1.1" from [::1]:46168 - 302 334B in 214.355Âµs
--- PASS: TestAuthorize_ValidateScopes_InvalidScope (0.00s)
    --- PASS: TestAuthorize_ValidateScopes_InvalidScope/Invalid_single_scope (0.00s)
    --- PASS: TestAuthorize_ValidateScopes_InvalidScope/Invalid_complex_scope (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ResourceDoesNotExist
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001662] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PcuLStRH&redirect_uri=https%3A%2F%2Fwww.chiefexperiences.biz%2Fsexy%2Fharness%2Fkiller&response_type=code&code_challenge_method=S256&code_challenge=tqlDQsBRNCejKNqLJDWiCEPmxEPbToggrCPuxqAXYYF&scope=non_existent_resource%3Aread HTTP/1.1" from [::1]:46180 - 302 241B in 236.757Âµs
--- PASS: TestAuthorize_ValidateScopes_ResourceDoesNotExist (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ResourceDoesNotHavePermissionAssociated
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001663] "GET http://localhost:19090/auth/authorize/?client_id=test-client-GIfZzHrp&redirect_uri=https%3A%2F%2Fwww.chiefmagnetic.com%2Fvisualize&response_type=code&code_challenge_method=S256&code_challenge=XWFmCqoBoOcpZMMMLAvCYaLsXXnTjTrLTZJNlFyGQRd&scope=test-resource-tOBzVHwW%3Anon_existent_permission HTTP/1.1" from [::1]:46184 - 302 307B in 290.91Âµs
--- PASS: TestAuthorize_ValidateScopes_ResourceDoesNotHavePermissionAssociated (0.00s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001664] "GET http://localhost:19090/auth/authorize/?client_id=test-client-faBbOqTS&redirect_uri=https%3A%2F%2Fwww.directdistributed.org%2Fvisionary%2Fmesh%2Fseamless%2Fvalue-added&response_type=code&code_challenge_method=S256&code_challenge=ZyCTloBZVuMxfujfVewrzojSwZWFuGeNmkeofEtHaKF&scope=openid+profile+email&state=sqztGdiJ&nonce=cxXoZLzx HTTP/1.1" from [::1]:46186 - 302 57B in 345.603Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001665] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46194 - 302 54B in 182.515Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001666] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46200 - 200 2949B in 1.269017ms
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":1958}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001667] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46200 - 302 0B in 35.838245ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001668] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46200 - 302 60B in 302.321Âµs
2025/11/25 13:25:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":4674,"userId":1958}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001669] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46214 - 302 56B in 1.526845ms
2025/11/25 13:25:14 INFO {"audit_event":"created_auth_code","details":{"clientId":4674,"codeId":870,"userId":1958}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001670] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46230 - 302 245B in 928.795Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsNotRequired
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001671] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SGUdRBil&redirect_uri=http%3A%2F%2Fwww.leadsynergistic.org%2Frich%2Finfrastructures&response_type=code&code_challenge_method=S256&code_challenge=UYBufVDqDOxJSjgNjUivCGcxvQfWxrUEGglfcIvnDru&scope=openid+profile+email&state=gFefdYlq&nonce=pnDCnKyo HTTP/1.1" from [::1]:46240 - 302 57B in 535.112Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001672] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46244 - 302 54B in 227.4Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001673] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46246 - 200 2949B in 252.818Âµs
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":1959}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001674] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46246 - 302 0B in 35.557215ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001675] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46246 - 302 57B in 268.597Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001676] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46252 - 302 60B in 539.609Âµs
2025/11/25 13:25:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":4675,"userId":1959}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001677] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46256 - 302 56B in 1.388243ms
2025/11/25 13:25:14 INFO {"audit_event":"created_auth_code","details":{"clientId":4675,"codeId":871,"userId":1959}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001678] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46266 - 302 227B in 825.43Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsNotRequired (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsNotRequired
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001679] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PorHhmyP&redirect_uri=https%3A%2F%2Fwww.directutilize.org%2Fvirtual%2Fworld-class&response_type=code&code_challenge_method=S256&code_challenge=TMGKyiVyHKzhLTxkmABsSpyiXAUYuVBODyLahnGmjxK&scope=openid+profile+email&state=JwzdoEoA&nonce=hGfYtBko HTTP/1.1" from [::1]:46282 - 302 57B in 548.086Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001680] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46286 - 302 54B in 211.109Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001681] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46294 - 200 2949B in 275.821Âµs
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":1960}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001682] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46294 - 302 0B in 36.226509ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001683] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46294 - 302 57B in 517.197Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001684] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46308 - 302 54B in 363.387Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001685] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46320 - 200 2471B in 354.089Âµs
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_otp","details":{"userId":1960}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001686] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46320 - 302 0B in 211.53Âµs
2025/11/25 13:25:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":4676,"userId":1960}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001687] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46320 - 302 56B in 1.224514ms
2025/11/25 13:25:14 INFO {"audit_event":"created_auth_code","details":{"clientId":4676,"codeId":872,"userId":1960}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001688] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46322 - 302 225B in 1.073859ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsNotRequired (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001689] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zotGDWcL&redirect_uri=http%3A%2F%2Fwww.centralclicks-and-mortar.name%2Fenable%2Fmarkets%2Fglobal%2Fcustomized&response_type=code&code_challenge_method=S256&code_challenge=AVNWDOZxbgrBNGiPzLWfrQdgYgVwVGAsBxvGglvuUfL&scope=openid+profile+email&state=DGYpELFd&nonce=UKuHmOqw HTTP/1.1" from [::1]:46330 - 302 57B in 598.731Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001690] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46342 - 302 54B in 184.699Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001691] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46350 - 200 2949B in 261.905Âµs
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":1961}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001692] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46350 - 302 0B in 35.581921ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001693] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46350 - 302 57B in 215.206Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001694] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46364 - 302 54B in 240.444Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001695] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46376 - 200 6166B in 3.82096ms
2025/11/25 13:25:14 INFO {"audit_event":"enabled_otp","details":{"userId":1961}}
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_otp","details":{"userId":1961}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001696] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46376 - 302 0B in 1.364167ms
2025/11/25 13:25:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":4677,"userId":1961}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001697] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46376 - 302 56B in 1.241295ms
2025/11/25 13:25:14 INFO {"audit_event":"created_auth_code","details":{"clientId":4677,"codeId":873,"userId":1961}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001698] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46390 - 302 249B in 958.922Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001699] "GET http://localhost:19090/auth/authorize/?client_id=test-client-HiCRyaYb&redirect_uri=http%3A%2F%2Fwww.seniordrive.biz%2Fviral%2Fenable%2Ftechnologies%2Farchitectures&response_type=code&code_challenge_method=S256&code_challenge=gSrCnVOEMQaJDkUYnguMiqcNKJYPVCAJopyXbDZVvgc&scope=openid+profile+email&state=ChqmPNHM&nonce=vzwzhDCa HTTP/1.1" from [::1]:46392 - 302 57B in 513.881Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001700] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46408 - 302 54B in 174.039Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001701] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46424 - 200 2949B in 303.454Âµs
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":1962}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001702] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46424 - 302 0B in 35.198247ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001703] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46424 - 302 57B in 309.595Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001704] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46430 - 302 54B in 319.323Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001705] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46434 - 200 2471B in 349.069Âµs
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_otp","details":{"userId":1962}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001706] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46434 - 302 0B in 197.273Âµs
2025/11/25 13:25:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":4678,"userId":1962}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001707] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46434 - 302 56B in 1.168267ms
2025/11/25 13:25:14 INFO {"audit_event":"created_auth_code","details":{"clientId":4678,"codeId":874,"userId":1962}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001708] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46450 - 302 242B in 801.244Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001709] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ummoLrhK&redirect_uri=http%3A%2F%2Fwww.nationale-tailers.name%2Fweb-readiness&response_type=code&code_challenge_method=S256&code_challenge=zzrQkuzZqrJfzlsrALPsaGFDrYRzVchQGLctkFHwJzr&scope=openid+profile+email+res-iODVgUJf%3Aperm-CNHGUppv+res-jxyiNYcc%3Aperm-jXfeJxKm&state=YHKkSkbU&nonce=nwFkxajr HTTP/1.1" from [::1]:46466 - 302 57B in 448.307Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001710] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46470 - 302 54B in 153.77Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001711] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46474 - 200 2949B in 296.53Âµs
2025/11/25 13:25:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":1963}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001712] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46474 - 302 0B in 35.177908ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001713] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46474 - 302 60B in 286.431Âµs
2025/11/25 13:25:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":4679,"userId":1963}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001714] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46486 - 302 58B in 1.59807ms
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001715] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46488 - 200 4699B in 571.5Âµs
2025/11/25 13:25:14 INFO {"audit_event":"saved_consent","details":{"clientId":4679,"consentId":157,"userId":1963}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001716] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46488 - 302 0B in 986.594Âµs
2025/11/25 13:25:14 INFO {"audit_event":"created_auth_code","details":{"clientId":4679,"codeId":875,"userId":1963}}
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001717] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46488 - 302 223B in 809.83Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001718] "GET http://localhost:19090/auth/authorize/?client_id=test-client-HOGXXzam&redirect_uri=https%3A%2F%2Fwww.globalvirtual.biz%2Ftransform&response_type=code&code_challenge_method=S256&code_challenge=MPFeNuyknEQxQVXBIjzmdAZWwIXVwxOfJalAXfcrEwh&scope=openid+profile+email+res-HBiHhmmA%3Aperm-dlzdRymu+res-HODwDLgm%3Aperm-ZWtJzUwb&state=tOFKeAmy&nonce=LYqpJYsS HTTP/1.1" from [::1]:46490 - 302 57B in 440.973Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001719] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46492 - 302 54B in 155.283Âµs
2025/11/25 13:25:14 [a357f2e3b56e/8P1BS7F7Qi-001720] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46500 - 200 2949B in 254.531Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1964}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001721] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46500 - 302 0B in 35.42811ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001722] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46500 - 302 60B in 267.396Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4680,"userId":1964}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001723] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46514 - 302 58B in 1.610893ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001724] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46526 - 200 4699B in 427.338Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4680,"consentId":158,"userId":1964}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001725] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46526 - 302 0B in 854.043Âµs
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4680,"codeId":876,"userId":1964}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001726] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46526 - 302 215B in 745.408Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001727] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YnvmJjMB&redirect_uri=https%3A%2F%2Fwww.humanbandwidth.name%2Ffacilitate%2Fgrow&response_type=code&code_challenge_method=S256&code_challenge=slUYUkaiBsuhSzCdlgUDiSijQobADEFbQnvlVyUvafW&scope=openid+profile+email+res-gpKtsDtW%3Aperm-mhcHIfOD+res-HzpCfsvo%3Aperm-rBdAmKLr&state=CGBZDfZo&nonce=trqFcgbY HTTP/1.1" from [::1]:46536 - 302 57B in 481.149Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001728] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46538 - 302 54B in 145.304Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001729] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46550 - 200 2949B in 405.576Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1965}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001730] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46550 - 302 0B in 35.77216ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001731] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46550 - 302 57B in 277.063Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001732] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46564 - 302 60B in 232.038Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4681,"userId":1965}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001733] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46576 - 302 58B in 1.774753ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001734] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46592 - 200 4699B in 419.814Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4681,"consentId":159,"userId":1965}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001735] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46592 - 302 0B in 1.023645ms
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4681,"codeId":877,"userId":1965}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001736] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46592 - 302 223B in 811.524Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001737] "GET http://localhost:19090/auth/authorize/?client_id=test-client-tFEGivuG&redirect_uri=https%3A%2F%2Fwww.chiefrelationships.name%2Fbrand%2Funleash%2Fturn-key%2Fe-markets&response_type=code&code_challenge_method=S256&code_challenge=trKUBdYiaJPVFFBcCdySGGZUSxFGLpUWxSDLmhoGbkI&scope=openid+profile+email+res-WsSKPkhI%3Aperm-SGdTUitQ+res-JkaaGhEE%3Aperm-TdiXFueB&state=YlikVnNj&nonce=XXfXFXJs HTTP/1.1" from [::1]:46600 - 302 57B in 505.716Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001738] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46604 - 302 54B in 202.493Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001739] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46606 - 200 2949B in 286.712Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1966}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001740] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46606 - 302 0B in 35.236308ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001741] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46606 - 302 57B in 346.385Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001742] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46612 - 302 60B in 297.442Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4682,"userId":1966}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001743] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46620 - 302 58B in 1.563213ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001744] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46628 - 200 4699B in 446.904Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4682,"consentId":160,"userId":1966}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001745] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46628 - 302 0B in 966.997Âµs
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4682,"codeId":878,"userId":1966}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001746] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46628 - 302 244B in 770.085Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001747] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YPATBkTI&redirect_uri=http%3A%2F%2Fwww.forwardend-to-end.net%2Finfrastructures%2Farchitect&response_type=code&code_challenge_method=S256&code_challenge=xCAfYVZyVFVgyTPKPrPmiSEIYSGBctnUIRYjUMwMCqD&scope=openid+profile+email+res-RVpepmYt%3Aperm-BoCqMmZW+res-ucLvvRae%3Aperm-ZarSvrnD&state=WRChwJIA&nonce=VqMcQRQS HTTP/1.1" from [::1]:46640 - 302 57B in 638.376Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001748] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46648 - 302 54B in 179.198Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001749] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46654 - 200 2949B in 305.557Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1967}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001750] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46654 - 302 0B in 35.290651ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001751] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46654 - 302 57B in 296.31Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001752] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46656 - 302 54B in 259.871Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001753] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46666 - 200 2471B in 298.124Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_otp","details":{"userId":1967}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001754] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46666 - 302 0B in 189.438Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4683,"userId":1967}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001755] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46666 - 302 58B in 1.386119ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001756] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46668 - 200 4699B in 422.409Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4683,"consentId":161,"userId":1967}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001757] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46668 - 302 0B in 885.423Âµs
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4683,"codeId":879,"userId":1967}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001758] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46668 - 302 234B in 760.237Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001759] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FfcEdkls&redirect_uri=http%3A%2F%2Fwww.customerredefine.com%2Fextend%2Fdeliver%2Fdisintermediate&response_type=code&code_challenge_method=S256&code_challenge=IIKDUjnqjJqOOTZAxtuzCDVbGMtRxgwweOySFTNvTva&scope=openid+profile+email+res-mUlEczOU%3Aperm-PbhsFqvD+res-XehpPxYB%3Aperm-qAoSCAGX&state=GgykCfhy&nonce=QvcmvCSD HTTP/1.1" from [::1]:46670 - 302 57B in 498.041Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001760] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46684 - 302 54B in 242.338Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001761] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46692 - 200 2949B in 243.19Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1968}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001762] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46692 - 302 0B in 35.306631ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001763] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46692 - 302 57B in 298.715Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001764] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46708 - 302 54B in 306.99Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001765] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46712 - 200 2471B in 311.879Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_otp","details":{"userId":1968}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001766] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46712 - 302 0B in 214.255Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4684,"userId":1968}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001767] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46712 - 302 58B in 1.398242ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001768] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46716 - 200 4699B in 371.642Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4684,"consentId":162,"userId":1968}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001769] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46716 - 302 0B in 835.388Âµs
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4684,"codeId":880,"userId":1968}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001770] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46716 - 302 238B in 723.758Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001771] "GET http://localhost:19090/auth/authorize/?client_id=test-client-TxImKPwr&redirect_uri=http%3A%2F%2Fwww.humansystems.net%2Fcutting-edge&response_type=code&code_challenge_method=S256&code_challenge=HZiKnXxZMschjllWdVgBhvrzDchwSNpDcZBwUoijEos&scope=openid+profile+email+res-nzTAdVoW%3Aperm-byHnaMvD+res-EmZxNjNL%3Aperm-PpRqaLjC&state=qioAIFBh&nonce=XzsjqzWE HTTP/1.1" from [::1]:46732 - 302 57B in 408.582Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001772] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46734 - 302 54B in 229.694Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001773] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46744 - 200 2949B in 254.411Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1969}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001774] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46744 - 302 0B in 34.98831ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001775] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46744 - 302 57B in 312.149Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001776] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46758 - 302 54B in 381.01Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001777] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46766 - 200 6166B in 3.732803ms
2025/11/25 13:25:15 INFO {"audit_event":"enabled_otp","details":{"userId":1969}}
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_otp","details":{"userId":1969}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001778] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46766 - 302 0B in 5.131005ms
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4685,"userId":1969}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001779] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46766 - 302 58B in 1.541122ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001780] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46776 - 200 4699B in 446.614Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4685,"consentId":163,"userId":1969}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001781] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46776 - 302 0B in 864.253Âµs
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4685,"codeId":881,"userId":1969}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001782] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46776 - 302 216B in 805.132Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001783] "GET http://localhost:19090/auth/authorize/?client_id=test-client-AEJRYhSm&redirect_uri=https%3A%2F%2Fwww.corporateworld-class.net%2Fholistic%2Fcompelling&response_type=code&code_challenge_method=S256&code_challenge=jBwgMwcFyiAFpNuTHSYhYVPBeGbgTNOrLNZHooykqkQ&scope=openid+profile+email+res-ZZWVnehW%3Aperm-sDGGPtuj+res-GgyJOkcn%3Aperm-kplfdkYw&state=LycEOJMA&nonce=uuYXrLrW HTTP/1.1" from [::1]:46792 - 302 57B in 1.315105ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001784] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46808 - 302 54B in 199.146Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001785] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46816 - 200 2949B in 295.258Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1970}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001786] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46816 - 302 0B in 35.670359ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001787] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46816 - 302 57B in 287.984Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001788] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46822 - 302 54B in 294.115Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001789] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46828 - 200 6122B in 3.447885ms
2025/11/25 13:25:15 INFO {"audit_event":"enabled_otp","details":{"userId":1970}}
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_otp","details":{"userId":1970}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001790] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46828 - 302 0B in 974.802Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4686,"userId":1970}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001791] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46828 - 302 58B in 1.376931ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001792] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46836 - 200 4699B in 426.506Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4686,"consentId":164,"userId":1970}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001793] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46836 - 302 0B in 793.399Âµs
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4686,"codeId":882,"userId":1970}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001794] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46836 - 302 232B in 759.966Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001795] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iwAGOhCw&redirect_uri=https%3A%2F%2Fwww.globalrelationships.com%2Ffacilitate&response_type=code&code_challenge_method=S256&code_challenge=ksmHUDvPgqSuXqrZnekDZaKNRdMWDQMymWlaCyGWuSm&scope=openid+profile+email+res-HbRlkPBJ%3Aperm-jHEixupg+res-rIOZGDbR%3Aperm-xfMVGkfp&state=vXycitGN&nonce=GpWeYEAm HTTP/1.1" from [::1]:46840 - 302 57B in 577.501Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001796] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46846 - 302 54B in 156.576Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001797] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46860 - 200 2949B in 202.222Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1971}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001798] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46860 - 302 0B in 35.123525ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001799] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46860 - 302 57B in 321.007Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001800] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46870 - 302 54B in 325.054Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001801] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46872 - 200 2471B in 293.634Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_otp","details":{"userId":1971}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001802] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46872 - 302 0B in 165.773Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4687,"userId":1971}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001803] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46872 - 302 58B in 1.67244ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001804] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46878 - 200 4699B in 362.284Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4687,"consentId":165,"userId":1971}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001805] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46878 - 302 0B in 751.069Âµs
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4687,"codeId":883,"userId":1971}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001806] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46878 - 302 222B in 672.381Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001807] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nejadGaX&redirect_uri=https%3A%2F%2Fwww.investorimpactful.org%2Finitiatives%2Fvirtual%2Fholistic%2Fstreamline&response_type=code&code_challenge_method=S256&code_challenge=pVQSstSLKmlYJOaWcoGTuPKGnLknTpshjbPELBiukBf&scope=openid+profile+email+res-YPdrVmuJ%3Aperm-pxNUKFne+res-AdXgZVDC%3Aperm-HBvUQSSk&state=oSakDCKw&nonce=vzHfSZho HTTP/1.1" from [::1]:46890 - 302 57B in 628.087Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001808] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46906 - 302 54B in 132.22Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001809] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46910 - 200 2949B in 208.784Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1972}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001810] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46910 - 302 0B in 35.245375ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001811] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46910 - 302 57B in 530.963Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001812] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46924 - 302 54B in 456.533Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001813] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46926 - 200 2471B in 478.794Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_otp","details":{"userId":1972}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001814] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46926 - 302 0B in 265.522Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4688,"userId":1972}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001815] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46926 - 302 58B in 1.61973ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001816] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46938 - 200 4699B in 475.568Âµs
2025/11/25 13:25:15 INFO {"audit_event":"saved_consent","details":{"clientId":4688,"consentId":166,"userId":1972}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001817] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46938 - 302 0B in 920.53Âµs
2025/11/25 13:25:15 INFO {"audit_event":"created_auth_code","details":{"clientId":4688,"codeId":884,"userId":1972}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001818] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46938 - 302 249B in 984.109Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001819] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iIPzZwpB&redirect_uri=http%3A%2F%2Fwww.leadgranular.name%2Fplug-and-play%2Fstreamline%2Fsynergies%2Fe-enable&response_type=code&code_challenge_method=S256&code_challenge=NEZLSlnaBEHNUlFOExEuhpuyGDcniOEQSFDpNeRjzPG&scope=openid+profile+email+res-riVXhyLx%3Aperm-FlqNgJZw+res-OqYlBtbG%3Aperm-MdymeUuu&state=JzWFPJFe&nonce=sLbwEOQp HTTP/1.1" from [::1]:46948 - 302 57B in 679.814Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001820] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46952 - 302 54B in 174.459Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001821] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46960 - 200 2949B in 481.039Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1973}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001822] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46960 - 302 0B in 35.220809ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001823] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46960 - 302 60B in 355.382Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4689,"userId":1973}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001824] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46974 - 302 58B in 1.695463ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001825] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46976 - 200 4699B in 404.474Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001826] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:46976 - 302 0B in 163.519Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsCancelled (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001827] "GET http://localhost:19090/auth/authorize/?client_id=test-client-yDvARftm&redirect_uri=http%3A%2F%2Fwww.productplug-and-play.com%2Farchitectures%2Fcommunities%2Fdot-com&response_type=code&code_challenge_method=S256&code_challenge=KhvwhovyPZOwMxORDRczlXPdHruqfeNgNlQdQCJpoDG&scope=openid+profile+email+res-aKpxNvKG%3Aperm-lrGxWZLP+res-LGtNOfvB%3Aperm-fHtTTeLF&state=uiXBqFal&nonce=sFulyQuo HTTP/1.1" from [::1]:46988 - 302 57B in 598.911Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001828] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46994 - 302 54B in 149.823Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001829] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47010 - 200 2949B in 247.578Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1974}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001830] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47010 - 302 0B in 35.048173ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001831] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47010 - 302 57B in 297.763Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001832] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47018 - 302 60B in 661.81Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4690,"userId":1974}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001833] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47026 - 302 58B in 1.454438ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001834] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47038 - 200 4699B in 392.361Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001835] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47038 - 302 0B in 158.349Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001836] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SevntkyU&redirect_uri=http%3A%2F%2Fwww.customerinteractive.net%2Frelationships%2Fuser-centric%2Fscalable&response_type=code&code_challenge_method=S256&code_challenge=cjmDPqEfhvPNOPdcfxOmJcXSNmGRPJyFroULSoFrncq&scope=openid+profile+email+res-RXADBFnt%3Aperm-ZQBvvCND+res-ExvhBPHM%3Aperm-RDpamBiV&state=gygfoDZY&nonce=zflYPVVj HTTP/1.1" from [::1]:47040 - 302 57B in 678.773Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001837] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47048 - 302 54B in 177.525Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001838] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47050 - 200 2949B in 456.783Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":1975}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001839] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47050 - 302 0B in 35.409856ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001840] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47050 - 302 57B in 465.168Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001841] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47064 - 302 54B in 335.093Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001842] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47070 - 200 2471B in 333.8Âµs
2025/11/25 13:25:15 INFO {"audit_event":"auth_success_otp","details":{"userId":1975}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001843] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47070 - 302 0B in 175.952Âµs
2025/11/25 13:25:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":4691,"userId":1975}}
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001844] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47070 - 302 58B in 1.553746ms
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001845] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47080 - 200 4699B in 391.99Âµs
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001846] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47080 - 302 0B in 166.745Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:15 [a357f2e3b56e/8P1BS7F7Qi-001847] "GET http://localhost:19090/auth/authorize/?client_id=test-client-aOvKLNNl&redirect_uri=http%3A%2F%2Fwww.forwardcross-platform.io%2Fvertical%2Fdrive%2Fnext-generation&response_type=code&code_challenge_method=S256&code_challenge=bIRFfjXTkXBRlxFjMeoADrujHVsvjfZxIDEFPjyexSG&scope=openid+profile+email+res-rDNsZlVn%3Aperm-AszUFNOs+res-gMvntITZ%3Aperm-GAHGGxkL&state=mRbgQLgT&nonce=LxRuCanG HTTP/1.1" from [::1]:47086 - 302 57B in 492.08Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001848] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47094 - 302 54B in 170.843Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001849] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47096 - 200 2949B in 253.298Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":1976}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001850] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47096 - 302 0B in 35.270202ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001851] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47096 - 302 57B in 227.029Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001852] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47106 - 302 54B in 256.324Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001853] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47108 - 200 6194B in 3.603809ms
2025/11/25 13:25:16 INFO {"audit_event":"enabled_otp","details":{"userId":1976}}
2025/11/25 13:25:16 INFO {"audit_event":"auth_success_otp","details":{"userId":1976}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001854] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47108 - 302 0B in 1.070362ms
2025/11/25 13:25:16 INFO {"audit_event":"started_new_user_session","details":{"clientId":4692,"userId":1976}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001855] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47108 - 302 58B in 1.468685ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001856] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47110 - 200 4699B in 474.006Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001857] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47110 - 302 0B in 232.48Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001858] "GET http://localhost:19090/auth/authorize/?client_id=test-client-tRlKYOYK&redirect_uri=http%3A%2F%2Fwww.centralrepurpose.io%2Fseamless%2Finfrastructures&response_type=code&code_challenge_method=S256&code_challenge=wOeTWmKpKWQDOuTsPxWhUjqWdyelYAgCImFGLWpjzOt&scope=openid+profile+email+res-lRsWCBHU%3Aperm-UIzYbCZr+res-WmsxFfkP%3Aperm-lHjmOsTq&state=otOItGqh&nonce=MRrxlIHz HTTP/1.1" from [::1]:47112 - 302 57B in 636.523Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001859] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47122 - 302 54B in 155.434Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001860] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47132 - 200 2949B in 259.04Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":1977}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001861] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47132 - 302 0B in 34.932914ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001862] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47132 - 302 57B in 244.593Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001863] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47142 - 302 54B in 251.375Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001864] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47152 - 200 2471B in 334.883Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_success_otp","details":{"userId":1977}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001865] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47152 - 302 0B in 206.7Âµs
2025/11/25 13:25:16 INFO {"audit_event":"started_new_user_session","details":{"clientId":4693,"userId":1977}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001866] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47152 - 302 58B in 1.410575ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001867] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47166 - 200 4699B in 438.298Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001868] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47166 - 302 0B in 286.992Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired_PasswordIsIncorrect
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001869] "GET http://localhost:19090/auth/authorize/?client_id=test-client-VJziMVQg&redirect_uri=http%3A%2F%2Fwww.directglobal.info%2Fchannels%2Freinvent%2Fproactive&response_type=code&code_challenge_method=S256&code_challenge=AsNOaeFbKkTVQdhyaYSRkaLdUMPazgBVhkbKLWdZGjO&scope=openid+profile+email&state=KpkphUmj&nonce=lFfIMMJs HTTP/1.1" from [::1]:47180 - 302 57B in 386.22Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001870] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47196 - 302 54B in 167.397Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001871] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47210 - 200 2949B in 382.543Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_failed_pwd","details":{"email":"bridiepagac@wuckert.net"}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001872] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47210 - 200 3011B in 36.337209ms
2025/11/25 13:25:16 ERROR authContext.AuthState 'level1_password' does not match any required state
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthLevel1CompletedGet.3
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_level1.go:78
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthLevel1CompletedGet.3
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_level1.go:78
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/8P1BS7F7Qi-001873
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001873] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47210 - 500 2303B in 487.712Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired_PasswordIsIncorrect (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired_OtpCodeIsIncorrect
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001874] "GET http://localhost:19090/auth/authorize/?client_id=test-client-TLuUbiRh&redirect_uri=http%3A%2F%2Fwww.corporateenterprise.biz%2Fgenerate&response_type=code&code_challenge_method=S256&code_challenge=hhGYCQyWfxaAxxNUsBNLTUqxIQVokZguXRapmuiJakv&scope=openid+profile+email&state=qrVahypX&nonce=HOIMkUuZ HTTP/1.1" from [::1]:47216 - 302 57B in 579.906Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001875] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47228 - 302 54B in 215.007Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001876] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47242 - 200 2949B in 282.995Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":1979}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001877] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47242 - 302 0B in 35.292003ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001878] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47242 - 302 57B in 300.498Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001879] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47256 - 302 54B in 415.625Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001880] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47268 - 200 6166B in 3.563793ms
2025/11/25 13:25:16 INFO {"audit_event":"auth_failed_otp","details":{"userId":1979}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001881] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47268 - 200 6393B in 390.067Âµs
2025/11/25 13:25:16 ERROR authContext.AuthState is not authentication_completed
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/8P1BS7F7Qi-001882
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001882] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47268 - 500 2303B in 273.147Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired_OtpCodeIsIncorrect (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired_OtpIsIncorrect
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001883] "GET http://localhost:19090/auth/authorize/?client_id=test-client-rnAAvMKV&redirect_uri=https%3A%2F%2Fwww.internalpartnerships.info%2Fweb-enabled%2Fkiller%2Fincentivize%2Fmesh&response_type=code&code_challenge_method=S256&code_challenge=GOAXyUnlRQJmGKWfkyUoVVZCKkNkXqVrUGhdmzepdxB&scope=openid+profile+email&state=ZWDkswkN&nonce=trUwtgsP HTTP/1.1" from [::1]:47282 - 302 57B in 372.323Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001884] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47290 - 302 54B in 149.602Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001885] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47306 - 200 2949B in 202.363Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":1980}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001886] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47306 - 302 0B in 35.922675ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001887] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47306 - 302 57B in 331.356Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001888] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47314 - 302 54B in 319.644Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001889] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47322 - 200 2471B in 372.013Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_failed_otp","details":{"userId":1980}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001890] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47322 - 200 2698B in 248.61Âµs
2025/11/25 13:25:16 ERROR authContext.AuthState is not authentication_completed
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/8P1BS7F7Qi-001891
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001891] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47322 - 500 2303B in 266.874Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired_OtpIsIncorrect (0.08s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel1Request
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001892] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kYFauTas&redirect_uri=http%3A%2F%2Fwww.humanschemas.name%2Fe-services%2Faction-items%2Frecontextualize%2Freinvent&response_type=code&code_challenge_method=S256&code_challenge=laHtwbHoBJJaFmcFcRCENQpMqEWKDklGEnHAsHeNera&scope=openid+profile+email&state=akJgDOJV&nonce=sNISLpeZ HTTP/1.1" from [::1]:47338 - 302 57B in 431.715Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001893] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47344 - 302 54B in 173.858Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001894] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47350 - 200 2949B in 273.486Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":1981}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001895] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47350 - 302 0B in 35.202474ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001896] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47350 - 302 60B in 333.05Âµs
2025/11/25 13:25:16 INFO {"audit_event":"started_new_user_session","details":{"clientId":4697,"userId":1981}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001897] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47366 - 302 56B in 1.465549ms
2025/11/25 13:25:16 INFO {"audit_event":"created_auth_code","details":{"clientId":4697,"codeId":885,"userId":1981}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001898] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47382 - 302 253B in 1.821883ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001899] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kYFauTas&redirect_uri=http%3A%2F%2Fwww.humanschemas.name%2Fe-services%2Faction-items%2Frecontextualize%2Freinvent&response_type=code&code_challenge_method=S256&code_challenge=ZZrHzFpRdUnQcotXgLmDCUvsjXapiUTwumVcNbmBZUj&scope=openid+profile+email&state=NpvUobie&nonce=ettwHRJo&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:47392 - 302 66B in 1.160052ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001900] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47396 - 302 60B in 395.929Âµs
2025/11/25 13:25:16 INFO {"audit_event":"bumped_user_session","details":{"clientId":4697,"userId":1981}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001901] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47398 - 302 56B in 4.360709ms
2025/11/25 13:25:16 INFO {"audit_event":"created_auth_code","details":{"clientId":4697,"codeId":886,"userId":1981}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001902] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47414 - 302 253B in 840.568Âµs
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel1Request (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001903] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YSelfkQB&redirect_uri=https%3A%2F%2Fwww.customerpartnerships.info%2Faggregate&response_type=code&code_challenge_method=S256&code_challenge=yqLMogfJFqiUgasrPrIIBbjcmVqFwEjPXdbKaBmrefv&scope=openid+profile+email&state=rbefVMwq&nonce=sXtMhEmj HTTP/1.1" from [::1]:47418 - 302 57B in 348.869Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001904] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47434 - 302 54B in 163.86Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001905] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47450 - 200 2949B in 249.932Âµs
2025/11/25 13:25:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":1982}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001906] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47450 - 302 0B in 35.324856ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001907] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47450 - 302 60B in 276.353Âµs
2025/11/25 13:25:16 INFO {"audit_event":"started_new_user_session","details":{"clientId":4698,"userId":1982}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001908] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47460 - 302 56B in 1.252627ms
2025/11/25 13:25:16 INFO {"audit_event":"created_auth_code","details":{"clientId":4698,"codeId":887,"userId":1982}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001909] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47464 - 302 223B in 853.303Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001910] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YSelfkQB&redirect_uri=https%3A%2F%2Fwww.customerpartnerships.info%2Faggregate&response_type=code&code_challenge_method=S256&code_challenge=qsVhUuNWXyFoltllUMDYWFdEmCzpQlNqxrxlZODpXtn&scope=openid+profile+email&state=hgiXJyBl&nonce=JqhvTKyU&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:47470 - 302 66B in 1.165011ms
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001911] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47486 - 302 57B in 441.223Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001912] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47500 - 302 60B in 284.678Âµs
2025/11/25 13:25:16 INFO {"audit_event":"bumped_user_session","details":{"clientId":4698,"userId":1982}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001913] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47514 - 302 56B in 4.137518ms
2025/11/25 13:25:16 INFO {"audit_event":"created_auth_code","details":{"clientId":4698,"codeId":888,"userId":1982}}
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001914] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47524 - 302 223B in 943.393Âµs
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpDisabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001915] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JFPRdLil&redirect_uri=https%3A%2F%2Fwww.principalscale.info%2Ftransform%2Fscale%2Fvirtual%2Fmetrics&response_type=code&code_challenge_method=S256&code_challenge=JIQHbpKnmBLeddHvBUeccRyOKPwsLmJHebSOMfwCpce&scope=openid+profile+email&state=gqjeTkKF&nonce=Vzejjsvq HTTP/1.1" from [::1]:47530 - 302 57B in 489.455Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001916] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47534 - 302 54B in 200.098Âµs
2025/11/25 13:25:16 [a357f2e3b56e/8P1BS7F7Qi-001917] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47544 - 200 2949B in 402.37Âµs
2025/11/25 13:25:17 INFO {"audit_event":"auth_success_pwd","details":{"userId":1983}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001918] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47544 - 302 0B in 35.158812ms
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001919] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47544 - 302 60B in 280.53Âµs
2025/11/25 13:25:17 INFO {"audit_event":"started_new_user_session","details":{"clientId":4699,"userId":1983}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001920] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47558 - 302 56B in 1.165021ms
2025/11/25 13:25:17 INFO {"audit_event":"created_auth_code","details":{"clientId":4699,"codeId":889,"userId":1983}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001921] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47574 - 302 239B in 903.597Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001922] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JFPRdLil&redirect_uri=https%3A%2F%2Fwww.principalscale.info%2Ftransform%2Fscale%2Fvirtual%2Fmetrics&response_type=code&code_challenge_method=S256&code_challenge=duFtjIjpWXtTbwGyBiVMgcHxKBxCJwVbpGuTLidtiCp&scope=openid+profile+email&state=laDOgNng&nonce=YgZHXqiu&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:47580 - 302 66B in 1.008706ms
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001923] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47586 - 302 57B in 464.718Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001924] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47592 - 302 54B in 293.504Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001925] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47602 - 200 2471B in 355.251Âµs
2025/11/25 13:25:17 INFO {"audit_event":"auth_success_otp","details":{"userId":1983}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001926] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47602 - 302 0B in 234.463Âµs
2025/11/25 13:25:17 INFO {"audit_event":"bumped_user_session","details":{"clientId":4699,"userId":1983}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001927] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47602 - 302 56B in 3.76306ms
2025/11/25 13:25:17 INFO {"audit_event":"created_auth_code","details":{"clientId":4699,"codeId":890,"userId":1983}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001928] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47616 - 302 239B in 924.848Âµs
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpEnabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001929] "GET http://localhost:19090/auth/authorize/?client_id=test-client-cgCSiHqg&redirect_uri=https%3A%2F%2Fwww.humanstrategize.name%2Fproductize%2Fb2c%2Fmission-critical%2Fproductize&response_type=code&code_challenge_method=S256&code_challenge=GSTInWwgWzYUkiIelWctJkocoqnqsnYYHaqFCLuscYK&scope=openid+profile+email&state=bPNpOHCm&nonce=PdXaHbmQ HTTP/1.1" from [::1]:47620 - 302 57B in 510.645Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001930] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47630 - 302 54B in 131.529Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001931] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47646 - 200 2949B in 256.114Âµs
2025/11/25 13:25:17 INFO {"audit_event":"auth_success_pwd","details":{"userId":1984}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001932] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47646 - 302 0B in 36.821463ms
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001933] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47646 - 302 60B in 313.302Âµs
2025/11/25 13:25:17 INFO {"audit_event":"started_new_user_session","details":{"clientId":4700,"userId":1984}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001934] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47654 - 302 56B in 1.149813ms
2025/11/25 13:25:17 INFO {"audit_event":"created_auth_code","details":{"clientId":4700,"codeId":891,"userId":1984}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001935] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47670 - 302 251B in 767.811Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001936] "GET http://localhost:19090/auth/authorize/?client_id=test-client-cgCSiHqg&redirect_uri=https%3A%2F%2Fwww.humanstrategize.name%2Fproductize%2Fb2c%2Fmission-critical%2Fproductize&response_type=code&code_challenge_method=S256&code_challenge=KVROjoiRcKUHefuWwoTLpqjGHWrCBlIDrUPUUjnNjpr&scope=openid+profile+email&state=qlQqjtVL&nonce=JNgUeTPe&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:47674 - 302 66B in 1.018144ms
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001937] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47678 - 302 57B in 363.717Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001938] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47680 - 302 54B in 372.324Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001939] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47688 - 200 6142B in 3.534829ms
2025/11/25 13:25:17 INFO {"audit_event":"enabled_otp","details":{"userId":1984}}
2025/11/25 13:25:17 INFO {"audit_event":"auth_success_otp","details":{"userId":1984}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001940] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47688 - 302 0B in 3.522977ms
2025/11/25 13:25:17 INFO {"audit_event":"bumped_user_session","details":{"clientId":4700,"userId":1984}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001941] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47688 - 302 56B in 1.575496ms
2025/11/25 13:25:17 INFO {"audit_event":"created_auth_code","details":{"clientId":4700,"codeId":892,"userId":1984}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001942] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47698 - 302 251B in 1.012863ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpDisabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001943] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JjFQfNds&redirect_uri=https%3A%2F%2Fwww.centralclicks-and-mortar.net%2Fincubate%2Fdeploy&response_type=code&code_challenge_method=S256&code_challenge=ArFmUecuUDCmZQecLdvscPNyjYmqArYZbuwKUiBeJCP&scope=openid+profile+email&state=CKlvECWm&nonce=HpBrVoBJ HTTP/1.1" from [::1]:47712 - 302 57B in 456.743Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001944] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47728 - 302 54B in 180.421Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001945] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47744 - 200 2949B in 250.383Âµs
2025/11/25 13:25:17 INFO {"audit_event":"auth_success_pwd","details":{"userId":1985}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001946] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47744 - 302 0B in 35.122773ms
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001947] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47744 - 302 60B in 363.146Âµs
2025/11/25 13:25:17 INFO {"audit_event":"started_new_user_session","details":{"clientId":4701,"userId":1985}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001948] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47760 - 302 56B in 1.517046ms
2025/11/25 13:25:17 INFO {"audit_event":"created_auth_code","details":{"clientId":4701,"codeId":893,"userId":1985}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001949] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47772 - 302 232B in 784.573Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001950] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JjFQfNds&redirect_uri=https%3A%2F%2Fwww.centralclicks-and-mortar.net%2Fincubate%2Fdeploy&response_type=code&code_challenge_method=S256&code_challenge=ZAkUoNCKEPgZccPPhMmQHqReYhHjMGDbkaWXlySoNmv&scope=openid+profile+email&state=wMaDbZQy&nonce=MczFmZnp&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:47776 - 302 66B in 1.053891ms
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001951] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47784 - 302 57B in 545.18Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001952] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47792 - 302 54B in 467.954Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001953] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47798 - 200 2471B in 598.281Âµs
2025/11/25 13:25:17 INFO {"audit_event":"auth_success_otp","details":{"userId":1985}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001954] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:47798 - 302 0B in 1.446222ms
2025/11/25 13:25:17 INFO {"audit_event":"bumped_user_session","details":{"clientId":4701,"userId":1985}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001955] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47798 - 302 56B in 3.984449ms
2025/11/25 13:25:17 INFO {"audit_event":"created_auth_code","details":{"clientId":4701,"codeId":894,"userId":1985}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001956] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47800 - 302 232B in 1.162016ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpEnabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel1Request
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001957] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LXUSLhZr&redirect_uri=https%3A%2F%2Fwww.dynamicb2b.io%2Fincubate%2Fextensible%2Fproductize%2Fpartnerships&response_type=code&code_challenge_method=S256&code_challenge=iFCFcPLGDsLassVcvfSQbBjtwOYzakVsbjWbASmHeXr&scope=openid+profile+email&state=KMwBgIgp&nonce=DLGWZtOb HTTP/1.1" from [::1]:47804 - 302 57B in 409.184Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001958] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47810 - 302 54B in 164.691Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001959] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47820 - 200 2949B in 278.606Âµs
2025/11/25 13:25:17 INFO {"audit_event":"auth_success_pwd","details":{"userId":1986}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001960] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47820 - 302 0B in 35.255795ms
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001961] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47820 - 302 57B in 419.793Âµs
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001962] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47828 - 302 60B in 490.728Âµs
2025/11/25 13:25:17 INFO {"audit_event":"started_new_user_session","details":{"clientId":4702,"userId":1986}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001963] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47844 - 302 56B in 1.347145ms
2025/11/25 13:25:17 INFO {"audit_event":"created_auth_code","details":{"clientId":4702,"codeId":895,"userId":1986}}
2025/11/25 13:25:17 [a357f2e3b56e/8P1BS7F7Qi-001964] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47854 - 302 245B in 795.313Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001965] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LXUSLhZr&redirect_uri=https%3A%2F%2Fwww.dynamicb2b.io%2Fincubate%2Fextensible%2Fproductize%2Fpartnerships&response_type=code&code_challenge_method=S256&code_challenge=rVOsnSsQTCOMyXcMqJLXPrjhnWLAYvctLwtEZVjbphZ&scope=openid+profile+email&state=VfmcBTZp&nonce=FlHIxAKO&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:47870 - 302 66B in 1.09549ms
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001966] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47876 - 302 60B in 337.067Âµs
2025/11/25 13:25:18 INFO {"audit_event":"bumped_user_session","details":{"clientId":4702,"userId":1986}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001967] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47890 - 302 56B in 3.947749ms
2025/11/25 13:25:18 INFO {"audit_event":"created_auth_code","details":{"clientId":4702,"codeId":896,"userId":1986}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001968] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47892 - 302 245B in 915.63Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel1Request (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001969] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oIoWqYFS&redirect_uri=https%3A%2F%2Fwww.productsystems.org%2Fmission-critical%2Fmonetize&response_type=code&code_challenge_method=S256&code_challenge=LUhKhuVukiGUTxNDcimTKWyYtBlQdlsCGflSiTjDszI&scope=openid+profile+email&state=YKdckLNl&nonce=CitqmDJg HTTP/1.1" from [::1]:47906 - 302 57B in 566.611Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001970] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47918 - 302 54B in 191.191Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001971] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47934 - 200 2949B in 283.135Âµs
2025/11/25 13:25:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":1987}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001972] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47934 - 302 0B in 35.800544ms
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001973] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47934 - 302 57B in 294.807Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001974] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47946 - 302 60B in 511.507Âµs
2025/11/25 13:25:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":4703,"userId":1987}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001975] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47954 - 302 56B in 1.238721ms
2025/11/25 13:25:18 INFO {"audit_event":"created_auth_code","details":{"clientId":4703,"codeId":897,"userId":1987}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001976] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47960 - 302 232B in 893.348Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001977] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oIoWqYFS&redirect_uri=https%3A%2F%2Fwww.productsystems.org%2Fmission-critical%2Fmonetize&response_type=code&code_challenge_method=S256&code_challenge=PSMISQUCaDVykQYhajvVokzuYAvNVTiCLzhkOVYUehV&scope=openid+profile+email&state=GwsDNjYE&nonce=KlpAyMtf&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:47974 - 302 66B in 896.524Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001978] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47978 - 302 60B in 350.282Âµs
2025/11/25 13:25:18 INFO {"audit_event":"bumped_user_session","details":{"clientId":4703,"userId":1987}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001979] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47986 - 302 56B in 3.730298ms
2025/11/25 13:25:18 INFO {"audit_event":"created_auth_code","details":{"clientId":4703,"codeId":898,"userId":1987}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001980] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47990 - 302 232B in 908.306Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpDisabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001981] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ATavutoc&redirect_uri=http%3A%2F%2Fwww.chiefleverage.org%2Fportals%2Fe-commerce&response_type=code&code_challenge_method=S256&code_challenge=AtbVKmOiFiVIexmUATiSZJslndZCPKMypoJVjQsHtkW&scope=openid+profile+email&state=DdbsYNMx&nonce=ktSWHwNj HTTP/1.1" from [::1]:47994 - 302 57B in 517.447Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001982] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48002 - 302 54B in 171.084Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001983] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48014 - 200 2949B in 257.768Âµs
2025/11/25 13:25:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":1988}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001984] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48014 - 302 0B in 35.957691ms
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001985] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48014 - 302 57B in 312.35Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001986] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48026 - 302 60B in 331.295Âµs
2025/11/25 13:25:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":4704,"userId":1988}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001987] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48038 - 302 56B in 1.073118ms
2025/11/25 13:25:18 INFO {"audit_event":"created_auth_code","details":{"clientId":4704,"codeId":899,"userId":1988}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001988] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48048 - 302 223B in 826.682Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001989] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ATavutoc&redirect_uri=http%3A%2F%2Fwww.chiefleverage.org%2Fportals%2Fe-commerce&response_type=code&code_challenge_method=S256&code_challenge=OYuFyVNruklUaMXUklOXvGtnyowowOaCmzCFJWYARJI&scope=openid+profile+email&state=MRXjIANJ&nonce=iFBhWsAZ&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:48064 - 302 66B in 1.103475ms
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001990] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48072 - 302 57B in 3.689701ms
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001991] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48074 - 302 54B in 832.283Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001992] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48090 - 200 2471B in 428.83Âµs
2025/11/25 13:25:18 INFO {"audit_event":"auth_success_otp","details":{"userId":1988}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001993] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48090 - 302 0B in 263.648Âµs
2025/11/25 13:25:18 INFO {"audit_event":"bumped_user_session","details":{"clientId":4704,"userId":1988}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001994] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48090 - 302 56B in 1.113053ms
2025/11/25 13:25:18 INFO {"audit_event":"created_auth_code","details":{"clientId":4704,"codeId":900,"userId":1988}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001995] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48102 - 302 223B in 810.201Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpEnabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001996] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iOBdHoAM&redirect_uri=https%3A%2F%2Fwww.forwardbenchmark.io%2Fscale%2Fexploit%2Fkiller&response_type=code&code_challenge_method=S256&code_challenge=uFywBYaNLNgUxTIRScovbVlpXEWAlVKEzPrEZkMqVFd&scope=openid+profile+email&state=htVhkDJk&nonce=FIuPQMeM HTTP/1.1" from [::1]:48112 - 302 57B in 507.829Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001997] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48122 - 302 54B in 238.461Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001998] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48134 - 200 2949B in 270.36Âµs
2025/11/25 13:25:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":1989}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-001999] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48134 - 302 0B in 35.061247ms
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002000] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48134 - 302 57B in 343.168Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002001] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48136 - 302 60B in 258.909Âµs
2025/11/25 13:25:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":4705,"userId":1989}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002002] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48142 - 302 56B in 1.421516ms
2025/11/25 13:25:18 INFO {"audit_event":"created_auth_code","details":{"clientId":4705,"codeId":901,"userId":1989}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002003] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48148 - 302 228B in 795.984Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002004] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iOBdHoAM&redirect_uri=https%3A%2F%2Fwww.forwardbenchmark.io%2Fscale%2Fexploit%2Fkiller&response_type=code&code_challenge_method=S256&code_challenge=uwJNoYPwFRSmYtbbCYQHKlKPfVWZiFkRwzPZHSfmMAl&scope=openid+profile+email&state=mZUHoReM&nonce=lItdiAcF&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:48150 - 302 66B in 1.269248ms
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002005] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48164 - 302 57B in 967.448Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002006] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48180 - 302 54B in 377.032Âµs
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002007] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48182 - 200 6178B in 4.22892ms
2025/11/25 13:25:18 INFO {"audit_event":"enabled_otp","details":{"userId":1989}}
2025/11/25 13:25:18 INFO {"audit_event":"auth_success_otp","details":{"userId":1989}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002008] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48182 - 302 0B in 4.267233ms
2025/11/25 13:25:18 INFO {"audit_event":"bumped_user_session","details":{"clientId":4705,"userId":1989}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002009] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48182 - 302 56B in 1.108274ms
2025/11/25 13:25:18 INFO {"audit_event":"created_auth_code","details":{"clientId":4705,"codeId":902,"userId":1989}}
2025/11/25 13:25:18 [a357f2e3b56e/8P1BS7F7Qi-002010] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48198 - 302 228B in 993.578Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpDisabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002011] "GET http://localhost:19090/auth/authorize/?client_id=test-client-KnUHuNCp&redirect_uri=http%3A%2F%2Fwww.leadcultivate.org%2Fe-business%2Fseize%2Ffacilitate&response_type=code&code_challenge_method=S256&code_challenge=TXpORkKkvJDWCgUNvdbXuhlozgiPqIHbZnAdnzOaeql&scope=openid+profile+email&state=PwVLcqFM&nonce=GcTdNBKV HTTP/1.1" from [::1]:48206 - 302 57B in 559.788Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002012] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48222 - 302 54B in 173.528Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002013] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48238 - 200 2949B in 754.255Âµs
2025/11/25 13:25:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":1990}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002014] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48238 - 302 0B in 37.199317ms
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002015] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48238 - 302 57B in 258.308Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002016] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48244 - 302 60B in 555.289Âµs
2025/11/25 13:25:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":4706,"userId":1990}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002017] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48260 - 302 56B in 1.20669ms
2025/11/25 13:25:19 INFO {"audit_event":"created_auth_code","details":{"clientId":4706,"codeId":903,"userId":1990}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002018] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48272 - 302 232B in 899.95Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002019] "GET http://localhost:19090/auth/authorize/?client_id=test-client-KnUHuNCp&redirect_uri=http%3A%2F%2Fwww.leadcultivate.org%2Fe-business%2Fseize%2Ffacilitate&response_type=code&code_challenge_method=S256&code_challenge=muKGUXmBMJCvMBIwfKrSuGeHqpFwvmKAJongPOoZTTt&scope=openid+profile+email&state=UMEqqSXB&nonce=MpUUCeYi&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:48284 - 302 66B in 1.112522ms
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002020] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48300 - 302 57B in 696.927Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002021] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48308 - 302 54B in 497.58Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002022] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48318 - 200 2471B in 435.112Âµs
2025/11/25 13:25:19 INFO {"audit_event":"auth_success_otp","details":{"userId":1990}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002023] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48318 - 302 0B in 294.547Âµs
2025/11/25 13:25:19 INFO {"audit_event":"bumped_user_session","details":{"clientId":4706,"userId":1990}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002024] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48318 - 302 56B in 1.787738ms
2025/11/25 13:25:19 INFO {"audit_event":"created_auth_code","details":{"clientId":4706,"codeId":904,"userId":1990}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002025] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48320 - 302 232B in 912.214Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpEnabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel1Request
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002026] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YnqkHRdu&redirect_uri=http%3A%2F%2Fwww.nationaldynamic.info%2Fproductize%2Fb2c&response_type=code&code_challenge_method=S256&code_challenge=nCSGxFluQXRijlDbdThjVSUSiqHlcwuDzuBGGhbmZjN&scope=openid+profile+email&state=sIgLPaAd&nonce=TCPfJsRO HTTP/1.1" from [::1]:48336 - 302 57B in 908.838Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002027] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48344 - 302 54B in 279.338Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002028] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48350 - 200 2949B in 330.014Âµs
2025/11/25 13:25:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":1991}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002029] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48350 - 302 0B in 38.653514ms
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002030] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48350 - 302 57B in 271.032Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002031] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48356 - 302 54B in 530.242Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002032] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48358 - 200 2471B in 322.62Âµs
2025/11/25 13:25:19 INFO {"audit_event":"auth_success_otp","details":{"userId":1991}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002033] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48358 - 302 0B in 332.177Âµs
2025/11/25 13:25:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":4707,"userId":1991}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002034] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48358 - 302 56B in 1.158318ms
2025/11/25 13:25:19 INFO {"audit_event":"created_auth_code","details":{"clientId":4707,"codeId":905,"userId":1991}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002035] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48372 - 302 222B in 813.858Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002036] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YnqkHRdu&redirect_uri=http%3A%2F%2Fwww.nationaldynamic.info%2Fproductize%2Fb2c&response_type=code&code_challenge_method=S256&code_challenge=LGsHTWLARfefnmyqyVfaZKwajiedvIUMouQBfFabaBy&scope=openid+profile+email&state=aBwcRSqe&nonce=ppePosPo&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:48378 - 302 66B in 1.300067ms
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002037] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48390 - 302 60B in 370.911Âµs
2025/11/25 13:25:19 INFO {"audit_event":"bumped_user_session","details":{"clientId":4707,"userId":1991}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002038] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48404 - 302 56B in 3.794089ms
2025/11/25 13:25:19 INFO {"audit_event":"created_auth_code","details":{"clientId":4707,"codeId":906,"userId":1991}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002039] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48416 - 302 222B in 895.161Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel1Request (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002040] "GET http://localhost:19090/auth/authorize/?client_id=test-client-EPdeHbKL&redirect_uri=https%3A%2F%2Fwww.principalback-end.net%2Fmission-critical%2Fbrand%2Fbricks-and-clicks&response_type=code&code_challenge_method=S256&code_challenge=izUWAmWWZZttvjGiRVBlCHCgTqJRKJlFjecNxoekoWV&scope=openid+profile+email&state=IvPJzMqz&nonce=SyxglBOI HTTP/1.1" from [::1]:48430 - 302 57B in 490.517Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002041] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48442 - 302 54B in 177.706Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002042] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48454 - 200 2949B in 299.196Âµs
2025/11/25 13:25:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":1992}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002043] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48454 - 302 0B in 39.263177ms
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002044] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48454 - 302 57B in 302.862Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002045] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48464 - 302 54B in 331.136Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002046] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48472 - 200 2471B in 351.825Âµs
2025/11/25 13:25:19 INFO {"audit_event":"auth_success_otp","details":{"userId":1992}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002047] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48472 - 302 0B in 206.029Âµs
2025/11/25 13:25:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":4708,"userId":1992}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002048] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48472 - 302 56B in 1.128433ms
2025/11/25 13:25:19 INFO {"audit_event":"created_auth_code","details":{"clientId":4708,"codeId":907,"userId":1992}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002049] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48474 - 302 250B in 822.224Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002050] "GET http://localhost:19090/auth/authorize/?client_id=test-client-EPdeHbKL&redirect_uri=https%3A%2F%2Fwww.principalback-end.net%2Fmission-critical%2Fbrand%2Fbricks-and-clicks&response_type=code&code_challenge_method=S256&code_challenge=iOYBplyAOzPIZlrKyJJAklYObDHqgxFvVVNvakegtTl&scope=openid+profile+email&state=hoSJniJG&nonce=HstFRxxq&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:48482 - 302 66B in 1.044794ms
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002051] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48494 - 302 60B in 338.95Âµs
2025/11/25 13:25:19 INFO {"audit_event":"bumped_user_session","details":{"clientId":4708,"userId":1992}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002052] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48498 - 302 56B in 3.835266ms
2025/11/25 13:25:19 INFO {"audit_event":"created_auth_code","details":{"clientId":4708,"codeId":908,"userId":1992}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002053] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48506 - 302 250B in 864.324Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpDisabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002054] "GET http://localhost:19090/auth/authorize/?client_id=test-client-jHLRnTAd&redirect_uri=https%3A%2F%2Fwww.directproductize.biz%2Fevolve&response_type=code&code_challenge_method=S256&code_challenge=CwUBIYHAAuqQrTLeXXPnSbvlzFHymQJuMUJQpjlSrYB&scope=openid+profile+email&state=tXhTErdu&nonce=DRqJmgiX HTTP/1.1" from [::1]:48512 - 302 57B in 735.43Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002055] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48526 - 302 54B in 197.273Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002056] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48536 - 200 2949B in 263.638Âµs
2025/11/25 13:25:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":1993}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002057] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48536 - 302 0B in 35.715203ms
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002058] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48536 - 302 57B in 553.707Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002059] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48542 - 302 54B in 432.126Âµs
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002060] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48554 - 200 2471B in 349.871Âµs
2025/11/25 13:25:19 INFO {"audit_event":"auth_success_otp","details":{"userId":1993}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002061] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48554 - 302 0B in 205.278Âµs
2025/11/25 13:25:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":4709,"userId":1993}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002062] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48554 - 302 56B in 1.212511ms
2025/11/25 13:25:19 INFO {"audit_event":"created_auth_code","details":{"clientId":4709,"codeId":909,"userId":1993}}
2025/11/25 13:25:19 [a357f2e3b56e/8P1BS7F7Qi-002063] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48556 - 302 215B in 875.364Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002064] "GET http://localhost:19090/auth/authorize/?client_id=test-client-jHLRnTAd&redirect_uri=https%3A%2F%2Fwww.directproductize.biz%2Fevolve&response_type=code&code_challenge_method=S256&code_challenge=DaMJjoHDrVUBzjFoDDRsWcOPVqYEmmpaxgwuZFfAgWB&scope=openid+profile+email&state=QvYRDlNX&nonce=eIqzDkPK&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:48572 - 302 66B in 981.966Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002065] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48586 - 302 60B in 424.913Âµs
2025/11/25 13:25:20 INFO {"audit_event":"bumped_user_session","details":{"clientId":4709,"userId":1993}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002066] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48596 - 302 56B in 3.798187ms
2025/11/25 13:25:20 INFO {"audit_event":"created_auth_code","details":{"clientId":4709,"codeId":910,"userId":1993}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002067] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48602 - 302 215B in 915.459Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpEnabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002068] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kGQFndMy&redirect_uri=https%3A%2F%2Fwww.dynamicmonetize.io%2Fenterprise&response_type=code&code_challenge_method=S256&code_challenge=pxUWLAuoLvhUlNtViQmzztFHucSkiJqhVferjHqgrzn&scope=openid+profile+email&state=YkHLcHnG&nonce=Ancwarut HTTP/1.1" from [::1]:48606 - 302 57B in 446.895Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002069] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48612 - 302 54B in 170.792Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002070] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48624 - 200 2949B in 261.494Âµs
2025/11/25 13:25:20 INFO {"audit_event":"auth_success_pwd","details":{"userId":1994}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002071] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48624 - 302 0B in 35.549901ms
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002072] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48624 - 302 57B in 359.55Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002073] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48634 - 302 54B in 252.988Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002074] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48636 - 200 2471B in 294.286Âµs
2025/11/25 13:25:20 INFO {"audit_event":"auth_success_otp","details":{"userId":1994}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002075] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48636 - 302 0B in 201.17Âµs
2025/11/25 13:25:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":4710,"userId":1994}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002076] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48636 - 302 56B in 1.05828ms
2025/11/25 13:25:20 INFO {"audit_event":"created_auth_code","details":{"clientId":4710,"codeId":911,"userId":1994}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002077] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48652 - 302 217B in 746.16Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002078] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kGQFndMy&redirect_uri=https%3A%2F%2Fwww.dynamicmonetize.io%2Fenterprise&response_type=code&code_challenge_method=S256&code_challenge=GRtUOHVSCKMlavZNalqObdrUzWTiOMwVjeSUUsUxrGO&scope=openid+profile+email&state=zlMzmoWT&nonce=yEFXbaix&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:48654 - 302 66B in 1.385608ms
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002079] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48660 - 302 57B in 3.736069ms
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002080] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48672 - 302 54B in 410.255Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002081] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48684 - 200 6142B in 4.522455ms
2025/11/25 13:25:20 INFO {"audit_event":"enabled_otp","details":{"userId":1994}}
2025/11/25 13:25:20 INFO {"audit_event":"auth_success_otp","details":{"userId":1994}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002082] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48684 - 302 0B in 1.312801ms
2025/11/25 13:25:20 INFO {"audit_event":"bumped_user_session","details":{"clientId":4710,"userId":1994}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002083] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48684 - 302 56B in 1.188505ms
2025/11/25 13:25:20 INFO {"audit_event":"created_auth_code","details":{"clientId":4710,"codeId":912,"userId":1994}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002084] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48698 - 302 217B in 957.559Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpDisabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002085] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zcKjTFoH&redirect_uri=http%3A%2F%2Fwww.futurewhiteboard.com%2Fsupply-chains&response_type=code&code_challenge_method=S256&code_challenge=GLxCoTezXvALKTIBRrLwqSsjUxtqXAVGVUwgtRtjObv&scope=openid+profile+email&state=BMcbUxBP&nonce=FmKcYDId HTTP/1.1" from [::1]:48710 - 302 57B in 610.303Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002086] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48718 - 302 54B in 284.076Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002087] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48734 - 200 2949B in 300.488Âµs
2025/11/25 13:25:20 INFO {"audit_event":"auth_success_pwd","details":{"userId":1995}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002088] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48734 - 302 0B in 35.603642ms
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002089] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48734 - 302 57B in 457.164Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002090] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48750 - 302 54B in 419.182Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002091] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48764 - 200 2471B in 347.567Âµs
2025/11/25 13:25:20 INFO {"audit_event":"auth_success_otp","details":{"userId":1995}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002092] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:48764 - 302 0B in 262.536Âµs
2025/11/25 13:25:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":4711,"userId":1995}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002093] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48764 - 302 56B in 1.160583ms
2025/11/25 13:25:20 INFO {"audit_event":"created_auth_code","details":{"clientId":4711,"codeId":913,"userId":1995}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002094] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48770 - 302 221B in 915.419Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002095] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zcKjTFoH&redirect_uri=http%3A%2F%2Fwww.futurewhiteboard.com%2Fsupply-chains&response_type=code&code_challenge_method=S256&code_challenge=tBuCByHuTsScYSurQgTTUjHvEjwXWpDmgqPTqJFDfEF&scope=openid+profile+email&state=AZwYTPiR&nonce=xEPiKcnI&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:48786 - 302 66B in 1.04235ms
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002096] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48794 - 302 60B in 654.026Âµs
2025/11/25 13:25:20 INFO {"audit_event":"bumped_user_session","details":{"clientId":4711,"userId":1995}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002097] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48802 - 302 56B in 1.424331ms
2025/11/25 13:25:20 INFO {"audit_event":"created_auth_code","details":{"clientId":4711,"codeId":914,"userId":1995}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002098] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48808 - 302 221B in 1.006482ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpEnabled (0.29s)
=== RUN   TestDCR_Disabled_Returns403
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002099] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48812 - 403 91B in 98.266Âµs
--- PASS: TestDCR_Disabled_Returns403 (0.00s)
=== RUN   TestDCR_PublicClient_MCP_UseCase_Success
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4712,"clientIdentifier":"dcr_d3e4080b-b73c-4681-be8b-35704ec34172","grantTypes":["authorization_code","refresh_token"],"isPublic":true,"sourceIP":"[::1]:48822"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002100] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48822 - 201 293B in 1.541242ms
--- PASS: TestDCR_PublicClient_MCP_UseCase_Success (0.00s)
=== RUN   TestDCR_ConfidentialClient_Success
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4713,"clientIdentifier":"dcr_1149f07d-68a7-4c1e-bce5-0c81262d5751","grantTypes":["authorization_code","client_credentials","refresh_token"],"isPublic":false,"sourceIP":"[::1]:48826"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002101] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48826 - 201 408B in 1.37609ms
--- PASS: TestDCR_ConfidentialClient_Success (0.00s)
=== RUN   TestDCR_DefaultValues_Applied
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4714,"clientIdentifier":"dcr_96e3bdf2-3c1b-4153-9b44-983fcff511d2","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:48832"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002102] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48832 - 201 370B in 1.538627ms
--- PASS: TestDCR_DefaultValues_Applied (0.00s)
=== RUN   TestDCR_RedirectURI_Validation
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_localhost_HTTP_allowed
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4715,"clientIdentifier":"dcr_165161e7-4575-48bc-9e9d-c8e9734de70b","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:48842"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002103] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48842 - 201 298B in 1.310276ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_127.0.0.1_HTTP_allowed
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4716,"clientIdentifier":"dcr_2c533631-3cdf-4437-b090-448b7ee45698","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:48850"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002104] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48850 - 201 298B in 1.236446ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_IPv6_localhost_allowed
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4717,"clientIdentifier":"dcr_bbd73bbf-af95-4903-86c9-c8345d30d731","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:48862"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002105] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48862 - 201 294B in 1.319984ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_custom_scheme_allowed
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4718,"clientIdentifier":"dcr_1c0d6531-7b9c-4fdf-978f-e3dad0f5cc2c","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:48878"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002106] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48878 - 201 283B in 1.186892ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_HTTPS_rejected_(security)
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002107] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48894 - 400 143B in 98.747Âµs
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_non-localhost_HTTP_rejected
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002108] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48900 - 400 116B in 110.168Âµs
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_HTTPS_allowed
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4719,"clientIdentifier":"dcr_51963b1e-16db-4259-bee7-82044959add9","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:48906"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002109] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48906 - 201 390B in 1.129164ms
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_localhost_HTTP_allowed
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4720,"clientIdentifier":"dcr_834aa4a8-2090-4bf0-8596-6ff67c19572f","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:48910"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002110] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48910 - 201 397B in 1.125056ms
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_non-localhost_HTTP_rejected
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002111] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48912 - 400 93B in 95.841Âµs
=== RUN   TestDCR_RedirectURI_Validation/Missing_redirect_uris_for_authorization_code
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002112] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48926 - 400 112B in 103.365Âµs
=== RUN   TestDCR_RedirectURI_Validation/Client_credentials_-_no_redirect_uris_required
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4721,"clientIdentifier":"dcr_01c7ee19-0382-4482-bef7-5dec82d8e25a","grantTypes":["client_credentials"],"isPublic":false,"sourceIP":"[::1]:48942"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002113] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48942 - 201 348B in 666.46Âµs
=== RUN   TestDCR_RedirectURI_Validation/Invalid_URI_format
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002114] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48954 - 400 100B in 76.594Âµs
--- PASS: TestDCR_RedirectURI_Validation (0.01s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_localhost_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_127.0.0.1_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_IPv6_localhost_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_custom_scheme_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_HTTPS_rejected_(security) (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_non-localhost_HTTP_rejected (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_HTTPS_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_localhost_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_non-localhost_HTTP_rejected (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Missing_redirect_uris_for_authorization_code (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Client_credentials_-_no_redirect_uris_required (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Invalid_URI_format (0.00s)
=== RUN   TestDCR_GrantType_Validation
=== RUN   TestDCR_GrantType_Validation/Valid_grant_types
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4722,"clientIdentifier":"dcr_25ccc34e-74f1-4f98-9406-5596b0e62e3b","grantTypes":["authorization_code","client_credentials","refresh_token"],"isPublic":false,"sourceIP":"[::1]:48962"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002115] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48962 - 201 409B in 1.140134ms
=== RUN   TestDCR_GrantType_Validation/Unsupported_grant_type
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002116] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48974 - 400 91B in 75.142Âµs
=== RUN   TestDCR_GrantType_Validation/Unsupported_implicit_grant
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002117] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48984 - 400 91B in 62.258Âµs
=== RUN   TestDCR_GrantType_Validation/Mixed_valid_and_invalid
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002118] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48994 - 400 91B in 60.714Âµs
--- PASS: TestDCR_GrantType_Validation (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Valid_grant_types (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Unsupported_grant_type (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Unsupported_implicit_grant (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Mixed_valid_and_invalid (0.00s)
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/none_-_public_client
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4723,"clientIdentifier":"dcr_306784ef-fbd7-4253-b491-9ca7280350b8","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:48998"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002119] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:48998 - 201 280B in 1.24355ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/client_secret_basic
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4724,"clientIdentifier":"dcr_9795fa0d-fc24-4f1c-9ec5-4730b0617cd0","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:49004"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002120] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49004 - 201 373B in 1.163919ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/client_secret_post
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4725,"clientIdentifier":"dcr_b6d481c7-58d8-4e8e-a872-6f18d4b10559","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:49008"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002121] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49008 - 201 371B in 1.245844ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_method
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002122] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49024 - 400 116B in 119.005Âµs
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_private_key_jwt
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002123] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49036 - 400 114B in 110.649Âµs
--- PASS: TestDCR_TokenEndpointAuthMethod_Validation (0.01s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/none_-_public_client (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/client_secret_basic (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/client_secret_post (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_method (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_private_key_jwt (0.00s)
=== RUN   TestDCR_ClientName_Validation
=== RUN   TestDCR_ClientName_Validation/Normal_name
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4726,"clientIdentifier":"dcr_159455ba-a3f9-49cb-8ed0-90968dccaaa3","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:49046"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002124] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49046 - 201 274B in 1.242378ms
=== RUN   TestDCR_ClientName_Validation/Empty_name_allowed
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4727,"clientIdentifier":"dcr_c0851db0-a064-4109-95c5-fee22c663667","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:49050"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002125] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49050 - 201 243B in 1.662722ms
=== RUN   TestDCR_ClientName_Validation/Max_length_(128_chars)
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4728,"clientIdentifier":"dcr_d4f1f208-bbb8-4e00-8ace-3858d6d1ec95","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:49062"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002126] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49062 - 201 388B in 1.330444ms
=== RUN   TestDCR_ClientName_Validation/Too_long_(129_chars)
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002127] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49066 - 400 99B in 174.961Âµs
--- PASS: TestDCR_ClientName_Validation (0.01s)
    --- PASS: TestDCR_ClientName_Validation/Normal_name (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Empty_name_allowed (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Max_length_(128_chars) (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Too_long_(129_chars) (0.00s)
=== RUN   TestDCR_WellKnown_Metadata
=== RUN   TestDCR_WellKnown_Metadata/DCR_enabled_-_registration_endpoint_present
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002128] "GET http://localhost:19090/.well-known/openid-configuration HTTP/1.1" from [::1]:49080 - 200 1275B in 128.683Âµs
=== RUN   TestDCR_WellKnown_Metadata/DCR_disabled_-_registration_endpoint_absent
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002129] "GET http://localhost:19090/.well-known/openid-configuration HTTP/1.1" from [::1]:49086 - 200 1209B in 84.7Âµs
--- PASS: TestDCR_WellKnown_Metadata (0.00s)
    --- PASS: TestDCR_WellKnown_Metadata/DCR_enabled_-_registration_endpoint_present (0.00s)
    --- PASS: TestDCR_WellKnown_Metadata/DCR_disabled_-_registration_endpoint_absent (0.00s)
=== RUN   TestDCR_MultipleRedirectURIs
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4729,"clientIdentifier":"dcr_ea4d0de3-ded1-4f53-85ad-12f1f21654f4","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:49092"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002130] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49092 - 201 338B in 2.213973ms
--- PASS: TestDCR_MultipleRedirectURIs (0.00s)
=== RUN   TestDCR_ConfidentialClient_DefaultAcrLevel
2025/11/25 13:25:20 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":4730,"clientIdentifier":"dcr_6d64bee7-8d9d-435c-8d68-1f6c05e4fcde","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:49096"}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002131] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:49096 - 201 371B in 1.284587ms
--- PASS: TestDCR_ConfidentialClient_DefaultAcrLevel (0.00s)
=== RUN   TestToken_ClientIdIsMissing
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002132] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49112 - 400 88B in 163.058Âµs
--- PASS: TestToken_ClientIdIsMissing (0.00s)
=== RUN   TestToken_ClientDoesNotExist
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002133] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49124 - 400 73B in 261.965Âµs
--- PASS: TestToken_ClientDoesNotExist (0.00s)
=== RUN   TestToken_InvalidGrantType
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002134] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49130 - 400 81B in 130.867Âµs
--- PASS: TestToken_InvalidGrantType (0.00s)
=== RUN   TestToken_AuthCode_MissingCode
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002135] "GET http://localhost:19090/auth/authorize/?client_id=test-client-vCrZcltr&redirect_uri=https%3A%2F%2Fwww.nationaldeliverables.org%2Fdeliverables&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=SVzuCnqu&nonce=ECQkrstG HTTP/1.1" from [::1]:49136 - 302 57B in 614.581Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002136] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49148 - 302 54B in 374.127Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002137] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49150 - 200 2949B in 314.665Âµs
2025/11/25 13:25:20 INFO {"audit_event":"auth_success_pwd","details":{"userId":1996}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002138] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49150 - 302 0B in 37.039024ms
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002139] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49150 - 302 57B in 416.206Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002140] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49152 - 302 60B in 550.099Âµs
2025/11/25 13:25:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":4732,"userId":1996}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002141] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49154 - 302 56B in 1.541572ms
2025/11/25 13:25:20 INFO {"audit_event":"created_auth_code","details":{"clientId":4732,"codeId":915,"userId":1996}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002142] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49162 - 302 225B in 911.612Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002143] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49176 - 400 83B in 255.262Âµs
--- PASS: TestToken_AuthCode_MissingCode (0.08s)
=== RUN   TestToken_AuthCode_MissingRedirectURI
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002144] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ereYQGLN&redirect_uri=http%3A%2F%2Fwww.nationalcompelling.org%2Fsticky%2Fexpedite%2Fproductize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=ijynxgdC&nonce=RgxlpNhS HTTP/1.1" from [::1]:49190 - 302 57B in 728.888Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002145] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49192 - 302 54B in 252.136Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002146] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49194 - 200 2949B in 609.462Âµs
2025/11/25 13:25:20 INFO {"audit_event":"auth_success_pwd","details":{"userId":1997}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002147] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49194 - 302 0B in 37.429342ms
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002148] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49194 - 302 57B in 482.181Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002149] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49198 - 302 60B in 542.325Âµs
2025/11/25 13:25:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":4733,"userId":1997}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002150] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49208 - 302 56B in 1.363576ms
2025/11/25 13:25:20 INFO {"audit_event":"created_auth_code","details":{"clientId":4733,"codeId":916,"userId":1997}}
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002151] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49214 - 302 236B in 789.982Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002152] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49228 - 400 91B in 208.785Âµs
--- PASS: TestToken_AuthCode_MissingRedirectURI (0.08s)
=== RUN   TestToken_AuthCode_MissingCodeVerifier
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002153] "GET http://localhost:19090/auth/authorize/?client_id=test-client-yUsMdKQT&redirect_uri=https%3A%2F%2Fwww.districtreinvent.net%2Fbest-of-breed%2Ftechnologies%2Fapplications%2Fmesh&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=iJJDVBhf&nonce=CBWjHLfs HTTP/1.1" from [::1]:49240 - 302 57B in 510.996Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002154] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49256 - 302 54B in 340.834Âµs
2025/11/25 13:25:20 [a357f2e3b56e/8P1BS7F7Qi-002155] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49260 - 200 2949B in 307.571Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":1998}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002156] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49260 - 302 0B in 35.502641ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002157] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49260 - 302 57B in 457.484Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002158] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49264 - 302 60B in 360.551Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4734,"userId":1998}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002159] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49270 - 302 56B in 1.093587ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4734,"codeId":917,"userId":1998}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002160] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49278 - 302 253B in 885.213Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002161] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49290 - 400 92B in 527.296Âµs
--- PASS: TestToken_AuthCode_MissingCodeVerifier (0.08s)
=== RUN   TestToken_AuthCode_ClientDoesNotExist
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002162] "GET http://localhost:19090/auth/authorize/?client_id=test-client-tElYqvNz&redirect_uri=http%3A%2F%2Fwww.regionalinterfaces.io%2Fiterate%2Fbricks-and-clicks%2Fniches%2Finterfaces&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=NKkNXreE&nonce=LovKrLJN HTTP/1.1" from [::1]:49294 - 302 57B in 370.22Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002163] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49304 - 302 54B in 142.018Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002164] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49314 - 200 2949B in 272.846Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":1999}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002165] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49314 - 302 0B in 35.334864ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002166] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49314 - 302 57B in 361.333Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002167] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49328 - 302 60B in 450.992Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4735,"userId":1999}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002168] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49336 - 302 56B in 1.143711ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4735,"codeId":918,"userId":1999}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002169] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49352 - 302 252B in 910.159Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002170] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49360 - 400 73B in 228.011Âµs
--- PASS: TestToken_AuthCode_ClientDoesNotExist (0.08s)
=== RUN   TestToken_AuthCode_CodeIsInvalid
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002171] "GET http://localhost:19090/auth/authorize/?client_id=test-client-mzMAFKFS&redirect_uri=http%3A%2F%2Fwww.chiefturn-key.info%2Fsticky&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=kNpknCmP&nonce=UyHGYZUa HTTP/1.1" from [::1]:49374 - 302 57B in 555.791Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002172] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49390 - 302 54B in 203.184Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002173] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49406 - 200 2949B in 281.722Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2000}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002174] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49406 - 302 0B in 35.68718ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002175] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49406 - 302 57B in 500.636Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002176] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49422 - 302 60B in 491.729Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4736,"userId":2000}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002177] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49438 - 302 56B in 1.590856ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4736,"codeId":919,"userId":2000}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002178] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49440 - 302 212B in 1.097975ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002179] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49442 - 400 65B in 433.419Âµs
--- PASS: TestToken_AuthCode_CodeIsInvalid (0.08s)
=== RUN   TestToken_AuthCode_RedirectURIIsInvalid
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002180] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iTsyPvNT&redirect_uri=https%3A%2F%2Fwww.regionalfunctionalities.org%2Fe-business%2Fcustomized%2Fmesh%2Fgrow&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=zswxufIN&nonce=OQSLeLeQ HTTP/1.1" from [::1]:49456 - 302 57B in 722.666Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002181] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49468 - 302 54B in 212.411Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002182] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49474 - 200 2949B in 329.242Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2001}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002183] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49474 - 302 0B in 35.494826ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002184] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49474 - 302 57B in 348.289Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002185] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49480 - 302 60B in 293.365Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4737,"userId":2001}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002186] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49496 - 302 56B in 1.365831ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4737,"codeId":920,"userId":2001}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002187] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49506 - 302 247B in 1.906432ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002188] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49518 - 400 70B in 411.377Âµs
--- PASS: TestToken_AuthCode_RedirectURIIsInvalid (0.08s)
=== RUN   TestToken_AuthCode_WrongClient
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002189] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SqnPmuaO&redirect_uri=https%3A%2F%2Fwww.futuremindshare.info%2Fpartnerships%2Fsynthesize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=LzEpuLOV&nonce=LzSECGNG HTTP/1.1" from [::1]:49522 - 302 57B in 509.363Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002190] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49534 - 302 54B in 167.657Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002191] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49548 - 200 2949B in 286.01Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2002}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002192] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49548 - 302 0B in 36.013697ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002193] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49548 - 302 57B in 458.095Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002194] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49558 - 302 60B in 390.898Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4738,"userId":2002}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002195] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49570 - 302 56B in 1.298825ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4738,"codeId":921,"userId":2002}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002196] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49586 - 302 232B in 875.344Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002197] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49594 - 400 111B in 445.942Âµs
--- PASS: TestToken_AuthCode_WrongClient (0.08s)
=== RUN   TestToken_AuthCode_ConfidentialClient_NoClientSecret
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002198] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xhdzHuyF&redirect_uri=https%3A%2F%2Fwww.globalweb-enabled.org%2Fb2c%2Fcutting-edge%2F24-7&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=VtAcoLYU&nonce=lYaTRVIc HTTP/1.1" from [::1]:49598 - 302 57B in 795.533Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002199] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49608 - 302 54B in 178.227Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002200] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49610 - 200 2949B in 629.128Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2003}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002201] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49610 - 302 0B in 35.679285ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002202] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49610 - 302 57B in 380.429Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002203] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49618 - 302 60B in 336.436Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4740,"userId":2003}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002204] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49622 - 302 56B in 1.186392ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4740,"codeId":922,"userId":2003}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002205] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49630 - 302 231B in 1.249801ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002206] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49644 - 400 215B in 399.395Âµs
--- PASS: TestToken_AuthCode_ConfidentialClient_NoClientSecret (0.08s)
=== RUN   TestToken_AuthCode_ConfidentialClient_ClientAuthFailed
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002207] "GET http://localhost:19090/auth/authorize/?client_id=test-client-rYmyhoXM&redirect_uri=https%3A%2F%2Fwww.humanoptimize.name%2Fviral&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=uZoOzrTN&nonce=iWQLsJAX HTTP/1.1" from [::1]:49660 - 302 57B in 520.263Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002208] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49666 - 302 54B in 329.874Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002209] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49674 - 200 2949B in 305.196Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2004}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002210] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49674 - 302 0B in 35.573495ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002211] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49674 - 302 57B in 525.112Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002212] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49682 - 302 60B in 321.157Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4741,"userId":2004}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002213] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49684 - 302 56B in 1.274989ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4741,"codeId":923,"userId":2004}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002214] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49690 - 302 212B in 903.698Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002215] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49702 - 400 112B in 485.127Âµs
--- PASS: TestToken_AuthCode_ConfidentialClient_ClientAuthFailed (0.08s)
=== RUN   TestToken_AuthCode_InvalidCodeVerifier
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002216] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JglmZDnV&redirect_uri=https%3A%2F%2Fwww.districtextend.name%2Fnetworks&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=ofCmQDyt&nonce=OSZDNKED HTTP/1.1" from [::1]:49706 - 302 57B in 500.645Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002217] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49720 - 302 54B in 179.81Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002218] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49734 - 200 2949B in 336.596Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2005}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002219] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49734 - 302 0B in 35.177567ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002220] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49734 - 302 57B in 385.668Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002221] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49742 - 302 60B in 304.305Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4742,"userId":2005}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002222] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49756 - 302 56B in 1.071294ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4742,"codeId":924,"userId":2005}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002223] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49760 - 302 216B in 830.389Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002224] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49766 - 400 78B in 303.945Âµs
--- PASS: TestToken_AuthCode_InvalidCodeVerifier (0.08s)
=== RUN   TestToken_AuthCode_SuccessPath
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002225] "GET http://localhost:19090/auth/authorize/?client_id=test-client-AtPByxzp&redirect_uri=https%3A%2F%2Fwww.principalb2b.name%2Fholistic%2Fcontent%2Ffunctionalities&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=GFtEhxhY&nonce=MBIyqkQd HTTP/1.1" from [::1]:49772 - 302 57B in 472.723Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002226] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49788 - 302 54B in 333.269Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002227] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49792 - 200 2949B in 313.762Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2006}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002228] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49792 - 302 0B in 35.627457ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002229] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49792 - 302 57B in 386.701Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002230] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49808 - 302 60B in 286.512Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4743,"userId":2006}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002231] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49818 - 302 56B in 1.117451ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4743,"codeId":925,"userId":2006}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002232] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49824 - 302 238B in 1.248609ms
2025/11/25 13:25:21 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":925}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002233] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49832 - 200 4234B in 13.097427ms
--- PASS: TestToken_AuthCode_SuccessPath (0.09s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_Success
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002234] "GET http://localhost:19090/auth/authorize/?client_id=test-client-OCFwyiNQ&redirect_uri=http%3A%2F%2Fwww.nationalrevolutionize.biz%2Fdistributed%2Fworld-class%2Ftransparent&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=OSrkMrgY&nonce=HzpLMENw HTTP/1.1" from [::1]:49848 - 302 57B in 590.435Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002235] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49862 - 302 54B in 211.239Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002236] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49870 - 200 2949B in 266.994Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2007}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002237] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49870 - 302 0B in 36.313043ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002238] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49870 - 302 57B in 546.653Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002239] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49876 - 302 60B in 600.625Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4744,"userId":2007}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002240] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49884 - 302 56B in 1.60345ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4744,"codeId":926,"userId":2007}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002241] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49888 - 302 248B in 1.087335ms
2025/11/25 13:25:21 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":926}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49904 - 200 4226B in 12.859448ms
--- PASS: TestToken_AuthCode_ClientSecretBasic_Success (0.09s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_WrongSecret
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002243] "GET http://localhost:19090/auth/authorize/?client_id=test-client-NbxyuYGF&redirect_uri=https%3A%2F%2Fwww.forwardexperiences.net%2Fe-markets%2Ffunctionalities%2Fredefine&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=OcBgifEz&nonce=KkEmaXjR HTTP/1.1" from [::1]:49910 - 302 57B in 462.033Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002244] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49918 - 302 54B in 155.464Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002245] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49934 - 200 2949B in 294.827Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2008}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002246] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49934 - 302 0B in 35.587942ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002247] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49934 - 302 57B in 400.597Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002248] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49944 - 302 60B in 293.965Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4745,"userId":2008}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002249] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49958 - 302 56B in 1.15923ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4745,"codeId":927,"userId":2008}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002250] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49968 - 302 245B in 818.106Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002251] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49970 - 400 112B in 319.935Âµs
--- PASS: TestToken_AuthCode_ClientSecretBasic_WrongSecret (0.08s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_BothMethodsProvided
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002252] "GET http://localhost:19090/auth/authorize/?client_id=test-client-OYENCWxh&redirect_uri=http%3A%2F%2Fwww.customermorph.name%2Fsyndicate%2Fincentivize%2Fe-services%2Ftransition&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=XydbgSjv&nonce=cHPRATTN HTTP/1.1" from [::1]:49974 - 302 57B in 400.046Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002253] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49990 - 302 54B in 234.994Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002254] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49996 - 200 2949B in 283.405Âµs
2025/11/25 13:25:21 INFO {"audit_event":"auth_success_pwd","details":{"userId":2009}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002255] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49996 - 302 0B in 35.414054ms
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002256] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49996 - 302 57B in 316.157Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002257] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50004 - 302 60B in 275.981Âµs
2025/11/25 13:25:21 INFO {"audit_event":"started_new_user_session","details":{"clientId":4746,"userId":2009}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002258] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50020 - 302 56B in 1.186272ms
2025/11/25 13:25:21 INFO {"audit_event":"created_auth_code","details":{"clientId":4746,"codeId":928,"userId":2009}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002259] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50030 - 302 249B in 974.602Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002260] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50046 - 400 211B in 146.507Âµs
--- PASS: TestToken_AuthCode_ClientSecretBasic_BothMethodsProvided (0.08s)
=== RUN   TestToken_ClientCred_ClientSecretBasic_Success
2025/11/25 13:25:21 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4747}}
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002261] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50060 - 200 1213B in 4.11753ms
--- PASS: TestToken_ClientCred_ClientSecretBasic_Success (0.01s)
=== RUN   TestToken_ClientCred_ClientSecretBasic_WrongSecret
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002262] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50072 - 401 79B in 124.435Âµs
--- PASS: TestToken_ClientCred_ClientSecretBasic_WrongSecret (0.00s)
=== RUN   TestToken_Refresh_ClientSecretBasic_Success
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002263] "GET http://localhost:19090/auth/authorize/?client_id=test-client-hMtQkSBe&redirect_uri=http%3A%2F%2Fwww.customerextend.name%2Finnovative%2Fvortals&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=xRsxkZDa&nonce=NqPohPHv HTTP/1.1" from [::1]:50076 - 302 57B in 608.059Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002264] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50080 - 302 54B in 183.697Âµs
2025/11/25 13:25:21 [a357f2e3b56e/8P1BS7F7Qi-002265] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50088 - 200 2949B in 278.837Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2010}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002266] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50088 - 302 0B in 35.606156ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002267] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50088 - 302 57B in 384.777Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002268] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50094 - 302 60B in 431.856Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4749,"userId":2010}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002269] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50110 - 302 56B in 2.457213ms
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4749,"codeId":929,"userId":2010}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002270] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50116 - 302 225B in 853.563Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":929}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002271] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50128 - 200 4218B in 13.068122ms
2025/11/25 13:25:22 INFO {"audit_event":"bumped_user_session","details":{"clientId":4749,"userId":2010}}
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":929,"refreshTokenJti":"4d078526-aef6-401e-b7ae-ead9748ead9b"}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002272] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50128 - 200 4218B in 14.136771ms
--- PASS: TestToken_Refresh_ClientSecretBasic_Success (0.11s)
=== RUN   TestToken_Refresh_ClientSecretBasic_WrongSecret
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002273] "GET http://localhost:19090/auth/authorize/?client_id=test-client-StmzcLTO&redirect_uri=https%3A%2F%2Fwww.legacystrategize.net%2Fturn-key%2Fincentivize%2Frelationships%2Finitiatives&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=fUShQCuF&nonce=EBEjwhqL HTTP/1.1" from [::1]:50144 - 302 57B in 748.274Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002274] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50154 - 302 54B in 176.845Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002275] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50156 - 200 2949B in 259.19Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2011}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002276] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50156 - 302 0B in 35.893629ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002277] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50156 - 302 57B in 443.387Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002278] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50166 - 302 60B in 416.677Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4750,"userId":2011}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002279] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50174 - 302 56B in 1.385547ms
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4750,"codeId":930,"userId":2011}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002280] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50190 - 302 255B in 851.439Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":930}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002281] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50198 - 200 4230B in 12.693213ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002282] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50198 - 400 112B in 253.859Âµs
--- PASS: TestToken_Refresh_ClientSecretBasic_WrongSecret (0.09s)
=== RUN   TestToken_ClientCred_FlowIsNotEnabled
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002283] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50204 - 400 146B in 158.359Âµs
--- PASS: TestToken_ClientCred_FlowIsNotEnabled (0.00s)
=== RUN   TestToken_ClientCred_ClientSecretIsMissing
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002284] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50210 - 400 215B in 114.347Âµs
--- PASS: TestToken_ClientCred_ClientSecretIsMissing (0.00s)
=== RUN   TestToken_ClientCred_ClientAuthFailed
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002285] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50216 - 401 79B in 125.187Âµs
--- PASS: TestToken_ClientCred_ClientAuthFailed (0.00s)
=== RUN   TestToken_ClientCred_InvalidScope
=== RUN   TestToken_ClientCred_InvalidScope/openid
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002286] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50228 - 400 269B in 250.594Âµs
=== RUN   TestToken_ClientCred_InvalidScope/groups
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002287] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50234 - 400 269B in 184.068Âµs
=== RUN   TestToken_ClientCred_InvalidScope/aaa
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002288] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50240 - 400 199B in 186.012Âµs
=== RUN   TestToken_ClientCred_InvalidScope/invalid:perm
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002289] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50248 - 400 132B in 190.911Âµs
=== RUN   TestToken_ClientCred_InvalidScope/backend-svcA-LhfpPdvg:perm
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002290] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50256 - 400 190B in 228.232Âµs
=== RUN   TestToken_ClientCred_InvalidScope/backend-svcA-LhfpPdvg:read-product-EBPQrgcc
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002291] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50268 - 400 151B in 207.452Âµs
--- PASS: TestToken_ClientCred_InvalidScope (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/openid (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/groups (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/aaa (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/invalid:perm (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/backend-svcA-LhfpPdvg:perm (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/backend-svcA-LhfpPdvg:read-product-EBPQrgcc (0.00s)
=== RUN   TestToken_ClientCred_NoScopesGiven
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4755}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002292] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50276 - 200 1359B in 4.18619ms
--- PASS: TestToken_ClientCred_NoScopesGiven (0.01s)
=== RUN   TestToken_ClientCred_SpecificScope
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":4756}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002293] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50286 - 200 1228B in 4.224812ms
--- PASS: TestToken_ClientCred_SpecificScope (0.01s)
=== RUN   TestToken_Refresh_ClientSecretIsMissing
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002294] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50292 - 400 215B in 192.073Âµs
--- PASS: TestToken_Refresh_ClientSecretIsMissing (0.00s)
=== RUN   TestToken_Refresh_ClientAuthFailed
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002295] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JtpTuxKV&redirect_uri=https%3A%2F%2Fwww.chiefcontent.org%2Fleading-edge%2Fplatforms&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=nhPpOBCy&nonce=gIYnMqqh HTTP/1.1" from [::1]:50306 - 302 57B in 713.618Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002296] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50322 - 302 54B in 195.119Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002297] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50324 - 200 2949B in 421.236Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2012}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002298] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50324 - 302 0B in 36.720763ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002299] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50324 - 302 57B in 484.947Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002300] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50326 - 302 60B in 312.29Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4758,"userId":2012}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002301] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50328 - 302 56B in 1.233611ms
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4758,"codeId":931,"userId":2012}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002302] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50340 - 302 227B in 944.916Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":931}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002303] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50350 - 200 4226B in 12.660672ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002304] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50350 - 400 112B in 223.773Âµs
--- PASS: TestToken_Refresh_ClientAuthFailed (0.09s)
=== RUN   TestToken_Refresh_MissingRefreshToken
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002305] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SGlPGPmj&redirect_uri=https%3A%2F%2Fwww.futureredefine.com%2Fbrand%2Fvertical%2Fexperiences&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=riREnUHh&nonce=xCOonwBH HTTP/1.1" from [::1]:50358 - 302 57B in 537.416Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002306] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50362 - 302 54B in 168.809Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002307] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50376 - 200 2949B in 305.047Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2013}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002308] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50376 - 302 0B in 35.201272ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002309] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50376 - 302 57B in 259.881Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002310] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50382 - 302 60B in 259.25Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4759,"userId":2013}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002311] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50396 - 302 56B in 1.105338ms
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4759,"codeId":932,"userId":2013}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002312] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50402 - 302 233B in 775.274Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":932}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002313] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50412 - 200 4250B in 12.383478ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002314] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50412 - 400 92B in 178.357Âµs
--- PASS: TestToken_Refresh_MissingRefreshToken (0.09s)
=== RUN   TestToken_Refresh_TokenWithBadSignature
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002315] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ZxvYlRya&redirect_uri=https%3A%2F%2Fwww.customerparadigms.name%2Fparadigms%2Fbrand%2Funleash%2Fexpedite&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=stVlzTsc&nonce=EFyXuRTb HTTP/1.1" from [::1]:50420 - 302 57B in 635.09Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002316] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50422 - 302 54B in 159.321Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002317] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50428 - 200 2949B in 280.67Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2014}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002318] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50428 - 302 0B in 35.396651ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002319] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50428 - 302 57B in 299.676Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002320] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50440 - 302 60B in 265.542Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4760,"userId":2014}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002321] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50454 - 302 56B in 1.168007ms
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4760,"codeId":933,"userId":2014}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002322] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50464 - 302 243B in 843.614Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":933}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002323] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50468 - 200 4232B in 12.318445ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002324] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50468 - 400 139B in 760.648Âµs
--- PASS: TestToken_Refresh_TokenWithBadSignature (0.12s)
=== RUN   TestToken_Refresh_TokenExpired
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002325] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:50474 - 400 123B in 394.646Âµs
--- PASS: TestToken_Refresh_TokenExpired (0.01s)
=== RUN   TestToken_Refresh_WrongClient
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002326] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oIMVFFig&redirect_uri=https%3A%2F%2Fwww.dynamiccommunities.net%2Fuser-centric%2Fdeliverables%2Fscalable&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=mhumePfA&nonce=QcGRRPht HTTP/1.1" from [::1]:50484 - 302 57B in 582.321Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002327] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50500 - 302 54B in 266.724Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002328] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50508 - 200 2949B in 536.454Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2015}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002329] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50508 - 302 0B in 36.439702ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002330] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50508 - 302 57B in 412.629Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002331] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50512 - 302 60B in 331.647Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4762,"userId":2015}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002332] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50518 - 302 56B in 1.176594ms
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4762,"codeId":934,"userId":2015}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002333] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50532 - 302 245B in 883.409Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":934}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002334] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50540 - 200 4238B in 12.472176ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002335] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50540 - 400 121B in 696.075Âµs
--- PASS: TestToken_Refresh_WrongClient (0.10s)
=== RUN   TestToken_Refresh_WithAdditionalScope
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002336] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FzPpqlSU&redirect_uri=http%3A%2F%2Fwww.seniorfrictionless.com%2Fmarkets%2Fgranular%2Fcustomized&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=sgAWKEjq&nonce=zGDWertL HTTP/1.1" from [::1]:50554 - 302 57B in 480.848Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002337] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50570 - 302 54B in 161.876Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002338] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50576 - 200 2949B in 270.22Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2016}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002339] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50576 - 302 0B in 35.530584ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002340] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50576 - 302 57B in 335.804Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002341] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50582 - 302 60B in 326.377Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4764,"userId":2016}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002342] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50586 - 302 56B in 2.068809ms
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4764,"codeId":935,"userId":2016}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002343] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50588 - 302 237B in 972.688Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":935}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002344] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50596 - 200 4214B in 12.310891ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002345] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50596 - 400 220B in 691.908Âµs
2025/11/25 13:25:22 INFO {"audit_event":"bumped_user_session","details":{"clientId":4764,"userId":2016}}
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":935,"refreshTokenJti":"0e8dac3e-3892-430e-987e-2e781f18f112"}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002346] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50596 - 200 4214B in 13.44782ms
--- PASS: TestToken_Refresh_WithAdditionalScope (0.11s)
=== RUN   TestToken_Refresh_ConsentRemoved
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002347] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oWYmDBcy&redirect_uri=https%3A%2F%2Fwww.futureplatforms.org%2Fmesh%2Fengineer%2Fexpedite&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+res-JKsBSsyf%3Aperm-iqqIbgLj&state=JLeTavsW&nonce=uGjjzyQu HTTP/1.1" from [::1]:50600 - 302 57B in 610.113Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002348] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50602 - 302 54B in 186.673Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002349] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50614 - 200 2949B in 289.336Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2017}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002350] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50614 - 302 0B in 36.213784ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002351] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50614 - 302 60B in 605.765Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4765,"userId":2017}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002352] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50618 - 302 58B in 1.502509ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002353] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:50620 - 200 4267B in 500.947Âµs
2025/11/25 13:25:22 INFO {"audit_event":"saved_consent","details":{"clientId":4765,"consentId":167,"userId":2017}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002354] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:50620 - 302 0B in 857.31Âµs
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4765,"codeId":936,"userId":2017}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002355] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50620 - 302 230B in 760.537Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":936}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002356] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:50634 - 200 4327B in 12.519475ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002357] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:50634 - 400 153B in 719.169Âµs
--- PASS: TestToken_Refresh_ConsentRemoved (0.10s)
=== RUN   TestToken_Refresh_ConsentDoesNotIncludeScope
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002358] "GET http://localhost:19090/auth/authorize/?client_id=test-client-AdfgMZyJ&redirect_uri=http%3A%2F%2Fwww.regionalplatforms.info%2Fschemas&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=HUvPchLl&nonce=fQoUkaxk HTTP/1.1" from [::1]:50642 - 302 57B in 676.649Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002359] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50648 - 302 54B in 177.265Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002360] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50650 - 200 2949B in 271.202Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2018}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002361] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50650 - 302 0B in 35.888901ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002362] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50650 - 302 60B in 376.792Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4766,"userId":2018}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002363] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50656 - 302 58B in 1.289887ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002364] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:50668 - 200 3835B in 465.189Âµs
2025/11/25 13:25:22 INFO {"audit_event":"saved_consent","details":{"clientId":4766,"consentId":168,"userId":2018}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002365] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:50668 - 302 0B in 823.697Âµs
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4766,"codeId":937,"userId":2018}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002366] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50668 - 302 217B in 761.078Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":937}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002367] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:50680 - 200 4190B in 12.679798ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002368] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:50680 - 400 188B in 639.088Âµs
--- PASS: TestToken_Refresh_ConsentDoesNotIncludeScope (0.09s)
=== RUN   TestToken_Refresh_TokenMarkedAsUsed
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002369] "GET http://localhost:19090/auth/authorize/?client_id=test-client-vHHEYPMK&redirect_uri=https%3A%2F%2Fwww.seniorscale.com%2Fefficient%2Fleverage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=ocmyvNvz&nonce=ciBvFBEg HTTP/1.1" from [::1]:50684 - 302 57B in 436.555Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002370] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50698 - 302 54B in 152.228Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002371] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50710 - 200 2949B in 228.231Âµs
2025/11/25 13:25:22 INFO {"audit_event":"auth_success_pwd","details":{"userId":2019}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002372] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50710 - 302 0B in 36.011813ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002373] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50710 - 302 57B in 364.118Âµs
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002374] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50712 - 302 60B in 352.466Âµs
2025/11/25 13:25:22 INFO {"audit_event":"started_new_user_session","details":{"clientId":4767,"userId":2019}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002375] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50720 - 302 56B in 1.272935ms
2025/11/25 13:25:22 INFO {"audit_event":"created_auth_code","details":{"clientId":4767,"codeId":938,"userId":2019}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002376] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50730 - 302 222B in 870.595Âµs
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":938}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002377] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50734 - 200 4230B in 13.330698ms
2025/11/25 13:25:22 INFO {"audit_event":"bumped_user_session","details":{"clientId":4767,"userId":2019}}
2025/11/25 13:25:22 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":938,"refreshTokenJti":"b42dccb9-da53-4d5d-957b-f3b3483be06a"}}
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002378] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50734 - 200 4230B in 13.332181ms
2025/11/25 13:25:22 [a357f2e3b56e/8P1BS7F7Qi-002379] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50734 - 400 85B in 594.223Âµs
--- PASS: TestToken_Refresh_TokenMarkedAsUsed (0.11s)
PASS
ok  	github.com/leodip/goiabada/authserver/tests/integration	24.203s
Tests finished. Killing the server...
Checking for processes on port 19090...
Found processes listening on port 19090: 132787
Killing process 132787 on port 19090
Checking for processes on port 19091...
No processes found on port 19091
./run-tests.sh: line 78: 132787 Killed                  ./tmp/goiabada-authserver
Port 19090 is now free
Port 19091 is now free
=== Completed integration tests with postgres ===

=== Running integration tests with mssql ===
Configuring for database: mssql
Started server with PID: 133081
Waiting for the server to start...
BROWSER=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/bin/helpers/browser.sh
COLORTERM=truecolor
DEBIAN_FRONTEND=noninteractive
DISPLAY=:0
DOCKER_BUILDKIT=1
GIT_ASKPASS=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/extensions/git/dist/askpass.sh
GOIABADA_ADMINCONSOLE_BASEURL=http://localhost:19091
GOIABADA_ADMINCONSOLE_CERTFILE=
GOIABADA_ADMINCONSOLE_KEYFILE=
GOIABADA_ADMINCONSOLE_LISTEN_HOST_HTTP=0.0.0.0
GOIABADA_ADMINCONSOLE_LISTEN_HOST_HTTPS=0.0.0.0
GOIABADA_ADMINCONSOLE_LISTEN_PORT_HTTP=19091
GOIABADA_ADMINCONSOLE_LISTEN_PORT_HTTPS=19444
GOIABADA_ADMINCONSOLE_LOG_HTTP_REQUESTS=true
GOIABADA_ADMINCONSOLE_OAUTH_CLIENT_ID=admin-console-client
GOIABADA_ADMINCONSOLE_OAUTH_CLIENT_SECRET=devcontainer-admin-console-secret-0123456789abcdef
GOIABADA_ADMINCONSOLE_SESSION_AUTHENTICATION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210
GOIABADA_ADMINCONSOLE_SESSION_ENCRYPTION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210
GOIABADA_ADMINCONSOLE_STATICDIR=
GOIABADA_ADMINCONSOLE_TEMPLATEDIR=
GOIABADA_ADMINCONSOLE_TRUST_PROXY_HEADERS=false
GOIABADA_ADMIN_EMAIL=admin@example.com
GOIABADA_ADMIN_PASSWORD=changeme
GOIABADA_APPNAME=Goiabada
GOIABADA_AUTHSERVER_AUDIT_LOGS_IN_CONSOLE=true
GOIABADA_AUTHSERVER_BASEURL=http://localhost:19090
GOIABADA_AUTHSERVER_CERTFILE=
GOIABADA_AUTHSERVER_DEBUG_API_REQUESTS=false
GOIABADA_AUTHSERVER_INTERNALBASEURL=
GOIABADA_AUTHSERVER_KEYFILE=
GOIABADA_AUTHSERVER_LISTEN_HOST_HTTP=0.0.0.0
GOIABADA_AUTHSERVER_LISTEN_HOST_HTTPS=0.0.0.0
GOIABADA_AUTHSERVER_LISTEN_PORT_HTTP=19090
GOIABADA_AUTHSERVER_LISTEN_PORT_HTTPS=19443
GOIABADA_AUTHSERVER_LOG_HTTP_REQUESTS=true
GOIABADA_AUTHSERVER_LOG_SQL=false
GOIABADA_AUTHSERVER_RATELIMITER_ENABLED=false
GOIABADA_AUTHSERVER_SESSION_AUTHENTICATION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
GOIABADA_AUTHSERVER_SESSION_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
GOIABADA_AUTHSERVER_STATICDIR=
GOIABADA_AUTHSERVER_TEMPLATEDIR=
GOIABADA_AUTHSERVER_TRUST_PROXY_HEADERS=false
GOIABADA_DB_DSN=
GOIABADA_DB_HOST=mssql-server
GOIABADA_DB_NAME=goiabada_integration
GOIABADA_DB_PASSWORD=YourStr0ngPassw0rd!
GOIABADA_DB_PORT=11433
GOIABADA_DB_TYPE=mssql
GOIABADA_DB_USERNAME=sa
HOME=/root
HOSTNAME=a357f2e3b56e
LANG=en_US.UTF-8
LESSCLOSE=/usr/bin/lesspipe %s %s
LESSOPEN=| /usr/bin/lesspipe %s
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=00:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.avif=01;35:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:*~=00;90:*#=00;90:*.bak=00;90:*.crdownload=00;90:*.dpkg-dist=00;90:*.dpkg-new=00;90:*.dpkg-old=00;90:*.dpkg-tmp=00;90:*.old=00;90:*.orig=00;90:*.part=00;90:*.rej=00;90:*.rpmnew=00;90:*.rpmorig=00;90:*.rpmsave=00;90:*.swp=00;90:*.tmp=00;90:*.ucf-dist=00;90:*.ucf-new=00;90:*.ucf-old=00;90:
OLDPWD=/workspaces/goiabada/src
PATH=/opt/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/go/bin:/root/go/bin
PWD=/workspaces/goiabada/src/authserver
REMOTE_CONTAINERS=true
REMOTE_CONTAINERS_DISPLAY_SOCK=/tmp/.X11-unix/X0
REMOTE_CONTAINERS_IPC=/tmp/vscode-remote-containers-ipc-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock
REMOTE_CONTAINERS_SOCKETS=["/tmp/vscode-ssh-auth-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock","/tmp/.X11-unix/X0","/root/.gnupg/S.gpg-agent"]
SHELL=/bin/bash
SHLVL=3
SSH_AUTH_SOCK=/tmp/vscode-ssh-auth-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock
TERM=xterm-256color
TERM_PROGRAM=vscode
TERM_PROGRAM_VERSION=1.106.2
TZ=Europe/Lisbon
VSCODE_GIT_ASKPASS_EXTRA_ARGS=
VSCODE_GIT_ASKPASS_MAIN=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/extensions/git/dist/askpass-main.js
VSCODE_GIT_ASKPASS_NODE=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/node
VSCODE_GIT_IPC_HANDLE=/tmp/user/0/vscode-git-27ddbaf538.sock
VSCODE_IPC_HOOK_CLI=/tmp/vscode-ipc-8cdca7a1-b8b6-4c1d-9f11-9fd95bbdc4c8.sock
VSCODE_PYTHON_AUTOACTIVATE_GUARD=1
WAYLAND_DISPLAY=vscode-wayland-7cc23a66-0244-472f-8cfe-838db66f3a44.sock
XDG_RUNTIME_DIR=/tmp/user/0
_=/usr/bin/env
2025/11/25 13:25:25 INFO auth server started
2025/11/25 13:25:25 INFO goiabada version: development
2025/11/25 13:25:25 INFO build date: development
2025/11/25 13:25:25 INFO git commit: development
2025/11/25 13:25:25 INFO config loaded
2025/11/25 13:25:25 INFO auth server base URL: http://localhost:19090
2025/11/25 13:25:25 INFO auth server internal base URL: 
2025/11/25 13:25:25 INFO admin console base URL: http://localhost:19091
2025/11/25 13:25:25 INFO debug API requests: false
2025/11/25 13:25:25 INFO current working directory: /workspaces/goiabada/src/authserver
Server is not ready yet. Retrying...
2025/11/25 13:25:25 INFO timezones loaded
2025/11/25 13:25:25 INFO current time zone is: Europe/Lisbon
2025/11/25 13:25:25 INFO current local time is: 2025-11-25 13:25:25.016120679 +0000 WET m=+0.002521165
2025/11/25 13:25:25 INFO current UTC time is: 2025-11-25 13:25:25.016125928 +0000 UTC
2025/11/25 13:25:25 INFO db type is mssql
2025/11/25 13:25:25 INFO creating mssql database
2025/11/25 13:25:25 INFO using database mssql
2025/11/25 13:25:25 INFO db username: sa
2025/11/25 13:25:25 INFO db host: mssql-server
2025/11/25 13:25:25 INFO db port: 11433
2025/11/25 13:25:25 INFO db name: goiabada_integration
2025/11/25 13:25:25 INFO created database connection
2025/11/25 13:25:25 INFO database already initialized, proceeding with normal startup
2025/11/25 13:25:25 INFO session keys validated
2025/11/25 13:25:25 INFO set cookie secure: false
2025/11/25 13:25:25 INFO initialized chunked cookie session store
2025/11/25 13:25:25 INFO using embedded static files directory
2025/11/25 13:25:25 INFO using embedded template files directory
2025/11/25 13:25:25 INFO background worker service started
2025/11/25 13:25:25 INFO initializing middleware
2025/11/25 13:25:25 INFO not adding real ip middleware
2025/11/25 13:25:25 INFO http request logging enabled
2025/11/25 13:25:25 INFO CSRF middleware configured trustedOrigins="[localhost:19090 localhost:19091]" secure=false
2025/11/25 13:25:25 INFO finished initializing middleware
2025/11/25 13:25:25 INFO listen host https: 0.0.0.0
2025/11/25 13:25:25 INFO listen port https: 19443
2025/11/25 13:25:25 INFO cert file: 
2025/11/25 13:25:25 INFO key file: 
2025/11/25 13:25:25 INFO https enabled: false
2025/11/25 13:25:25 INFO listen host http: 0.0.0.0
2025/11/25 13:25:25 INFO listen port http: 19090
2025/11/25 13:25:25 INFO http enabled: true
2025/11/25 13:25:25 WARN === WARNING ===
2025/11/25 13:25:25 WARN You are running the auth server with HTTP (without TLS/HTTPS).
2025/11/25 13:25:25 WARN This is HIGHLY INSECURE unless you are:
2025/11/25 13:25:25 WARN   1. Only doing development/testing, OR
2025/11/25 13:25:25 WARN   2. Running behind a reverse proxy that handles HTTPS
2025/11/25 13:25:25 WARN 
2025/11/25 13:25:25 WARN In production environments, you should either:
2025/11/25 13:25:25 WARN   - Enable HTTPS configuration, OR
2025/11/25 13:25:25 WARN   - Ensure your reverse proxy handles HTTPS properly
2025/11/25 13:25:25 WARN ===============
2025/11/25 13:25:25 INFO starting HTTP server on 0.0.0.0:19090
Server is up and running
Running integration tests...
2025/11/25 13:25:26 INFO running TestMain
2025/11/25 13:25:26 INFO db type is mssql
2025/11/25 13:25:26 INFO creating mssql database
2025/11/25 13:25:26 INFO using database mssql
2025/11/25 13:25:26 INFO db username: sa
2025/11/25 13:25:26 INFO db host: mssql-server
2025/11/25 13:25:26 INFO db port: 11433
2025/11/25 13:25:26 INFO db name: goiabada_integration
2025/11/25 13:25:26 INFO no need to migrate the database
=== RUN   TestAPIAccountAddressPut_Success
2025/11/25 13:25:26 [a357f2e3b56e/a04mE72Kgg-000002] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-nfgKhNgG&redirect_uri=https%3A%2F%2Fwww.dynamicvisualize.info%2Ffacilitate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=FPJpicRe&nonce=WnYFONdu HTTP/1.1" from [::1]:56746 - 302 57B in 1.973639ms
2025/11/25 13:25:26 [a357f2e3b56e/a04mE72Kgg-000003] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56762 - 302 54B in 265.733Âµs
2025/11/25 13:25:26 [a357f2e3b56e/a04mE72Kgg-000004] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56768 - 200 2949B in 499.323Âµs
2025/11/25 13:25:26 INFO {"audit_event":"auth_success_pwd","details":{"userId":11612}}
2025/11/25 13:25:26 [a357f2e3b56e/a04mE72Kgg-000005] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56768 - 302 0B in 36.73549ms
2025/11/25 13:25:26 [a357f2e3b56e/a04mE72Kgg-000006] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56768 - 302 57B in 504.504Âµs
2025/11/25 13:25:26 [a357f2e3b56e/a04mE72Kgg-000007] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56784 - 302 60B in 1.175411ms
2025/11/25 13:25:26 INFO {"audit_event":"started_new_user_session","details":{"clientId":13957,"userId":11612}}
2025/11/25 13:25:26 [a357f2e3b56e/a04mE72Kgg-000008] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56788 - 302 56B in 5.917972ms
2025/11/25 13:25:26 INFO {"audit_event":"created_auth_code","details":{"clientId":13957,"codeId":10754,"userId":11612}}
2025/11/25 13:25:26 [a357f2e3b56e/a04mE72Kgg-000009] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56790 - 302 220B in 3.219353ms
2025/11/25 13:25:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10754}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000010] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56796 - 200 4328B in 833.283042ms
2025/11/25 13:25:27 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"48a1b337-89e4-49f0-ad00-21ed76311b1e","userId":11612}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000011] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56808 - 200 735B in 6.179636ms
--- PASS: TestAPIAccountAddressPut_Success (0.94s)
=== RUN   TestAPIAccountAddressPut_PartialAddress
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000012] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-JCOlWMJH&redirect_uri=https%3A%2F%2Fwww.corporateclicks-and-mortar.com%2Fwireless%2Fmetrics%2Fcross-media&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=iGfJcJgk&nonce=rioAWGrq HTTP/1.1" from [::1]:56816 - 302 57B in 1.424691ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000013] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56824 - 302 54B in 225.476Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000014] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56832 - 200 2949B in 365.501Âµs
2025/11/25 13:25:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":11613}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000015] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56832 - 302 0B in 36.763674ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000016] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56832 - 302 57B in 584.785Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000017] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56836 - 302 60B in 989.309Âµs
2025/11/25 13:25:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":13958,"userId":11613}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000018] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56844 - 302 56B in 2.696455ms
2025/11/25 13:25:27 INFO {"audit_event":"created_auth_code","details":{"clientId":13958,"codeId":10755,"userId":11613}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000019] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56854 - 302 247B in 3.36084ms
2025/11/25 13:25:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10755}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000020] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56864 - 200 4342B in 16.977318ms
2025/11/25 13:25:27 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"488004f6-df14-481a-9b56-f5b833a5c8aa","userId":11613}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000021] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56880 - 200 720B in 4.480847ms
--- PASS: TestAPIAccountAddressPut_PartialAddress (0.12s)
=== RUN   TestAPIAccountAddressPut_ClearAllFields
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000022] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-UunFPZSb&redirect_uri=http%3A%2F%2Fwww.nationalcollaborative.info%2Fubiquitous%2Ftechnologies&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=UPHKTnmx&nonce=nERMPVsm HTTP/1.1" from [::1]:56890 - 302 57B in 1.0162ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000023] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56898 - 302 54B in 222.29Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000024] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56902 - 200 2949B in 340.844Âµs
2025/11/25 13:25:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":11614}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000025] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56902 - 302 0B in 36.675257ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000026] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56902 - 302 57B in 491.689Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000027] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56914 - 302 60B in 972.127Âµs
2025/11/25 13:25:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":13959,"userId":11614}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000028] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56926 - 302 56B in 2.286259ms
2025/11/25 13:25:27 INFO {"audit_event":"created_auth_code","details":{"clientId":13959,"codeId":10756,"userId":11614}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000029] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56936 - 302 237B in 2.842711ms
2025/11/25 13:25:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10756}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000030] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:56938 - 200 4322B in 15.55475ms
2025/11/25 13:25:27 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"b70fbd29-aba0-46f9-a669-219c91428cef","userId":11614}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000031] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:56948 - 200 695B in 4.715119ms
--- PASS: TestAPIAccountAddressPut_ClearAllFields (0.11s)
=== RUN   TestAPIAccountAddressPut_ValidationErrors
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000032] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-apQWcjRj&redirect_uri=https%3A%2F%2Fwww.chiefmesh.org%2Fenable%2Feyeballs&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=nlRHGRwG&nonce=yhQDfjeO HTTP/1.1" from [::1]:56954 - 302 57B in 906.563Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000033] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:56964 - 302 54B in 187.554Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000034] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56968 - 200 2949B in 279.899Âµs
2025/11/25 13:25:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":11615}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000035] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:56968 - 302 0B in 36.347377ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000036] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:56968 - 302 57B in 840.198Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000037] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:56972 - 302 60B in 451.674Âµs
2025/11/25 13:25:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":13960,"userId":11615}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000038] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:56978 - 302 56B in 2.438277ms
2025/11/25 13:25:27 INFO {"audit_event":"created_auth_code","details":{"clientId":13960,"codeId":10757,"userId":11615}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000039] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:56990 - 302 217B in 2.560969ms
2025/11/25 13:25:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10757}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000040] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57004 - 200 4334B in 15.487573ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000041] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57018 - 400 116B in 590.275Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000042] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57032 - 400 116B in 687.288Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000043] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57048 - 400 110B in 387.331Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000044] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57058 - 400 108B in 381.841Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000045] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57072 - 400 113B in 406.018Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000046] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57080 - 400 67B in 846.67Âµs
--- PASS: TestAPIAccountAddressPut_ValidationErrors (0.11s)
=== RUN   TestAPIAccountAddressPut_UnauthorizedAndScope
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000047] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57090 - 401 22B in 111.481Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000048] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57096 - 401 22B in 566.07Âµs
2025/11/25 13:25:27 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13961}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000049] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57100 - 200 1165B in 5.850715ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000050] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57108 - 403 19B in 358.177Âµs
--- PASS: TestAPIAccountAddressPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountAddressPut_InvalidRequestBody
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000051] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-jzYwfUbF&redirect_uri=http%3A%2F%2Fwww.directeyeballs.info%2Fcommunities%2Fstreamline&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ePCZhaOL&nonce=ISXPOZML HTTP/1.1" from [::1]:57112 - 302 57B in 1.31808ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000052] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57118 - 302 54B in 212.001Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000053] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57134 - 200 2949B in 305.898Âµs
2025/11/25 13:25:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":11616}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000054] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57134 - 302 0B in 35.932484ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000055] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57134 - 302 57B in 374.648Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000056] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57136 - 302 60B in 374.658Âµs
2025/11/25 13:25:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":13962,"userId":11616}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000057] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57140 - 302 56B in 2.785774ms
2025/11/25 13:25:27 INFO {"audit_event":"created_auth_code","details":{"clientId":13962,"codeId":10758,"userId":11616}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000058] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57156 - 302 229B in 2.917111ms
2025/11/25 13:25:27 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10758}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000059] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57164 - 200 4330B in 15.736083ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000060] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:57166 - 400 75B in 547.224Âµs
--- PASS: TestAPIAccountAddressPut_InvalidRequestBody (0.11s)
=== RUN   TestAPIAccountConsentsGet_Success
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000061] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-cNktPXee&redirect_uri=http%3A%2F%2Fwww.humaninnovate.org%2F24-365&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=SKWlgVVL&nonce=xjYUVcOM HTTP/1.1" from [::1]:57172 - 302 57B in 931.72Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000062] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57174 - 302 54B in 225.215Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000063] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57182 - 200 2949B in 361.743Âµs
2025/11/25 13:25:27 INFO {"audit_event":"auth_success_pwd","details":{"userId":11617}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000064] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57182 - 302 0B in 35.496861ms
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000065] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57182 - 302 57B in 450.972Âµs
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000066] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57194 - 302 60B in 759.134Âµs
2025/11/25 13:25:27 INFO {"audit_event":"started_new_user_session","details":{"clientId":13963,"userId":11617}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000067] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57196 - 302 56B in 2.249551ms
2025/11/25 13:25:27 INFO {"audit_event":"created_auth_code","details":{"clientId":13963,"codeId":10759,"userId":11617}}
2025/11/25 13:25:27 [a357f2e3b56e/a04mE72Kgg-000068] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57210 - 302 211B in 2.673171ms
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10759}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000069] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57222 - 200 4334B in 16.308965ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000070] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:57230 - 200 319B in 1.746751ms
--- PASS: TestAPIAccountConsentsGet_Success (0.12s)
=== RUN   TestAPIAccountConsentsGet_UnauthorizedAndScope
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000071] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:57246 - 401 22B in 209.767Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000072] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:57250 - 401 22B in 651.772Âµs
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13965}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000073] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57258 - 200 1165B in 5.336213ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000074] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:57262 - 403 19B in 625.582Âµs
--- PASS: TestAPIAccountConsentsGet_UnauthorizedAndScope (0.04s)
=== RUN   TestAPIAccountConsentDelete_Success
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000075] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-vTPYLiYa&redirect_uri=https%3A%2F%2Fwww.customertransparent.biz%2Fengage%2Fsynergistic%2Farchitect&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=BEQkoxQK&nonce=OtiMwFvm HTTP/1.1" from [::1]:57266 - 302 57B in 1.001311ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000076] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57272 - 302 54B in 192.012Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000077] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57276 - 200 2949B in 313.432Âµs
2025/11/25 13:25:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":11618}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000078] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57276 - 302 0B in 36.147629ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000079] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57276 - 302 57B in 618.809Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000080] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57292 - 302 60B in 524.22Âµs
2025/11/25 13:25:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":13966,"userId":11618}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000081] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57308 - 302 56B in 2.358356ms
2025/11/25 13:25:28 INFO {"audit_event":"created_auth_code","details":{"clientId":13966,"codeId":10760,"userId":11618}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000082] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57320 - 302 240B in 2.74668ms
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10760}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000083] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57326 - 200 4326B in 16.294438ms
2025/11/25 13:25:28 INFO {"audit_event":"deleted_own_user_consent","details":{"consentId":10132,"loggedInUser":"778db127-15df-4606-8be1-9f04f8236601","userId":11618}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000084] "DELETE http://localhost:19090/api/v1/account/consents/10132 HTTP/1.1" from [::1]:57334 - 200 17B in 2.469797ms
--- PASS: TestAPIAccountConsentDelete_Success (0.12s)
=== RUN   TestAPIAccountConsentDelete_ForbiddenOnOtherUser
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000085] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ZnHUIHvE&redirect_uri=https%3A%2F%2Fwww.leadunleash.info%2Fseamless%2Fe-tailers&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=MREsVyuP&nonce=mVkwaOME HTTP/1.1" from [::1]:57346 - 302 57B in 898.998Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000086] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57354 - 302 54B in 224.855Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000087] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57358 - 200 2949B in 324.022Âµs
2025/11/25 13:25:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":11619}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000088] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57358 - 302 0B in 35.621977ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000089] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57358 - 302 57B in 501.869Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000090] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57360 - 302 60B in 417.138Âµs
2025/11/25 13:25:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":13968,"userId":11619}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000091] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57370 - 302 56B in 2.322338ms
2025/11/25 13:25:28 INFO {"audit_event":"created_auth_code","details":{"clientId":13968,"codeId":10761,"userId":11619}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000092] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57382 - 302 223B in 2.640629ms
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10761}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000093] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57394 - 200 4342B in 172.954071ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000094] "DELETE http://localhost:19090/api/v1/account/consents/10133 HTTP/1.1" from [::1]:57398 - 403 53B in 829.858Âµs
--- PASS: TestAPIAccountConsentDelete_ForbiddenOnOtherUser (0.28s)
=== RUN   TestAPIAccountConsentDelete_NotFoundAndBadId
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000095] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-HnijLOwX&redirect_uri=https%3A%2F%2Fwww.leadsticky.info%2Fmetrics%2Finnovate%2Fenvisioneer%2Fglobal&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=HHCCyqJd&nonce=uvZexRcM HTTP/1.1" from [::1]:57410 - 302 57B in 831.131Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000096] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57422 - 302 54B in 205.669Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000097] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57430 - 200 2949B in 315.326Âµs
2025/11/25 13:25:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":11621}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000098] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57430 - 302 0B in 35.881817ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000099] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57430 - 302 57B in 541.122Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000100] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57434 - 302 60B in 427.999Âµs
2025/11/25 13:25:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":13970,"userId":11621}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000101] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57446 - 302 56B in 2.256764ms
2025/11/25 13:25:28 INFO {"audit_event":"created_auth_code","details":{"clientId":13970,"codeId":10762,"userId":11621}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000102] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57460 - 302 239B in 2.850236ms
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10762}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000103] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57476 - 200 4328B in 16.346446ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000104] "DELETE http://localhost:19090/api/v1/account/consents/999999999 HTTP/1.1" from [::1]:57488 - 404 61B in 591.908Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000105] "DELETE http://localhost:19090/api/v1/account/consents/abc HTTP/1.1" from [::1]:57504 - 400 76B in 482.592Âµs
--- PASS: TestAPIAccountConsentDelete_NotFoundAndBadId (0.11s)
=== RUN   TestAPIAccountEmailPut_Success
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000106] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ukXnbPTp&redirect_uri=https%3A%2F%2Fwww.internalinnovative.name%2Fmesh&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=SqtvaUis&nonce=dZkLsnor HTTP/1.1" from [::1]:57506 - 302 57B in 651.341Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000107] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57520 - 302 54B in 181.413Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000108] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57536 - 200 2949B in 277.814Âµs
2025/11/25 13:25:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":11622}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000109] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57536 - 302 0B in 35.648497ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000110] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57536 - 302 57B in 602.428Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000111] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57538 - 302 60B in 408.482Âµs
2025/11/25 13:25:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":13971,"userId":11622}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000112] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57550 - 302 56B in 2.345231ms
2025/11/25 13:25:28 INFO {"audit_event":"created_auth_code","details":{"clientId":13971,"codeId":10763,"userId":11622}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000113] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57566 - 302 216B in 2.700673ms
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10763}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000114] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57576 - 200 4330B in 17.398043ms
2025/11/25 13:25:28 INFO {"audit_event":"updated_own_email","details":{"loggedInUser":"eeb082cd-79e9-4a6c-b835-4bd68b330c27","userId":11622}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000115] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57590 - 200 695B in 1.992745ms
--- PASS: TestAPIAccountEmailPut_Success (0.11s)
=== RUN   TestAPIAccountEmailPut_ValidationErrors
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000116] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-hJhhqCbQ&redirect_uri=https%3A%2F%2Fwww.dynamicgranular.info%2Fenterprise%2Fiterate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=SQoLvKZO&nonce=gtEllsDv HTTP/1.1" from [::1]:57592 - 302 57B in 895.261Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000117] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57600 - 302 54B in 191.061Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000118] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57608 - 200 2949B in 320.585Âµs
2025/11/25 13:25:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":11623}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000119] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57608 - 302 0B in 36.637485ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000120] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57608 - 302 57B in 592.76Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000121] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57616 - 302 60B in 961.968Âµs
2025/11/25 13:25:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":13972,"userId":11623}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000122] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57620 - 302 56B in 4.795241ms
2025/11/25 13:25:28 INFO {"audit_event":"created_auth_code","details":{"clientId":13972,"codeId":10764,"userId":11623}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000123] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57630 - 302 227B in 2.547203ms
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10764}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000124] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57642 - 200 4344B in 16.098407ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000125] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57656 - 400 81B in 539.159Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000126] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57672 - 400 86B in 432.587Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000127] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57686 - 400 117B in 378.035Âµs
--- PASS: TestAPIAccountEmailPut_ValidationErrors (0.11s)
=== RUN   TestAPIAccountEmailPut_EmailAlreadyExists
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000128] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-LVFPlSnD&redirect_uri=http%3A%2F%2Fwww.regionalmatrix.com%2Fsynergistic%2Fcultivate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=tpjhDbMH&nonce=oaAwSRCI HTTP/1.1" from [::1]:57702 - 302 57B in 773.542Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000129] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57718 - 302 54B in 227.079Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000130] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57730 - 200 2949B in 280.75Âµs
2025/11/25 13:25:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":11624}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000131] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57730 - 302 0B in 35.359099ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000132] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57730 - 302 57B in 882.548Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000133] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57744 - 302 60B in 406.588Âµs
2025/11/25 13:25:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":13973,"userId":11624}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000134] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57758 - 302 56B in 2.122511ms
2025/11/25 13:25:28 INFO {"audit_event":"created_auth_code","details":{"clientId":13973,"codeId":10765,"userId":11624}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000135] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57762 - 302 227B in 1.426425ms
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10765}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000136] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57766 - 200 4328B in 13.795977ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000137] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57782 - 400 107B in 1.525683ms
--- PASS: TestAPIAccountEmailPut_EmailAlreadyExists (0.10s)
=== RUN   TestAPIAccountEmailPut_UnauthorizedAndScope
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000138] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57786 - 401 22B in 145.775Âµs
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13974}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000139] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57802 - 200 1165B in 4.75776ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000140] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57812 - 403 19B in 325.425Âµs
--- PASS: TestAPIAccountEmailPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountEmailPut_InvalidRequestBody
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000141] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-JTiQnNGy&redirect_uri=https%3A%2F%2Fwww.regionalbricks-and-clicks.name%2Faction-items%2Fexperiences%2Ftransparent%2Fsyndicate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=jMlCwTjA&nonce=oICgCbCF HTTP/1.1" from [::1]:57816 - 302 57B in 1.15378ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000142] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57830 - 302 54B in 308.052Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000143] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57836 - 200 2949B in 424.973Âµs
2025/11/25 13:25:28 INFO {"audit_event":"auth_success_pwd","details":{"userId":11626}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000144] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57836 - 302 0B in 36.08425ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000145] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57836 - 302 57B in 771.768Âµs
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000146] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57844 - 302 60B in 836.56Âµs
2025/11/25 13:25:28 INFO {"audit_event":"started_new_user_session","details":{"clientId":13975,"userId":11626}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000147] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57854 - 302 56B in 2.436554ms
2025/11/25 13:25:28 INFO {"audit_event":"created_auth_code","details":{"clientId":13975,"codeId":10766,"userId":11626}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000148] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57860 - 302 265B in 3.018243ms
2025/11/25 13:25:28 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10766}}
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000149] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57870 - 200 4330B in 16.208716ms
2025/11/25 13:25:28 [a357f2e3b56e/a04mE72Kgg-000150] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:57884 - 400 75B in 797.557Âµs
--- PASS: TestAPIAccountEmailPut_InvalidRequestBody (0.11s)
=== RUN   TestAPIAccountEmailVerificationSend_Success
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000151] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-jRWvckVt&redirect_uri=http%3A%2F%2Fwww.internationalharness.com%2Fgranular&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ccuEkVYY&nonce=wuNYaVBx HTTP/1.1" from [::1]:57890 - 302 57B in 956.747Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000152] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57894 - 302 54B in 202.312Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000153] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57902 - 200 2949B in 275.29Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11627}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000154] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57902 - 302 0B in 35.772551ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000155] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57902 - 302 57B in 497.961Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000156] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57916 - 302 60B in 484.065Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13976,"userId":11627}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000157] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57928 - 302 56B in 2.605233ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13976,"codeId":10767,"userId":11627}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000158] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57940 - 302 220B in 1.610703ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10767}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000159] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57946 - 200 4322B in 13.964255ms
2025/11/25 13:25:29 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"edythbruen@howell.io","loggedInUser":"32cc85e4-12ec-40e4-a9ed-4b09568e9eb1","userId":11627}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000160] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:57950 - 200 137B in 5.946276ms
--- PASS: TestAPIAccountEmailVerificationSend_Success (0.11s)
=== RUN   TestAPIAccountEmailVerificationSend_TooManyRequests
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000161] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-SLHlAZUQ&redirect_uri=https%3A%2F%2Fwww.globalclicks-and-mortar.name%2Fleading-edge%2Fchannels&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=agdEBfXH&nonce=zbrdBNkm HTTP/1.1" from [::1]:57954 - 302 57B in 1.125657ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000162] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:57962 - 302 54B in 484.866Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000163] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57970 - 200 2949B in 330.595Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11628}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000164] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:57970 - 302 0B in 35.286623ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000165] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:57970 - 302 57B in 529.43Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000166] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:57976 - 302 60B in 576.199Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13977,"userId":11628}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000167] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:57986 - 302 56B in 2.268105ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13977,"codeId":10768,"userId":11628}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000168] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:57990 - 302 238B in 2.809819ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10768}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000169] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:57998 - 200 4322B in 16.130428ms
2025/11/25 13:25:29 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"willoreilly@rath.org","loggedInUser":"efc5090d-0d28-4dc1-9358-e4b3c4527153","userId":11628}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000170] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:58008 - 200 137B in 2.629408ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000171] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:58024 - 200 118B in 720.922Âµs
--- PASS: TestAPIAccountEmailVerificationSend_TooManyRequests (0.12s)
=== RUN   TestAPIAccountEmailVerificationSend_AlreadyVerified
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000172] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-IPvzSmOe&redirect_uri=https%3A%2F%2Fwww.corporateclicks-and-mortar.com%2Fcollaborative%2Fturn-key%2Fb2c&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=VktYspsb&nonce=vtyftafE HTTP/1.1" from [::1]:58034 - 302 57B in 886.064Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000173] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58036 - 302 54B in 250.483Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000174] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58044 - 200 2949B in 303.514Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11629}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000175] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58044 - 302 0B in 36.885144ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000176] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58044 - 302 57B in 406.688Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000177] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58050 - 302 60B in 378.324Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13978,"userId":11629}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000178] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58052 - 302 56B in 2.36572ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13978,"codeId":10769,"userId":11629}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000179] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58068 - 302 245B in 2.477331ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10769}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000180] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58082 - 200 4336B in 16.071667ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000181] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:58084 - 200 117B in 679.093Âµs
--- PASS: TestAPIAccountEmailVerificationSend_AlreadyVerified (0.11s)
=== RUN   TestAPIAccountEmailVerificationSend_SMTPDisabled
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000182] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-iKocZpWX&redirect_uri=http%3A%2F%2Fwww.regionaltransparent.biz%2Ffront-end%2Fvisionary&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=QFVrclob&nonce=LMWzScZB HTTP/1.1" from [::1]:58092 - 302 57B in 878.86Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000183] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58108 - 302 54B in 246.065Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000184] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58118 - 200 2949B in 289.907Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11630}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000185] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58118 - 302 0B in 36.130547ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000186] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58118 - 302 57B in 1.120567ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000187] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58128 - 302 60B in 593.061Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13979,"userId":11630}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000188] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58138 - 302 56B in 2.668362ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13979,"codeId":10770,"userId":11630}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000189] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58154 - 302 230B in 3.034944ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10770}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000190] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58168 - 200 4338B in 16.803911ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000191] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:58184 - 400 70B in 656.07Âµs
--- PASS: TestAPIAccountEmailVerificationSend_SMTPDisabled (0.11s)
=== RUN   TestAPIAccountEmailVerificationSend_Unauthorized
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000192] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:58186 - 401 22B in 191.783Âµs
--- PASS: TestAPIAccountEmailVerificationSend_Unauthorized (0.00s)
=== RUN   TestAPIAccountEmailVerification_VerifySuccess
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000193] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-RMzXMuUI&redirect_uri=http%3A%2F%2Fwww.producte-business.com%2Fout-of-the-box&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=mhTiHzcB&nonce=WVxRNcNV HTTP/1.1" from [::1]:58202 - 302 57B in 891.615Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000194] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58214 - 302 54B in 196.962Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000195] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58228 - 200 2949B in 310.938Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11631}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000196] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58228 - 302 0B in 35.677522ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000197] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58228 - 302 57B in 558.856Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000198] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58234 - 302 60B in 523.179Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13980,"userId":11631}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000199] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58238 - 302 56B in 2.451623ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13980,"codeId":10771,"userId":11631}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000200] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58240 - 302 223B in 1.558014ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10771}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000201] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58244 - 200 4342B in 14.335546ms
2025/11/25 13:25:29 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"felicitabradtke@cassin.name","loggedInUser":"ff637ac5-51c2-4853-9b3d-7f3cf81a367e","userId":11631}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000202] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:58258 - 200 144B in 6.410543ms
2025/11/25 13:25:29 INFO {"audit_event":"verified_email","details":{"loggedInUser":"ff637ac5-51c2-4853-9b3d-7f3cf81a367e","userId":11631}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000203] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58264 - 200 701B in 4.307149ms
--- PASS: TestAPIAccountEmailVerification_VerifySuccess (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifyInvalidCode
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000204] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-lnERskhi&redirect_uri=https%3A%2F%2Fwww.corporateharness.io%2Fcultivate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=RipdbWcw&nonce=rHKZeQDi HTTP/1.1" from [::1]:58272 - 302 57B in 769.564Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000205] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58288 - 302 54B in 193.485Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000206] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58302 - 200 2949B in 278.396Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11632}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000207] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58302 - 302 0B in 36.42273ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000208] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58302 - 302 57B in 433.689Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000209] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58304 - 302 60B in 751.61Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13981,"userId":11632}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000210] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58312 - 302 56B in 2.536883ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13981,"codeId":10772,"userId":11632}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000211] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58324 - 302 217B in 1.533327ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10772}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000212] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58334 - 200 4322B in 15.232281ms
2025/11/25 13:25:29 INFO {"audit_event":"failed_email_verification_code","details":{"loggedInUser":"3db15bd2-e9f7-41b4-8304-5ab92b5fc9b5","userId":11632}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000213] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58344 - 400 107B in 637.655Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyInvalidCode (0.10s)
=== RUN   TestAPIAccountEmailVerification_VerifyExpiredCode
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000214] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-NJqjIPcJ&redirect_uri=https%3A%2F%2Fwww.dynamicproductize.name%2Faggregate%2Fempower%2Finitiatives%2Fembrace&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=fhDvGAgU&nonce=HdGDQtzJ HTTP/1.1" from [::1]:58356 - 302 57B in 947.5Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000215] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58366 - 302 54B in 210.157Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000216] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58368 - 200 2949B in 604.041Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11633}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000217] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58368 - 302 0B in 36.251646ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000218] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58368 - 302 57B in 518.249Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000219] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58380 - 302 60B in 543.988Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13982,"userId":11633}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000220] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58392 - 302 56B in 2.510583ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13982,"codeId":10773,"userId":11633}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000221] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58402 - 302 248B in 2.898617ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10773}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000222] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58418 - 200 4330B in 15.59167ms
2025/11/25 13:25:29 INFO {"audit_event":"failed_email_verification_code","details":{"loggedInUser":"6a49ff9e-d077-420b-bd6f-356f3a744509","userId":11633}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000223] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58424 - 400 107B in 637.244Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyExpiredCode (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifyAlreadyVerified
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000224] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-nQfACvBg&redirect_uri=http%3A%2F%2Fwww.nationalmorph.com%2Fusers%2Fopen-source%2Fevolve%2Fengineer&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=dBxUSJKW&nonce=iLYMMxVp HTTP/1.1" from [::1]:58436 - 302 57B in 930.388Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000225] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58446 - 302 54B in 296.881Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000226] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58456 - 200 2949B in 309.184Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11634}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000227] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58456 - 302 0B in 35.309897ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000228] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58456 - 302 57B in 573.824Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000229] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58468 - 302 60B in 540.091Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13983,"userId":11634}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000230] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58474 - 302 56B in 2.14876ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13983,"codeId":10774,"userId":11634}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000231] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58480 - 302 238B in 1.48726ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10774}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000232] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58492 - 200 4334B in 14.192216ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000233] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58500 - 200 693B in 615.122Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyAlreadyVerified (0.11s)
=== RUN   TestAPIAccountEmailVerification_VerifySMTPDisabled
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000234] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-Wmzlcqln&redirect_uri=http%3A%2F%2Fwww.regionalcontent.org%2Farchitect%2Fdeploy&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=IYWlcPvv&nonce=iuXStEin HTTP/1.1" from [::1]:58514 - 302 57B in 877.769Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000235] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58526 - 302 54B in 242.037Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000236] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58532 - 200 2949B in 362.274Âµs
2025/11/25 13:25:29 INFO {"audit_event":"auth_success_pwd","details":{"userId":11635}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000237] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58532 - 302 0B in 35.894381ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000238] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58532 - 302 57B in 933.834Âµs
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000239] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58546 - 302 60B in 682.119Âµs
2025/11/25 13:25:29 INFO {"audit_event":"started_new_user_session","details":{"clientId":13984,"userId":11635}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000240] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58554 - 302 56B in 3.422196ms
2025/11/25 13:25:29 INFO {"audit_event":"created_auth_code","details":{"clientId":13984,"codeId":10775,"userId":11635}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000241] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58570 - 302 223B in 1.992374ms
2025/11/25 13:25:29 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10775}}
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58578 - 200 4338B in 13.991857ms
2025/11/25 13:25:29 [a357f2e3b56e/a04mE72Kgg-000243] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58580 - 400 70B in 384.877Âµs
--- PASS: TestAPIAccountEmailVerification_VerifySMTPDisabled (0.10s)
=== RUN   TestAPIAccountEmailVerification_VerifyInvalidRequestBody
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000244] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-EpsnkDQx&redirect_uri=https%3A%2F%2Fwww.futurecompelling.net%2Fembrace&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ViSmdcAd&nonce=lWtoHofq HTTP/1.1" from [::1]:58592 - 302 57B in 824.147Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000245] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58606 - 302 54B in 297.271Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000246] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58608 - 200 2949B in 325.325Âµs
2025/11/25 13:25:30 INFO {"audit_event":"auth_success_pwd","details":{"userId":11636}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000247] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58608 - 302 0B in 36.505967ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000248] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58608 - 302 57B in 571.59Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000249] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58622 - 302 60B in 463.436Âµs
2025/11/25 13:25:30 INFO {"audit_event":"started_new_user_session","details":{"clientId":13985,"userId":11636}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000250] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58628 - 302 56B in 2.695683ms
2025/11/25 13:25:30 INFO {"audit_event":"created_auth_code","details":{"clientId":13985,"codeId":10776,"userId":11636}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000251] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58632 - 302 216B in 1.53997ms
2025/11/25 13:25:30 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10776}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000252] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58648 - 200 4338B in 13.692431ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000253] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58650 - 400 75B in 571.931Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyInvalidRequestBody (0.10s)
=== RUN   TestAPIAccountEmailVerification_VerifyUnauthorized
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000254] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:58658 - 401 22B in 107.863Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyUnauthorized (0.00s)
=== RUN   TestAPIAccountLogoutRequest_Success_And_LogoutFlow_WithAndWithoutCookie
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000255] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-hDYwmITa&redirect_uri=http%3A%2F%2Fwww.districtbleeding-edge.io%2Fviral%2Fvertical&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ilmaTBFu&nonce=arKOpYKl HTTP/1.1" from [::1]:58660 - 302 57B in 790.945Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000256] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58674 - 302 54B in 296.2Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000257] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58688 - 200 2949B in 307.581Âµs
2025/11/25 13:25:30 INFO {"audit_event":"auth_success_pwd","details":{"userId":11637}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000258] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58688 - 302 0B in 36.1635ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000259] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58688 - 302 57B in 406.809Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000260] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58702 - 302 60B in 520.825Âµs
2025/11/25 13:25:30 INFO {"audit_event":"started_new_user_session","details":{"clientId":13986,"userId":11637}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000261] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58710 - 302 56B in 2.846628ms
2025/11/25 13:25:30 INFO {"audit_event":"created_auth_code","details":{"clientId":13986,"codeId":10777,"userId":11637}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000262] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58716 - 302 226B in 2.834877ms
2025/11/25 13:25:30 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10777}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000263] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58722 - 200 4320B in 16.65557ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000264] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58724 - 200 1218B in 257.901417ms
2025/11/25 13:25:30 INFO {"audit_event":"deleted_user_session_client","details":{"clientId":13986,"loggedInUser":"","userId":11637,"userSessionId":11693}}
2025/11/25 13:25:30 INFO {"audit_event":"logout","details":{"loggedInUser":"","sessionIdentifier":"df1d54f0-ffd1-4505-97d3-353216728cc9","userId":11637}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000265] "GET http://localhost:19090/auth/logout?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6ImJlYTY0YTU4LTYxOTktNDhmMS04M2Y4LTdmM2EzZTYwYTQwYSIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhY2N0c2NvcGUtY2xpZW50LWhEWXdtSVRhIiwiZXhwIjoxNzY0MDc3MTkwLCJpYXQiOjE3NjQwNzcxMzAsImlzcyI6Imlzc3Vlci1mZ3pVYW0iLCJzaWQiOiJkZjFkNTRmMC1mZmQxLTQ1MDUtOTdkMy0zNTMyMTY3MjhjYzkiLCJzdWIiOiIxZmE3ZDkxMy05MWEwLTRlYzEtYWJhNC03OTBmYjVkZmM5ZDgiLCJ0eXAiOiJJRCJ9.JDcoYLiXcbW0enDvxE8LLwCDd7GgS-hgQ2L5cF7Di3ej6recwLrDgWAKi6q3lzSuWte6msIt0k6DC8FBKHpVWhbxWrJLkkjHqEOlLSjCRqL4f6BSO0p_Siggxo85UF18tKX4s59gtZdgEQW_09z9QdWHvR-FEe81QB65rcIpOFcJOESJU7LiYncfJUQJexsVnmZS5rei5yQ6mmp_ct-R7PpPbFxpSX8wb6SFK49317QD3rSKLxBd0bdxiwJQEQJ0taCPNk_WNB7KbCNjOWJ-yxPf274dEKCBlrEBBTu-yCusRGWDnBZEMTtgJ2gjKV7C89v6hy1lRjOD0fFmD3_-l2R8l3qUxVh74FuEcE7_uLKZCpq5xEFB80ltxdVAGqNjISQWB3uNgJhcNRwe0ZNQe2MAawIRE7AcuOYy-7CJG6jHyBNrBp0XPZ8pNeiXS47u1d6cvFjKUgfEpmdPRSbGrvU6JE4BtYhwOyEhvr-_v-rHd-X3UV1xLd4m3D7t6Egs7mLiyibz9TIVATqW-HAIrMsleYfPsFbQ75kAeqQlWDLH3st9wWMiG0EzhgTekdwxO65jLcy2U_XGRXOVD2y1Q2Tj7fguJ5A2ulQN-rcFewLq7146MH1KnjgzquGGgwBqD23b_5OHkQerL6Ya6Wf_xPwksfLQqoab2TEtBAIInME&post_logout_redirect_uri=http%3A%2F%2Fwww.districtbleeding-edge.io%2Fviral%2Fvertical&state=UufYDmwmZAVj HTTP/1.1" from [::1]:58722 - 302 137B in 14.598914ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000266] "GET http://localhost:19090/auth/logout?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6ImJlYTY0YTU4LTYxOTktNDhmMS04M2Y4LTdmM2EzZTYwYTQwYSIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhY2N0c2NvcGUtY2xpZW50LWhEWXdtSVRhIiwiZXhwIjoxNzY0MDc3MTkwLCJpYXQiOjE3NjQwNzcxMzAsImlzcyI6Imlzc3Vlci1mZ3pVYW0iLCJzaWQiOiJkZjFkNTRmMC1mZmQxLTQ1MDUtOTdkMy0zNTMyMTY3MjhjYzkiLCJzdWIiOiIxZmE3ZDkxMy05MWEwLTRlYzEtYWJhNC03OTBmYjVkZmM5ZDgiLCJ0eXAiOiJJRCJ9.JDcoYLiXcbW0enDvxE8LLwCDd7GgS-hgQ2L5cF7Di3ej6recwLrDgWAKi6q3lzSuWte6msIt0k6DC8FBKHpVWhbxWrJLkkjHqEOlLSjCRqL4f6BSO0p_Siggxo85UF18tKX4s59gtZdgEQW_09z9QdWHvR-FEe81QB65rcIpOFcJOESJU7LiYncfJUQJexsVnmZS5rei5yQ6mmp_ct-R7PpPbFxpSX8wb6SFK49317QD3rSKLxBd0bdxiwJQEQJ0taCPNk_WNB7KbCNjOWJ-yxPf274dEKCBlrEBBTu-yCusRGWDnBZEMTtgJ2gjKV7C89v6hy1lRjOD0fFmD3_-l2R8l3qUxVh74FuEcE7_uLKZCpq5xEFB80ltxdVAGqNjISQWB3uNgJhcNRwe0ZNQe2MAawIRE7AcuOYy-7CJG6jHyBNrBp0XPZ8pNeiXS47u1d6cvFjKUgfEpmdPRSbGrvU6JE4BtYhwOyEhvr-_v-rHd-X3UV1xLd4m3D7t6Egs7mLiyibz9TIVATqW-HAIrMsleYfPsFbQ75kAeqQlWDLH3st9wWMiG0EzhgTekdwxO65jLcy2U_XGRXOVD2y1Q2Tj7fguJ5A2ulQN-rcFewLq7146MH1KnjgzquGGgwBqD23b_5OHkQerL6Ya6Wf_xPwksfLQqoab2TEtBAIInME&post_logout_redirect_uri=http%3A%2F%2Fwww.districtbleeding-edge.io%2Fviral%2Fvertical&state=UufYDmwmZAVj HTTP/1.1" from [::1]:58738 - 302 137B in 838.885Âµs
--- PASS: TestAPIAccountLogoutRequest_Success_And_LogoutFlow_WithAndWithoutCookie (0.38s)
=== RUN   TestAPIAccountLogoutRequest_ValidationErrors_And_Scope
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000267] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-lFtZxmEz&redirect_uri=http%3A%2F%2Fwww.districtclicks-and-mortar.name%2Forchestrate%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JCOrDpQB&nonce=JbwEuIGp HTTP/1.1" from [::1]:58748 - 302 57B in 881.054Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000268] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58764 - 302 54B in 230.565Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000269] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58776 - 200 2949B in 368.686Âµs
2025/11/25 13:25:30 INFO {"audit_event":"auth_success_pwd","details":{"userId":11638}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000270] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58776 - 302 0B in 35.542256ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000271] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58776 - 302 57B in 572.191Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000272] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58782 - 302 60B in 453.778Âµs
2025/11/25 13:25:30 INFO {"audit_event":"started_new_user_session","details":{"clientId":13987,"userId":11638}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000273] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58792 - 302 56B in 2.298062ms
2025/11/25 13:25:30 INFO {"audit_event":"created_auth_code","details":{"clientId":13987,"codeId":10778,"userId":11638}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000274] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58802 - 302 237B in 1.512387ms
2025/11/25 13:25:30 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10778}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58816 - 200 4334B in 15.681399ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000276] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58824 - 400 84B in 474.607Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000277] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58830 - 400 128B in 257.368109ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000278] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58834 - 401 22B in 158.239Âµs
2025/11/25 13:25:30 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13988}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58850 - 200 1165B in 4.415864ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000280] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:58852 - 403 19B in 408.152Âµs
--- PASS: TestAPIAccountLogoutRequest_ValidationErrors_And_Scope (0.37s)
=== RUN   TestAPIAccountOTPEnrollmentGet_Success
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000281] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-hHPlwJyS&redirect_uri=https%3A%2F%2Fwww.futurefacilitate.org%2Frich%2Fextensible&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=UIYPyPoh&nonce=bqxALOsI HTTP/1.1" from [::1]:58864 - 302 57B in 676.278Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000282] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58878 - 302 54B in 220.396Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000283] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58880 - 200 2949B in 337.948Âµs
2025/11/25 13:25:30 INFO {"audit_event":"auth_success_pwd","details":{"userId":11639}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000284] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58880 - 302 0B in 35.317791ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000285] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58880 - 302 57B in 449.329Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000286] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58890 - 302 60B in 847.782Âµs
2025/11/25 13:25:30 INFO {"audit_event":"started_new_user_session","details":{"clientId":13989,"userId":11639}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000287] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:58906 - 302 56B in 2.304023ms
2025/11/25 13:25:30 INFO {"audit_event":"created_auth_code","details":{"clientId":13989,"codeId":10779,"userId":11639}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000288] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:58916 - 302 224B in 2.843222ms
2025/11/25 13:25:30 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10779}}
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000289] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:58930 - 200 4330B in 15.731304ms
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000290] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:58932 - 200 695B in 730.009Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000291] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:58940 - 200 2162B in 4.163957ms
--- PASS: TestAPIAccountOTPEnrollmentGet_Success (0.11s)
=== RUN   TestAPIAccountOTPEnrollmentGet_AlreadyEnabled
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000292] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-gkNtpYZO&redirect_uri=https%3A%2F%2Fwww.productplug-and-play.info%2Fworld-class%2Fgrow%2Fconvergence&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=aFihjQXk&nonce=fTvNGysa HTTP/1.1" from [::1]:58954 - 302 57B in 765.246Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000293] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:58964 - 302 54B in 269.199Âµs
2025/11/25 13:25:30 [a357f2e3b56e/a04mE72Kgg-000294] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58978 - 200 2949B in 415.055Âµs
2025/11/25 13:25:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":11640}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000295] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:58978 - 302 0B in 35.520956ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000296] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:58978 - 302 57B in 844.526Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000297] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:58994 - 302 60B in 593.411Âµs
2025/11/25 13:25:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":13990,"userId":11640}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000298] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59000 - 302 56B in 3.654024ms
2025/11/25 13:25:31 INFO {"audit_event":"created_auth_code","details":{"clientId":13990,"codeId":10780,"userId":11640}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000299] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59012 - 302 242B in 3.052267ms
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10780}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000300] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59020 - 200 4330B in 18.194889ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000301] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59034 - 200 695B in 651.661Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000302] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:59036 - 400 76B in 651.05Âµs
--- PASS: TestAPIAccountOTPEnrollmentGet_AlreadyEnabled (0.12s)
=== RUN   TestAPIAccountOTPEnrollmentGet_UnauthorizedAndScope
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000303] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:59050 - 401 22B in 105.76Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000304] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:59064 - 401 22B in 646.822Âµs
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13991}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000305] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59074 - 200 1165B in 4.337005ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000306] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:59080 - 403 19B in 323.19Âµs
--- PASS: TestAPIAccountOTPEnrollmentGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountOTPPut_Enable_Success
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000307] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-SGMERWim&redirect_uri=https%3A%2F%2Fwww.legacywebservices.com%2Fend-to-end%2Fportals%2Fcontent%2Fimplement&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=FsAJnRMh&nonce=vFRFCMOv HTTP/1.1" from [::1]:59092 - 302 57B in 766.999Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000308] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59098 - 302 54B in 210.428Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000309] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59114 - 200 2949B in 333.72Âµs
2025/11/25 13:25:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":11641}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000310] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59114 - 302 0B in 35.363499ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000311] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59114 - 302 57B in 379.277Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000312] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59118 - 302 60B in 337.278Âµs
2025/11/25 13:25:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":13992,"userId":11641}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000313] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59130 - 302 56B in 2.233871ms
2025/11/25 13:25:31 INFO {"audit_event":"created_auth_code","details":{"clientId":13992,"codeId":10781,"userId":11641}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000314] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59138 - 302 246B in 2.68838ms
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10781}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000315] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59144 - 200 4330B in 16.474528ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000316] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59152 - 200 695B in 643.376Âµs
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13993}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000317] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59164 - 200 1156B in 5.20801ms
2025/11/25 13:25:31 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-LfuySnVE","userId":11641}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000318] "PUT http://localhost:19090/api/v1/admin/users/11641/password HTTP/1.1" from [::1]:59180 - 200 695B in 37.518911ms
2025/11/25 13:25:31 INFO {"audit_event":"enabled_otp","details":{"userId":11641}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000319] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59190 - 200 693B in 42.924034ms
--- PASS: TestAPIAccountOTPPut_Enable_Success (0.23s)
=== RUN   TestAPIAccountOTPPut_Enable_AuthFailed
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000320] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-TvpxetLZ&redirect_uri=https%3A%2F%2Fwww.regionalseize.info%2Fplatforms&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=oMjKoZtI&nonce=rbbqUApr HTTP/1.1" from [::1]:59196 - 302 57B in 1.010219ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000321] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59206 - 302 54B in 247.167Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000322] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59222 - 200 2949B in 299.226Âµs
2025/11/25 13:25:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":11642}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000323] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59222 - 302 0B in 36.388185ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000324] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59222 - 302 57B in 722.495Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000325] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59226 - 302 60B in 504.934Âµs
2025/11/25 13:25:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":13994,"userId":11642}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000326] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59232 - 302 56B in 2.8264ms
2025/11/25 13:25:31 INFO {"audit_event":"created_auth_code","details":{"clientId":13994,"codeId":10782,"userId":11642}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000327] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59246 - 302 216B in 1.710442ms
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10782}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000328] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59252 - 200 4330B in 13.971379ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000329] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59266 - 200 695B in 548.066Âµs
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13995}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59282 - 200 1156B in 4.456671ms
2025/11/25 13:25:31 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-njyEEmsL","userId":11642}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000331] "PUT http://localhost:19090/api/v1/admin/users/11642/password HTTP/1.1" from [::1]:59298 - 200 695B in 38.720642ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000332] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59308 - 400 113B in 37.593091ms
--- PASS: TestAPIAccountOTPPut_Enable_AuthFailed (0.22s)
=== RUN   TestAPIAccountOTPPut_Enable_InvalidFormats
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000333] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-uSSJVhDn&redirect_uri=http%3A%2F%2Fwww.futuresystems.biz%2Fsynergize%2Frepurpose&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=avhdpCRP&nonce=PZdfCoaG HTTP/1.1" from [::1]:59314 - 302 57B in 1.550319ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000334] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59316 - 302 54B in 252.427Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000335] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59330 - 200 2949B in 375.61Âµs
2025/11/25 13:25:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":11643}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000336] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59330 - 302 0B in 36.233603ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000337] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59330 - 302 57B in 605.204Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000338] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59340 - 302 60B in 454.559Âµs
2025/11/25 13:25:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":13996,"userId":11643}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000339] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59350 - 302 56B in 2.409763ms
2025/11/25 13:25:31 INFO {"audit_event":"created_auth_code","details":{"clientId":13996,"codeId":10783,"userId":11643}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000340] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59364 - 302 224B in 1.673091ms
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10783}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000341] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59370 - 200 4326B in 15.60229ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000342] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59372 - 200 693B in 610.633Âµs
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13997}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000343] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59374 - 200 1156B in 4.591215ms
2025/11/25 13:25:31 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-DScFJRdy","userId":11643}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000344] "PUT http://localhost:19090/api/v1/admin/users/11643/password HTTP/1.1" from [::1]:59390 - 200 693B in 41.789861ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000345] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59402 - 400 68B in 37.156436ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000346] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59416 - 400 79B in 35.677462ms
--- PASS: TestAPIAccountOTPPut_Enable_InvalidFormats (0.26s)
=== RUN   TestAPIAccountOTPPut_Enable_WrongCode
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000347] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-RKaYDqbT&redirect_uri=http%3A%2F%2Fwww.nationalscale.io%2Finitiatives%2Ftransition%2Fchannels&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=dWbVxeVX&nonce=DVhXaTTl HTTP/1.1" from [::1]:59420 - 302 57B in 1.084078ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000348] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59432 - 302 54B in 227.379Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000349] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59440 - 200 2949B in 297.152Âµs
2025/11/25 13:25:31 INFO {"audit_event":"auth_success_pwd","details":{"userId":11644}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000350] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59440 - 302 0B in 35.43865ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000351] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59440 - 302 57B in 437.286Âµs
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000352] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59444 - 302 60B in 419.413Âµs
2025/11/25 13:25:31 INFO {"audit_event":"started_new_user_session","details":{"clientId":13998,"userId":11644}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000353] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59460 - 302 56B in 2.4132ms
2025/11/25 13:25:31 INFO {"audit_event":"created_auth_code","details":{"clientId":13998,"codeId":10784,"userId":11644}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000354] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59476 - 302 235B in 2.905149ms
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10784}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000355] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59480 - 200 4330B in 16.826593ms
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000356] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59490 - 200 695B in 864.824Âµs
2025/11/25 13:25:31 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":13999}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000357] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59494 - 200 1156B in 4.732763ms
2025/11/25 13:25:31 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-XkTjNlac","userId":11644}}
2025/11/25 13:25:31 [a357f2e3b56e/a04mE72Kgg-000358] "PUT http://localhost:19090/api/v1/admin/users/11644/password HTTP/1.1" from [::1]:59504 - 200 695B in 37.917765ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000359] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59518 - 400 209B in 36.193978ms
--- PASS: TestAPIAccountOTPPut_Enable_WrongCode (0.25s)
=== RUN   TestAPIAccountOTPPut_Disable_Success
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000360] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-xsckBbRI&redirect_uri=http%3A%2F%2Fwww.internationalbricks-and-clicks.info%2Ffacilitate%2Fsexy%2Fmodels%2Fb2b&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JyhUvXMA&nonce=oIKaSHIF HTTP/1.1" from [::1]:59520 - 302 57B in 1.409834ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000361] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59530 - 302 54B in 285.89Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000362] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59544 - 200 2949B in 337.477Âµs
2025/11/25 13:25:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":11645}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000363] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59544 - 302 0B in 37.529731ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000364] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59544 - 302 57B in 993.047Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000365] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59550 - 302 60B in 602.068Âµs
2025/11/25 13:25:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":14000,"userId":11645}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000366] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59556 - 302 56B in 4.204204ms
2025/11/25 13:25:32 INFO {"audit_event":"created_auth_code","details":{"clientId":14000,"codeId":10785,"userId":11645}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000367] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59572 - 302 249B in 4.443526ms
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10785}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000368] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59584 - 200 4336B in 17.988639ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000369] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59598 - 200 697B in 767.22Âµs
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14001}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000370] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59610 - 200 1156B in 4.663662ms
2025/11/25 13:25:32 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-SWQqMIuq","userId":11645}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000371] "PUT http://localhost:19090/api/v1/admin/users/11645/password HTTP/1.1" from [::1]:59618 - 200 697B in 38.900361ms
2025/11/25 13:25:32 INFO {"audit_event":"disabled_otp","details":{"userId":11645}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000372] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59624 - 200 697B in 39.780224ms
--- PASS: TestAPIAccountOTPPut_Disable_Success (0.25s)
=== RUN   TestAPIAccountOTPPut_Enable_SetsSessionFlag
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000373] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ZOfzdKqG&redirect_uri=https%3A%2F%2Fwww.futureoptimize.biz%2Ffacilitate%2Fvertical%2Fenvisioneer&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=hItFTibA&nonce=fafvBKBg HTTP/1.1" from [::1]:59630 - 302 57B in 689.242Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000374] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59638 - 302 54B in 250.684Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000375] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59642 - 200 2949B in 355.131Âµs
2025/11/25 13:25:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":11646}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000376] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59642 - 302 0B in 36.278005ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000377] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59642 - 302 57B in 768.372Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000378] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59650 - 302 60B in 1.107383ms
2025/11/25 13:25:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":14002,"userId":11646}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000379] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59658 - 302 56B in 2.590665ms
2025/11/25 13:25:32 INFO {"audit_event":"created_auth_code","details":{"clientId":14002,"codeId":10786,"userId":11646}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000380] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59660 - 302 238B in 1.551902ms
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10786}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000381] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59668 - 200 4334B in 14.73966ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000382] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59674 - 200 696B in 654.747Âµs
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14003}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59676 - 200 1156B in 4.56221ms
2025/11/25 13:25:32 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-rnSyLfyG","userId":11646}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000384] "PUT http://localhost:19090/api/v1/admin/users/11646/password HTTP/1.1" from [::1]:59686 - 200 695B in 37.804902ms
2025/11/25 13:25:32 INFO {"audit_event":"enabled_otp","details":{"userId":11646}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000385] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59692 - 200 695B in 44.125704ms
--- PASS: TestAPIAccountOTPPut_Enable_SetsSessionFlag (0.23s)
=== RUN   TestAPIAccountOTPPut_Disable_SetsSessionFlag
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000386] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-cjTyNLGY&redirect_uri=https%3A%2F%2Fwww.principaldeploy.org%2Fnext-generation%2Fgranular%2Finfrastructures&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=rnDDTGWi&nonce=vHpkSAMI HTTP/1.1" from [::1]:59696 - 302 57B in 947.33Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000387] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59702 - 302 54B in 219.164Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000388] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59704 - 200 2949B in 305.628Âµs
2025/11/25 13:25:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":11647}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000389] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59704 - 302 0B in 37.657623ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000390] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59704 - 302 57B in 842.773Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000391] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59708 - 302 60B in 423.771Âµs
2025/11/25 13:25:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":14004,"userId":11647}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000392] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59720 - 302 56B in 2.639467ms
2025/11/25 13:25:32 INFO {"audit_event":"created_auth_code","details":{"clientId":14004,"codeId":10787,"userId":11647}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000393] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59722 - 302 248B in 1.643977ms
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10787}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000394] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59728 - 200 4330B in 14.564008ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000395] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59742 - 200 695B in 848.183Âµs
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14005}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000396] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59744 - 200 1156B in 4.453114ms
2025/11/25 13:25:32 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-HeBXleYC","userId":11647}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000397] "PUT http://localhost:19090/api/v1/admin/users/11647/password HTTP/1.1" from [::1]:59750 - 200 695B in 37.782068ms
2025/11/25 13:25:32 INFO {"audit_event":"disabled_otp","details":{"userId":11647}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000398] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59764 - 200 694B in 39.337297ms
--- PASS: TestAPIAccountOTPPut_Disable_SetsSessionFlag (0.23s)
=== RUN   TestAPIAccountOTPPut_Disable_NotEnabled
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000399] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-RcpPQOsy&redirect_uri=http%3A%2F%2Fwww.seniorreinvent.name%2Fe-tailers%2Frevolutionary&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=DRSUqoSv&nonce=oVXyWCum HTTP/1.1" from [::1]:59780 - 302 57B in 1.085351ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000400] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59796 - 302 54B in 303.814Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000401] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59806 - 200 2949B in 289.477Âµs
2025/11/25 13:25:32 INFO {"audit_event":"auth_success_pwd","details":{"userId":11648}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000402] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59806 - 302 0B in 36.605715ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000403] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59806 - 302 57B in 665.518Âµs
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000404] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59820 - 302 60B in 811.032Âµs
2025/11/25 13:25:32 INFO {"audit_event":"started_new_user_session","details":{"clientId":14006,"userId":11648}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000405] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59828 - 302 56B in 3.421264ms
2025/11/25 13:25:32 INFO {"audit_event":"created_auth_code","details":{"clientId":14006,"codeId":10788,"userId":11648}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000406] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59840 - 302 230B in 1.615052ms
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10788}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000407] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59842 - 200 4328B in 14.720995ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000408] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:59858 - 200 694B in 461.973Âµs
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14007}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000409] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59868 - 200 1156B in 5.10173ms
2025/11/25 13:25:32 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-NYpZVNXc","userId":11648}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000410] "PUT http://localhost:19090/api/v1/admin/users/11648/password HTTP/1.1" from [::1]:59880 - 200 694B in 42.858539ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000411] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59892 - 400 80B in 37.169751ms
--- PASS: TestAPIAccountOTPPut_Disable_NotEnabled (0.23s)
=== RUN   TestAPIAccountOTPPut_UnauthorizedAndScope
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000412] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59902 - 401 22B in 287.553Âµs
2025/11/25 13:25:32 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14008}}
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000413] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59910 - 200 1165B in 4.497588ms
2025/11/25 13:25:32 [a357f2e3b56e/a04mE72Kgg-000414] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:59920 - 403 19B in 552.143Âµs
--- PASS: TestAPIAccountOTPPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPasswordPut_Success
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000415] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-reNjGKds&redirect_uri=http%3A%2F%2Fwww.directe-business.com%2Fnetworks%2Fvortals%2Fmatrix%2Fembrace&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=TVvbHxEr&nonce=AyBYRRIp HTTP/1.1" from [::1]:59922 - 302 57B in 1.966866ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000416] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:59928 - 302 54B in 254.131Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000417] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59940 - 200 2949B in 359.108Âµs
2025/11/25 13:25:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":11649}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000418] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:59940 - 302 0B in 36.939015ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000419] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:59940 - 302 57B in 758.904Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000420] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:59954 - 302 60B in 426.826Âµs
2025/11/25 13:25:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":14009,"userId":11649}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000421] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:59962 - 302 56B in 2.497379ms
2025/11/25 13:25:33 INFO {"audit_event":"created_auth_code","details":{"clientId":14009,"codeId":10789,"userId":11649}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000422] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:59976 - 302 239B in 1.657672ms
2025/11/25 13:25:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10789}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000423] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:59982 - 200 4346B in 14.434564ms
2025/11/25 13:25:33 INFO {"audit_event":"changed_password","details":{"loggedInUser":"ccaecbd1-0258-45b0-9737-4a14b009012a","userId":11649}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000424] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:59998 - 200 703B in 73.064483ms
--- PASS: TestAPIAccountPasswordPut_Success (0.26s)
=== RUN   TestAPIAccountPasswordPut_WrongCurrentPassword
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000425] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-mJiawuhT&redirect_uri=https%3A%2F%2Fwww.customerrelationships.biz%2Fbenchmark%2Fgrow&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=EShJEMvv&nonce=FHvlWHLa HTTP/1.1" from [::1]:60008 - 302 57B in 1.467383ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000426] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60012 - 302 54B in 266.183Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000427] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60016 - 200 2949B in 388.955Âµs
2025/11/25 13:25:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":11650}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000428] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60016 - 302 0B in 36.099288ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000429] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60016 - 302 57B in 701.746Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000430] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60028 - 302 60B in 541.353Âµs
2025/11/25 13:25:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":14010,"userId":11650}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000431] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60042 - 302 56B in 2.602757ms
2025/11/25 13:25:33 INFO {"audit_event":"created_auth_code","details":{"clientId":14010,"codeId":10790,"userId":11650}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000432] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60052 - 302 228B in 2.902895ms
2025/11/25 13:25:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10790}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000433] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60068 - 200 4326B in 16.171626ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000434] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60078 - 400 121B in 36.922524ms
--- PASS: TestAPIAccountPasswordPut_WrongCurrentPassword (0.18s)
=== RUN   TestAPIAccountPasswordPut_ValidationErrors
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000435] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-gNViqXFJ&redirect_uri=https%3A%2F%2Fwww.principalrobust.org%2Frich%2Fsyndicate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=cSXXvPbk&nonce=NxDYbuPW HTTP/1.1" from [::1]:60080 - 302 57B in 951.067Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000436] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60088 - 302 54B in 259.08Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000437] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60096 - 200 2949B in 333.04Âµs
2025/11/25 13:25:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":11651}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000438] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60096 - 302 0B in 36.868261ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000439] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60096 - 302 57B in 616.866Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000440] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60104 - 302 60B in 453.537Âµs
2025/11/25 13:25:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":14011,"userId":11651}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000441] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60116 - 302 56B in 2.389354ms
2025/11/25 13:25:33 INFO {"audit_event":"created_auth_code","details":{"clientId":14011,"codeId":10791,"userId":11651}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000442] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60126 - 302 222B in 2.763933ms
2025/11/25 13:25:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10791}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000443] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60140 - 200 4346B in 16.050347ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000444] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60152 - 400 89B in 724.719Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000445] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60168 - 400 77B in 598.26Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000446] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60184 - 400 102B in 38.447375ms
--- PASS: TestAPIAccountPasswordPut_ValidationErrors (0.18s)
=== RUN   TestAPIAccountPasswordPut_UnauthorizedAndScope
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000447] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60200 - 401 22B in 282.032Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000448] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60208 - 401 22B in 528.619Âµs
2025/11/25 13:25:33 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14012}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000449] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60218 - 200 1165B in 4.770855ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000450] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60232 - 403 19B in 369.318Âµs
--- PASS: TestAPIAccountPasswordPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPasswordPut_InvalidRequestBody
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000451] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-visjurNS&redirect_uri=https%3A%2F%2Fwww.centralmarkets.name%2Fextensible%2Fredefine%2Fmethodologies&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=jWGCswsl&nonce=lYsffdmP HTTP/1.1" from [::1]:60248 - 302 57B in 945.787Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000452] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60258 - 302 54B in 188.486Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000453] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60264 - 200 2949B in 304.916Âµs
2025/11/25 13:25:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":11652}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000454] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60264 - 302 0B in 37.057759ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000455] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60264 - 302 57B in 550.961Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000456] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60274 - 302 60B in 506.817Âµs
2025/11/25 13:25:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":14013,"userId":11652}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000457] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60276 - 302 56B in 3.135405ms
2025/11/25 13:25:33 INFO {"audit_event":"created_auth_code","details":{"clientId":14013,"codeId":10792,"userId":11652}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000458] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60280 - 302 241B in 2.684041ms
2025/11/25 13:25:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10792}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000459] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60282 - 200 4334B in 17.308924ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000460] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:60288 - 400 75B in 523.028Âµs
--- PASS: TestAPIAccountPasswordPut_InvalidRequestBody (0.11s)
=== RUN   TestAPIAccountPhonePut_Success
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000461] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-eUwZPAYy&redirect_uri=https%3A%2F%2Fwww.customerdeploy.com%2Fexperiences%2Fsupply-chains%2Feyeballs%2Finnovative&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=jsYKHAlj&nonce=uoNOtjNT HTTP/1.1" from [::1]:60290 - 302 57B in 1.112762ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000462] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60306 - 302 54B in 280.92Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000463] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60318 - 200 2949B in 481.7Âµs
2025/11/25 13:25:33 INFO {"audit_event":"auth_success_pwd","details":{"userId":11653}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000464] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60318 - 302 0B in 36.720021ms
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000465] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60318 - 302 57B in 676.769Âµs
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000466] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60322 - 302 60B in 606.116Âµs
2025/11/25 13:25:33 INFO {"audit_event":"started_new_user_session","details":{"clientId":14014,"userId":11653}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000467] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60334 - 302 56B in 2.516405ms
2025/11/25 13:25:33 INFO {"audit_event":"created_auth_code","details":{"clientId":14014,"codeId":10793,"userId":11653}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000468] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60342 - 302 252B in 2.424621ms
2025/11/25 13:25:33 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10793}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000469] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60352 - 200 4352B in 16.617388ms
2025/11/25 13:25:33 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"922486ae-37f2-45d4-950b-eb8fd9b06b91","userId":11653}}
2025/11/25 13:25:33 [a357f2e3b56e/a04mE72Kgg-000470] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:60368 - 200 725B in 137.349016ms
--- PASS: TestAPIAccountPhonePut_Success (0.25s)
=== RUN   TestAPIAccountPhonePut_ClearPhone
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000471] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-dLUxQvTs&redirect_uri=https%3A%2F%2Fwww.customercompelling.biz%2Fvisionary&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ZKXaTimL&nonce=hJCVDlZC HTTP/1.1" from [::1]:60382 - 302 57B in 1.098406ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000472] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60396 - 302 54B in 232.549Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000473] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60406 - 200 2949B in 374.167Âµs
2025/11/25 13:25:34 INFO {"audit_event":"auth_success_pwd","details":{"userId":11654}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000474] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60406 - 302 0B in 35.860938ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000475] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60406 - 302 57B in 625.341Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000476] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60410 - 302 60B in 1.321848ms
2025/11/25 13:25:34 INFO {"audit_event":"started_new_user_session","details":{"clientId":14015,"userId":11654}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000477] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60416 - 302 56B in 2.749264ms
2025/11/25 13:25:34 INFO {"audit_event":"created_auth_code","details":{"clientId":14015,"codeId":10794,"userId":11654}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000478] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60424 - 302 220B in 1.692248ms
2025/11/25 13:25:34 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10794}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000479] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60426 - 200 4326B in 14.16292ms
2025/11/25 13:25:34 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"b9f364e4-a608-41b8-8e1e-dbb5b769b3ab","userId":11654}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000480] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:60428 - 200 715B in 135.338908ms
2025/11/25 13:25:34 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"b9f364e4-a608-41b8-8e1e-dbb5b769b3ab","userId":11654}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000481] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:60434 - 200 696B in 2.149471ms
--- PASS: TestAPIAccountPhonePut_ClearPhone (0.24s)
=== RUN   TestAPIAccountPhonePut_ValidationErrors
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000482] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-xJHdzOJl&redirect_uri=http%3A%2F%2Fwww.futurestrategic.info%2Fexpedite%2Fout-of-the-box%2Fclicks-and-mortar&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=KTeVkSAF&nonce=NkutsmDQ HTTP/1.1" from [::1]:60444 - 302 57B in 1.012252ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000483] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:60446 - 302 54B in 316.859Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000484] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60462 - 200 2949B in 305.458Âµs
2025/11/25 13:25:34 INFO {"audit_event":"auth_success_pwd","details":{"userId":11655}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000485] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:60462 - 302 0B in 35.865216ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000486] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:60462 - 302 57B in 497.269Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000487] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:60472 - 302 60B in 613.83Âµs
2025/11/25 13:25:34 INFO {"audit_event":"started_new_user_session","details":{"clientId":14016,"userId":11655}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000488] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:60486 - 302 56B in 2.380689ms
2025/11/25 13:25:34 INFO {"audit_event":"created_auth_code","details":{"clientId":14016,"codeId":10795,"userId":11655}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000489] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:60494 - 302 249B in 1.504403ms
2025/11/25 13:25:34 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10795}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000490] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60504 - 200 4338B in 14.653126ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000491] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:60516 - 400 99B in 649.057Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000492] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:60526 - 400 266B in 62.716501ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000493] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:43194 - 400 99B in 65.935332ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000494] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:43202 - 400 114B in 64.442722ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000495] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:43208 - 400 174B in 64.881321ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000496] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:43222 - 400 76B in 69.847785ms
--- PASS: TestAPIAccountPhonePut_ValidationErrors (0.43s)
=== RUN   TestAPIAccountPhonePut_UnauthorizedAndScope
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000497] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:43236 - 401 22B in 752.542Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000498] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:43246 - 401 22B in 768.031Âµs
2025/11/25 13:25:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14017}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000499] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43252 - 200 1165B in 5.15503ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000500] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:43264 - 403 19B in 412.269Âµs
--- PASS: TestAPIAccountPhonePut_UnauthorizedAndScope (0.02s)
=== RUN   TestAPIAccountPhonePut_InvalidRequestBody
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000501] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-iJJzvZWi&redirect_uri=https%3A%2F%2Fwww.internaldeliverables.org%2Fmatrix%2Fparadigms&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=aalXLtxv&nonce=YhuYNILk HTTP/1.1" from [::1]:43274 - 302 57B in 1.146747ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000502] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43286 - 302 54B in 246.526Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000503] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43298 - 200 2949B in 411.357Âµs
2025/11/25 13:25:34 INFO {"audit_event":"auth_success_pwd","details":{"userId":11656}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000504] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43298 - 302 0B in 36.517409ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000505] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43298 - 302 57B in 788.54Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000506] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43314 - 302 60B in 583.252Âµs
2025/11/25 13:25:34 INFO {"audit_event":"started_new_user_session","details":{"clientId":14018,"userId":11656}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000507] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43322 - 302 56B in 2.597478ms
2025/11/25 13:25:34 INFO {"audit_event":"created_auth_code","details":{"clientId":14018,"codeId":10796,"userId":11656}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000508] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43324 - 302 229B in 1.598901ms
2025/11/25 13:25:34 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10796}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000509] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43328 - 200 4330B in 14.597772ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000510] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:43338 - 400 75B in 539.88Âµs
--- PASS: TestAPIAccountPhonePut_InvalidRequestBody (0.11s)
=== RUN   TestAPIAccountProfileGet_Success
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000511] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-meMBdUBY&redirect_uri=https%3A%2F%2Fwww.centralrevolutionize.io%2Fmindshare%2Fmaximize%2Fvisualize%2Finitiatives&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=APWWRkEI&nonce=RdmJEpZl HTTP/1.1" from [::1]:43350 - 302 57B in 1.653544ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000512] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43352 - 302 54B in 259.21Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000513] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43356 - 200 2949B in 333.109Âµs
2025/11/25 13:25:34 INFO {"audit_event":"auth_success_pwd","details":{"userId":11657}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000514] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43356 - 302 0B in 35.88301ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000515] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43356 - 302 57B in 663.654Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000516] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43362 - 302 60B in 703.719Âµs
2025/11/25 13:25:34 INFO {"audit_event":"started_new_user_session","details":{"clientId":14019,"userId":11657}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000517] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43366 - 302 56B in 2.591967ms
2025/11/25 13:25:34 INFO {"audit_event":"created_auth_code","details":{"clientId":14019,"codeId":10797,"userId":11657}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000518] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43378 - 302 252B in 2.53488ms
2025/11/25 13:25:34 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10797}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000519] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43384 - 200 4344B in 14.532789ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000520] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43386 - 200 700B in 571.339Âµs
--- PASS: TestAPIAccountProfileGet_Success (0.10s)
=== RUN   TestAPIAccountProfileGet_UnauthorizedAndScope
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000521] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43392 - 401 22B in 140.195Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000522] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43400 - 401 22B in 295.919Âµs
2025/11/25 13:25:34 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14020}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000523] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43410 - 200 1165B in 4.382551ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000524] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43414 - 403 19B in 364.239Âµs
--- PASS: TestAPIAccountProfileGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountProfilePut_Success
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000525] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-tJMscvFn&redirect_uri=http%3A%2F%2Fwww.investorwhiteboard.com%2Fengage%2Fdrive&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=aSZHhKPR&nonce=LMufWSTe HTTP/1.1" from [::1]:43424 - 302 57B in 1.527045ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000526] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43438 - 302 54B in 238.35Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000527] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43450 - 200 2949B in 323.562Âµs
2025/11/25 13:25:34 INFO {"audit_event":"auth_success_pwd","details":{"userId":11658}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000528] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43450 - 302 0B in 36.235625ms
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000529] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43450 - 302 57B in 526.144Âµs
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000530] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43456 - 302 60B in 393.694Âµs
2025/11/25 13:25:34 INFO {"audit_event":"started_new_user_session","details":{"clientId":14021,"userId":11658}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000531] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43462 - 302 56B in 2.355301ms
2025/11/25 13:25:34 INFO {"audit_event":"created_auth_code","details":{"clientId":14021,"codeId":10798,"userId":11658}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000532] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43468 - 302 222B in 1.579534ms
2025/11/25 13:25:34 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10798}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000533] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43484 - 200 4352B in 14.449763ms
2025/11/25 13:25:34 INFO {"audit_event":"updated_own_profile","details":{"loggedInUser":"4b6b1ec2-0356-4c1e-8a7c-ebc9396177fd","userId":11658}}
2025/11/25 13:25:34 [a357f2e3b56e/a04mE72Kgg-000534] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43490 - 200 808B in 7.655365ms
--- PASS: TestAPIAccountProfilePut_Success (0.11s)
=== RUN   TestAPIAccountProfilePut_ValidationErrors
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000535] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-RLdlQjTx&redirect_uri=https%3A%2F%2Fwww.chiefdisintermediate.info%2Forchestrate%2Frich&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=KlmxfNyZ&nonce=xhEchrxf HTTP/1.1" from [::1]:43498 - 302 57B in 897.576Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000536] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43512 - 302 54B in 224.695Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000537] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43526 - 200 2949B in 306.168Âµs
2025/11/25 13:25:35 INFO worker task started
2025/11/25 13:25:35 INFO deleted expired or revoked refresh tokens
2025/11/25 13:25:35 INFO deleted used codes without refresh tokens
2025/11/25 13:25:35 INFO {"audit_event":"auth_success_pwd","details":{"userId":11659}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000538] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43526 - 302 0B in 35.702268ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000539] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43526 - 302 57B in 1.537215ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000540] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43542 - 302 60B in 438.639Âµs
2025/11/25 13:25:35 INFO deleted idle sessions (idle timeout: 3600 seconds)
2025/11/25 13:25:35 INFO {"audit_event":"started_new_user_session","details":{"clientId":14022,"userId":11659}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000541] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43558 - 302 56B in 2.456972ms
2025/11/25 13:25:35 INFO deleted expired sessions (max lifetime: 7200 seconds)
2025/11/25 13:25:35 INFO worker task completed
2025/11/25 13:25:35 INFO {"audit_event":"created_auth_code","details":{"clientId":14022,"codeId":10799,"userId":11659}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000542] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43564 - 302 230B in 2.993756ms
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10799}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000543] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43572 - 200 4328B in 14.871941ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000544] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43584 - 400 69B in 1.29658ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000545] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43592 - 400 114B in 1.427087ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000546] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43606 - 400 76B in 1.61461ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000547] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43622 - 400 73B in 1.68292ms
--- PASS: TestAPIAccountProfilePut_ValidationErrors (0.11s)
=== RUN   TestAPIAccountProfilePut_UnauthorizedAndScope
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000548] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43636 - 401 22B in 228.421Âµs
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14023}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000549] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43650 - 200 1165B in 4.648353ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000550] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43658 - 403 19B in 334.282Âµs
--- PASS: TestAPIAccountProfilePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountSessionsGet_Success_IncludesIsCurrent
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000551] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-GtNPvrAl&redirect_uri=http%3A%2F%2Fwww.futuredot-com.info%2Fbandwidth&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=NHkqBSfE&nonce=ZlEiDKQF HTTP/1.1" from [::1]:43664 - 302 57B in 1.046768ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000552] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43672 - 302 54B in 234.503Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000553] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43680 - 200 2949B in 327.189Âµs
2025/11/25 13:25:35 INFO {"audit_event":"auth_success_pwd","details":{"userId":11660}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000554] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43680 - 302 0B in 35.328071ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000555] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43680 - 302 57B in 550.951Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000556] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43688 - 302 60B in 505.084Âµs
2025/11/25 13:25:35 INFO {"audit_event":"started_new_user_session","details":{"clientId":14024,"userId":11660}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000557] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43690 - 302 56B in 2.628807ms
2025/11/25 13:25:35 INFO {"audit_event":"created_auth_code","details":{"clientId":14024,"codeId":10800,"userId":11660}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000558] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43706 - 302 215B in 2.80513ms
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10800}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000559] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43712 - 200 4328B in 15.735672ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000560] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43722 - 200 2181B in 1.740299ms
--- PASS: TestAPIAccountSessionsGet_Success_IncludesIsCurrent (0.13s)
=== RUN   TestAPIAccountSessionsGet_OnlyValidSessions
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000561] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-XWIEoNgD&redirect_uri=http%3A%2F%2Fwww.internationalsynergies.io%2Froi%2Fholistic%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=FcwtqKJC&nonce=IZvOMOGs HTTP/1.1" from [::1]:43734 - 302 57B in 1.588311ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000562] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43748 - 302 54B in 345.583Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000563] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43750 - 200 2949B in 337.278Âµs
2025/11/25 13:25:35 INFO {"audit_event":"auth_success_pwd","details":{"userId":11661}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000564] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43750 - 302 0B in 35.584175ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000565] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43750 - 302 57B in 473.014Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000566] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43764 - 302 60B in 537.516Âµs
2025/11/25 13:25:35 INFO {"audit_event":"started_new_user_session","details":{"clientId":14026,"userId":11661}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000567] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43776 - 302 56B in 2.400004ms
2025/11/25 13:25:35 INFO {"audit_event":"created_auth_code","details":{"clientId":14026,"codeId":10801,"userId":11661}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000568] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43792 - 302 233B in 2.909548ms
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10801}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000569] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43802 - 200 4330B in 16.39612ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000570] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43816 - 200 1437B in 1.027171ms
--- PASS: TestAPIAccountSessionsGet_OnlyValidSessions (0.11s)
=== RUN   TestAPIAccountSessionDelete_Success
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000571] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-phIORPLT&redirect_uri=http%3A%2F%2Fwww.internationale-business.name%2Frecontextualize%2Frich%2Fturn-key&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=MjuwZoQI&nonce=KnOntkft HTTP/1.1" from [::1]:43828 - 302 57B in 999.218Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000572] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43842 - 302 54B in 854.003Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000573] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43858 - 200 2949B in 649.237Âµs
2025/11/25 13:25:35 INFO {"audit_event":"auth_success_pwd","details":{"userId":11662}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000574] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43858 - 302 0B in 35.710775ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000575] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43858 - 302 57B in 622.146Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000576] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43866 - 302 60B in 811.042Âµs
2025/11/25 13:25:35 INFO {"audit_event":"started_new_user_session","details":{"clientId":14027,"userId":11662}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000577] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43868 - 302 56B in 2.512187ms
2025/11/25 13:25:35 INFO {"audit_event":"created_auth_code","details":{"clientId":14027,"codeId":10802,"userId":11662}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000578] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43872 - 302 245B in 1.559046ms
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10802}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000579] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43876 - 200 4342B in 14.359722ms
2025/11/25 13:25:35 INFO {"audit_event":"deleted_user_session","details":{"loggedInUser":"","userSessionId":11723}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000580] "DELETE http://localhost:19090/api/v1/account/sessions/11723 HTTP/1.1" from [::1]:43878 - 200 17B in 3.774682ms
--- PASS: TestAPIAccountSessionDelete_Success (0.11s)
=== RUN   TestAPIAccountSessionDelete_ForbiddenOnOtherUsersSession
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000581] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-IlnAzMuO&redirect_uri=https%3A%2F%2Fwww.globalproductize.io%2Fe-markets%2Fembrace&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ogjPTUaS&nonce=eKJYrmvY HTTP/1.1" from [::1]:43894 - 302 57B in 1.098645ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000582] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43902 - 302 54B in 250.974Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000583] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43908 - 200 2949B in 340.633Âµs
2025/11/25 13:25:35 INFO {"audit_event":"auth_success_pwd","details":{"userId":11663}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000584] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43908 - 302 0B in 36.935809ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000585] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43908 - 302 57B in 1.151676ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000586] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43916 - 302 60B in 638.787Âµs
2025/11/25 13:25:35 INFO {"audit_event":"started_new_user_session","details":{"clientId":14028,"userId":11663}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000587] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43932 - 302 56B in 2.40767ms
2025/11/25 13:25:35 INFO {"audit_event":"created_auth_code","details":{"clientId":14028,"codeId":10803,"userId":11663}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000588] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43946 - 302 225B in 3.081943ms
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10803}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000589] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43954 - 200 4334B in 18.157127ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000590] "DELETE http://localhost:19090/api/v1/account/sessions/11725 HTTP/1.1" from [::1]:43956 - 403 53B in 657.612Âµs
--- PASS: TestAPIAccountSessionDelete_ForbiddenOnOtherUsersSession (0.12s)
=== RUN   TestAPIAccountSessions_UnauthorizedAndScope
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000591] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43970 - 401 22B in 172.135Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000592] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43976 - 401 22B in 304.656Âµs
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14029}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000593] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43978 - 200 1165B in 4.435671ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000594] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43980 - 403 19B in 460.61Âµs
--- PASS: TestAPIAccountSessions_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountSessionDelete_UnauthorizedAndInvalidId
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000595] "DELETE http://localhost:19090/api/v1/account/sessions/123 HTTP/1.1" from [::1]:43996 - 401 22B in 136.718Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000596] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-TcOefbqb&redirect_uri=http%3A%2F%2Fwww.chiefscalable.name%2Frecontextualize%2Fb2b%2Fmatrix%2Fproductize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=GbrZhZMF&nonce=fSycanTJ HTTP/1.1" from [::1]:43998 - 302 57B in 762.771Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000597] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:44006 - 302 54B in 247.207Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000598] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44014 - 200 2949B in 320.185Âµs
2025/11/25 13:25:35 INFO {"audit_event":"auth_success_pwd","details":{"userId":11665}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000599] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44014 - 302 0B in 35.667733ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000600] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:44014 - 302 57B in 1.043862ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000601] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:44026 - 302 60B in 461.993Âµs
2025/11/25 13:25:35 INFO {"audit_event":"started_new_user_session","details":{"clientId":14030,"userId":11665}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000602] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:44028 - 302 56B in 2.409983ms
2025/11/25 13:25:35 INFO {"audit_event":"created_auth_code","details":{"clientId":14030,"codeId":10804,"userId":11665}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000603] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:44034 - 302 243B in 2.937891ms
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10804}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000604] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44042 - 200 4328B in 16.806595ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000605] "DELETE http://localhost:19090/api/v1/account/sessions/abc HTTP/1.1" from [::1]:44050 - 400 86B in 424.843Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000606] "DELETE http://localhost:19090/api/v1/account/sessions/-1 HTTP/1.1" from [::1]:44052 - 400 86B in 349.009Âµs
--- PASS: TestAPIAccountSessionDelete_UnauthorizedAndInvalidId (0.11s)
=== RUN   TestAPIAccountSessionDelete_NotFound
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000607] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-NzyYTQGS&redirect_uri=http%3A%2F%2Fwww.dynamic24-7.org%2Fexpedite%2Fharness%2Fbest-of-breed&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JjRGxNTj&nonce=sLqyZANM HTTP/1.1" from [::1]:44058 - 302 57B in 1.253338ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000608] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:44072 - 302 54B in 286.882Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000609] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44078 - 200 2949B in 389.887Âµs
2025/11/25 13:25:35 INFO {"audit_event":"auth_success_pwd","details":{"userId":11666}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000610] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44078 - 302 0B in 37.265512ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000611] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:44078 - 302 57B in 769.955Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000612] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:44092 - 302 60B in 560.048Âµs
2025/11/25 13:25:35 INFO {"audit_event":"started_new_user_session","details":{"clientId":14031,"userId":11666}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000613] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:44106 - 302 56B in 3.371611ms
2025/11/25 13:25:35 INFO {"audit_event":"created_auth_code","details":{"clientId":14031,"codeId":10805,"userId":11666}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000614] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:44116 - 302 233B in 1.841138ms
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10805}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000615] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44120 - 200 4344B in 14.768374ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000616] "DELETE http://localhost:19090/api/v1/account/sessions/99999999 HTTP/1.1" from [::1]:44126 - 404 79B in 553.666Âµs
--- PASS: TestAPIAccountSessionDelete_NotFound (0.11s)
=== RUN   TestAPIClientPermissions_Get_Success
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14032}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000617] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44134 - 200 1156B in 4.479574ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000618] "GET http://localhost:19090/api/v1/admin/clients/14033/permissions HTTP/1.1" from [::1]:44146 - 200 737B in 998.847Âµs
--- PASS: TestAPIClientPermissions_Get_Success (0.02s)
=== RUN   TestAPIClientPermissions_Get_Errors
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14034}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000619] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44162 - 200 1156B in 4.3925ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000620] "GET http://localhost:19090/api/v1/admin/clients/abc/permissions HTTP/1.1" from [::1]:44164 - 400 75B in 363.617Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000621] "GET http://localhost:19090/api/v1/admin/clients/9999999/permissions HTTP/1.1" from [::1]:44172 - 404 60B in 543.627Âµs
--- PASS: TestAPIClientPermissions_Get_Errors (0.01s)
=== RUN   TestAPIClientPermissions_Put_AddRemove
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14035}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000622] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44186 - 200 1156B in 4.426564ms
2025/11/25 13:25:35 INFO {"audit_event":"updated_client_permissions","details":{"clientId":14036,"loggedInUser":""}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000623] "PUT http://localhost:19090/api/v1/admin/clients/14036/permissions HTTP/1.1" from [::1]:44202 - 200 17B in 2.44023ms
2025/11/25 13:25:35 INFO {"audit_event":"updated_client_permissions","details":{"clientId":14036,"loggedInUser":""}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000624] "PUT http://localhost:19090/api/v1/admin/clients/14036/permissions HTTP/1.1" from [::1]:44214 - 200 17B in 3.946818ms
--- PASS: TestAPIClientPermissions_Put_AddRemove (0.02s)
=== RUN   TestAPIClientPermissions_Put_Idempotent
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14037}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000625] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44218 - 200 1156B in 4.407137ms
2025/11/25 13:25:35 INFO {"audit_event":"updated_client_permissions","details":{"clientId":14038,"loggedInUser":""}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000626] "PUT http://localhost:19090/api/v1/admin/clients/14038/permissions HTTP/1.1" from [::1]:44230 - 200 17B in 1.787788ms
2025/11/25 13:25:35 INFO {"audit_event":"updated_client_permissions","details":{"clientId":14038,"loggedInUser":""}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000627] "PUT http://localhost:19090/api/v1/admin/clients/14038/permissions HTTP/1.1" from [::1]:44234 - 200 17B in 670.347Âµs
--- PASS: TestAPIClientPermissions_Put_Idempotent (0.02s)
=== RUN   TestAPIClientPermissions_Unauthorized
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000628] "GET http://localhost:19090/api/v1/admin/clients/14039/permissions HTTP/1.1" from [::1]:44250 - 401 22B in 182.866Âµs
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000629] "PUT http://localhost:19090/api/v1/admin/clients/14039/permissions HTTP/1.1" from [::1]:44250 - 401 22B in 132.069Âµs
--- PASS: TestAPIClientPermissions_Unauthorized (0.00s)
=== RUN   TestAPIClientPermissions_Put_ClientCredentialsDisabled
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14040}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000630] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44266 - 200 1156B in 7.140141ms
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000631] "PUT http://localhost:19090/api/v1/admin/clients/14041/permissions HTTP/1.1" from [::1]:44268 - 400 132B in 584.064Âµs
--- PASS: TestAPIClientPermissions_Put_ClientCredentialsDisabled (0.02s)
=== RUN   TestAPIClientPermissions_Put_SystemLevelRejected
2025/11/25 13:25:35 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14042}}
2025/11/25 13:25:35 [a357f2e3b56e/a04mE72Kgg-000632] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44282 - 200 1156B in 4.559786ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000633] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44286 - 200 2259684B in 412.766878ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000634] "PUT http://localhost:19090/api/v1/admin/clients/1/permissions HTTP/1.1" from [::1]:44296 - 400 87B in 842.051Âµs
--- PASS: TestAPIClientPermissions_Put_SystemLevelRejected (0.43s)
=== RUN   TestAPIClientPermissions_Put_PermissionNotFound
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14043}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000635] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44304 - 200 1156B in 4.96974ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000636] "PUT http://localhost:19090/api/v1/admin/clients/14044/permissions HTTP/1.1" from [::1]:44308 - 404 64B in 857.981Âµs
--- PASS: TestAPIClientPermissions_Put_PermissionNotFound (0.02s)
=== RUN   TestAPIClientPermissions_Put_InsufficientScope
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14045}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000637] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44320 - 200 1160B in 4.536762ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000638] "PUT http://localhost:19090/api/v1/admin/clients/14046/permissions HTTP/1.1" from [::1]:44332 - 403 19B in 406.197Âµs
--- PASS: TestAPIClientPermissions_Put_InsufficientScope (0.01s)
=== RUN   TestAPIClientAuthenticationPut_ConfidentialToPublic_Success
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14047}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000639] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44348 - 200 1156B in 4.665576ms
2025/11/25 13:25:36 INFO {"audit_event":"updated_client_authentication","details":{"clientId":14048,"loggedInUser":""}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000640] "PUT http://localhost:19090/api/v1/admin/clients/14048/authentication HTTP/1.1" from [::1]:44350 - 200 560B in 3.406577ms
--- PASS: TestAPIClientAuthenticationPut_ConfidentialToPublic_Success (0.02s)
=== RUN   TestAPIClientAuthenticationPut_PublicToConfidential_Success
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14049}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000641] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44354 - 200 1156B in 4.671156ms
2025/11/25 13:25:36 INFO {"audit_event":"updated_client_authentication","details":{"clientId":14050,"loggedInUser":""}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000642] "PUT http://localhost:19090/api/v1/admin/clients/14050/authentication HTTP/1.1" from [::1]:44366 - 200 559B in 3.068798ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000643] "GET http://localhost:19090/api/v1/admin/clients/14050 HTTP/1.1" from [::1]:44380 - 200 634B in 575.026Âµs
--- PASS: TestAPIClientAuthenticationPut_PublicToConfidential_Success (0.02s)
=== RUN   TestAPIClientAuthenticationPut_InvalidSecret_TooShort
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14051}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000644] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44384 - 200 1156B in 4.254899ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000645] "PUT http://localhost:19090/api/v1/admin/clients/14052/authentication HTTP/1.1" from [::1]:44388 - 400 100B in 584.484Âµs
--- PASS: TestAPIClientAuthenticationPut_InvalidSecret_TooShort (0.01s)
=== RUN   TestAPIClientAuthenticationPut_InvalidSecret_BadChars
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14053}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000646] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44394 - 200 1156B in 4.595633ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000647] "PUT http://localhost:19090/api/v1/admin/clients/14054/authentication HTTP/1.1" from [::1]:44402 - 400 100B in 611.475Âµs
--- PASS: TestAPIClientAuthenticationPut_InvalidSecret_BadChars (0.01s)
=== RUN   TestAPIClientAuthenticationPut_NotFoundAndInvalidId
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14055}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000648] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44406 - 200 1156B in 4.29758ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000649] "PUT http://localhost:19090/api/v1/admin/clients/999999/authentication HTTP/1.1" from [::1]:44412 - 404 60B in 366.813Âµs
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000650] "PUT http://localhost:19090/api/v1/admin/clients/abc/authentication HTTP/1.1" from [::1]:44416 - 400 68B in 304.255Âµs
--- PASS: TestAPIClientAuthenticationPut_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientAuthenticationPut_SystemLevelClientRejected
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14056}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000651] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44432 - 200 1156B in 4.395234ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000652] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44444 - 200 2263532B in 455.194013ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000653] "PUT http://localhost:19090/api/v1/admin/clients/1/authentication HTTP/1.1" from [::1]:44458 - 400 87B in 939.876Âµs
--- PASS: TestAPIClientAuthenticationPut_SystemLevelClientRejected (0.48s)
=== RUN   TestAPIClientAuthenticationPut_InsufficientScope
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14057}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000654] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44466 - 200 1154B in 5.686805ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000655] "PUT http://localhost:19090/api/v1/admin/clients/14058/authentication HTTP/1.1" from [::1]:44482 - 403 19B in 411.327Âµs
--- PASS: TestAPIClientAuthenticationPut_InsufficientScope (0.02s)
=== RUN   TestAPIClientCreate_Success
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14059}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000656] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44496 - 200 1156B in 4.52499ms
2025/11/25 13:25:36 INFO {"audit_event":"created_client","details":{"clientId":14060,"clientIdentifier":"client-bjrlviob","loggedInUser":""}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000657] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44500 - 201 602B in 3.437194ms
--- PASS: TestAPIClientCreate_Success (0.01s)
=== RUN   TestAPIClientCreate_Validation
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14061}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000658] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44502 - 200 1156B in 5.32979ms
=== RUN   TestAPIClientCreate_Validation/Empty_client_identifier
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000659] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44518 - 400 81B in 418.231Âµs
=== RUN   TestAPIClientCreate_Validation/Client_identifier_too_short
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000660] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44528 - 400 101B in 315.826Âµs
=== RUN   TestAPIClientCreate_Validation/Client_identifier_too_long
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000661] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44540 - 400 114B in 308.604Âµs
=== RUN   TestAPIClientCreate_Validation/Invalid_client_identifier_characters
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000662] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44550 - 400 250B in 293.875Âµs
=== RUN   TestAPIClientCreate_Validation/Description_too_long
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000663] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44560 - 400 116B in 373.295Âµs
--- PASS: TestAPIClientCreate_Validation (0.01s)
    --- PASS: TestAPIClientCreate_Validation/Empty_client_identifier (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Client_identifier_too_short (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Client_identifier_too_long (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Invalid_client_identifier_characters (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Description_too_long (0.00s)
=== RUN   TestAPIClientCreate_Duplicate
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14062}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000664] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44576 - 200 1156B in 4.307278ms
2025/11/25 13:25:36 INFO {"audit_event":"created_client","details":{"clientId":14063,"clientIdentifier":"client-xxuxacdr","loggedInUser":""}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000665] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44582 - 201 597B in 2.570918ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000666] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44590 - 400 91B in 400.587Âµs
--- PASS: TestAPIClientCreate_Duplicate (0.01s)
=== RUN   TestAPIClientCreate_Unauthorized
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000667] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44596 - 401 22B in 115.077Âµs
--- PASS: TestAPIClientCreate_Unauthorized (0.00s)
=== RUN   TestAPIClientCreate_InsufficientScope
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14064}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000668] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44598 - 200 1157B in 5.088384ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000669] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44614 - 403 19B in 429.432Âµs
--- PASS: TestAPIClientCreate_InsufficientScope (0.01s)
=== RUN   TestAPIClientDelete_Success
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14065}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000670] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44620 - 200 1156B in 4.421544ms
2025/11/25 13:25:36 INFO {"audit_event":"deleted_client","details":{"clientId":14066,"clientIdentifier":"del-client-SYkVRScg","loggedInUser":""}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000671] "DELETE http://localhost:19090/api/v1/admin/clients/14066 HTTP/1.1" from [::1]:44636 - 200 17B in 3.523688ms
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000672] "GET http://localhost:19090/api/v1/admin/clients/14066 HTTP/1.1" from [::1]:44640 - 404 60B in 473.705Âµs
--- PASS: TestAPIClientDelete_Success (0.01s)
=== RUN   TestAPIClientDelete_SystemLevelRejected
2025/11/25 13:25:36 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14067}}
2025/11/25 13:25:36 [a357f2e3b56e/a04mE72Kgg-000673] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44648 - 200 1156B in 4.354647ms
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000674] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44658 - 200 2267990B in 478.015473ms
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000675] "DELETE http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44674 - 400 89B in 1.036588ms
--- PASS: TestAPIClientDelete_SystemLevelRejected (0.50s)
=== RUN   TestAPIClientDelete_NotFoundAndInvalidId
2025/11/25 13:25:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14068}}
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000676] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44688 - 200 1156B in 5.578921ms
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000677] "DELETE http://localhost:19090/api/v1/admin/clients/9999999 HTTP/1.1" from [::1]:44704 - 404 60B in 825.63Âµs
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000678] "DELETE http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:44720 - 400 68B in 531.233Âµs
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000679] "DELETE http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44724 - 401 22B in 130.266Âµs
--- PASS: TestAPIClientDelete_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientGetPermissions_IncludesPermissions
2025/11/25 13:25:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14069}}
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000680] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44728 - 200 1156B in 4.718876ms
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000681] "GET http://localhost:19090/api/v1/admin/clients/14070/permissions HTTP/1.1" from [::1]:44738 - 200 738B in 1.043702ms
--- PASS: TestAPIClientGetPermissions_IncludesPermissions (0.02s)
=== RUN   TestAPIClientDelete_InsufficientScope
2025/11/25 13:25:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14071}}
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000682] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44744 - 200 1157B in 4.432074ms
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000683] "DELETE http://localhost:19090/api/v1/admin/clients/14072 HTTP/1.1" from [::1]:44748 - 403 19B in 592.309Âµs
--- PASS: TestAPIClientDelete_InsufficientScope (0.01s)
=== RUN   TestAPIClientDelete_CascadesLinkedData
2025/11/25 13:25:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14073}}
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000684] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44762 - 200 1156B in 4.64663ms
2025/11/25 13:25:37 INFO {"audit_event":"deleted_client","details":{"clientId":14074,"clientIdentifier":"cascade-client-Kohypt","loggedInUser":""}}
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000685] "DELETE http://localhost:19090/api/v1/admin/clients/14074 HTTP/1.1" from [::1]:44776 - 200 17B in 3.18082ms
--- PASS: TestAPIClientDelete_CascadesLinkedData (0.02s)
=== RUN   TestAPIClientGet_ConfidentialIncludesSecretInDetailButNotList
2025/11/25 13:25:37 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14075}}
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000686] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44780 - 200 1156B in 4.755936ms
2025/11/25 13:25:37 [a357f2e3b56e/a04mE72Kgg-000687] "GET http://localhost:19090/api/v1/admin/clients/14076 HTTP/1.1" from [::1]:44782 - 200 607B in 637.865Âµs
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000688] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44786 - 200 2270736B in 473.97029ms
--- PASS: TestAPIClientGet_ConfidentialIncludesSecretInDetailButNotList (0.50s)
=== RUN   TestAPIClientOAuth2FlowsPut_Success_PublicClient_ForcesNoClientCredentials
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14077}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000689] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44792 - 200 1156B in 4.754814ms
2025/11/25 13:25:38 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":14078,"loggedInUser":""}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000690] "PUT http://localhost:19090/api/v1/admin/clients/14078/oauth2-flows HTTP/1.1" from [::1]:44802 - 200 558B in 4.772477ms
--- PASS: TestAPIClientOAuth2FlowsPut_Success_PublicClient_ForcesNoClientCredentials (0.02s)
=== RUN   TestAPIClientOAuth2FlowsPut_Success_ConfidentialClient_ToggleBoth
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14079}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000691] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44814 - 200 1156B in 5.20277ms
2025/11/25 13:25:38 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":14080,"loggedInUser":""}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000692] "PUT http://localhost:19090/api/v1/admin/clients/14080/oauth2-flows HTTP/1.1" from [::1]:44824 - 200 556B in 3.584092ms
--- PASS: TestAPIClientOAuth2FlowsPut_Success_ConfidentialClient_ToggleBoth (0.02s)
=== RUN   TestAPIClientOAuth2FlowsPut_SystemLevelClientRejected
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14081}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000693] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44836 - 200 1156B in 4.707585ms
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000694] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44848 - 200 2271840B in 473.058096ms
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000695] "PUT http://localhost:19090/api/v1/admin/clients/1/oauth2-flows HTTP/1.1" from [::1]:44854 - 400 87B in 1.019837ms
--- PASS: TestAPIClientOAuth2FlowsPut_SystemLevelClientRejected (0.50s)
=== RUN   TestAPIClientOAuth2FlowsPut_NotFoundAndInvalidId
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14082}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000696] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44856 - 200 1156B in 4.700812ms
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000697] "PUT http://localhost:19090/api/v1/admin/clients/999999/oauth2-flows HTTP/1.1" from [::1]:44872 - 404 60B in 587.54Âµs
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000698] "PUT http://localhost:19090/api/v1/admin/clients/abc/oauth2-flows HTTP/1.1" from [::1]:44882 - 400 68B in 543.567Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_NotFoundAndInvalidId (0.03s)
=== RUN   TestAPIClientOAuth2FlowsPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14083}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000699] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44886 - 200 1156B in 5.573592ms
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000700] "PUT http://localhost:19090/api/v1/admin/clients/14084/oauth2-flows HTTP/1.1" from [::1]:44892 - 400 70B in 718.978Âµs
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000701] "PUT http://localhost:19090/api/v1/admin/clients/14084/oauth2-flows HTTP/1.1" from [::1]:44892 - 401 22B in 158.168Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_InvalidRequestBodyAndUnauthorized (0.03s)
=== RUN   TestAPIClientOAuth2FlowsPut_InsufficientScope
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14085}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000702] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44902 - 200 1156B in 5.314842ms
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000703] "PUT http://localhost:19090/api/v1/admin/clients/14086/oauth2-flows HTTP/1.1" from [::1]:44910 - 403 19B in 374.498Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_BothDisabledAllowed
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14087}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000704] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44926 - 200 1156B in 4.766817ms
2025/11/25 13:25:38 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":14088,"loggedInUser":""}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000705] "PUT http://localhost:19090/api/v1/admin/clients/14088/oauth2-flows HTTP/1.1" from [::1]:44928 - 200 561B in 3.451762ms
--- PASS: TestAPIClientOAuth2FlowsPut_BothDisabledAllowed (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_Success_AddRemoveAndTrim
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14089}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000706] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44930 - 200 1156B in 5.019995ms
2025/11/25 13:25:38 INFO {"audit_event":"updated_redirect_uris","details":{"clientId":14090,"loggedInUser":""}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000707] "PUT http://localhost:19090/api/v1/admin/clients/14090/redirect-uris HTTP/1.1" from [::1]:44934 - 200 814B in 4.369506ms
--- PASS: TestAPIClientRedirectURIsPut_Success_AddRemoveAndTrim (0.02s)
=== RUN   TestAPIClientRedirectURIsPut_AuthCodeDisabledRejected
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14091}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000708] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44946 - 200 1156B in 4.407338ms
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000709] "PUT http://localhost:19090/api/v1/admin/clients/14092/redirect-uris HTTP/1.1" from [::1]:44950 - 400 103B in 797.016Âµs
--- PASS: TestAPIClientRedirectURIsPut_AuthCodeDisabledRejected (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_SystemLevelClientRejected
2025/11/25 13:25:38 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14093}}
2025/11/25 13:25:38 [a357f2e3b56e/a04mE72Kgg-000710] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44954 - 200 1156B in 4.3078ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000711] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44960 - 200 2275140B in 444.606678ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000712] "PUT http://localhost:19090/api/v1/admin/clients/1/redirect-uris HTTP/1.1" from [::1]:44970 - 400 87B in 1.221067ms
--- PASS: TestAPIClientRedirectURIsPut_SystemLevelClientRejected (0.47s)
=== RUN   TestAPIClientRedirectURIsPut_DuplicateAndInvalidURLs
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14094}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000713] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44972 - 200 1156B in 6.740767ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000714] "PUT http://localhost:19090/api/v1/admin/clients/14095/redirect-uris HTTP/1.1" from [::1]:44980 - 400 90B in 764.395Âµs
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000715] "PUT http://localhost:19090/api/v1/admin/clients/14095/redirect-uris HTTP/1.1" from [::1]:44996 - 400 82B in 616.525Âµs
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000716] "PUT http://localhost:19090/api/v1/admin/clients/14095/redirect-uris HTTP/1.1" from [::1]:45010 - 400 79B in 555.219Âµs
--- PASS: TestAPIClientRedirectURIsPut_DuplicateAndInvalidURLs (0.02s)
=== RUN   TestAPIClientRedirectURIsPut_NotFound_InvalidId_InvalidBody_Unauthorized
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14096}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000717] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45018 - 200 1156B in 4.580325ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000718] "PUT http://localhost:19090/api/v1/admin/clients/999999/redirect-uris HTTP/1.1" from [::1]:45034 - 404 60B in 450.962Âµs
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000719] "PUT http://localhost:19090/api/v1/admin/clients/abc/redirect-uris HTTP/1.1" from [::1]:45048 - 400 68B in 299.376Âµs
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000720] "PUT http://localhost:19090/api/v1/admin/clients/14097/redirect-uris HTTP/1.1" from [::1]:45050 - 400 70B in 447.535Âµs
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000721] "PUT http://localhost:19090/api/v1/admin/clients/14097/redirect-uris HTTP/1.1" from [::1]:45050 - 401 22B in 112.843Âµs
--- PASS: TestAPIClientRedirectURIsPut_NotFound_InvalidId_InvalidBody_Unauthorized (0.02s)
=== RUN   TestAPIClientRedirectURIsPut_InsufficientScope
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14098}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000722] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45064 - 200 1156B in 4.762208ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000723] "PUT http://localhost:19090/api/v1/admin/clients/14099/redirect-uris HTTP/1.1" from [::1]:45074 - 403 19B in 380.949Âµs
--- PASS: TestAPIClientRedirectURIsPut_InsufficientScope (0.02s)
=== RUN   TestAPIClientSessionsGet_Success
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14100}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000724] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45080 - 200 1156B in 4.622664ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000725] "GET http://localhost:19090/api/v1/admin/clients/14101/sessions HTTP/1.1" from [::1]:45084 - 200 1471B in 4.288012ms
--- PASS: TestAPIClientSessionsGet_Success (0.04s)
=== RUN   TestAPIClientSessionsGet_EmptySessions
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14102}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000726] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45090 - 200 1156B in 5.466389ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000727] "GET http://localhost:19090/api/v1/admin/clients/14103/sessions HTTP/1.1" from [::1]:45094 - 200 16B in 1.152848ms
--- PASS: TestAPIClientSessionsGet_EmptySessions (0.02s)
=== RUN   TestAPIClientSessionsGet_ClientNotFound
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14104}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000728] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45104 - 200 1156B in 4.646669ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000729] "GET http://localhost:19090/api/v1/admin/clients/999999/sessions HTTP/1.1" from [::1]:45116 - 404 67B in 630.531Âµs
--- PASS: TestAPIClientSessionsGet_ClientNotFound (0.01s)
=== RUN   TestAPIClientSessionsGet_InvalidId
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14105}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000730] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45126 - 200 1156B in 4.827291ms
=== RUN   TestAPIClientSessionsGet_InvalidId/non-numeric
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000731] "GET http://localhost:19090/api/v1/admin/clients/abc/sessions HTTP/1.1" from [::1]:45130 - 400 76B in 682.37Âµs
=== RUN   TestAPIClientSessionsGet_InvalidId/negative
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000732] "GET http://localhost:19090/api/v1/admin/clients/-1/sessions HTTP/1.1" from [::1]:45144 - 404 67B in 631.784Âµs
--- PASS: TestAPIClientSessionsGet_InvalidId (0.01s)
    --- PASS: TestAPIClientSessionsGet_InvalidId/non-numeric (0.00s)
    --- PASS: TestAPIClientSessionsGet_InvalidId/negative (0.00s)
=== RUN   TestAPIClientSessionsGet_Unauthorized
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000733] "GET http://localhost:19090/api/v1/admin/clients/14106/sessions HTTP/1.1" from [::1]:45158 - 401 22B in 295.628Âµs
--- PASS: TestAPIClientSessionsGet_Unauthorized (0.01s)
=== RUN   TestAPIClientSessionsGet_OnlyValidSessions
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14107}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000734] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45160 - 200 1156B in 5.900529ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000735] "GET http://localhost:19090/api/v1/admin/clients/14108/sessions HTTP/1.1" from [::1]:45168 - 200 744B in 1.891594ms
--- PASS: TestAPIClientSessionsGet_OnlyValidSessions (0.04s)
=== RUN   TestAPIClientSessionsGet_PaginationDefaultAndCap
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14109}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000736] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45174 - 200 1156B in 5.417897ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000737] "GET http://localhost:19090/api/v1/admin/clients/14110/sessions HTTP/1.1" from [::1]:45190 - 200 36149B in 7.400032ms
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000738] "GET http://localhost:19090/api/v1/admin/clients/14110/sessions?size=200 HTTP/1.1" from [::1]:45192 - 200 72287B in 12.701299ms
--- PASS: TestAPIClientSessionsGet_PaginationDefaultAndCap (0.54s)
=== RUN   TestAPIClientsGet_Success
2025/11/25 13:25:39 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14111}}
2025/11/25 13:25:39 [a357f2e3b56e/a04mE72Kgg-000739] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45200 - 200 1156B in 4.647181ms
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000740] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:45214 - 200 2280090B in 417.151983ms
--- PASS: TestAPIClientsGet_Success (0.44s)
=== RUN   TestAPIClientsGet_Unauthorized
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000741] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:45220 - 401 22B in 451.282Âµs
--- PASS: TestAPIClientsGet_Unauthorized (0.00s)
=== RUN   TestAPIClientGet_Success
2025/11/25 13:25:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14112}}
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000742] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45228 - 200 1156B in 4.648373ms
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000743] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:45234 - 200 2280636B in 411.144122ms
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000744] "GET http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:45250 - 200 935B in 968.45Âµs
--- PASS: TestAPIClientGet_Success (0.44s)
=== RUN   TestAPIClientGet_NotFound
2025/11/25 13:25:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14113}}
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000745] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45262 - 200 1156B in 4.705331ms
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000746] "GET http://localhost:19090/api/v1/admin/clients/99999 HTTP/1.1" from [::1]:45276 - 404 60B in 440.382Âµs
--- PASS: TestAPIClientGet_NotFound (0.01s)
=== RUN   TestAPIClientGet_InvalidId
2025/11/25 13:25:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14114}}
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000747] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45278 - 200 1156B in 4.713465ms
=== RUN   TestAPIClientGet_InvalidId/non-numeric_ID
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000748] "GET http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:45290 - 400 68B in 397.751Âµs
=== RUN   TestAPIClientGet_InvalidId/negative_ID
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000749] "GET http://localhost:19090/api/v1/admin/clients/-1 HTTP/1.1" from [::1]:45292 - 404 60B in 422.819Âµs
--- PASS: TestAPIClientGet_InvalidId (0.01s)
    --- PASS: TestAPIClientGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIClientGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIClientGet_EmptyId
2025/11/25 13:25:40 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14115}}
2025/11/25 13:25:40 [a357f2e3b56e/a04mE72Kgg-000750] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45306 - 200 1156B in 4.469014ms
--- PASS: TestAPIClientGet_EmptyId (0.44s)
=== RUN   TestAPIClientGet_Unauthorized
2025/11/25 13:25:41 ERROR write tcp [::1]:19090->[::1]:45314: write: connection reset by peer
request-id: a357f2e3b56e/a04mE72Kgg-000751
2025/11/25 13:25:41 ERROR write tcp [::1]:19090->[::1]:45314: write: connection reset by peer
request-id: a357f2e3b56e/a04mE72Kgg-000751
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000751] "GET http://localhost:19090/api/v1/admin/clients/ HTTP/1.1" from [::1]:45314 - 200 1642358B in 430.60882ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000752] "GET http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:45320 - 401 22B in 281.482Âµs
--- PASS: TestAPIClientGet_Unauthorized (0.00s)
=== RUN   TestAPIClientTokensPut_Success
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14116}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000753] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45334 - 200 1156B in 4.819998ms
2025/11/25 13:25:41 INFO {"audit_event":"updated_client_tokens","details":{"clientId":14117,"loggedInUser":""}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000754] "PUT http://localhost:19090/api/v1/admin/clients/14117/tokens HTTP/1.1" from [::1]:45344 - 200 609B in 3.29734ms
--- PASS: TestAPIClientTokensPut_Success (0.02s)
=== RUN   TestAPIClientTokensPut_ValidationErrors
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14118}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000755] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45360 - 200 1156B in 4.338949ms
=== RUN   TestAPIClientTokensPut_ValidationErrors/token_exp_too_large
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000756] "PUT http://localhost:19090/api/v1/admin/clients/14119/tokens HTTP/1.1" from [::1]:45364 - 400 111B in 413.702Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/idle_too_large
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000757] "PUT http://localhost:19090/api/v1/admin/clients/14119/tokens HTTP/1.1" from [::1]:45378 - 400 131B in 349.36Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/maxlife_too_large
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000758] "PUT http://localhost:19090/api/v1/admin/clients/14119/tokens HTTP/1.1" from [::1]:45394 - 400 131B in 368.035Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/idle_gt_maxlife
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000759] "PUT http://localhost:19090/api/v1/admin/clients/14119/tokens HTTP/1.1" from [::1]:45396 - 400 124B in 330.485Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/invalid_three_state
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000760] "PUT http://localhost:19090/api/v1/admin/clients/14119/tokens HTTP/1.1" from [::1]:45408 - 400 109B in 414.483Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/negatives_rejected
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000761] "PUT http://localhost:19090/api/v1/admin/clients/14119/tokens HTTP/1.1" from [::1]:45420 - 400 111B in 382.633Âµs
--- PASS: TestAPIClientTokensPut_ValidationErrors (0.01s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/token_exp_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/idle_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/maxlife_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/idle_gt_maxlife (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/invalid_three_state (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/negatives_rejected (0.00s)
=== RUN   TestAPIClientTokensPut_NotFoundAndInvalidId
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14120}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000762] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45426 - 200 1156B in 4.304052ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000763] "PUT http://localhost:19090/api/v1/admin/clients/999999/tokens HTTP/1.1" from [::1]:45440 - 404 60B in 366.392Âµs
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000764] "PUT http://localhost:19090/api/v1/admin/clients/abc/tokens HTTP/1.1" from [::1]:45442 - 400 68B in 273.707Âµs
--- PASS: TestAPIClientTokensPut_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientTokensPut_SystemLevelClientRejected
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14121}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000765] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45444 - 200 1156B in 4.498831ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000766] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:45460 - 200 2284486B in 409.695555ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000767] "PUT http://localhost:19090/api/v1/admin/clients/1/tokens HTTP/1.1" from [::1]:45472 - 400 87B in 1.012733ms
--- PASS: TestAPIClientTokensPut_SystemLevelClientRejected (0.43s)
=== RUN   TestAPIClientTokensPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14122}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000768] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45484 - 200 1156B in 4.406325ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000769] "PUT http://localhost:19090/api/v1/admin/clients/14123/tokens HTTP/1.1" from [::1]:45498 - 400 70B in 448.888Âµs
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000770] "PUT http://localhost:19090/api/v1/admin/clients/14123/tokens HTTP/1.1" from [::1]:45498 - 401 22B in 83.478Âµs
--- PASS: TestAPIClientTokensPut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPIClientTokensPut_InsufficientScope
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14124}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000771] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45510 - 200 1157B in 4.428077ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000772] "PUT http://localhost:19090/api/v1/admin/clients/14125/tokens HTTP/1.1" from [::1]:45514 - 403 19B in 416.216Âµs
--- PASS: TestAPIClientTokensPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientUpdatePut_Success
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14126}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000773] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45518 - 200 1156B in 4.319672ms
2025/11/25 13:25:41 INFO {"audit_event":"updated_client_settings","details":{"clientId":14127,"loggedInUser":""}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000774] "PUT http://localhost:19090/api/v1/admin/clients/14127 HTTP/1.1" from [::1]:45530 - 200 600B in 3.623076ms
--- PASS: TestAPIClientUpdatePut_Success (0.01s)
=== RUN   TestAPIClientUpdatePut_ValidationErrors
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14128}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000775] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45544 - 200 1156B in 4.306076ms
=== RUN   TestAPIClientUpdatePut_ValidationErrors/empty_identifier
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000776] "PUT http://localhost:19090/api/v1/admin/clients/14129 HTTP/1.1" from [::1]:45558 - 400 81B in 503.291Âµs
=== RUN   TestAPIClientUpdatePut_ValidationErrors/desc_too_long
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000777] "PUT http://localhost:19090/api/v1/admin/clients/14129 HTTP/1.1" from [::1]:45566 - 400 116B in 394.415Âµs
=== RUN   TestAPIClientUpdatePut_ValidationErrors/invalid_identifier_format
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000778] "PUT http://localhost:19090/api/v1/admin/clients/14129 HTTP/1.1" from [::1]:45570 - 400 250B in 431.485Âµs
--- PASS: TestAPIClientUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/empty_identifier (0.00s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/desc_too_long (0.00s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIClientUpdatePut_DuplicateIdentifier
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14130}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000779] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45574 - 200 1156B in 4.365278ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000780] "PUT http://localhost:19090/api/v1/admin/clients/14132 HTTP/1.1" from [::1]:45578 - 400 91B in 600.785Âµs
--- PASS: TestAPIClientUpdatePut_DuplicateIdentifier (0.01s)
=== RUN   TestAPIClientUpdatePut_SameIdentifierAllowed
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14133}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000781] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45586 - 200 1156B in 4.373093ms
2025/11/25 13:25:41 INFO {"audit_event":"updated_client_settings","details":{"clientId":14134,"loggedInUser":""}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000782] "PUT http://localhost:19090/api/v1/admin/clients/14134 HTTP/1.1" from [::1]:45600 - 200 594B in 3.341233ms
--- PASS: TestAPIClientUpdatePut_SameIdentifierAllowed (0.01s)
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14135}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000783] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45604 - 200 1156B in 4.463774ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000784] "PUT http://localhost:19090/api/v1/admin/clients/99999 HTTP/1.1" from [::1]:45608 - 404 60B in 455.19Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/non-numeric
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000785] "PUT http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:45624 - 400 68B in 319.724Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/empty
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000786] "PUT http://localhost:19090/api/v1/admin/clients/ HTTP/1.1" from [::1]:45636 - 405 0B in 323.741Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/negative
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000787] "PUT http://localhost:19090/api/v1/admin/clients/-1 HTTP/1.1" from [::1]:45652 - 404 60B in 347.156Âµs
--- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId (0.01s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/non-numeric (0.00s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/empty (0.00s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/negative (0.00s)
=== RUN   TestAPIClientUpdatePut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14136}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000788] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45660 - 200 1156B in 4.387189ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000789] "PUT http://localhost:19090/api/v1/admin/clients/14137 HTTP/1.1" from [::1]:45668 - 400 70B in 503.501Âµs
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000790] "PUT http://localhost:19090/api/v1/admin/clients/14137 HTTP/1.1" from [::1]:45668 - 401 22B in 93.927Âµs
--- PASS: TestAPIClientUpdatePut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPIClientUpdatePut_ACRRuleEnforcement
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14138}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000791] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45672 - 200 1156B in 4.338397ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000792] "PUT http://localhost:19090/api/v1/admin/clients/14139 HTTP/1.1" from [::1]:45686 - 400 128B in 578.272Âµs
--- PASS: TestAPIClientUpdatePut_ACRRuleEnforcement (0.01s)
=== RUN   TestAPIClientUpdatePut_WhitespaceHandling
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14140}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000793] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45694 - 200 1156B in 5.114604ms
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000794] "PUT http://localhost:19090/api/v1/admin/clients/14141 HTTP/1.1" from [::1]:45698 - 400 250B in 562.793Âµs
2025/11/25 13:25:41 INFO {"audit_event":"updated_client_settings","details":{"clientId":14141,"loggedInUser":""}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000795] "PUT http://localhost:19090/api/v1/admin/clients/14141 HTTP/1.1" from [::1]:45700 - 200 599B in 3.265199ms
--- PASS: TestAPIClientUpdatePut_WhitespaceHandling (0.02s)
=== RUN   TestAPIClientUpdatePut_SystemLevelClientRejected
2025/11/25 13:25:41 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14142}}
2025/11/25 13:25:41 [a357f2e3b56e/a04mE72Kgg-000796] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45716 - 200 1156B in 4.297069ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000797] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:45726 - 200 2289982B in 427.769715ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000798] "PUT http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:45734 - 400 87B in 941.068Âµs
--- PASS: TestAPIClientUpdatePut_SystemLevelClientRejected (0.45s)
=== RUN   TestAPIClientUpdatePut_InvalidDefaultAcrLevelValue
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14143}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000799] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45746 - 200 1156B in 5.227357ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000800] "PUT http://localhost:19090/api/v1/admin/clients/14144 HTTP/1.1" from [::1]:45754 - 400 76B in 614.491Âµs
--- PASS: TestAPIClientUpdatePut_InvalidDefaultAcrLevelValue (0.02s)
=== RUN   TestAPIClientUpdatePut_InsufficientScope
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14145}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000801] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45764 - 200 1157B in 4.315695ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000802] "PUT http://localhost:19090/api/v1/admin/clients/14146 HTTP/1.1" from [::1]:45780 - 403 19B in 388.634Âµs
--- PASS: TestAPIClientUpdatePut_InsufficientScope (0.01s)
=== RUN   TestAPIClientWebOriginsPut_Success_AddRemoveAndNormalize
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14147}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000803] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45792 - 200 1156B in 4.305676ms
2025/11/25 13:25:42 INFO {"audit_event":"updated_web_origins","details":{"clientId":14148,"loggedInUser":""}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000804] "PUT http://localhost:19090/api/v1/admin/clients/14148/web-origins HTTP/1.1" from [::1]:45800 - 200 799B in 3.451782ms
--- PASS: TestAPIClientWebOriginsPut_Success_AddRemoveAndNormalize (0.02s)
=== RUN   TestAPIClientWebOriginsPut_AuthCodeDisabledRejected
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14149}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000805] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45812 - 200 1156B in 4.393682ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000806] "PUT http://localhost:19090/api/v1/admin/clients/14150/web-origins HTTP/1.1" from [::1]:45822 - 400 103B in 488.102Âµs
--- PASS: TestAPIClientWebOriginsPut_AuthCodeDisabledRejected (0.01s)
=== RUN   TestAPIClientWebOriginsPut_SystemLevelClientRejected
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14151}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000807] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45834 - 200 1156B in 4.351562ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000808] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:45846 - 200 2292182B in 435.387911ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000809] "PUT http://localhost:19090/api/v1/admin/clients/1/web-origins HTTP/1.1" from [::1]:45858 - 400 87B in 1.000029ms
--- PASS: TestAPIClientWebOriginsPut_SystemLevelClientRejected (0.46s)
=== RUN   TestAPIClientWebOriginsPut_DuplicateInvalidWrongSchemeAndEmpty
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14152}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000810] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45868 - 200 1156B in 4.602647ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000811] "PUT http://localhost:19090/api/v1/admin/clients/14153/web-origins HTTP/1.1" from [::1]:45874 - 400 88B in 490.216Âµs
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000812] "PUT http://localhost:19090/api/v1/admin/clients/14153/web-origins HTTP/1.1" from [::1]:45890 - 400 80B in 961.827Âµs
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000813] "PUT http://localhost:19090/api/v1/admin/clients/14153/web-origins HTTP/1.1" from [::1]:45892 - 400 91B in 495.707Âµs
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000814] "PUT http://localhost:19090/api/v1/admin/clients/14153/web-origins HTTP/1.1" from [::1]:45904 - 400 77B in 403.081Âµs
--- PASS: TestAPIClientWebOriginsPut_DuplicateInvalidWrongSchemeAndEmpty (0.02s)
=== RUN   TestAPIClientWebOriginsPut_NotFound_InvalidId_InvalidBody_Unauthorized
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14154}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000815] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45918 - 200 1156B in 4.363465ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000816] "PUT http://localhost:19090/api/v1/admin/clients/999999/web-origins HTTP/1.1" from [::1]:45934 - 404 60B in 429.712Âµs
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000817] "PUT http://localhost:19090/api/v1/admin/clients/abc/web-origins HTTP/1.1" from [::1]:45936 - 400 68B in 327.358Âµs
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000818] "PUT http://localhost:19090/api/v1/admin/clients/14155/web-origins HTTP/1.1" from [::1]:45948 - 400 70B in 359.088Âµs
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000819] "PUT http://localhost:19090/api/v1/admin/clients/14155/web-origins HTTP/1.1" from [::1]:45948 - 401 22B in 97.434Âµs
--- PASS: TestAPIClientWebOriginsPut_NotFound_InvalidId_InvalidBody_Unauthorized (0.01s)
=== RUN   TestAPIClientWebOriginsPut_InsufficientScope
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14156}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000820] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45952 - 200 1158B in 5.116468ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000821] "PUT http://localhost:19090/api/v1/admin/clients/14157/web-origins HTTP/1.1" from [::1]:45964 - 403 19B in 392.461Âµs
--- PASS: TestAPIClientWebOriginsPut_InsufficientScope (0.01s)
=== RUN   TestAPIGroupMembersGet_Success
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14158}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000822] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45966 - 200 1156B in 4.3454ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000823] "GET http://localhost:19090/api/v1/admin/groups/10525/members HTTP/1.1" from [::1]:45976 - 200 1421B in 2.962187ms
--- PASS: TestAPIGroupMembersGet_Success (0.03s)
=== RUN   TestAPIGroupMembersGet_EmptyGroup
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14159}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000824] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45992 - 200 1156B in 4.48826ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000825] "GET http://localhost:19090/api/v1/admin/groups/10526/members HTTP/1.1" from [::1]:46002 - 200 46B in 615.202Âµs
--- PASS: TestAPIGroupMembersGet_EmptyGroup (0.01s)
=== RUN   TestAPIGroupMembersGet_Pagination
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14160}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000826] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46006 - 200 1156B in 4.342925ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000827] "GET http://localhost:19090/api/v1/admin/groups/10527/members?page=1&size=2 HTTP/1.1" from [::1]:46016 - 200 1424B in 734.528Âµs
--- PASS: TestAPIGroupMembersGet_Pagination (0.03s)
=== RUN   TestAPIGroupMembersGet_GroupNotFound
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14161}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000828] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46018 - 200 1156B in 4.357143ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000829] "GET http://localhost:19090/api/v1/admin/groups/99999/members HTTP/1.1" from [::1]:46022 - 404 59B in 459.117Âµs
--- PASS: TestAPIGroupMembersGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMembersGet_InvalidGroupId
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14162}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000830] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46034 - 200 1156B in 4.286649ms
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/non-numeric_ID
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000831] "GET http://localhost:19090/api/v1/admin/groups/abc/members HTTP/1.1" from [::1]:46044 - 400 67B in 367.805Âµs
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/empty_ID
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000832] "GET http://localhost:19090/api/v1/admin/groups//members HTTP/1.1" from [::1]:46058 - 400 71B in 293.615Âµs
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/negative_ID
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000833] "GET http://localhost:19090/api/v1/admin/groups/-1/members HTTP/1.1" from [::1]:46068 - 404 59B in 348.097Âµs
--- PASS: TestAPIGroupMembersGet_InvalidGroupId (0.01s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/empty_ID (0.00s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/negative_ID (0.00s)
=== RUN   TestAPIGroupMemberAdd_Success
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14163}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000834] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46080 - 200 1156B in 4.243959ms
2025/11/25 13:25:42 INFO {"audit_event":"user_added_to_group","details":{"groupId":10528,"loggedInUser":"","userId":11676}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000835] "POST http://localhost:19090/api/v1/admin/groups/10528/members HTTP/1.1" from [::1]:46086 - 201 17B in 2.358787ms
--- PASS: TestAPIGroupMemberAdd_Success (0.02s)
=== RUN   TestAPIGroupMemberAdd_UserAlreadyInGroup
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14164}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000836] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46094 - 200 1156B in 4.498199ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000837] "POST http://localhost:19090/api/v1/admin/groups/10529/members HTTP/1.1" from [::1]:46108 - 400 89B in 668.052Âµs
--- PASS: TestAPIGroupMemberAdd_UserAlreadyInGroup (0.02s)
=== RUN   TestAPIGroupMemberAdd_UserNotFound
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14165}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000838] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46118 - 200 1156B in 4.272372ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000839] "POST http://localhost:19090/api/v1/admin/groups/10530/members HTTP/1.1" from [::1]:46128 - 404 63B in 562.914Âµs
--- PASS: TestAPIGroupMemberAdd_UserNotFound (0.01s)
=== RUN   TestAPIGroupMemberAdd_GroupNotFound
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14166}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000840] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46132 - 200 1156B in 4.863339ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000841] "POST http://localhost:19090/api/v1/admin/groups/99999/members HTTP/1.1" from [::1]:46134 - 404 59B in 650.058Âµs
--- PASS: TestAPIGroupMemberAdd_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMemberAdd_InvalidRequestBody
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14167}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000842] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46142 - 200 1156B in 4.826991ms
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000843] "POST http://localhost:19090/api/v1/admin/groups/10531/members HTTP/1.1" from [::1]:46144 - 400 70B in 532.576Âµs
--- PASS: TestAPIGroupMemberAdd_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupMemberRemove_Success
2025/11/25 13:25:42 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14168}}
2025/11/25 13:25:42 [a357f2e3b56e/a04mE72Kgg-000844] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46152 - 200 1156B in 4.80035ms
2025/11/25 13:25:43 INFO {"audit_event":"user_removed_from_group","details":{"groupId":10532,"loggedInUser":"","userId":11678}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000845] "DELETE http://localhost:19090/api/v1/admin/groups/10532/members/11678 HTTP/1.1" from [::1]:46158 - 200 17B in 2.052047ms
--- PASS: TestAPIGroupMemberRemove_Success (0.02s)
=== RUN   TestAPIGroupMemberRemove_UserNotInGroup
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14169}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000846] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46172 - 200 1156B in 5.291699ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000847] "DELETE http://localhost:19090/api/v1/admin/groups/10533/members/11679 HTTP/1.1" from [::1]:46184 - 400 85B in 651.16Âµs
--- PASS: TestAPIGroupMemberRemove_UserNotInGroup (0.02s)
=== RUN   TestAPIGroupMemberRemove_UserNotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14170}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000848] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46192 - 200 1156B in 4.499462ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000849] "DELETE http://localhost:19090/api/v1/admin/groups/10534/members/99999 HTTP/1.1" from [::1]:46196 - 404 63B in 608.91Âµs
--- PASS: TestAPIGroupMemberRemove_UserNotFound (0.01s)
=== RUN   TestAPIGroupMemberRemove_GroupNotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14171}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000850] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46198 - 200 1156B in 4.482058ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000851] "DELETE http://localhost:19090/api/v1/admin/groups/99999/members/1 HTTP/1.1" from [::1]:46212 - 404 59B in 1.367544ms
--- PASS: TestAPIGroupMemberRemove_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMemberRemove_InvalidIds
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14172}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000852] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46220 - 200 1156B in 4.648874ms
=== RUN   TestAPIGroupMemberRemove_InvalidIds/non-numeric_group_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000853] "DELETE http://localhost:19090/api/v1/admin/groups/abc/members/1 HTTP/1.1" from [::1]:46228 - 400 67B in 434.21Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/non-numeric_user_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000854] "DELETE http://localhost:19090/api/v1/admin/groups/1/members/abc HTTP/1.1" from [::1]:46240 - 400 66B in 311.348Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/negative_group_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000855] "DELETE http://localhost:19090/api/v1/admin/groups/-1/members/1 HTTP/1.1" from [::1]:46244 - 404 59B in 375.47Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/negative_user_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000856] "DELETE http://localhost:19090/api/v1/admin/groups/1/members/-1 HTTP/1.1" from [::1]:46260 - 404 59B in 413.792Âµs
--- PASS: TestAPIGroupMemberRemove_InvalidIds (0.01s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/non-numeric_group_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/non-numeric_user_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/negative_group_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/negative_user_ID (0.00s)
=== RUN   TestAPIGroupMembers_Unauthorized
=== RUN   TestAPIGroupMembers_Unauthorized/GET_members
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000857] "GET http://localhost:19090/api/v1/admin/groups/10535/members HTTP/1.1" from [::1]:46268 - 401 22B in 156.185Âµs
=== RUN   TestAPIGroupMembers_Unauthorized/POST_add_member
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000858] "POST http://localhost:19090/api/v1/admin/groups/10535/members HTTP/1.1" from [::1]:46274 - 401 22B in 149.202Âµs
=== RUN   TestAPIGroupMembers_Unauthorized/DELETE_remove_member
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000859] "DELETE http://localhost:19090/api/v1/admin/groups/10535/members/1 HTTP/1.1" from [::1]:46290 - 401 22B in 98.266Âµs
--- PASS: TestAPIGroupMembers_Unauthorized (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/GET_members (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/POST_add_member (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/DELETE_remove_member (0.00s)
=== RUN   TestAPIGroupAttributesGet_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14173}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000860] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46292 - 200 1156B in 4.335682ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000861] "GET http://localhost:19090/api/v1/admin/groups/10536/attributes HTTP/1.1" from [::1]:46300 - 200 417B in 1.366261ms
--- PASS: TestAPIGroupAttributesGet_Success (0.02s)
=== RUN   TestAPIGroupAttributesGet_EmptyAttributes
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14174}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000862] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46310 - 200 1156B in 4.668401ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000863] "GET http://localhost:19090/api/v1/admin/groups/10537/attributes HTTP/1.1" from [::1]:46314 - 200 18B in 502.379Âµs
--- PASS: TestAPIGroupAttributesGet_EmptyAttributes (0.01s)
=== RUN   TestAPIGroupAttributesGet_GroupNotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14175}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000864] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46330 - 200 1156B in 4.258676ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000865] "GET http://localhost:19090/api/v1/admin/groups/99999/attributes HTTP/1.1" from [::1]:46334 - 404 59B in 331.607Âµs
--- PASS: TestAPIGroupAttributesGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupAttributesGet_InvalidId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14176}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000866] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46340 - 200 1156B in 4.274487ms
=== RUN   TestAPIGroupAttributesGet_InvalidId/non-numeric_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000867] "GET http://localhost:19090/api/v1/admin/groups/abc/attributes HTTP/1.1" from [::1]:46350 - 400 67B in 326.687Âµs
=== RUN   TestAPIGroupAttributesGet_InvalidId/empty_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000868] "GET http://localhost:19090/api/v1/admin/groups//attributes HTTP/1.1" from [::1]:46360 - 400 71B in 296.981Âµs
=== RUN   TestAPIGroupAttributesGet_InvalidId/negative_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000869] "GET http://localhost:19090/api/v1/admin/groups/-1/attributes HTTP/1.1" from [::1]:46374 - 404 59B in 322.87Âµs
--- PASS: TestAPIGroupAttributesGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributesGet_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000870] "GET http://localhost:19090/api/v1/admin/groups/10538/attributes HTTP/1.1" from [::1]:46380 - 401 22B in 91.052Âµs
--- PASS: TestAPIGroupAttributesGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeGet_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14177}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000871] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46388 - 200 1156B in 4.262042ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000872] "GET http://localhost:19090/api/v1/admin/group-attributes/80 HTTP/1.1" from [::1]:46402 - 200 208B in 860.165Âµs
--- PASS: TestAPIGroupAttributeGet_Success (0.01s)
=== RUN   TestAPIGroupAttributeGet_NotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14178}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000873] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46416 - 200 1156B in 4.327998ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000874] "GET http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:46420 - 404 69B in 451.583Âµs
--- PASS: TestAPIGroupAttributeGet_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeGet_InvalidId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14179}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000875] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46424 - 200 1156B in 4.253217ms
=== RUN   TestAPIGroupAttributeGet_InvalidId/non-numeric_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000876] "GET http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:46428 - 400 77B in 380.389Âµs
=== RUN   TestAPIGroupAttributeGet_InvalidId/empty_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000877] "GET http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:46434 - 405 0B in 298.564Âµs
=== RUN   TestAPIGroupAttributeGet_InvalidId/negative_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000878] "GET http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:46440 - 404 69B in 273.888Âµs
--- PASS: TestAPIGroupAttributeGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeGet_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000879] "GET http://localhost:19090/api/v1/admin/group-attributes/81 HTTP/1.1" from [::1]:46450 - 401 22B in 116.189Âµs
--- PASS: TestAPIGroupAttributeGet_Unauthorized (0.01s)
=== RUN   TestAPIGroupAttributeCreatePost_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14180}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000880] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46462 - 200 1156B in 4.240523ms
2025/11/25 13:25:43 INFO {"audit_event":"added_group_attribute","details":{"groupAttributeId":82,"groupId":10541,"groupIdentifier":"test-group-292f4ce6","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000881] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46466 - 201 223B in 2.637924ms
--- PASS: TestAPIGroupAttributeCreatePost_Success (0.01s)
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14181}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000882] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46482 - 200 1156B in 4.651499ms
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/missing_key
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000883] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46488 - 400 76B in 389.506Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/empty_key
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000884] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46492 - 400 76B in 344.661Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/value_too_long
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000885] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46504 - 400 119B in 420.374Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/invalid_key_format
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000886] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46514 - 400 250B in 344.681Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/group_not_found
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000887] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46528 - 404 59B in 383.274Âµs
--- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/invalid_key_format (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/group_not_found (0.00s)
=== RUN   TestAPIGroupAttributeCreatePost_InvalidRequestBody
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14182}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000888] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46538 - 200 1156B in 4.322247ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000889] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46548 - 400 70B in 614.491Âµs
--- PASS: TestAPIGroupAttributeCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupAttributeCreatePost_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000890] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46552 - 401 22B in 191.953Âµs
--- PASS: TestAPIGroupAttributeCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14183}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000891] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46558 - 200 1156B in 4.448906ms
2025/11/25 13:25:43 INFO {"audit_event":"updated_group_attribute","details":{"groupAttributeId":83,"groupId":10543,"groupIdentifier":"test-group-15b6fe54","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000892] "PUT http://localhost:19090/api/v1/admin/group-attributes/83 HTTP/1.1" from [::1]:46562 - 200 213B in 2.58783ms
--- PASS: TestAPIGroupAttributeUpdatePut_Success (0.02s)
=== RUN   TestAPIGroupAttributeUpdatePut_NotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14184}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000893] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46568 - 200 1156B in 4.356312ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000894] "PUT http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:46584 - 404 69B in 380.209Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14185}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000895] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46596 - 200 1156B in 4.321445ms
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/missing_key
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000896] "PUT http://localhost:19090/api/v1/admin/group-attributes/84 HTTP/1.1" from [::1]:46604 - 400 76B in 471.701Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/empty_key
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000897] "PUT http://localhost:19090/api/v1/admin/group-attributes/84 HTTP/1.1" from [::1]:46610 - 400 76B in 419.923Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/value_too_long
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000898] "PUT http://localhost:19090/api/v1/admin/group-attributes/84 HTTP/1.1" from [::1]:46614 - 400 119B in 397.401Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/invalid_key_format
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000899] "PUT http://localhost:19090/api/v1/admin/group-attributes/84 HTTP/1.1" from [::1]:46618 - 400 250B in 355.832Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/invalid_key_format (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14186}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000900] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46634 - 200 1156B in 4.374625ms
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000901] "PUT http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:46636 - 400 77B in 371.863Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/empty_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000902] "PUT http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:46646 - 405 0B in 300.808Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/negative_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000903] "PUT http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:46656 - 404 69B in 307.651Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidRequestBody
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14187}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000904] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46670 - 200 1156B in 4.342755ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000905] "PUT http://localhost:19090/api/v1/admin/group-attributes/85 HTTP/1.1" from [::1]:46682 - 400 70B in 477.492Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000906] "PUT http://localhost:19090/api/v1/admin/group-attributes/86 HTTP/1.1" from [::1]:46694 - 401 22B in 172.987Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeDelete_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14188}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000907] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46708 - 200 1156B in 4.330202ms
2025/11/25 13:25:43 INFO {"audit_event":"deleted_group_attribute","details":{"groupAttributeId":87,"groupId":10547,"groupIdentifier":"test-group-581e4b2f","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000908] "DELETE http://localhost:19090/api/v1/admin/group-attributes/87 HTTP/1.1" from [::1]:46712 - 200 17B in 1.759404ms
--- PASS: TestAPIGroupAttributeDelete_Success (0.01s)
=== RUN   TestAPIGroupAttributeDelete_NotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14189}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000909] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46716 - 200 1156B in 4.454897ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000910] "DELETE http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:46728 - 404 69B in 418.841Âµs
--- PASS: TestAPIGroupAttributeDelete_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeDelete_InvalidId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14190}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000911] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46744 - 200 1156B in 4.705992ms
=== RUN   TestAPIGroupAttributeDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000912] "DELETE http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:46748 - 400 77B in 582.11Âµs
=== RUN   TestAPIGroupAttributeDelete_InvalidId/empty_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000913] "DELETE http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:46754 - 405 0B in 315.015Âµs
=== RUN   TestAPIGroupAttributeDelete_InvalidId/negative_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000914] "DELETE http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:46758 - 404 69B in 408.923Âµs
--- PASS: TestAPIGroupAttributeDelete_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeDelete_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000915] "DELETE http://localhost:19090/api/v1/admin/group-attributes/88 HTTP/1.1" from [::1]:46764 - 401 22B in 159.912Âµs
--- PASS: TestAPIGroupAttributeDelete_Unauthorized (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14191}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000916] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46778 - 200 1156B in 4.341784ms
2025/11/25 13:25:43 INFO {"audit_event":"created_group","details":{"groupId":10549,"groupIdentifier":"test-group-thqlAc","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000917] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46794 - 201 259B in 2.779903ms
--- PASS: TestHandleAPIGroupCreatePost_Success (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14192}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000918] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46808 - 200 1156B in 4.590324ms
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Empty_group_identifier
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000919] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46818 - 400 79B in 428.57Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_short
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000920] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46820 - 400 101B in 355.973Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_long
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000921] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46826 - 400 114B in 348.228Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Invalid_group_identifier_characters
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000922] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46834 - 400 250B in 371.562Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Description_too_long
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000923] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46846 - 400 115B in 319.343Âµs
--- PASS: TestHandleAPIGroupCreatePost_ValidationErrors (0.01s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Empty_group_identifier (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_short (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_long (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Invalid_group_identifier_characters (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Description_too_long (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_DuplicateGroupIdentifier
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14193}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000924] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46860 - 200 1156B in 4.29734ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000925] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46864 - 400 89B in 919.187Âµs
--- PASS: TestHandleAPIGroupCreatePost_DuplicateGroupIdentifier (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_InputSanitization
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14194}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000926] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46876 - 200 1156B in 4.256943ms
2025/11/25 13:25:43 INFO {"audit_event":"created_group","details":{"groupId":10551,"groupIdentifier":"test-group-WWJEOg","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000927] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46882 - 201 251B in 2.088286ms
--- PASS: TestHandleAPIGroupCreatePost_InputSanitization (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000928] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46896 - 401 22B in 146.898Âµs
--- PASS: TestHandleAPIGroupCreatePost_Unauthorized (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_InvalidJSON
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14195}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000929] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46906 - 200 1156B in 4.291669ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000930] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46922 - 400 70B in 372.353Âµs
--- PASS: TestHandleAPIGroupCreatePost_InvalidJSON (0.01s)
=== RUN   TestAPIGroupDelete_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14196}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000931] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46926 - 200 1156B in 4.318069ms
2025/11/25 13:25:43 INFO {"audit_event":"deleted_group","details":{"groupId":10552,"groupIdentifier":"test-group-9d544ec4","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000932] "DELETE http://localhost:19090/api/v1/admin/groups/10552 HTTP/1.1" from [::1]:46934 - 200 17B in 1.701525ms
--- PASS: TestAPIGroupDelete_Success (0.01s)
=== RUN   TestAPIGroupDelete_SuccessWithMembers
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14197}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000933] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46944 - 200 1156B in 4.35064ms
2025/11/25 13:25:43 INFO {"audit_event":"deleted_group","details":{"groupId":10553,"groupIdentifier":"test-group-3028847c","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000934] "DELETE http://localhost:19090/api/v1/admin/groups/10553 HTTP/1.1" from [::1]:46954 - 200 17B in 75.83621ms
--- PASS: TestAPIGroupDelete_SuccessWithMembers (0.09s)
=== RUN   TestAPIGroupDelete_NotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14198}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000935] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46964 - 200 1156B in 4.695512ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000936] "DELETE http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:46968 - 404 59B in 695.675Âµs
--- PASS: TestAPIGroupDelete_NotFound (0.01s)
=== RUN   TestAPIGroupDelete_InvalidId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14199}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000937] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46980 - 200 1156B in 4.272653ms
=== RUN   TestAPIGroupDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000938] "DELETE http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:46988 - 400 67B in 356.864Âµs
=== RUN   TestAPIGroupDelete_InvalidId/empty_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000939] "DELETE http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:46996 - 405 0B in 277.404Âµs
=== RUN   TestAPIGroupDelete_InvalidId/negative_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000940] "DELETE http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:47004 - 404 59B in 368.085Âµs
--- PASS: TestAPIGroupDelete_InvalidId (0.01s)
    --- PASS: TestAPIGroupDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupDelete_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000941] "DELETE http://localhost:19090/api/v1/admin/groups/10554 HTTP/1.1" from [::1]:47008 - 401 22B in 110.93Âµs
--- PASS: TestAPIGroupDelete_Unauthorized (0.00s)
=== RUN   TestAPIGroupDelete_InvalidToken
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000942] "DELETE http://localhost:19090/api/v1/admin/groups/10555 HTTP/1.1" from [::1]:47010 - 401 22B in 319.794Âµs
--- PASS: TestAPIGroupDelete_InvalidToken (0.00s)
=== RUN   TestAPIGroupDelete_WithGroupPermissions
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14200}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000943] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47026 - 200 1156B in 5.369356ms
2025/11/25 13:25:43 INFO {"audit_event":"deleted_group","details":{"groupId":10556,"groupIdentifier":"test-group-5e1401cf","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000944] "DELETE http://localhost:19090/api/v1/admin/groups/10556 HTTP/1.1" from [::1]:47042 - 200 17B in 3.237707ms
--- PASS: TestAPIGroupDelete_WithGroupPermissions (0.02s)
=== RUN   TestAPIGroupDelete_ResponseStructure
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14201}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000945] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47052 - 200 1156B in 4.577358ms
2025/11/25 13:25:43 INFO {"audit_event":"deleted_group","details":{"groupId":10557,"groupIdentifier":"test-group-762d9cb7","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000946] "DELETE http://localhost:19090/api/v1/admin/groups/10557 HTTP/1.1" from [::1]:47054 - 200 17B in 1.715591ms
--- PASS: TestAPIGroupDelete_ResponseStructure (0.01s)
=== RUN   TestAPIGroupsGet_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14202}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000947] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47058 - 200 1156B in 4.862457ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000948] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:47068 - 200 467B in 1.896633ms
--- PASS: TestAPIGroupsGet_Success (0.02s)
=== RUN   TestAPIGroupsGet_EmptyGroups
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14203}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000949] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47084 - 200 1156B in 5.421203ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000950] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:47094 - 200 14B in 1.073559ms
    api_groups_get_test.go:113: Raw response body: {"groups":[]}
    api_groups_get_test.go:121: Response Groups: []
    api_groups_get_test.go:122: Groups is nil: false
    api_groups_get_test.go:123: Groups length: 0
    api_groups_get_test.go:129: Raw map parsing - groups value: []
    api_groups_get_test.go:130: Raw map parsing - groups type: []interface {}
--- PASS: TestAPIGroupsGet_EmptyGroups (0.01s)
=== RUN   TestAPIGroupsGet_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000951] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:47110 - 401 22B in 210.157Âµs
--- PASS: TestAPIGroupsGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupsGet_InvalidToken
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000952] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:47114 - 401 22B in 416.778Âµs
--- PASS: TestAPIGroupsGet_InvalidToken (0.00s)
=== RUN   TestAPIGroupsGet_EnhancedResponseStructure
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14204}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000953] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47122 - 200 1156B in 4.835556ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000954] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:47124 - 200 254B in 921Âµs
--- PASS: TestAPIGroupsGet_EnhancedResponseStructure (0.01s)
=== RUN   TestAPIGroupsGet_MixedTokenInclusion
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14205}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000955] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47130 - 200 1156B in 5.0702ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000956] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:47134 - 200 993B in 972.317Âµs
--- PASS: TestAPIGroupsGet_MixedTokenInclusion (0.02s)
=== RUN   TestAPIGroupsGet_MemberCountAccuracy
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14206}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000957] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47146 - 200 1156B in 5.125444ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000958] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:47156 - 200 246B in 746.681Âµs
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000959] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:47170 - 200 246B in 503.992Âµs
--- PASS: TestAPIGroupsGet_MemberCountAccuracy (0.03s)
=== RUN   TestAPIGroupPermissionsGet_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14207}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000960] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47176 - 200 1156B in 4.606244ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000961] "GET http://localhost:19090/api/v1/admin/groups/10566/permissions HTTP/1.1" from [::1]:47180 - 200 655B in 2.229002ms
--- PASS: TestAPIGroupPermissionsGet_Success (0.03s)
=== RUN   TestAPIGroupPermissionsGet_GroupNotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14208}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000962] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47190 - 200 1156B in 5.634856ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000963] "GET http://localhost:19090/api/v1/admin/groups/99999/permissions HTTP/1.1" from [::1]:47206 - 404 59B in 532.667Âµs
--- PASS: TestAPIGroupPermissionsGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsGet_InvalidGroupId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14209}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000964] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47216 - 200 1156B in 4.428868ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000965] "GET http://localhost:19090/api/v1/admin/groups/invalid/permissions HTTP/1.1" from [::1]:47224 - 400 74B in 408.101Âµs
--- PASS: TestAPIGroupPermissionsGet_InvalidGroupId (0.01s)
=== RUN   TestAPIGroupPermissionsGet_NoPermissions
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14210}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000966] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47232 - 200 1156B in 4.275328ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000967] "GET http://localhost:19090/api/v1/admin/groups/10567/permissions HTTP/1.1" from [::1]:47236 - 200 260B in 508.932Âµs
--- PASS: TestAPIGroupPermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIGroupPermissionsGet_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000968] "GET http://localhost:19090/api/v1/admin/groups/10568/permissions HTTP/1.1" from [::1]:47248 - 401 22B in 134.114Âµs
--- PASS: TestAPIGroupPermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupPermissionsPut_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14211}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000969] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47264 - 200 1156B in 4.331104ms
2025/11/25 13:25:43 INFO {"audit_event":"added_group_permission","details":{"groupId":10569,"loggedInUser":"","permissionId":10627}}
2025/11/25 13:25:43 INFO {"audit_event":"added_group_permission","details":{"groupId":10569,"loggedInUser":"","permissionId":10628}}
2025/11/25 13:25:43 INFO {"audit_event":"deleted_group_permission","details":{"groupId":10569,"loggedInUser":"","permissionId":10626}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000970] "PUT http://localhost:19090/api/v1/admin/groups/10569/permissions HTTP/1.1" from [::1]:47268 - 200 17B in 4.620009ms
--- PASS: TestAPIGroupPermissionsPut_Success (0.03s)
=== RUN   TestAPIGroupPermissionsPut_RemoveAllPermissions
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14212}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000971] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47280 - 200 1156B in 5.444387ms
2025/11/25 13:25:43 INFO {"audit_event":"deleted_group_permission","details":{"groupId":10570,"loggedInUser":"","permissionId":10629}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000972] "PUT http://localhost:19090/api/v1/admin/groups/10570/permissions HTTP/1.1" from [::1]:47282 - 200 17B in 1.973199ms
--- PASS: TestAPIGroupPermissionsPut_RemoveAllPermissions (0.02s)
=== RUN   TestAPIGroupPermissionsPut_AddPermissionsToEmptyGroup
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14213}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000973] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47296 - 200 1156B in 4.499412ms
2025/11/25 13:25:43 INFO {"audit_event":"added_group_permission","details":{"groupId":10571,"loggedInUser":"","permissionId":10630}}
2025/11/25 13:25:43 INFO {"audit_event":"added_group_permission","details":{"groupId":10571,"loggedInUser":"","permissionId":10631}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000974] "PUT http://localhost:19090/api/v1/admin/groups/10571/permissions HTTP/1.1" from [::1]:47312 - 200 17B in 2.906382ms
--- PASS: TestAPIGroupPermissionsPut_AddPermissionsToEmptyGroup (0.02s)
=== RUN   TestAPIGroupPermissionsPut_GroupNotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14214}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000975] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47322 - 200 1156B in 4.392299ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000976] "PUT http://localhost:19090/api/v1/admin/groups/99999/permissions HTTP/1.1" from [::1]:47326 - 404 59B in 495.366Âµs
--- PASS: TestAPIGroupPermissionsPut_GroupNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsPut_PermissionNotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14215}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000977] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47328 - 200 1156B in 4.436393ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000978] "PUT http://localhost:19090/api/v1/admin/groups/10572/permissions HTTP/1.1" from [::1]:47334 - 404 64B in 572.311Âµs
--- PASS: TestAPIGroupPermissionsPut_PermissionNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsPut_InvalidRequestBody
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14216}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000979] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47338 - 200 1156B in 4.568231ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000980] "PUT http://localhost:19090/api/v1/admin/groups/10573/permissions HTTP/1.1" from [::1]:47346 - 400 71B in 495.086Âµs
--- PASS: TestAPIGroupPermissionsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14217}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000981] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47358 - 200 1156B in 4.371259ms
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/non-numeric_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000982] "PUT http://localhost:19090/api/v1/admin/groups/abc/permissions HTTP/1.1" from [::1]:47366 - 400 74B in 430.052Âµs
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/negative_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000983] "PUT http://localhost:19090/api/v1/admin/groups/-1/permissions HTTP/1.1" from [::1]:47374 - 404 59B in 488.263Âµs
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/zero_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000984] "PUT http://localhost:19090/api/v1/admin/groups/0/permissions HTTP/1.1" from [::1]:47378 - 404 59B in 399.164Âµs
--- PASS: TestAPIGroupPermissionsPut_InvalidGroupId (0.01s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/negative_ID (0.00s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/zero_ID (0.00s)
=== RUN   TestAPIGroupPermissionsPut_DuplicatePermissionIds
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14218}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000985] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47390 - 200 1156B in 4.476879ms
2025/11/25 13:25:43 INFO {"audit_event":"added_group_permission","details":{"groupId":10574,"loggedInUser":"","permissionId":10632}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000986] "PUT http://localhost:19090/api/v1/admin/groups/10574/permissions HTTP/1.1" from [::1]:47404 - 200 17B in 1.787678ms
--- PASS: TestAPIGroupPermissionsPut_DuplicatePermissionIds (0.02s)
=== RUN   TestAPIGroupPermissionsPut_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000987] "PUT http://localhost:19090/api/v1/admin/groups/10575/permissions HTTP/1.1" from [::1]:47406 - 401 22B in 157.407Âµs
--- PASS: TestAPIGroupPermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIGroupPermissionsPut_ComplexScenario
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14219}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000988] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47416 - 200 1156B in 4.363805ms
2025/11/25 13:25:43 INFO {"audit_event":"added_group_permission","details":{"groupId":10576,"loggedInUser":"","permissionId":10636}}
2025/11/25 13:25:43 INFO {"audit_event":"deleted_group_permission","details":{"groupId":10576,"loggedInUser":"","permissionId":10633}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000989] "PUT http://localhost:19090/api/v1/admin/groups/10576/permissions HTTP/1.1" from [::1]:47430 - 200 17B in 3.790642ms
--- PASS: TestAPIGroupPermissionsPut_ComplexScenario (0.04s)
=== RUN   TestAPIGroupsSearch_Annotated_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14220}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000990] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47434 - 200 1156B in 4.38241ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000991] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=10637&page=1&size=200 HTTP/1.1" from [::1]:47438 - 200 804B in 2.385487ms
--- PASS: TestAPIGroupsSearch_Annotated_Success (0.02s)
=== RUN   TestAPIGroupsSearch_MissingAnnotateParam
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14221}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000992] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47452 - 200 1156B in 4.484614ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000993] "GET http://localhost:19090/api/v1/admin/groups/search?page=1&size=10 HTTP/1.1" from [::1]:47460 - 400 83B in 354.661Âµs
--- PASS: TestAPIGroupsSearch_MissingAnnotateParam (0.01s)
=== RUN   TestAPIGroupsSearch_InvalidAnnotateParam
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14222}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000994] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47462 - 200 1156B in 4.520401ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000995] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=abc&page=1&size=10 HTTP/1.1" from [::1]:47470 - 400 79B in 342.778Âµs
--- PASS: TestAPIGroupsSearch_InvalidAnnotateParam (0.01s)
=== RUN   TestAPIGroupsSearch_PermissionNotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14223}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000996] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47486 - 200 1156B in 4.377491ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000997] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=9681147 HTTP/1.1" from [::1]:47498 - 404 64B in 412.77Âµs
--- PASS: TestAPIGroupsSearch_PermissionNotFound (0.01s)
=== RUN   TestAPIGroupsSearch_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000998] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=10638 HTTP/1.1" from [::1]:47514 - 401 22B in 112.623Âµs
--- PASS: TestAPIGroupsSearch_Unauthorized (0.00s)
=== RUN   TestAPIGroupGet_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14224}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-000999] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47520 - 200 1156B in 5.330653ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001000] "GET http://localhost:19090/api/v1/admin/groups/10580 HTTP/1.1" from [::1]:47526 - 200 243B in 701.125Âµs
--- PASS: TestAPIGroupGet_Success (0.01s)
=== RUN   TestAPIGroupGet_NotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14225}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001001] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47542 - 200 1156B in 4.738614ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001002] "GET http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:47550 - 404 59B in 485.417Âµs
--- PASS: TestAPIGroupGet_NotFound (0.01s)
=== RUN   TestAPIGroupGet_InvalidId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14226}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001003] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47554 - 200 1156B in 4.794569ms
=== RUN   TestAPIGroupGet_InvalidId/non-numeric_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001004] "GET http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:47570 - 400 67B in 361.994Âµs
=== RUN   TestAPIGroupGet_InvalidId/empty_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001005] "GET http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:47582 - 200 14B in 566.841Âµs
=== RUN   TestAPIGroupGet_InvalidId/negative_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001006] "GET http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:47594 - 404 59B in 387.392Âµs
--- PASS: TestAPIGroupGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupGet_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001007] "GET http://localhost:19090/api/v1/admin/groups/10581 HTTP/1.1" from [::1]:47598 - 401 22B in 133.773Âµs
--- PASS: TestAPIGroupGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupGet_MemberCountAccuracy
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14227}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001008] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47612 - 200 1156B in 4.568302ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001009] "GET http://localhost:19090/api/v1/admin/groups/10582 HTTP/1.1" from [::1]:47614 - 200 243B in 513.62Âµs
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001010] "GET http://localhost:19090/api/v1/admin/groups/10582 HTTP/1.1" from [::1]:47624 - 200 243B in 514.933Âµs
--- PASS: TestAPIGroupGet_MemberCountAccuracy (0.02s)
=== RUN   TestAPIGroupUpdatePut_Success
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14228}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001011] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47634 - 200 1156B in 4.646369ms
2025/11/25 13:25:43 INFO {"audit_event":"updated_group","details":{"groupId":10583,"groupIdentifier":"updated-group-hcddet","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001012] "PUT http://localhost:19090/api/v1/admin/groups/10583 HTTP/1.1" from [::1]:47636 - 200 262B in 3.409963ms
--- PASS: TestAPIGroupUpdatePut_Success (0.01s)
=== RUN   TestAPIGroupUpdatePut_ValidationErrors
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14229}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001013] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47638 - 200 1156B in 4.601054ms
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/empty_group_identifier
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001014] "PUT http://localhost:19090/api/v1/admin/groups/10584 HTTP/1.1" from [::1]:47648 - 400 79B in 465.98Âµs
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/description_too_long
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001015] "PUT http://localhost:19090/api/v1/admin/groups/10584 HTTP/1.1" from [::1]:47650 - 400 115B in 418.862Âµs
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/invalid_identifier_format
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001016] "PUT http://localhost:19090/api/v1/admin/groups/10584 HTTP/1.1" from [::1]:47652 - 400 250B in 404.615Âµs
--- PASS: TestAPIGroupUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/empty_group_identifier (0.00s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/description_too_long (0.00s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIGroupUpdatePut_DuplicateIdentifier
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14230}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001017] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47662 - 200 1156B in 4.576217ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001018] "PUT http://localhost:19090/api/v1/admin/groups/10586 HTTP/1.1" from [::1]:47676 - 400 89B in 1.183716ms
--- PASS: TestAPIGroupUpdatePut_DuplicateIdentifier (0.01s)
=== RUN   TestAPIGroupUpdatePut_SameIdentifier
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14231}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001019] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47678 - 200 1156B in 4.654915ms
2025/11/25 13:25:43 INFO {"audit_event":"updated_group","details":{"groupId":10587,"groupIdentifier":"test-group-32f6d42f","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001020] "PUT http://localhost:19090/api/v1/admin/groups/10587 HTTP/1.1" from [::1]:47684 - 200 255B in 2.525382ms
--- PASS: TestAPIGroupUpdatePut_SameIdentifier (0.01s)
=== RUN   TestAPIGroupUpdatePut_NotFound
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14232}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001021] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47698 - 200 1156B in 4.642723ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001022] "PUT http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:47712 - 404 59B in 434.701Âµs
--- PASS: TestAPIGroupUpdatePut_NotFound (0.01s)
=== RUN   TestAPIGroupUpdatePut_InvalidId
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14233}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001023] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47720 - 200 1156B in 4.499101ms
=== RUN   TestAPIGroupUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001024] "PUT http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:47722 - 400 67B in 405.586Âµs
=== RUN   TestAPIGroupUpdatePut_InvalidId/empty_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001025] "PUT http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:47738 - 405 0B in 362.836Âµs
=== RUN   TestAPIGroupUpdatePut_InvalidId/negative_ID
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001026] "PUT http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:47740 - 404 59B in 366.222Âµs
--- PASS: TestAPIGroupUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupUpdatePut_InvalidRequestBody
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14234}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001027] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47752 - 200 1156B in 4.656157ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001028] "PUT http://localhost:19090/api/v1/admin/groups/10588 HTTP/1.1" from [::1]:47754 - 400 70B in 596.637Âµs
--- PASS: TestAPIGroupUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupUpdatePut_Unauthorized
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001029] "PUT http://localhost:19090/api/v1/admin/groups/10589 HTTP/1.1" from [::1]:47766 - 401 22B in 171.545Âµs
--- PASS: TestAPIGroupUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIGroupUpdatePut_WhitespaceHandling
2025/11/25 13:25:43 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14235}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001030] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47770 - 200 1156B in 4.665395ms
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001031] "PUT http://localhost:19090/api/v1/admin/groups/10590 HTTP/1.1" from [::1]:47778 - 400 250B in 760.467Âµs
2025/11/25 13:25:43 INFO {"audit_event":"updated_group","details":{"groupId":10590,"groupIdentifier":"whitespace-identifier-NeLh","loggedInUser":""}}
2025/11/25 13:25:43 [a357f2e3b56e/a04mE72Kgg-001032] "PUT http://localhost:19090/api/v1/admin/groups/10590 HTTP/1.1" from [::1]:47782 - 200 264B in 4.537494ms
--- PASS: TestAPIGroupUpdatePut_WhitespaceHandling (0.02s)
=== RUN   TestAPIGroupUpdatePut_BooleanFlags
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14236}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001033] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47788 - 200 1156B in 4.857708ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/both_false
2025/11/25 13:25:44 INFO {"audit_event":"updated_group","details":{"groupId":10591,"groupIdentifier":"test-bool-group-nozBqxBf","loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001034] "PUT http://localhost:19090/api/v1/admin/groups/10591 HTTP/1.1" from [::1]:47792 - 200 262B in 3.496216ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/id_token_only
2025/11/25 13:25:44 INFO {"audit_event":"updated_group","details":{"groupId":10591,"groupIdentifier":"test-bool-group-nozBqxBf","loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001035] "PUT http://localhost:19090/api/v1/admin/groups/10591 HTTP/1.1" from [::1]:47800 - 200 265B in 2.623727ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/access_token_only
2025/11/25 13:25:44 INFO {"audit_event":"updated_group","details":{"groupId":10591,"groupIdentifier":"test-bool-group-nozBqxBf","loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001036] "PUT http://localhost:19090/api/v1/admin/groups/10591 HTTP/1.1" from [::1]:47804 - 200 269B in 2.720049ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/both_true
2025/11/25 13:25:44 INFO {"audit_event":"updated_group","details":{"groupId":10591,"groupIdentifier":"test-bool-group-nozBqxBf","loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001037] "PUT http://localhost:19090/api/v1/admin/groups/10591 HTTP/1.1" from [::1]:47814 - 200 260B in 2.461661ms
--- PASS: TestAPIGroupUpdatePut_BooleanFlags (0.02s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/both_false (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/id_token_only (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/access_token_only (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/both_true (0.00s)
=== RUN   TestAPIGroupUpdatePut_MemberCountInResponse
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14237}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001038] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47824 - 200 1156B in 4.603188ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_group","details":{"groupId":10592,"groupIdentifier":"test-group-4e3eef0d-updated","loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001039] "PUT http://localhost:19090/api/v1/admin/groups/10592 HTTP/1.1" from [::1]:47832 - 200 263B in 2.924836ms
--- PASS: TestAPIGroupUpdatePut_MemberCountInResponse (0.02s)
=== RUN   TestAPIPermissionUsersGet_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14238}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001040] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47836 - 200 1156B in 4.856106ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001041] "GET http://localhost:19090/api/v1/admin/permissions/10639/users?page=1&size=200 HTTP/1.1" from [::1]:47840 - 200 1456B in 3.018734ms
--- PASS: TestAPIPermissionUsersGet_Success (0.03s)
=== RUN   TestAPIPermissionUsersGet_InvalidPermissionId
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14239}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001042] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47846 - 200 1156B in 4.418148ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001043] "GET http://localhost:19090/api/v1/admin/permissions/invalid/users HTTP/1.1" from [::1]:47858 - 400 79B in 480.999Âµs
--- PASS: TestAPIPermissionUsersGet_InvalidPermissionId (0.01s)
=== RUN   TestAPIPermissionUsersGet_PermissionNotFound
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14240}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001044] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47874 - 200 1156B in 4.365608ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001045] "GET http://localhost:19090/api/v1/admin/permissions/7333196/users HTTP/1.1" from [::1]:47888 - 404 64B in 428.169Âµs
--- PASS: TestAPIPermissionUsersGet_PermissionNotFound (0.01s)
=== RUN   TestAPIPermissionUsersGet_UserinfoForbidden
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14241}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001046] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47898 - 200 1156B in 4.479994ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001047] "GET http://localhost:19090/api/v1/admin/permissions/1/users HTTP/1.1" from [::1]:47912 - 400 96B in 446.523Âµs
--- PASS: TestAPIPermissionUsersGet_UserinfoForbidden (0.01s)
=== RUN   TestAPIPermissionUsersGet_Unauthorized
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001048] "GET http://localhost:19090/api/v1/admin/permissions/10640/users HTTP/1.1" from [::1]:47918 - 401 22B in 234.994Âµs
--- PASS: TestAPIPermissionUsersGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcePermissionsGet_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14242}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001049] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47926 - 200 1156B in 4.418037ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001050] "GET http://localhost:19090/api/v1/admin/resources/10576/permissions HTTP/1.1" from [::1]:47936 - 200 670B in 814.018Âµs
--- PASS: TestAPIResourcePermissionsGet_Success (0.02s)
=== RUN   TestAPIResourcePermissionsGet_NoPermissions
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14243}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001051] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47944 - 200 1156B in 4.349879ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001052] "GET http://localhost:19090/api/v1/admin/resources/10577/permissions HTTP/1.1" from [::1]:47946 - 200 19B in 379.427Âµs
--- PASS: TestAPIResourcePermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NonExistentResource
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14244}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001053] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47950 - 200 1156B in 4.279276ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001054] "GET http://localhost:19090/api/v1/admin/resources/99999/permissions HTTP/1.1" from [::1]:47958 - 200 19B in 471.331Âµs
--- PASS: TestAPIResourcePermissionsGet_NonExistentResource (0.01s)
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14245}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001055] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47968 - 200 1156B in 4.453755ms
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/non-numeric_ID
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001056] "GET http://localhost:19090/api/v1/admin/resources/abc/permissions HTTP/1.1" from [::1]:47974 - 400 77B in 541.924Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/empty_ID
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001057] "GET http://localhost:19090/api/v1/admin/resources//permissions HTTP/1.1" from [::1]:47984 - 400 74B in 294.026Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/negative_ID
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001058] "GET http://localhost:19090/api/v1/admin/resources/-1/permissions HTTP/1.1" from [::1]:47986 - 200 19B in 369.238Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/zero_ID
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001059] "GET http://localhost:19090/api/v1/admin/resources/0/permissions HTTP/1.1" from [::1]:47998 - 200 19B in 334.993Âµs
--- PASS: TestAPIResourcePermissionsGet_InvalidResourceId (0.01s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/non-numeric_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/empty_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/negative_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/zero_ID (0.00s)
=== RUN   TestAPIResourcePermissionsGet_AuthServerResourceFiltersUserinfo
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14246}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001060] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48002 - 200 1156B in 4.284516ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001061] "GET http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:48004 - 200 491B in 562.353Âµs
--- PASS: TestAPIResourcePermissionsGet_AuthServerResourceFiltersUserinfo (0.01s)
=== RUN   TestAPIResourcePermissionsGet_AuthServerResourceIncludesOtherPermissions
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14247}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001062] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48018 - 200 1156B in 4.438607ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001063] "GET http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:48032 - 200 702B in 1.757361ms
--- PASS: TestAPIResourcePermissionsGet_AuthServerResourceIncludesOtherPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NonAuthServerResourceIncludesAllPermissions
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14248}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001064] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48034 - 200 1156B in 4.527866ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001065] "GET http://localhost:19090/api/v1/admin/resources/10578/permissions HTTP/1.1" from [::1]:48044 - 200 472B in 1.201911ms
--- PASS: TestAPIResourcePermissionsGet_NonAuthServerResourceIncludesAllPermissions (0.02s)
=== RUN   TestAPIResourcePermissionsGet_Unauthorized
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001066] "GET http://localhost:19090/api/v1/admin/resources/10579/permissions HTTP/1.1" from [::1]:48052 - 401 22B in 236.066Âµs
--- PASS: TestAPIResourcePermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcePermissionsGet_InvalidAccessToken
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001067] "GET http://localhost:19090/api/v1/admin/resources/10580/permissions HTTP/1.1" from [::1]:48064 - 401 22B in 425.654Âµs
--- PASS: TestAPIResourcePermissionsGet_InvalidAccessToken (0.00s)
=== RUN   TestAPIResourcePermissionsGet_LargeNumberOfPermissions
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14249}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001068] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48072 - 200 1156B in 5.452091ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001069] "GET http://localhost:19090/api/v1/admin/resources/10581/permissions HTTP/1.1" from [::1]:48084 - 200 2408B in 1.675596ms
--- PASS: TestAPIResourcePermissionsGet_LargeNumberOfPermissions (0.04s)
=== RUN   TestAPIResourcePermissionsPut_Success_CreateUpdateDelete
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14250}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001070] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48092 - 200 1156B in 4.482901ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_resource_permissions","details":{"loggedInUser":"","resourceId":10582}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001071] "PUT http://localhost:19090/api/v1/admin/resources/10582/permissions HTTP/1.1" from [::1]:48096 - 200 17B in 7.946064ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001072] "GET http://localhost:19090/api/v1/admin/resources/10582/permissions HTTP/1.1" from [::1]:48102 - 200 566B in 543.517Âµs
--- PASS: TestAPIResourcePermissionsPut_Success_CreateUpdateDelete (0.03s)
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14251}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001073] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48110 - 200 1156B in 4.327487ms
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/empty_identifier
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001074] "PUT http://localhost:19090/api/v1/admin/resources/10583/permissions HTTP/1.1" from [::1]:48120 - 400 84B in 466.902Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/invalid_format
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001075] "PUT http://localhost:19090/api/v1/admin/resources/10583/permissions HTTP/1.1" from [::1]:48132 - 400 250B in 364.709Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/html_in_description
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001076] "PUT http://localhost:19090/api/v1/admin/resources/10583/permissions HTTP/1.1" from [::1]:48140 - 400 151B in 332.789Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/too_long_description
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001077] "PUT http://localhost:19090/api/v1/admin/resources/10583/permissions HTTP/1.1" from [::1]:48148 - 400 116B in 397.4Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/duplicate_identifiers
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001078] "PUT http://localhost:19090/api/v1/admin/resources/10583/permissions HTTP/1.1" from [::1]:48152 - 400 80B in 357.536Âµs
--- PASS: TestAPIResourcePermissionsPut_ValidationErrors (0.01s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/empty_identifier (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/invalid_format (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/html_in_description (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/too_long_description (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/duplicate_identifiers (0.00s)
=== RUN   TestAPIResourcePermissionsPut_UpdateConflict
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14252}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001079] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48164 - 200 1156B in 4.261903ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001080] "PUT http://localhost:19090/api/v1/admin/resources/10584/permissions HTTP/1.1" from [::1]:48176 - 400 95B in 506.507Âµs
--- PASS: TestAPIResourcePermissionsPut_UpdateConflict (0.02s)
=== RUN   TestAPIResourcePermissionsPut_SystemResourceDenied
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14253}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001081] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48182 - 200 1156B in 4.314643ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001082] "PUT http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:48192 - 400 92B in 399.836Âµs
--- PASS: TestAPIResourcePermissionsPut_SystemResourceDenied (0.01s)
=== RUN   TestAPIResourcePermissionsPut_Unauthorized
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001083] "PUT http://localhost:19090/api/v1/admin/resources/10585/permissions HTTP/1.1" from [::1]:48204 - 401 22B in 166.434Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001084] "PUT http://localhost:19090/api/v1/admin/resources/10585/permissions HTTP/1.1" from [::1]:48220 - 401 22B in 360.07Âµs
--- PASS: TestAPIResourcePermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIResourcesCreate_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14254}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001085] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48224 - 200 1156B in 4.623676ms
2025/11/25 13:25:44 INFO {"audit_event":"created_resource","details":{"loggedInUser":"","resourceId":10586,"resourceIdentifier":"api-test-create-resource-zoWxYkGr"}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001086] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48226 - 201 115B in 2.620511ms
--- PASS: TestAPIResourcesCreate_Success (0.01s)
=== RUN   TestAPIResourcesCreate_ValidationErrors
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14255}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001087] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48232 - 200 1156B in 4.453845ms
=== RUN   TestAPIResourcesCreate_ValidationErrors/missing_identifier
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001088] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48242 - 400 82B in 431.876Âµs
=== RUN   TestAPIResourcesCreate_ValidationErrors/too_long_description
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001089] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48248 - 400 115B in 358.457Âµs
=== RUN   TestAPIResourcesCreate_ValidationErrors/invalid_identifier_format
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001090] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48256 - 400 250B in 339.351Âµs
--- PASS: TestAPIResourcesCreate_ValidationErrors (0.01s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/missing_identifier (0.00s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/too_long_description (0.00s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIResourcesCreate_DuplicateIdentifier
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14256}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001091] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48260 - 200 1156B in 4.307589ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001092] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48268 - 400 92B in 1.109196ms
--- PASS: TestAPIResourcesCreate_DuplicateIdentifier (0.01s)
=== RUN   TestAPIResourcesCreate_InvalidRequestBody
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14257}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001093] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48282 - 200 1156B in 4.329651ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001094] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:60812 - 400 70B in 364.719Âµs
--- PASS: TestAPIResourcesCreate_InvalidRequestBody (0.01s)
=== RUN   TestAPIResourcesCreate_UnauthorizedAndScope
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001095] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:60828 - 401 22B in 119.596Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001096] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:60840 - 401 22B in 289.898Âµs
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14258}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001097] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60842 - 200 1165B in 4.339449ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001098] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:60854 - 403 19B in 406.127Âµs
--- PASS: TestAPIResourcesCreate_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceDelete_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14259}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001099] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60868 - 200 1156B in 4.345591ms
2025/11/25 13:25:44 INFO {"audit_event":"deleted_resource","details":{"loggedInUser":"","resourceId":10588,"resourceIdentifier":"api-test-del-resource-NVgMKA"}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001100] "DELETE http://localhost:19090/api/v1/admin/resources/10588 HTTP/1.1" from [::1]:60880 - 200 17B in 3.304624ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001101] "GET http://localhost:19090/api/v1/admin/resources/10588 HTTP/1.1" from [::1]:60894 - 404 62B in 582.351Âµs
--- PASS: TestAPIResourceDelete_Success (0.01s)
=== RUN   TestAPIResourceDelete_NotFoundAndInvalidId
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14260}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001102] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60904 - 200 1156B in 4.536311ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001103] "DELETE http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:60916 - 404 62B in 470.659Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001104] "DELETE http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:60930 - 400 70B in 357.866Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001105] "DELETE http://localhost:19090/api/v1/admin/resources/-1 HTTP/1.1" from [::1]:60944 - 404 62B in 437.347Âµs
--- PASS: TestAPIResourceDelete_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIResourceDelete_SystemLevelResource
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14261}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001106] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:60956 - 200 1156B in 4.758942ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001107] "DELETE http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:60972 - 400 91B in 466.342Âµs
--- PASS: TestAPIResourceDelete_SystemLevelResource (0.01s)
=== RUN   TestAPIResourceDelete_UnauthorizedAndScope
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001108] "DELETE http://localhost:19090/api/v1/admin/resources/10589 HTTP/1.1" from [::1]:60984 - 401 22B in 147.969Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001109] "DELETE http://localhost:19090/api/v1/admin/resources/10589 HTTP/1.1" from [::1]:32768 - 401 22B in 347.297Âµs
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14262}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001110] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32770 - 200 1165B in 4.730468ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001111] "DELETE http://localhost:19090/api/v1/admin/resources/10589 HTTP/1.1" from [::1]:32786 - 403 19B in 343.499Âµs
--- PASS: TestAPIResourceDelete_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceGet_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14263}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001112] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32794 - 200 1156B in 4.482169ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001113] "GET http://localhost:19090/api/v1/admin/resources/10590 HTTP/1.1" from [::1]:32802 - 200 107B in 466.11Âµs
--- PASS: TestAPIResourceGet_Success (0.01s)
=== RUN   TestAPIResourceGet_NotFoundAndInvalidId
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14264}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001114] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32816 - 200 1156B in 4.626842ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001115] "GET http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:32828 - 404 62B in 484.505Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001116] "GET http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:32830 - 400 70B in 383.004Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001117] "GET http://localhost:19090/api/v1/admin/resources/-1 HTTP/1.1" from [::1]:32832 - 404 62B in 401.208Âµs
--- PASS: TestAPIResourceGet_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIResourceGet_UnauthorizedAndScope
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001118] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:32842 - 401 22B in 98.917Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001119] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:32846 - 401 22B in 292.683Âµs
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14265}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001120] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32856 - 200 1165B in 4.441071ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001121] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:32862 - 403 19B in 517.969Âµs
--- PASS: TestAPIResourceGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceUpdatePut_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14266}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001122] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32864 - 200 1156B in 4.671106ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_resource","details":{"loggedInUser":"","resourceId":10591,"resourceIdentifier":"updated-resource-ybOwXS"}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001123] "PUT http://localhost:19090/api/v1/admin/resources/10591 HTTP/1.1" from [::1]:32872 - 200 102B in 3.36078ms
--- PASS: TestAPIResourceUpdatePut_Success (0.01s)
=== RUN   TestAPIResourceUpdatePut_ValidationErrors
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14267}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001124] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32882 - 200 1156B in 4.592197ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001125] "PUT http://localhost:19090/api/v1/admin/resources/10592 HTTP/1.1" from [::1]:32894 - 400 82B in 422.769Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001126] "PUT http://localhost:19090/api/v1/admin/resources/10592 HTTP/1.1" from [::1]:32910 - 400 115B in 374.768Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001127] "PUT http://localhost:19090/api/v1/admin/resources/10592 HTTP/1.1" from [::1]:32926 - 400 250B in 407.169Âµs
--- PASS: TestAPIResourceUpdatePut_ValidationErrors (0.01s)
=== RUN   TestAPIResourceUpdatePut_DuplicateIdentifier
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14268}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001128] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32928 - 200 1156B in 4.677558ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001129] "PUT http://localhost:19090/api/v1/admin/resources/10594 HTTP/1.1" from [::1]:32940 - 400 92B in 1.219544ms
--- PASS: TestAPIResourceUpdatePut_DuplicateIdentifier (0.01s)
=== RUN   TestAPIResourceUpdatePut_SystemLevelResource
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14269}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001130] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32956 - 200 1156B in 4.548885ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001131] "PUT http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:32966 - 400 101B in 637.815Âµs
--- PASS: TestAPIResourceUpdatePut_SystemLevelResource (0.01s)
=== RUN   TestAPIResourceUpdatePut_InvalidIdAndBody
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14270}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001132] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:32980 - 200 1156B in 4.542784ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001133] "PUT http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:32994 - 400 70B in 563.435Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001134] "PUT http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:33002 - 404 62B in 470.549Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001135] "PUT http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:33014 - 400 101B in 376.541Âµs
--- PASS: TestAPIResourceUpdatePut_InvalidIdAndBody (0.01s)
=== RUN   TestAPIResourceUpdatePut_UnauthorizedAndScope
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001136] "PUT http://localhost:19090/api/v1/admin/resources/10595 HTTP/1.1" from [::1]:33026 - 401 22B in 151.105Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001137] "PUT http://localhost:19090/api/v1/admin/resources/10595 HTTP/1.1" from [::1]:33038 - 401 22B in 419.492Âµs
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14271}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001138] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33044 - 200 1165B in 4.980501ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001139] "PUT http://localhost:19090/api/v1/admin/resources/10595 HTTP/1.1" from [::1]:33054 - 403 19B in 692.248Âµs
--- PASS: TestAPIResourceUpdatePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourcesGet_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14272}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001140] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33070 - 200 1156B in 5.34553ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001141] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:33078 - 200 24953B in 1.580165ms
--- PASS: TestAPIResourcesGet_Success (0.02s)
=== RUN   TestAPIResourcesGet_EmptyDatabase
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14273}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001142] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33082 - 200 1156B in 4.793126ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001143] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:33088 - 200 24769B in 936.32Âµs
--- PASS: TestAPIResourcesGet_EmptyDatabase (0.01s)
=== RUN   TestAPIResourcesGet_Unauthorized
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001144] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:33092 - 401 22B in 193.556Âµs
--- PASS: TestAPIResourcesGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcesGet_InvalidToken
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001145] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:33108 - 401 22B in 306.409Âµs
--- PASS: TestAPIResourcesGet_InvalidToken (0.00s)
=== RUN   TestAPIResourcesGet_InsufficientScope
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14274}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001146] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33110 - 200 1165B in 4.882576ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001147] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:33116 - 403 19B in 322.73Âµs
--- PASS: TestAPIResourcesGet_InsufficientScope (0.01s)
=== RUN   TestAPIResourcesGet_ManyResources
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14275}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001148] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33124 - 200 1156B in 4.754624ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001149] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:33134 - 200 25061B in 930.177Âµs
--- PASS: TestAPIResourcesGet_ManyResources (0.02s)
=== RUN   TestAPISettingsEmailGet_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14276}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001150] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33150 - 200 1156B in 4.53573ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001151] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33158 - 200 190B in 353.187Âµs
--- PASS: TestAPISettingsEmailGet_Success (0.01s)
=== RUN   TestAPISettingsEmailPut_EnableSuccess
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14277}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001152] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33162 - 200 1156B in 4.385486ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001153] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33172 - 200 190B in 3.74715ms
--- PASS: TestAPISettingsEmailPut_EnableSuccess (0.01s)
=== RUN   TestAPISettingsEmailPut_DisableResetsFields
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14278}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001154] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33174 - 200 1156B in 4.573772ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001155] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33186 - 200 192B in 3.181071ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001156] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33200 - 200 152B in 2.919026ms
--- PASS: TestAPISettingsEmailPut_DisableResetsFields (0.02s)
=== RUN   TestAPISettingsEmailPut_ValidationErrors
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14279}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001157] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33210 - 200 1156B in 4.452763ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001158] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33226 - 400 73B in 437.737Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001159] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33238 - 400 73B in 389.847Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001160] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33252 - 400 89B in 305.097Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001161] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33260 - 400 94B in 367.545Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001162] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33272 - 400 75B in 499.073Âµs
--- PASS: TestAPISettingsEmailPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsEmailPut_TCPConnectionFailure
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14280}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001163] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33278 - 200 1156B in 4.703107ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001164] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33286 - 400 142B in 595.284Âµs
--- PASS: TestAPISettingsEmailPut_TCPConnectionFailure (0.01s)
=== RUN   TestAPISettingsEmailPut_PasswordLifecycle
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14281}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001165] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33296 - 200 1156B in 4.833643ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001166] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33308 - 200 180B in 3.790983ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001167] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33320 - 200 180B in 492.029Âµs
2025/11/25 13:25:44 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001168] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33330 - 200 181B in 3.230564ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001169] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33344 - 200 181B in 1.152898ms
--- PASS: TestAPISettingsEmailPut_PasswordLifecycle (0.02s)
=== RUN   TestAPISettingsEmailSendTest_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14282}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001170] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33356 - 200 1156B in 4.557922ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001171] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33362 - 200 181B in 2.006361ms
2025/11/25 13:25:44 INFO {"audit_event":"sent_test_email","details":{"loggedInUser":"","to":"someone@example.com"}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001172] "POST http://localhost:19090/api/v1/admin/settings/email/send-test HTTP/1.1" from [::1]:33370 - 200 17B in 872.779Âµs
--- PASS: TestAPISettingsEmailSendTest_Success (0.01s)
=== RUN   TestAPISettingsEmailSendTest_SMTPDisabled
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14283}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001173] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33384 - 200 1156B in 4.37165ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001174] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33394 - 200 152B in 1.817413ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001175] "POST http://localhost:19090/api/v1/admin/settings/email/send-test HTTP/1.1" from [::1]:33410 - 400 70B in 372.253Âµs
--- PASS: TestAPISettingsEmailSendTest_SMTPDisabled (0.01s)
=== RUN   TestAPISettingsEmail_Unauthorized
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001176] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33422 - 401 22B in 100.32Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001177] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:33422 - 401 22B in 67.959Âµs
--- PASS: TestAPISettingsEmail_Unauthorized (0.00s)
=== RUN   TestAPISettingsGeneralGet_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14284}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001178] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33436 - 200 1156B in 4.579563ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001179] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33440 - 200 211B in 393.333Âµs
--- PASS: TestAPISettingsGeneralGet_Success (0.01s)
=== RUN   TestAPISettingsGeneralPut_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14285}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001180] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33442 - 200 1156B in 4.574574ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001181] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33446 - 200 221B in 3.105147ms
--- PASS: TestAPISettingsGeneralPut_Success (0.01s)
=== RUN   TestAPISettingsGeneralPut_DisableSelfRegForcesVerificationFalse
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14286}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001182] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33462 - 200 1164B in 5.494792ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001183] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33468 - 200 210B in 1.733295ms
2025/11/25 13:25:44 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001184] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33482 - 200 212B in 1.609161ms
--- PASS: TestAPISettingsGeneralPut_DisableSelfRegForcesVerificationFalse (0.01s)
=== RUN   TestAPISettingsGeneralPut_ValidationErrors
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14287}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001185] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33498 - 200 1156B in 4.591866ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001186] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33506 - 400 109B in 404.745Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001187] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33518 - 400 92B in 453.598Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001188] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33532 - 400 239B in 470.709Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001189] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33546 - 400 239B in 358.738Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001190] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33562 - 400 107B in 424.292Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001191] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33568 - 400 107B in 332.218Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001192] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33572 - 400 74B in 367.495Âµs
--- PASS: TestAPISettingsGeneralPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsGeneral_UnauthorizedAndScope
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001193] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33574 - 401 22B in 94.238Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001194] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33576 - 401 22B in 251.355Âµs
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14288}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001195] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33590 - 200 1165B in 5.07059ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001196] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33592 - 403 19B in 412.49Âµs
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001197] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:33574 - 401 22B in 89.99Âµs
--- PASS: TestAPISettingsGeneral_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsKeysGet_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14289}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001198] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33594 - 200 1156B in 4.596165ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001199] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33606 - 200 5238B in 691.717Âµs
--- PASS: TestAPISettingsKeysGet_Success (0.01s)
=== RUN   TestAPISettingsKeysRotatePost_Success
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14290}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001200] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33616 - 200 1156B in 4.685383ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001201] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33632 - 200 5238B in 628.437Âµs
2025/11/25 13:25:44 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001202] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:33636 - 200 17B in 163.431978ms
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001203] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33642 - 200 7854B in 1.103775ms
--- PASS: TestAPISettingsKeysRotatePost_Success (0.17s)
=== RUN   TestAPISettingsKeysRotatePost_DeletesPrevious
2025/11/25 13:25:44 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14291}}
2025/11/25 13:25:44 [a357f2e3b56e/a04mE72Kgg-001204] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33652 - 200 1156B in 4.938421ms
2025/11/25 13:25:45 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001205] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:33668 - 200 17B in 658.801139ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001206] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33676 - 200 7854B in 1.641601ms
2025/11/25 13:25:45 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001207] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:33688 - 200 17B in 64.529295ms
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14292}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001208] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33700 - 200 1156B in 5.093584ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001209] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33706 - 200 7854B in 765.025Âµs
--- PASS: TestAPISettingsKeysRotatePost_DeletesPrevious (0.74s)
=== RUN   TestAPISettingsKeyDelete_Success
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14293}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001210] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33716 - 200 1156B in 4.761256ms
2025/11/25 13:25:45 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001211] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:33726 - 200 17B in 204.689543ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001212] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33742 - 200 7854B in 978.669Âµs
2025/11/25 13:25:45 INFO {"audit_event":"revoked_key","details":{"keyId":"5acd3e7d-cb0d-41e1-8c93-bd82e17d5bff","loggedInUser":""}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001213] "DELETE http://localhost:19090/api/v1/admin/settings/keys/32 HTTP/1.1" from [::1]:33744 - 200 17B in 2.753493ms
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14294}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001214] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33752 - 200 1156B in 4.727463ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001215] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33762 - 200 5238B in 553.516Âµs
--- PASS: TestAPISettingsKeyDelete_Success (0.23s)
=== RUN   TestAPISettingsKeyDelete_ValidationAndUnauthorized
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14295}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001216] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33766 - 200 1156B in 4.35581ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001217] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33770 - 200 5238B in 538.628Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001218] "DELETE http://localhost:19090/api/v1/admin/settings/keys/33 HTTP/1.1" from [::1]:33778 - 400 85B in 357.495Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001219] "DELETE http://localhost:19090/api/v1/admin/settings/keys/99999999 HTTP/1.1" from [::1]:33788 - 400 64B in 339.581Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001220] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:33802 - 401 22B in 144.803Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001221] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:33802 - 401 22B in 105.669Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001222] "DELETE http://localhost:19090/api/v1/admin/settings/keys/1 HTTP/1.1" from [::1]:33806 - 401 22B in 123.754Âµs
--- PASS: TestAPISettingsKeyDelete_ValidationAndUnauthorized (0.01s)
=== RUN   TestAPISettingsSessionsGet_Success
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14296}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001223] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33812 - 200 1156B in 4.432946ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001224] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33822 - 200 80B in 403.132Âµs
--- PASS: TestAPISettingsSessionsGet_Success (0.01s)
=== RUN   TestAPISettingsSessionsPut_Success
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14297}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001225] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33832 - 200 1156B in 4.362573ms
2025/11/25 13:25:45 INFO {"audit_event":"updated_sessions_settings","details":{"loggedInUser":""}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001226] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33842 - 200 80B in 1.557333ms
--- PASS: TestAPISettingsSessionsPut_Success (0.01s)
=== RUN   TestAPISettingsSessionsPut_ValidationErrors
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14298}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001227] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33858 - 200 1156B in 4.300646ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001228] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33864 - 400 116B in 330.013Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001229] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33868 - 400 116B in 279.438Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001230] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33874 - 400 123B in 274.379Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001231] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33878 - 400 123B in 286.241Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001232] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33884 - 400 123B in 272.175Âµs
--- PASS: TestAPISettingsSessionsPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsSessionsPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14299}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001233] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33896 - 200 1156B in 4.227227ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001234] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33900 - 400 70B in 315.175Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001235] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33900 - 401 22B in 80.111Âµs
--- PASS: TestAPISettingsSessionsPut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsSessions_UnauthorizedAndScope
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001236] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33916 - 401 22B in 119.526Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001237] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33928 - 401 22B in 247.418Âµs
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14300}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001238] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33932 - 200 1165B in 4.294374ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001239] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:33944 - 403 19B in 344.541Âµs
--- PASS: TestAPISettingsSessions_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsTokensGet_Success
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14301}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001240] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33954 - 200 1156B in 4.231836ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001241] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:33956 - 200 174B in 402.009Âµs
--- PASS: TestAPISettingsTokensGet_Success (0.01s)
=== RUN   TestAPISettingsTokensPut_Success
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14302}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33962 - 200 1156B in 4.3031ms
2025/11/25 13:25:45 INFO {"audit_event":"updated_tokens_settings","details":{"loggedInUser":"","new":{"includeOpenIDConnectClaimsInAccessToken":true,"refreshTokenOfflineIdleTimeoutInSeconds":3600,"refreshTokenOfflineMaxLifetimeInSeconds":7200,"tokenExpirationInSeconds":600},"old":{"includeOpenIDConnectClaimsInAccessToken":true,"refreshTokenOfflineIdleTimeoutInSeconds":3600,"refreshTokenOfflineMaxLifetimeInSeconds":7200,"tokenExpirationInSeconds":600}}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001243] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:33968 - 200 174B in 1.602568ms
--- PASS: TestAPISettingsTokensPut_Success (0.01s)
=== RUN   TestAPISettingsTokensPut_ValidationErrors
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14303}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001244] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:33970 - 200 1156B in 4.290777ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001245] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:33974 - 400 105B in 379.738Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001246] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:33976 - 400 112B in 300.778Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001247] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:33980 - 400 125B in 309.605Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001248] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:33988 - 400 132B in 332.257Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001249] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:33990 - 400 125B in 287.403Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001250] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:34002 - 400 132B in 312.801Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001251] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:34008 - 400 124B in 269.9Âµs
--- PASS: TestAPISettingsTokensPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsTokens_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14304}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001252] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34016 - 200 1156B in 4.317939ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001253] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:34028 - 400 70B in 1.203514ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001254] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:34028 - 401 22B in 147.238Âµs
--- PASS: TestAPISettingsTokens_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsTokens_UnauthorizedAndScope
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001255] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:34032 - 401 22B in 125.267Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001256] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:34046 - 401 22B in 245.634Âµs
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14305}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001257] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34060 - 200 1165B in 4.367903ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001258] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:34070 - 403 19B in 422.208Âµs
--- PASS: TestAPISettingsTokens_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsUIThemeGet_Success
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14306}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001259] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34080 - 200 1156B in 4.285728ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001260] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34084 - 200 333B in 364.048Âµs
--- PASS: TestAPISettingsUIThemeGet_Success (0.01s)
=== RUN   TestAPISettingsUIThemePut_Success
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14307}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001261] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34100 - 200 1156B in 4.292641ms
2025/11/25 13:25:45 INFO {"audit_event":"updated_ui_theme_settings","details":{"loggedInUser":"","newUITheme":"light","oldUITheme":""}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001262] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34104 - 200 338B in 3.383613ms
2025/11/25 13:25:45 INFO {"audit_event":"updated_ui_theme_settings","details":{"loggedInUser":"","newUITheme":"","oldUITheme":"light"}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001263] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34114 - 200 333B in 1.546893ms
--- PASS: TestAPISettingsUIThemePut_Success (0.01s)
=== RUN   TestAPISettingsUIThemePut_ValidationErrors
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14308}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001264] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34126 - 200 1156B in 4.295647ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001265] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34132 - 400 65B in 576.269Âµs
--- PASS: TestAPISettingsUIThemePut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsUITheme_InvalidRequestBodyAndUnauthorized
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14309}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001266] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34146 - 200 1156B in 4.423388ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001267] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34162 - 400 70B in 382.933Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001268] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34162 - 401 22B in 102.894Âµs
--- PASS: TestAPISettingsUITheme_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsUITheme_UnauthorizedAndScope
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001269] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34174 - 401 22B in 92.995Âµs
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001270] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34178 - 401 22B in 298.825Âµs
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14310}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001271] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34188 - 200 1165B in 4.27101ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001272] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:34192 - 403 19B in 314.244Âµs
--- PASS: TestAPISettingsUITheme_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIUserGroupsGet_Success
2025/11/25 13:25:45 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14311}}
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001273] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34200 - 200 1156B in 4.303371ms
2025/11/25 13:25:45 [a357f2e3b56e/a04mE72Kgg-001274] "GET http://localhost:19090/api/v1/admin/users/11688/groups HTTP/1.1" from [::1]:34202 - 200 1249B in 1.320435ms
--- PASS: TestAPIUserGroupsGet_Success (0.02s)
=== RUN   TestAPIUserGroupsGet_NoGroups
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14312}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34208 - 200 1156B in 4.284135ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001276] "GET http://localhost:19090/api/v1/admin/users/11689/groups HTTP/1.1" from [::1]:34224 - 200 715B in 654.136Âµs
--- PASS: TestAPIUserGroupsGet_NoGroups (0.01s)
=== RUN   TestAPIUserGroupsGet_UserNotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14313}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001277] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34234 - 200 1156B in 4.32349ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001278] "GET http://localhost:19090/api/v1/admin/users/99999/groups HTTP/1.1" from [::1]:34238 - 404 63B in 441.714Âµs
--- PASS: TestAPIUserGroupsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserGroupsGet_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14314}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34252 - 200 1156B in 4.293974ms
=== RUN   TestAPIUserGroupsGet_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001280] "GET http://localhost:19090/api/v1/admin/users/abc/groups HTTP/1.1" from [::1]:34266 - 400 65B in 380.138Âµs
=== RUN   TestAPIUserGroupsGet_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001281] "GET http://localhost:19090/api/v1/admin/users//groups HTTP/1.1" from [::1]:34280 - 400 69B in 320.025Âµs
=== RUN   TestAPIUserGroupsGet_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001282] "GET http://localhost:19090/api/v1/admin/users/-1/groups HTTP/1.1" from [::1]:34282 - 404 63B in 498.221Âµs
--- PASS: TestAPIUserGroupsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGroupsGet_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001283] "GET http://localhost:19090/api/v1/admin/users/11690/groups HTTP/1.1" from [::1]:34292 - 401 22B in 149.322Âµs
--- PASS: TestAPIUserGroupsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserGroupsPut_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14315}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001284] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34308 - 200 1156B in 4.294014ms
2025/11/25 13:25:46 INFO {"audit_event":"user_added_to_group","details":{"groupId":10597,"loggedInUser":"","userId":11691}}
2025/11/25 13:25:46 INFO {"audit_event":"user_removed_from_group","details":{"groupId":10595,"loggedInUser":"","userId":11691}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001285] "PUT http://localhost:19090/api/v1/admin/users/11691/groups HTTP/1.1" from [::1]:34310 - 200 1802B in 4.080419ms
--- PASS: TestAPIUserGroupsPut_Success (0.03s)
=== RUN   TestAPIUserGroupsPut_EmptyGroups
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14316}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001286] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34316 - 200 1156B in 4.300366ms
2025/11/25 13:25:46 INFO {"audit_event":"user_removed_from_group","details":{"groupId":10598,"loggedInUser":"","userId":11692}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001287] "PUT http://localhost:19090/api/v1/admin/users/11692/groups HTTP/1.1" from [::1]:34326 - 200 718B in 1.857981ms
--- PASS: TestAPIUserGroupsPut_EmptyGroups (0.02s)
=== RUN   TestAPIUserGroupsPut_NonExistentGroup
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14317}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001288] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34342 - 200 1156B in 4.543805ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001289] "PUT http://localhost:19090/api/v1/admin/users/11693/groups HTTP/1.1" from [::1]:34346 - 400 79B in 502.991Âµs
--- PASS: TestAPIUserGroupsPut_NonExistentGroup (0.01s)
=== RUN   TestAPIUserGroupsPut_UserNotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14318}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001290] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34358 - 200 1156B in 4.292531ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001291] "PUT http://localhost:19090/api/v1/admin/users/99999/groups HTTP/1.1" from [::1]:34364 - 404 63B in 447.256Âµs
--- PASS: TestAPIUserGroupsPut_UserNotFound (0.01s)
=== RUN   TestAPIUserGroupsPut_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14319}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001292] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34376 - 200 1156B in 4.523868ms
=== RUN   TestAPIUserGroupsPut_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001293] "PUT http://localhost:19090/api/v1/admin/users/abc/groups HTTP/1.1" from [::1]:34388 - 400 65B in 472.763Âµs
=== RUN   TestAPIUserGroupsPut_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001294] "PUT http://localhost:19090/api/v1/admin/users//groups HTTP/1.1" from [::1]:34396 - 400 69B in 1.09002ms
=== RUN   TestAPIUserGroupsPut_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001295] "PUT http://localhost:19090/api/v1/admin/users/-1/groups HTTP/1.1" from [::1]:34398 - 404 63B in 490.417Âµs
--- PASS: TestAPIUserGroupsPut_InvalidId (0.01s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGroupsPut_InvalidRequestBody
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14320}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001296] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34408 - 200 1156B in 4.316837ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001297] "PUT http://localhost:19090/api/v1/admin/users/11694/groups HTTP/1.1" from [::1]:34416 - 400 70B in 367.244Âµs
--- PASS: TestAPIUserGroupsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserGroupsPut_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001298] "PUT http://localhost:19090/api/v1/admin/users/11695/groups HTTP/1.1" from [::1]:34428 - 401 22B in 152.768Âµs
--- PASS: TestAPIUserGroupsPut_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributesGet_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14321}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001299] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34440 - 200 1156B in 4.421364ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001300] "GET http://localhost:19090/api/v1/admin/users/11696/attributes HTTP/1.1" from [::1]:34442 - 200 411B in 681.918Âµs
--- PASS: TestAPIUserAttributesGet_Success (0.02s)
=== RUN   TestAPIUserAttributesGet_EmptyAttributes
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14322}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001301] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34456 - 200 1156B in 4.568603ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001302] "GET http://localhost:19090/api/v1/admin/users/11697/attributes HTTP/1.1" from [::1]:34462 - 200 20B in 479.446Âµs
--- PASS: TestAPIUserAttributesGet_EmptyAttributes (0.01s)
=== RUN   TestAPIUserAttributesGet_UserNotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14323}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001303] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34468 - 200 1156B in 4.294444ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001304] "GET http://localhost:19090/api/v1/admin/users/99999/attributes HTTP/1.1" from [::1]:34484 - 404 63B in 521.516Âµs
--- PASS: TestAPIUserAttributesGet_UserNotFound (0.01s)
=== RUN   TestAPIUserAttributesGet_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14324}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001305] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34496 - 200 1156B in 4.29205ms
=== RUN   TestAPIUserAttributesGet_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001306] "GET http://localhost:19090/api/v1/admin/users/abc/attributes HTTP/1.1" from [::1]:34512 - 400 65B in 343.519Âµs
=== RUN   TestAPIUserAttributesGet_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001307] "GET http://localhost:19090/api/v1/admin/users//attributes HTTP/1.1" from [::1]:34516 - 400 70B in 323.531Âµs
=== RUN   TestAPIUserAttributesGet_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001308] "GET http://localhost:19090/api/v1/admin/users/-1/attributes HTTP/1.1" from [::1]:34520 - 404 63B in 463.776Âµs
--- PASS: TestAPIUserAttributesGet_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributesGet_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001309] "GET http://localhost:19090/api/v1/admin/users/11698/attributes HTTP/1.1" from [::1]:34530 - 401 22B in 210.428Âµs
--- PASS: TestAPIUserAttributesGet_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeGet_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14325}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001310] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34542 - 200 1156B in 4.32938ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001311] "GET http://localhost:19090/api/v1/admin/user-attributes/80 HTTP/1.1" from [::1]:34548 - 200 207B in 1.16986ms
--- PASS: TestAPIUserAttributeGet_Success (0.02s)
=== RUN   TestAPIUserAttributeGet_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14326}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001312] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34554 - 200 1156B in 4.368454ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001313] "GET http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:34560 - 404 73B in 414.243Âµs
--- PASS: TestAPIUserAttributeGet_NotFound (0.01s)
=== RUN   TestAPIUserAttributeGet_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14327}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001314] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34568 - 200 1156B in 4.375107ms
=== RUN   TestAPIUserAttributeGet_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001315] "GET http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:34580 - 400 75B in 378.565Âµs
=== RUN   TestAPIUserAttributeGet_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001316] "GET http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:34594 - 405 0B in 413.541Âµs
=== RUN   TestAPIUserAttributeGet_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001317] "GET http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:34598 - 404 73B in 360.391Âµs
--- PASS: TestAPIUserAttributeGet_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeGet_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001318] "GET http://localhost:19090/api/v1/admin/user-attributes/81 HTTP/1.1" from [::1]:34602 - 401 22B in 162.938Âµs
--- PASS: TestAPIUserAttributeGet_Unauthorized (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14328}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001319] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34612 - 200 1156B in 4.323349ms
2025/11/25 13:25:46 INFO {"audit_event":"added_user_attribute","details":{"loggedInUser":"admin-test-client-VXOVvWcE","userAttributeId":82,"userId":11701}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001320] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:34628 - 201 222B in 2.481358ms
--- PASS: TestAPIUserAttributeCreatePost_Success (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14329}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001321] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34636 - 200 1156B in 4.346122ms
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/missing_key
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001322] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:34650 - 400 72B in 507.249Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/empty_key
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001323] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:34662 - 400 72B in 347.307Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/value_too_long
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001324] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:34676 - 400 117B in 529.481Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/invalid_key_format
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001325] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:34686 - 400 250B in 464.177Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/user_not_found
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001326] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:34698 - 404 63B in 370.971Âµs
--- PASS: TestAPIUserAttributeCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/invalid_key_format (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/user_not_found (0.00s)
=== RUN   TestAPIUserAttributeCreatePost_InvalidRequestBody
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14330}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001327] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34706 - 200 1156B in 4.413309ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001328] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:34714 - 400 75B in 353.999Âµs
--- PASS: TestAPIUserAttributeCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001329] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:34724 - 401 22B in 92.785Âµs
--- PASS: TestAPIUserAttributeCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14331}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34736 - 200 1156B in 4.361712ms
2025/11/25 13:25:46 INFO {"audit_event":"updated_user_attribute","details":{"loggedInUser":"admin-test-client-wFjluZux","userAttributeId":83,"userId":11703}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001331] "PUT http://localhost:19090/api/v1/admin/user-attributes/83 HTTP/1.1" from [::1]:34740 - 200 213B in 2.777458ms
--- PASS: TestAPIUserAttributeUpdatePut_Success (0.02s)
=== RUN   TestAPIUserAttributeUpdatePut_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14332}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001332] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34746 - 200 1156B in 4.901311ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001333] "PUT http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:34752 - 404 73B in 688.822Âµs
--- PASS: TestAPIUserAttributeUpdatePut_NotFound (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14333}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001334] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34762 - 200 1156B in 4.610913ms
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/missing_key
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001335] "PUT http://localhost:19090/api/v1/admin/user-attributes/84 HTTP/1.1" from [::1]:34770 - 400 72B in 803.058Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/empty_key
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001336] "PUT http://localhost:19090/api/v1/admin/user-attributes/84 HTTP/1.1" from [::1]:34780 - 400 72B in 488.854Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/value_too_long
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001337] "PUT http://localhost:19090/api/v1/admin/user-attributes/84 HTTP/1.1" from [::1]:34788 - 400 117B in 570.338Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/invalid_key_format
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001338] "PUT http://localhost:19090/api/v1/admin/user-attributes/84 HTTP/1.1" from [::1]:34790 - 400 250B in 568.644Âµs
--- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors (0.02s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/invalid_key_format (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14334}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001339] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34794 - 200 1156B in 5.592927ms
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001340] "PUT http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:34806 - 400 75B in 387.532Âµs
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001341] "PUT http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:34818 - 405 0B in 308.764Âµs
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001342] "PUT http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:34830 - 404 73B in 400.967Âµs
--- PASS: TestAPIUserAttributeUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_InvalidRequestBody
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14335}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001343] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34836 - 200 1156B in 4.396777ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001344] "PUT http://localhost:19090/api/v1/admin/user-attributes/85 HTTP/1.1" from [::1]:34850 - 400 75B in 344.861Âµs
--- PASS: TestAPIUserAttributeUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001345] "PUT http://localhost:19090/api/v1/admin/user-attributes/86 HTTP/1.1" from [::1]:34856 - 401 22B in 173.758Âµs
--- PASS: TestAPIUserAttributeUpdatePut_Unauthorized (0.01s)
=== RUN   TestAPIUserAttributeDelete_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14336}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001346] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34862 - 200 1156B in 4.294956ms
2025/11/25 13:25:46 INFO {"audit_event":"deleted_user_attribute","details":{"loggedInUser":"admin-test-client-TNLgHVPF","userAttributeId":87,"userId":11707}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001347] "DELETE http://localhost:19090/api/v1/admin/user-attributes/87 HTTP/1.1" from [::1]:34874 - 200 17B in 1.534089ms
--- PASS: TestAPIUserAttributeDelete_Success (0.01s)
=== RUN   TestAPIUserAttributeDelete_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14337}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001348] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34884 - 200 1156B in 4.377251ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001349] "DELETE http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:34898 - 404 73B in 530.352Âµs
--- PASS: TestAPIUserAttributeDelete_NotFound (0.01s)
=== RUN   TestAPIUserAttributeDelete_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14338}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001350] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34914 - 200 1156B in 4.206297ms
=== RUN   TestAPIUserAttributeDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001351] "DELETE http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:34926 - 400 75B in 322.941Âµs
=== RUN   TestAPIUserAttributeDelete_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001352] "DELETE http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:34930 - 405 0B in 300.478Âµs
=== RUN   TestAPIUserAttributeDelete_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001353] "DELETE http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:34944 - 404 73B in 383.885Âµs
--- PASS: TestAPIUserAttributeDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeDelete_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001354] "DELETE http://localhost:19090/api/v1/admin/user-attributes/88 HTTP/1.1" from [::1]:34958 - 401 22B in 183.166Âµs
--- PASS: TestAPIUserAttributeDelete_Unauthorized (0.01s)
=== RUN   TestAPIUserPasswordPut_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14339}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001355] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34962 - 200 1156B in 4.483522ms
2025/11/25 13:25:46 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-wMkFudMz","userId":11709}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001356] "PUT http://localhost:19090/api/v1/admin/users/11709/password HTTP/1.1" from [::1]:34966 - 200 701B in 40.890771ms
--- PASS: TestAPIUserPasswordPut_Success (0.09s)
=== RUN   TestAPIUserPasswordPut_ValidationError
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14340}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001357] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34970 - 200 1156B in 4.648684ms
=== RUN   TestAPIUserPasswordPut_ValidationError/empty_password
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001358] "PUT http://localhost:19090/api/v1/admin/users/11710/password HTTP/1.1" from [::1]:34978 - 400 76B in 477.212Âµs
=== RUN   TestAPIUserPasswordPut_ValidationError/too_short_password
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001359] "PUT http://localhost:19090/api/v1/admin/users/11710/password HTTP/1.1" from [::1]:34982 - 400 102B in 495.746Âµs
=== RUN   TestAPIUserPasswordPut_ValidationError/too_long_password
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001360] "PUT http://localhost:19090/api/v1/admin/users/11710/password HTTP/1.1" from [::1]:34990 - 400 103B in 389.045Âµs
--- PASS: TestAPIUserPasswordPut_ValidationError (0.01s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/empty_password (0.00s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/too_short_password (0.00s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/too_long_password (0.00s)
=== RUN   TestAPIUserPasswordPut_UserNotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14341}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001361] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:34996 - 200 1156B in 4.485024ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001362] "PUT http://localhost:19090/api/v1/admin/users/99999/password HTTP/1.1" from [::1]:35008 - 404 63B in 548.657Âµs
--- PASS: TestAPIUserPasswordPut_UserNotFound (0.01s)
=== RUN   TestAPIUserPasswordPut_InvalidUserId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14342}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001363] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35012 - 200 1156B in 4.760304ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001364] "PUT http://localhost:19090/api/v1/admin/users/invalid/password HTTP/1.1" from [::1]:35028 - 400 65B in 412.499Âµs
--- PASS: TestAPIUserPasswordPut_InvalidUserId (0.01s)
=== RUN   TestAPIUserOTPPut_DisableSuccess
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14343}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001365] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35042 - 200 1156B in 4.375517ms
2025/11/25 13:25:46 INFO {"audit_event":"disabled_otp","details":{"userId":11711}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001366] "PUT http://localhost:19090/api/v1/admin/users/11711/otp HTTP/1.1" from [::1]:35054 - 200 695B in 4.846086ms
--- PASS: TestAPIUserOTPPut_DisableSuccess (0.02s)
=== RUN   TestAPIUserOTPPut_EnableNotSupported
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14344}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001367] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35068 - 200 1156B in 4.411926ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001368] "PUT http://localhost:19090/api/v1/admin/users/11712/otp HTTP/1.1" from [::1]:35072 - 400 110B in 358.618Âµs
--- PASS: TestAPIUserOTPPut_EnableNotSupported (0.01s)
=== RUN   TestAPIUserOTPPut_UserNotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14345}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001369] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35082 - 200 1156B in 4.471739ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001370] "PUT http://localhost:19090/api/v1/admin/users/99999/otp HTTP/1.1" from [::1]:35090 - 404 63B in 604.151Âµs
--- PASS: TestAPIUserOTPPut_UserNotFound (0.01s)
=== RUN   TestAPIUserOTPPut_OTPNotEnabled
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14346}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001371] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35104 - 200 1156B in 4.986261ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001372] "PUT http://localhost:19090/api/v1/admin/users/11713/otp HTTP/1.1" from [::1]:35118 - 400 80B in 798.198Âµs
--- PASS: TestAPIUserOTPPut_OTPNotEnabled (0.02s)
=== RUN   TestAPIUserSessionGet_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14347}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001373] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35128 - 200 1156B in 4.60441ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001374] "GET http://localhost:19090/api/v1/admin/user-sessions/34f24178-1f0e-4145-8871-7a9254224df6 HTTP/1.1" from [::1]:35144 - 200 490B in 638.456Âµs
--- PASS: TestAPIUserSessionGet_Success (0.02s)
=== RUN   TestAPIUserSessionGet_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14348}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001375] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35158 - 200 1156B in 4.442735ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001376] "GET http://localhost:19090/api/v1/admin/user-sessions/nonexistent-session HTTP/1.1" from [::1]:35162 - 404 79B in 1.084308ms
--- PASS: TestAPIUserSessionGet_NotFound (0.01s)
=== RUN   TestAPIUserSessionPut_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14349}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001377] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35166 - 200 1156B in 4.427515ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001378] "PUT http://localhost:19090/api/v1/admin/user-sessions/5b993e63-f948-455c-b48c-7754fb9d4385 HTTP/1.1" from [::1]:35176 - 200 489B in 3.126297ms
--- PASS: TestAPIUserSessionPut_Success (0.02s)
=== RUN   TestAPIUserSessionPut_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14350}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001379] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35186 - 200 1156B in 4.388001ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001380] "PUT http://localhost:19090/api/v1/admin/user-sessions/nonexistent-session HTTP/1.1" from [::1]:35188 - 404 79B in 688.351Âµs
--- PASS: TestAPIUserSessionPut_NotFound (0.01s)
=== RUN   TestAPIUserSessionPut_NilUpdate
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14351}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001381] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35202 - 200 1156B in 5.498018ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001382] "PUT http://localhost:19090/api/v1/admin/user-sessions/b3168902-f643-49c1-8605-874d8c8e607b HTTP/1.1" from [::1]:35216 - 200 490B in 1.928494ms
--- PASS: TestAPIUserSessionPut_NilUpdate (0.02s)
=== RUN   TestAPIUserConsentsGet_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14352}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35224 - 200 1156B in 4.444969ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001384] "GET http://localhost:19090/api/v1/admin/users/11717/consents HTTP/1.1" from [::1]:35234 - 200 583B in 3.99047ms
--- PASS: TestAPIUserConsentsGet_Success (0.03s)
=== RUN   TestAPIUserConsentsGet_EmptyConsents
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14355}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001385] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35238 - 200 1156B in 4.561979ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001386] "GET http://localhost:19090/api/v1/admin/users/11718/consents HTTP/1.1" from [::1]:35252 - 200 18B in 643.967Âµs
--- PASS: TestAPIUserConsentsGet_EmptyConsents (0.01s)
=== RUN   TestAPIUserConsentsGet_UserNotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14356}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001387] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35258 - 200 1156B in 4.444358ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001388] "GET http://localhost:19090/api/v1/admin/users/99999/consents HTTP/1.1" from [::1]:35266 - 404 58B in 532.436Âµs
--- PASS: TestAPIUserConsentsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserConsentsGet_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14357}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001389] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35270 - 200 1156B in 4.487799ms
=== RUN   TestAPIUserConsentsGet_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001390] "GET http://localhost:19090/api/v1/admin/users/abc/consents HTTP/1.1" from [::1]:35276 - 400 73B in 378.976Âµs
=== RUN   TestAPIUserConsentsGet_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001391] "GET http://localhost:19090/api/v1/admin/users//consents HTTP/1.1" from [::1]:35286 - 400 70B in 373.606Âµs
=== RUN   TestAPIUserConsentsGet_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001392] "GET http://localhost:19090/api/v1/admin/users/-1/consents HTTP/1.1" from [::1]:35288 - 404 58B in 441.183Âµs
--- PASS: TestAPIUserConsentsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserConsentsGet_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001393] "GET http://localhost:19090/api/v1/admin/users/11719/consents HTTP/1.1" from [::1]:35304 - 401 22B in 127.671Âµs
--- PASS: TestAPIUserConsentsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserConsentDelete_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14358}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001394] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35314 - 200 1156B in 4.380978ms
2025/11/25 13:25:46 INFO {"audit_event":"deleted_user_consent","details":{"consentId":10137,"loggedInUser":null,"userId":11720}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001395] "DELETE http://localhost:19090/api/v1/admin/user-consents/10137 HTTP/1.1" from [::1]:35322 - 200 17B in 1.60913ms
--- PASS: TestAPIUserConsentDelete_Success (0.02s)
=== RUN   TestAPIUserConsentDelete_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14360}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001396] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35332 - 200 1156B in 4.375948ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001397] "DELETE http://localhost:19090/api/v1/admin/user-consents/99999 HTTP/1.1" from [::1]:35334 - 404 61B in 420.003Âµs
--- PASS: TestAPIUserConsentDelete_NotFound (0.01s)
=== RUN   TestAPIUserConsentDelete_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14361}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001398] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35348 - 200 1156B in 4.267794ms
=== RUN   TestAPIUserConsentDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001399] "DELETE http://localhost:19090/api/v1/admin/user-consents/abc HTTP/1.1" from [::1]:35362 - 400 76B in 346.836Âµs
=== RUN   TestAPIUserConsentDelete_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001400] "DELETE http://localhost:19090/api/v1/admin/user-consents/ HTTP/1.1" from [::1]:35378 - 404 2447B in 432.176Âµs
=== RUN   TestAPIUserConsentDelete_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001401] "DELETE http://localhost:19090/api/v1/admin/user-consents/-1 HTTP/1.1" from [::1]:35382 - 404 61B in 459.659Âµs
--- PASS: TestAPIUserConsentDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserConsentDelete_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001402] "DELETE http://localhost:19090/api/v1/admin/user-consents/10138 HTTP/1.1" from [::1]:35392 - 401 22B in 159.481Âµs
--- PASS: TestAPIUserConsentDelete_Unauthorized (0.01s)
=== RUN   TestAPIUserConsentDelete_WithClientDetails
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14363}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001403] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35396 - 200 1156B in 4.336263ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001404] "GET http://localhost:19090/api/v1/admin/users/11722/consents HTTP/1.1" from [::1]:35398 - 200 337B in 706.995Âµs
2025/11/25 13:25:46 INFO {"audit_event":"deleted_user_consent","details":{"consentId":10139,"loggedInUser":null,"userId":11722}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001405] "DELETE http://localhost:19090/api/v1/admin/user-consents/10139 HTTP/1.1" from [::1]:35408 - 200 17B in 1.434581ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001406] "GET http://localhost:19090/api/v1/admin/users/11722/consents HTTP/1.1" from [::1]:35420 - 200 18B in 458.196Âµs
--- PASS: TestAPIUserConsentDelete_WithClientDetails (0.02s)
=== RUN   TestAPIUserGet_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14365}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001407] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35434 - 200 1156B in 4.338016ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001408] "GET http://localhost:19090/api/v1/admin/users/11723 HTTP/1.1" from [::1]:35450 - 200 696B in 516.466Âµs
--- PASS: TestAPIUserGet_Success (0.01s)
=== RUN   TestAPIUserGet_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14366}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001409] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35462 - 200 1156B in 4.377862ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001410] "GET http://localhost:19090/api/v1/admin/users/99999 HTTP/1.1" from [::1]:35466 - 404 63B in 541.153Âµs
--- PASS: TestAPIUserGet_NotFound (0.01s)
=== RUN   TestAPIUserGet_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14367}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001411] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35478 - 200 1156B in 4.239871ms
=== RUN   TestAPIUserGet_InvalidId/non-numeric_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001412] "GET http://localhost:19090/api/v1/admin/users/abc HTTP/1.1" from [::1]:35494 - 400 65B in 486.329Âµs
=== RUN   TestAPIUserGet_InvalidId/empty_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001413] "GET http://localhost:19090/api/v1/admin/users/ HTTP/1.1" from [::1]:35504 - 404 2447B in 551.572Âµs
=== RUN   TestAPIUserGet_InvalidId/negative_ID
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001414] "GET http://localhost:19090/api/v1/admin/users/-1 HTTP/1.1" from [::1]:35508 - 404 63B in 433.329Âµs
--- PASS: TestAPIUserGet_InvalidId (0.01s)
    --- PASS: TestAPIUserGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGet_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001415] "GET http://localhost:19090/api/v1/admin/users/11724 HTTP/1.1" from [::1]:35516 - 401 22B in 174.47Âµs
--- PASS: TestAPIUserGet_Unauthorized (0.00s)
=== RUN   TestAPIUserCreatePost_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14368}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001416] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35520 - 200 1156B in 4.726059ms
2025/11/25 13:25:46 INFO {"audit_event":"created_user","details":{"email":"newuser@create.test","loggedInUser":"admin-test-client-QdyyMMto"}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001417] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:35536 - 201 1140B in 42.992382ms
--- PASS: TestAPIUserCreatePost_Success (0.05s)
=== RUN   TestAPIUserCreatePost_DuplicateEmail
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14369}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001418] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35544 - 200 1156B in 6.077142ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001419] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:35558 - 409 95B in 705.433Âµs
--- PASS: TestAPIUserCreatePost_DuplicateEmail (0.02s)
=== RUN   TestAPIUserCreatePost_ValidationErrors
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14370}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001420] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35566 - 200 1156B in 4.558052ms
=== RUN   TestAPIUserCreatePost_ValidationErrors/missing_email
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001421] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:35570 - 400 66B in 427.979Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/invalid_email_format
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001422] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:35572 - 400 86B in 401.388Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/email_too_long
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001423] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:35588 - 400 114B in 365.29Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/missing_password_when_required
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001424] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:35602 - 400 72B in 1.224644ms
--- PASS: TestAPIUserCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/missing_email (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/invalid_email_format (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/email_too_long (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/missing_password_when_required (0.00s)
=== RUN   TestAPIUserCreatePost_InvalidRequestBody
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14371}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001425] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35614 - 200 1156B in 4.887455ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001426] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:35624 - 400 75B in 447.886Âµs
--- PASS: TestAPIUserCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserCreatePost_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001427] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:35638 - 401 22B in 172.256Âµs
--- PASS: TestAPIUserCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIUserEnabledPut_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14372}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001428] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35654 - 200 1156B in 4.54613ms
2025/11/25 13:25:46 INFO {"audit_event":"updated_user_details","details":{"loggedInUser":"admin-test-client-vuOgUzqD","userId":11727}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001429] "PUT http://localhost:19090/api/v1/admin/users/11727/enabled HTTP/1.1" from [::1]:35656 - 200 701B in 5.071873ms
--- PASS: TestAPIUserEnabledPut_Success (0.02s)
=== RUN   TestAPIUserEnabledPut_EnableUser
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14373}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001430] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35658 - 200 1156B in 4.386889ms
2025/11/25 13:25:46 INFO {"audit_event":"updated_user_details","details":{"loggedInUser":"admin-test-client-cxrhSsZK","userId":11728}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001431] "PUT http://localhost:19090/api/v1/admin/users/11728/enabled HTTP/1.1" from [::1]:35674 - 200 704B in 4.382561ms
--- PASS: TestAPIUserEnabledPut_EnableUser (0.01s)
=== RUN   TestAPIUserEnabledPut_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14374}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001432] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35678 - 200 1156B in 4.407087ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001433] "PUT http://localhost:19090/api/v1/admin/users/99999/enabled HTTP/1.1" from [::1]:35688 - 404 63B in 425.825Âµs
--- PASS: TestAPIUserEnabledPut_NotFound (0.01s)
=== RUN   TestAPIUserEnabledPut_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14375}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001434] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35700 - 200 1156B in 4.241004ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001435] "PUT http://localhost:19090/api/v1/admin/users/invalid/enabled HTTP/1.1" from [::1]:35710 - 400 65B in 331.797Âµs
--- PASS: TestAPIUserEnabledPut_InvalidId (0.01s)
=== RUN   TestAPIUserEnabledPut_InvalidRequestBody
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14376}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001436] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35726 - 200 1156B in 4.293783ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001437] "PUT http://localhost:19090/api/v1/admin/users/11729/enabled HTTP/1.1" from [::1]:35740 - 400 75B in 361.033Âµs
--- PASS: TestAPIUserEnabledPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserDelete_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14377}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001438] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35752 - 200 1156B in 5.219613ms
2025/11/25 13:25:46 INFO {"audit_event":"deleted_user","details":{"loggedInUser":"admin-test-client-ttvRCiMm","userId":11730}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001439] "DELETE http://localhost:19090/api/v1/admin/users/11730 HTTP/1.1" from [::1]:35762 - 200 17B in 2.387881ms
--- PASS: TestAPIUserDelete_Success (0.01s)
=== RUN   TestAPIUserDelete_NotFound
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14378}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001440] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35776 - 200 1156B in 4.393021ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001441] "DELETE http://localhost:19090/api/v1/admin/users/99999 HTTP/1.1" from [::1]:35792 - 404 63B in 559.778Âµs
--- PASS: TestAPIUserDelete_NotFound (0.01s)
=== RUN   TestAPIUserDelete_InvalidId
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14379}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001442] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35804 - 200 1156B in 4.602536ms
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_invalid
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001443] "DELETE http://localhost:19090/api/v1/admin/users/invalid HTTP/1.1" from [::1]:35810 - 400 65B in 404.283Âµs
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_abc
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001444] "DELETE http://localhost:19090/api/v1/admin/users/abc HTTP/1.1" from [::1]:35824 - 400 65B in 360.451Âµs
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_-1
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001445] "DELETE http://localhost:19090/api/v1/admin/users/-1 HTTP/1.1" from [::1]:35828 - 404 63B in 416.096Âµs
--- PASS: TestAPIUserDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_invalid (0.00s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_abc (0.00s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_-1 (0.00s)
=== RUN   TestAPIUserDelete_Unauthorized
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001446] "DELETE http://localhost:19090/api/v1/admin/users/11731 HTTP/1.1" from [::1]:35830 - 401 22B in 142.209Âµs
--- PASS: TestAPIUserDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserEmailPut_Success
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14380}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001447] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35844 - 200 1156B in 4.28117ms
2025/11/25 13:25:46 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-ovUUKHTj","userId":11732}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001448] "PUT http://localhost:19090/api/v1/admin/users/11732/email HTTP/1.1" from [::1]:35860 - 200 700B in 4.563132ms
--- PASS: TestAPIUserEmailPut_Success (0.02s)
=== RUN   TestAPIUserEmailPut_EmailNormalization
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14381}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001449] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35876 - 200 1156B in 4.33435ms
2025/11/25 13:25:46 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-VOqaEYjM","userId":11733}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001450] "PUT http://localhost:19090/api/v1/admin/users/11733/email HTTP/1.1" from [::1]:35890 - 200 704B in 1.948321ms
--- PASS: TestAPIUserEmailPut_EmailNormalization (0.01s)
=== RUN   TestAPIUserEmailPut_DuplicateEmail
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14382}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001451] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35892 - 200 1156B in 4.310535ms
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001452] "PUT http://localhost:19090/api/v1/admin/users/11735/email HTTP/1.1" from [::1]:35904 - 400 107B in 711.434Âµs
--- PASS: TestAPIUserEmailPut_DuplicateEmail (0.02s)
=== RUN   TestAPIUserEmailPut_InvalidEmail
2025/11/25 13:25:46 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14383}}
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001453] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35916 - 200 1156B in 4.301317ms
=== RUN   TestAPIUserEmailPut_InvalidEmail/empty_email
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001454] "PUT http://localhost:19090/api/v1/admin/users/11736/email HTTP/1.1" from [::1]:35926 - 400 81B in 521.365Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/invalid_format
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001455] "PUT http://localhost:19090/api/v1/admin/users/11736/email HTTP/1.1" from [::1]:35934 - 400 86B in 408.081Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/missing_domain
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001456] "PUT http://localhost:19090/api/v1/admin/users/11736/email HTTP/1.1" from [::1]:35938 - 400 86B in 465.52Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/missing_username
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001457] "PUT http://localhost:19090/api/v1/admin/users/11736/email HTTP/1.1" from [::1]:35942 - 400 86B in 432.417Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/multiple_@
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001458] "PUT http://localhost:19090/api/v1/admin/users/11736/email HTTP/1.1" from [::1]:35956 - 400 86B in 462.564Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/spaces_in_middle
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001459] "PUT http://localhost:19090/api/v1/admin/users/11736/email HTTP/1.1" from [::1]:35968 - 400 86B in 446.865Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/special_chars
2025/11/25 13:25:46 [a357f2e3b56e/a04mE72Kgg-001460] "PUT http://localhost:19090/api/v1/admin/users/11736/email HTTP/1.1" from [::1]:35982 - 400 86B in 392.802Âµs
--- PASS: TestAPIUserEmailPut_InvalidEmail (0.01s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/empty_email (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/invalid_format (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/missing_domain (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/missing_username (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/multiple_@ (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/spaces_in_middle (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/special_chars (0.00s)
=== RUN   TestAPIUserEmailPut_SetEmailVerified
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14384}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001461] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:35988 - 200 1156B in 4.344048ms
2025/11/25 13:25:47 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-gNpGXHRW","userId":11737}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001462] "PUT http://localhost:19090/api/v1/admin/users/11737/email HTTP/1.1" from [::1]:35990 - 200 704B in 4.679231ms
--- PASS: TestAPIUserEmailPut_SetEmailVerified (0.02s)
=== RUN   TestAPIUserEmailPut_UnsetEmailVerified
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14385}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001463] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36004 - 200 1156B in 4.452993ms
2025/11/25 13:25:47 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-lTaerhAb","userId":11738}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001464] "PUT http://localhost:19090/api/v1/admin/users/11738/email HTTP/1.1" from [::1]:36014 - 200 706B in 4.553423ms
--- PASS: TestAPIUserEmailPut_UnsetEmailVerified (0.02s)
=== RUN   TestAPIUserEmailPut_UserNotFound
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14386}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001465] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36024 - 200 1156B in 4.516083ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001466] "PUT http://localhost:19090/api/v1/admin/users/99999/email HTTP/1.1" from [::1]:36034 - 404 63B in 637.664Âµs
--- PASS: TestAPIUserEmailPut_UserNotFound (0.03s)
=== RUN   TestAPIUserEmailPut_InvalidId
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14387}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001467] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36048 - 200 1156B in 4.647672ms
=== RUN   TestAPIUserEmailPut_InvalidId/non-numeric_ID
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001468] "PUT http://localhost:19090/api/v1/admin/users/abc/email HTTP/1.1" from [::1]:36064 - 400 65B in 347.557Âµs
=== RUN   TestAPIUserEmailPut_InvalidId/empty_ID
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001469] "PUT http://localhost:19090/api/v1/admin/users//email HTTP/1.1" from [::1]:36074 - 400 70B in 308.994Âµs
=== RUN   TestAPIUserEmailPut_InvalidId/negative_ID
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001470] "PUT http://localhost:19090/api/v1/admin/users/-1/email HTTP/1.1" from [::1]:36084 - 404 63B in 348.308Âµs
--- PASS: TestAPIUserEmailPut_InvalidId (0.01s)
    --- PASS: TestAPIUserEmailPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserEmailPut_InvalidRequestBody
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14388}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001471] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36092 - 200 1156B in 4.262053ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001472] "PUT http://localhost:19090/api/v1/admin/users/11739/email HTTP/1.1" from [::1]:36106 - 400 75B in 392.041Âµs
--- PASS: TestAPIUserEmailPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserEmailPut_Unauthorized
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001473] "PUT http://localhost:19090/api/v1/admin/users/11740/email HTTP/1.1" from [::1]:36108 - 401 22B in 143.041Âµs
--- PASS: TestAPIUserEmailPut_Unauthorized (0.00s)
=== RUN   TestAPIUserEmailPut_PartialUpdate
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14389}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001474] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36120 - 200 1156B in 5.659584ms
2025/11/25 13:25:47 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-VwrLxapq","userId":11741}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001475] "PUT http://localhost:19090/api/v1/admin/users/11741/email HTTP/1.1" from [::1]:36134 - 200 702B in 4.85337ms
--- PASS: TestAPIUserEmailPut_PartialUpdate (0.02s)
=== RUN   TestAPIUserPermissionsGet_Success
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14390}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001476] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36136 - 200 1156B in 4.674122ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001477] "GET http://localhost:19090/api/v1/admin/users/11742/permissions HTTP/1.1" from [::1]:36138 - 200 1973B in 974.311Âµs
--- PASS: TestAPIUserPermissionsGet_Success (0.03s)
=== RUN   TestAPIUserPermissionsGet_UserNotFound
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14391}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001478] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36150 - 200 1156B in 4.792635ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001479] "GET http://localhost:19090/api/v1/admin/users/99999/permissions HTTP/1.1" from [::1]:36166 - 404 58B in 523.308Âµs
--- PASS: TestAPIUserPermissionsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserPermissionsGet_InvalidUserId
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14392}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001480] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36174 - 200 1156B in 4.374396ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001481] "GET http://localhost:19090/api/v1/admin/users/invalid/permissions HTTP/1.1" from [::1]:36190 - 400 73B in 441.554Âµs
--- PASS: TestAPIUserPermissionsGet_InvalidUserId (0.01s)
=== RUN   TestAPIUserPermissionsGet_NoPermissions
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14393}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001482] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36198 - 200 1156B in 4.366971ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001483] "GET http://localhost:19090/api/v1/admin/users/11743/permissions HTTP/1.1" from [::1]:36202 - 200 727B in 580.226Âµs
--- PASS: TestAPIUserPermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIUserPermissionsGet_Unauthorized
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001484] "GET http://localhost:19090/api/v1/admin/users/11744/permissions HTTP/1.1" from [::1]:36214 - 401 22B in 177.646Âµs
--- PASS: TestAPIUserPermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserPermissionsPut_Success
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14394}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001485] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36224 - 200 1156B in 4.608879ms
2025/11/25 13:25:47 INFO {"audit_event":"added_user_permission","details":{"loggedInUser":"","permissionId":10666,"userId":11745}}
2025/11/25 13:25:47 INFO {"audit_event":"added_user_permission","details":{"loggedInUser":"","permissionId":10667,"userId":11745}}
2025/11/25 13:25:47 INFO {"audit_event":"deleted_user_permission","details":{"loggedInUser":"","permissionId":10665,"userId":11745}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001486] "PUT http://localhost:19090/api/v1/admin/users/11745/permissions HTTP/1.1" from [::1]:36238 - 200 17B in 4.909536ms
--- PASS: TestAPIUserPermissionsPut_Success (0.03s)
=== RUN   TestAPIUserPermissionsPut_RemoveAllPermissions
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14395}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001487] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36242 - 200 1156B in 4.414811ms
2025/11/25 13:25:47 INFO {"audit_event":"deleted_user_permission","details":{"loggedInUser":"","permissionId":10668,"userId":11746}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001488] "PUT http://localhost:19090/api/v1/admin/users/11746/permissions HTTP/1.1" from [::1]:36258 - 200 17B in 1.919988ms
--- PASS: TestAPIUserPermissionsPut_RemoveAllPermissions (0.02s)
=== RUN   TestAPIUserPermissionsPut_UserNotFound
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14396}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001489] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36272 - 200 1156B in 4.879109ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001490] "PUT http://localhost:19090/api/v1/admin/users/99999/permissions HTTP/1.1" from [::1]:36282 - 404 58B in 573.213Âµs
--- PASS: TestAPIUserPermissionsPut_UserNotFound (0.01s)
=== RUN   TestAPIUserPermissionsPut_PermissionNotFound
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14397}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001491] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36298 - 200 1156B in 4.487729ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001492] "PUT http://localhost:19090/api/v1/admin/users/11747/permissions HTTP/1.1" from [::1]:36304 - 404 64B in 840.147Âµs
--- PASS: TestAPIUserPermissionsPut_PermissionNotFound (0.01s)
=== RUN   TestAPIUserPermissionsPut_InvalidRequestBody
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14398}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001493] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36314 - 200 1156B in 4.455398ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001494] "PUT http://localhost:19090/api/v1/admin/users/11748/permissions HTTP/1.1" from [::1]:36328 - 400 71B in 563.896Âµs
--- PASS: TestAPIUserPermissionsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserPermissionsPut_Unauthorized
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001495] "PUT http://localhost:19090/api/v1/admin/users/11749/permissions HTTP/1.1" from [::1]:36330 - 401 22B in 153.64Âµs
--- PASS: TestAPIUserPermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIPhoneCountriesGet_Success
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14399}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001496] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36342 - 200 1156B in 4.63669ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001497] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:36352 - 200 21243B in 60.900279ms
--- PASS: TestAPIPhoneCountriesGet_Success (0.07s)
=== RUN   TestAPIPhoneCountriesGet_Unauthorized
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001498] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:36354 - 401 22B in 431.816Âµs
--- PASS: TestAPIPhoneCountriesGet_Unauthorized (0.00s)
=== RUN   TestAPIPhoneCountriesGet_InvalidToken
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001499] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:36364 - 401 22B in 794.712Âµs
--- PASS: TestAPIPhoneCountriesGet_InvalidToken (0.00s)
=== RUN   TestAPIUserPhonePut_Success
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14400}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001500] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36370 - 200 1156B in 4.648573ms
2025/11/25 13:25:47 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-CUadOnSK","userId":11750}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001501] "PUT http://localhost:19090/api/v1/admin/users/11750/phone HTTP/1.1" from [::1]:36384 - 200 718B in 127.492582ms
--- PASS: TestAPIUserPhonePut_Success (0.14s)
=== RUN   TestAPIUserPhonePut_ClearPhoneNumber
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14401}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001502] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36392 - 200 1156B in 4.690743ms
2025/11/25 13:25:47 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-gXJsqWeQ","userId":11751}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001503] "PUT http://localhost:19090/api/v1/admin/users/11751/phone HTTP/1.1" from [::1]:36396 - 200 707B in 67.77603ms
--- PASS: TestAPIUserPhonePut_ClearPhoneNumber (0.08s)
=== RUN   TestAPIUserPhonePut_ValidationErrors
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14402}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001504] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36398 - 200 1156B in 4.937189ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_without_country
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001505] "PUT http://localhost:19090/api/v1/admin/users/11752/phone HTTP/1.1" from [::1]:36400 - 400 99B in 548.085Âµs
=== RUN   TestAPIUserPhonePut_ValidationErrors/country_without_phone_number
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001506] "PUT http://localhost:19090/api/v1/admin/users/11752/phone HTTP/1.1" from [::1]:36402 - 400 266B in 62.331774ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_too_short
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001507] "PUT http://localhost:19090/api/v1/admin/users/11752/phone HTTP/1.1" from [::1]:36408 - 400 99B in 63.302408ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_too_long
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001508] "PUT http://localhost:19090/api/v1/admin/users/11752/phone HTTP/1.1" from [::1]:36414 - 400 114B in 62.85946ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/invalid_phone_number_characters
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001509] "PUT http://localhost:19090/api/v1/admin/users/11752/phone HTTP/1.1" from [::1]:36416 - 400 174B in 63.546448ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/invalid_country_id
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001510] "PUT http://localhost:19090/api/v1/admin/users/11752/phone HTTP/1.1" from [::1]:36432 - 400 76B in 61.513116ms
--- PASS: TestAPIUserPhonePut_ValidationErrors (0.33s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_without_country (0.00s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/country_without_phone_number (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_too_short (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_too_long (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/invalid_phone_number_characters (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/invalid_country_id (0.06s)
=== RUN   TestAPIUserPhonePut_UserNotFound
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14403}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001511] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36444 - 200 1156B in 4.833002ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001512] "PUT http://localhost:19090/api/v1/admin/users/99999/phone HTTP/1.1" from [::1]:36448 - 404 63B in 594.293Âµs
--- PASS: TestAPIUserPhonePut_UserNotFound (0.01s)
=== RUN   TestAPIUserPhonePut_InvalidUserId
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14404}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001513] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36464 - 200 1156B in 4.477139ms
=== RUN   TestAPIUserPhonePut_InvalidUserId/non-numeric_ID
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001514] "PUT http://localhost:19090/api/v1/admin/users/abc/phone HTTP/1.1" from [::1]:36468 - 400 65B in 348.187Âµs
=== RUN   TestAPIUserPhonePut_InvalidUserId/empty_ID
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001515] "PUT http://localhost:19090/api/v1/admin/users//phone HTTP/1.1" from [::1]:36472 - 400 70B in 350.202Âµs
=== RUN   TestAPIUserPhonePut_InvalidUserId/negative_ID
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001516] "PUT http://localhost:19090/api/v1/admin/users/-1/phone HTTP/1.1" from [::1]:36486 - 404 63B in 413.101Âµs
--- PASS: TestAPIUserPhonePut_InvalidUserId (0.01s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/empty_ID (0.00s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/negative_ID (0.00s)
=== RUN   TestAPIUserPhonePut_InvalidRequestBody
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14405}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001517] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36492 - 200 1156B in 4.412036ms
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001518] "PUT http://localhost:19090/api/v1/admin/users/11753/phone HTTP/1.1" from [::1]:36508 - 400 75B in 406.848Âµs
--- PASS: TestAPIUserPhonePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserPhonePut_Unauthorized
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001519] "PUT http://localhost:19090/api/v1/admin/users/11754/phone HTTP/1.1" from [::1]:36520 - 401 22B in 292.142Âµs
--- PASS: TestAPIUserPhonePut_Unauthorized (0.00s)
=== RUN   TestAPIUserPhonePut_PhoneNumberVerifiedAutoCleared
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14406}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001520] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36524 - 200 1156B in 4.557802ms
2025/11/25 13:25:47 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-HcICHLKV","userId":11755}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001521] "PUT http://localhost:19090/api/v1/admin/users/11755/phone HTTP/1.1" from [::1]:36534 - 200 709B in 66.527221ms
--- PASS: TestAPIUserPhonePut_PhoneNumberVerifiedAutoCleared (0.08s)
=== RUN   TestAPIUserProfilePut_Success
2025/11/25 13:25:47 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14407}}
2025/11/25 13:25:47 [a357f2e3b56e/a04mE72Kgg-001522] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36540 - 200 1156B in 4.981562ms
2025/11/25 13:25:48 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-tbjDhMoO","userId":11756}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001523] "PUT http://localhost:19090/api/v1/admin/users/11756/profile HTTP/1.1" from [::1]:36546 - 200 826B in 28.215502ms
--- PASS: TestAPIUserProfilePut_Success (0.04s)
=== RUN   TestAPIUserProfilePut_PartialUpdate
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14408}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001524] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36548 - 200 1156B in 4.969199ms
2025/11/25 13:25:48 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-xSUjZgHp","userId":11757}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001525] "PUT http://localhost:19090/api/v1/admin/users/11757/profile HTTP/1.1" from [::1]:36552 - 200 711B in 6.918652ms
--- PASS: TestAPIUserProfilePut_PartialUpdate (0.02s)
=== RUN   TestAPIUserProfilePut_InvalidGender
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14409}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001526] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36556 - 200 1156B in 4.859822ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001527] "PUT http://localhost:19090/api/v1/admin/users/11758/profile HTTP/1.1" from [::1]:36572 - 400 69B in 1.339231ms
--- PASS: TestAPIUserProfilePut_InvalidGender (0.01s)
=== RUN   TestAPIUserProfilePut_ValidGender
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14410}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001528] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36578 - 200 1156B in 4.856266ms
=== RUN   TestAPIUserProfilePut_ValidGender/female
2025/11/25 13:25:48 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-xoUTcgAP","userId":11759}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001529] "PUT http://localhost:19090/api/v1/admin/users/11759/profile HTTP/1.1" from [::1]:36584 - 200 715B in 5.539026ms
=== RUN   TestAPIUserProfilePut_ValidGender/male
2025/11/25 13:25:48 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-xoUTcgAP","userId":11759}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001530] "PUT http://localhost:19090/api/v1/admin/users/11759/profile HTTP/1.1" from [::1]:36590 - 200 713B in 7.188252ms
=== RUN   TestAPIUserProfilePut_ValidGender/other
2025/11/25 13:25:48 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-xoUTcgAP","userId":11759}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001531] "PUT http://localhost:19090/api/v1/admin/users/11759/profile HTTP/1.1" from [::1]:36606 - 200 714B in 5.250641ms
--- PASS: TestAPIUserProfilePut_ValidGender (0.03s)
    --- PASS: TestAPIUserProfilePut_ValidGender/female (0.01s)
    --- PASS: TestAPIUserProfilePut_ValidGender/male (0.01s)
    --- PASS: TestAPIUserProfilePut_ValidGender/other (0.01s)
=== RUN   TestAPIUserProfilePut_InvalidDateOfBirth
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14411}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001532] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36608 - 200 1156B in 4.864191ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001533] "PUT http://localhost:19090/api/v1/admin/users/11760/profile HTTP/1.1" from [::1]:36610 - 400 114B in 1.44444ms
--- PASS: TestAPIUserProfilePut_InvalidDateOfBirth (0.02s)
=== RUN   TestAPIUserProfilePut_UserNotFound
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14412}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001534] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36612 - 200 1156B in 5.772247ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001535] "PUT http://localhost:19090/api/v1/admin/users/99999/profile HTTP/1.1" from [::1]:36626 - 404 63B in 679.834Âµs
--- PASS: TestAPIUserProfilePut_UserNotFound (0.01s)
=== RUN   TestAPIUserProfilePut_InvalidId
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14413}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001536] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36638 - 200 1156B in 4.545429ms
=== RUN   TestAPIUserProfilePut_InvalidId/non-numeric_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001537] "PUT http://localhost:19090/api/v1/admin/users/abc/profile HTTP/1.1" from [::1]:36654 - 400 65B in 422.699Âµs
=== RUN   TestAPIUserProfilePut_InvalidId/empty_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001538] "PUT http://localhost:19090/api/v1/admin/users//profile HTTP/1.1" from [::1]:36664 - 400 70B in 324.643Âµs
=== RUN   TestAPIUserProfilePut_InvalidId/negative_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001539] "PUT http://localhost:19090/api/v1/admin/users/-1/profile HTTP/1.1" from [::1]:36674 - 404 63B in 443.298Âµs
--- PASS: TestAPIUserProfilePut_InvalidId (0.01s)
    --- PASS: TestAPIUserProfilePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserProfilePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserProfilePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserProfilePut_InvalidRequestBody
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14414}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001540] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36678 - 200 1156B in 4.661077ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001541] "PUT http://localhost:19090/api/v1/admin/users/11761/profile HTTP/1.1" from [::1]:36692 - 400 75B in 423.971Âµs
--- PASS: TestAPIUserProfilePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserProfilePut_Unauthorized
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001542] "PUT http://localhost:19090/api/v1/admin/users/11762/profile HTTP/1.1" from [::1]:36696 - 401 22B in 180.08Âµs
--- PASS: TestAPIUserProfilePut_Unauthorized (0.00s)
=== RUN   TestAPIUserAddressPut_Success
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14415}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001543] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36698 - 200 1156B in 4.545168ms
2025/11/25 13:25:48 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-LQSivyra","userId":11763}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001544] "PUT http://localhost:19090/api/v1/admin/users/11763/address HTTP/1.1" from [::1]:36704 - 200 741B in 4.931628ms
--- PASS: TestAPIUserAddressPut_Success (0.02s)
=== RUN   TestAPIUserAddressPut_PartialAddress
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14416}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001545] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36716 - 200 1156B in 5.256923ms
2025/11/25 13:25:48 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-ltNiulIY","userId":11764}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001546] "PUT http://localhost:19090/api/v1/admin/users/11764/address HTTP/1.1" from [::1]:36726 - 200 728B in 5.634676ms
--- PASS: TestAPIUserAddressPut_PartialAddress (0.02s)
=== RUN   TestAPIUserAddressPut_ClearAllFields
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14417}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001547] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36740 - 200 1156B in 4.684351ms
2025/11/25 13:25:48 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-BmGHTZKq","userId":11765}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001548] "PUT http://localhost:19090/api/v1/admin/users/11765/address HTTP/1.1" from [::1]:36750 - 200 706B in 1.889991ms
--- PASS: TestAPIUserAddressPut_ClearAllFields (0.02s)
=== RUN   TestAPIUserAddressPut_UserNotFound
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14418}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001549] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36760 - 200 1156B in 6.112119ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001550] "PUT http://localhost:19090/api/v1/admin/users/99999/address HTTP/1.1" from [::1]:36774 - 404 63B in 605.745Âµs
--- PASS: TestAPIUserAddressPut_UserNotFound (0.01s)
=== RUN   TestAPIUserAddressPut_InvalidId
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14419}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001551] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36784 - 200 1156B in 4.682527ms
=== RUN   TestAPIUserAddressPut_InvalidId/non-numeric_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001552] "PUT http://localhost:19090/api/v1/admin/users/abc/address HTTP/1.1" from [::1]:36790 - 400 65B in 476.651Âµs
=== RUN   TestAPIUserAddressPut_InvalidId/empty_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001553] "PUT http://localhost:19090/api/v1/admin/users//address HTTP/1.1" from [::1]:36792 - 400 70B in 365.35Âµs
=== RUN   TestAPIUserAddressPut_InvalidId/negative_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001554] "PUT http://localhost:19090/api/v1/admin/users/-1/address HTTP/1.1" from [::1]:36798 - 404 63B in 455.03Âµs
--- PASS: TestAPIUserAddressPut_InvalidId (0.01s)
    --- PASS: TestAPIUserAddressPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAddressPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAddressPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAddressPut_InvalidRequestBody
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14420}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001555] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36810 - 200 1156B in 4.459355ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001556] "PUT http://localhost:19090/api/v1/admin/users/11766/address HTTP/1.1" from [::1]:36820 - 400 75B in 399.014Âµs
--- PASS: TestAPIUserAddressPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAddressPut_Unauthorized
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001557] "PUT http://localhost:19090/api/v1/admin/users/11767/address HTTP/1.1" from [::1]:36834 - 401 22B in 202.162Âµs
--- PASS: TestAPIUserAddressPut_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_Success
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14421}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001558] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36842 - 200 1156B in 5.26589ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001559] "GET http://localhost:19090/api/v1/admin/users/search?query=annperm&annotatePermissionId=10669&page=1&size=200 HTTP/1.1" from [::1]:36850 - 200 3013B in 12.451877ms
--- PASS: TestAPIUsersSearch_AnnotatePermission_Success (0.04s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_InvalidParam
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14422}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001560] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36854 - 200 1156B in 4.825878ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001561] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=abc HTTP/1.1" from [::1]:36858 - 400 85B in 4.919064ms
--- PASS: TestAPIUsersSearch_AnnotatePermission_InvalidParam (0.02s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_PermissionNotFound
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14423}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001562] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36860 - 200 1156B in 5.904176ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001563] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=8983039 HTTP/1.1" from [::1]:36870 - 404 64B in 1.118213ms
--- PASS: TestAPIUsersSearch_AnnotatePermission_PermissionNotFound (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_Unauthorized
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001564] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=10670 HTTP/1.1" from [::1]:36886 - 401 22B in 194.618Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_ConflictWithGroupAnnotation
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14424}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001565] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36892 - 200 1156B in 6.293631ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001566] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=10671&annotateGroupMembership=10599 HTTP/1.1" from [::1]:36896 - 400 123B in 1.1169ms
--- PASS: TestAPIUsersSearch_AnnotatePermission_ConflictWithGroupAnnotation (0.02s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_UserinfoForbidden
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14425}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001567] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36904 - 200 1156B in 4.813976ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001568] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=1 HTTP/1.1" from [::1]:36920 - 400 96B in 1.059642ms
--- PASS: TestAPIUsersSearch_AnnotatePermission_UserinfoForbidden (0.01s)
=== RUN   TestAPIUsersSearch_Success
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14426}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001569] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:36934 - 200 1156B in 4.894888ms
    api_users_search_test.go:31: Created 3 test users:
    api_users_search_test.go:33:   - john.doe@test.com 'AAA John' (ID: 11771, Enabled: true)
    api_users_search_test.go:33:   - jane.smith@test.com 'AAA Jane' (ID: 11772, Enabled: true)
    api_users_search_test.go:33:   - disabled@test.com 'AAA Disabled' (ID: 11773, Enabled: false)
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001570] "GET http://localhost:19090/api/v1/admin/users/search?page=1&size=50 HTTP/1.1" from [::1]:36946 - 200 34281B in 1.383274ms
    api_users_search_test.go:64: Total users in database: 832
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001571] "GET http://localhost:19090/api/v1/admin/users/search?page=2&size=50 HTTP/1.1" from [::1]:36948 - 200 34284B in 1.213883ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001572] "GET http://localhost:19090/api/v1/admin/users/search?page=3&size=50 HTTP/1.1" from [::1]:36960 - 200 34337B in 1.290559ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001573] "GET http://localhost:19090/api/v1/admin/users/search?page=4&size=50 HTTP/1.1" from [::1]:36974 - 200 34260B in 1.163598ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001574] "GET http://localhost:19090/api/v1/admin/users/search?page=5&size=50 HTTP/1.1" from [::1]:36976 - 200 34369B in 1.163569ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001575] "GET http://localhost:19090/api/v1/admin/users/search?page=6&size=50 HTTP/1.1" from [::1]:36990 - 200 34280B in 1.234502ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001576] "GET http://localhost:19090/api/v1/admin/users/search?page=7&size=50 HTTP/1.1" from [::1]:37002 - 200 34336B in 1.620993ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001577] "GET http://localhost:19090/api/v1/admin/users/search?page=8&size=50 HTTP/1.1" from [::1]:37014 - 200 34267B in 2.047058ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001578] "GET http://localhost:19090/api/v1/admin/users/search?page=9&size=50 HTTP/1.1" from [::1]:37018 - 200 34357B in 1.938292ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001579] "GET http://localhost:19090/api/v1/admin/users/search?page=10&size=50 HTTP/1.1" from [::1]:37024 - 200 34400B in 1.707086ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001580] "GET http://localhost:19090/api/v1/admin/users/search?page=11&size=50 HTTP/1.1" from [::1]:37034 - 200 34405B in 1.845507ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001581] "GET http://localhost:19090/api/v1/admin/users/search?page=12&size=50 HTTP/1.1" from [::1]:37050 - 200 34361B in 1.54021ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001582] "GET http://localhost:19090/api/v1/admin/users/search?page=13&size=50 HTTP/1.1" from [::1]:37054 - 200 34345B in 1.537836ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001583] "GET http://localhost:19090/api/v1/admin/users/search?page=14&size=50 HTTP/1.1" from [::1]:37066 - 200 34441B in 1.606906ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001584] "GET http://localhost:19090/api/v1/admin/users/search?page=15&size=50 HTTP/1.1" from [::1]:37082 - 200 34377B in 1.527125ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001585] "GET http://localhost:19090/api/v1/admin/users/search?page=16&size=50 HTTP/1.1" from [::1]:37084 - 200 34425B in 1.648646ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001586] "GET http://localhost:19090/api/v1/admin/users/search?page=17&size=50 HTTP/1.1" from [::1]:37098 - 200 22884B in 1.754345ms
    api_users_search_test.go:72: Found test user: disabled@test.com 'AAA Disabled' (ID: 11773, Enabled: false)
    api_users_search_test.go:72: Found test user: jane.smith@test.com 'AAA Jane' (ID: 11772, Enabled: true)
    api_users_search_test.go:72: Found test user: john.doe@test.com 'AAA John' (ID: 11771, Enabled: true)
--- PASS: TestAPIUsersSearch_Success (0.06s)
=== RUN   TestAPIUsersSearch_WithQuery
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14427}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001587] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37106 - 200 1156B in 4.861375ms
    api_users_search_test.go:126: Created test user: uniquejohnPwefHMOF@searchtest.com 'UniqueJohn TestUser' (ID: 11774, Enabled: true)
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001588] "GET http://localhost:19090/api/v1/admin/users/search?query=uniquejohnPwefHMOF HTTP/1.1" from [::1]:37108 - 200 783B in 10.733841ms
    api_users_search_test.go:148: Search query: 'uniquejohnPwefHMOF'
    api_users_search_test.go:149: Total results: 1
    api_users_search_test.go:150: Number of users returned: 1
    api_users_search_test.go:151: Search results:
    api_users_search_test.go:153:   [0] ID: 11774, Email: uniquejohnPwefHMOF@searchtest.com, GivenName: UniqueJohn, FamilyName: TestUser, Enabled: true
--- PASS: TestAPIUsersSearch_WithQuery (0.03s)
=== RUN   TestAPIUsersSearch_WithPagination
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14428}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001589] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37110 - 200 1156B in 4.840656ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001590] "GET http://localhost:19090/api/v1/admin/users/search?page=1&size=2 HTTP/1.1" from [::1]:37124 - 200 1457B in 823.095Âµs
--- PASS: TestAPIUsersSearch_WithPagination (0.02s)
=== RUN   TestAPIUsersSearch_Unauthorized
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001591] "GET http://localhost:19090/api/v1/admin/users/search HTTP/1.1" from [::1]:37128 - 401 22B in 292.743Âµs
--- PASS: TestAPIUsersSearch_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_InvalidToken
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001592] "GET http://localhost:19090/api/v1/admin/users/search HTTP/1.1" from [::1]:37134 - 401 22B in 381.821Âµs
--- PASS: TestAPIUsersSearch_InvalidToken (0.00s)
=== RUN   TestAPIUsersSearch_InvalidParameters
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14429}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001593] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37144 - 200 1156B in 4.53009ms
=== RUN   TestAPIUsersSearch_InvalidParameters/negative_page
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001594] "GET http://localhost:19090/api/v1/admin/users/search?page=-1 HTTP/1.1" from [::1]:37148 - 200 6928B in 821.652Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/zero_page
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001595] "GET http://localhost:19090/api/v1/admin/users/search?page=0 HTTP/1.1" from [::1]:37152 - 200 6928B in 766.698Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/non-numeric_page
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001596] "GET http://localhost:19090/api/v1/admin/users/search?page=abc HTTP/1.1" from [::1]:37156 - 200 6928B in 743.044Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/negative_size
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001597] "GET http://localhost:19090/api/v1/admin/users/search?size=-1 HTTP/1.1" from [::1]:37170 - 200 6928B in 950.496Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/zero_size
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001598] "GET http://localhost:19090/api/v1/admin/users/search?size=0 HTTP/1.1" from [::1]:37172 - 200 6928B in 954.584Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/over-limit_size
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001599] "GET http://localhost:19090/api/v1/admin/users/search?size=300 HTTP/1.1" from [::1]:37184 - 200 6928B in 792.447Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/non-numeric_size
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001600] "GET http://localhost:19090/api/v1/admin/users/search?size=xyz HTTP/1.1" from [::1]:37200 - 200 6928B in 820.13Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/both_invalid
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001601] "GET http://localhost:19090/api/v1/admin/users/search?page=abc&size=xyz HTTP/1.1" from [::1]:37216 - 200 6928B in 755.467Âµs
--- PASS: TestAPIUsersSearch_InvalidParameters (0.03s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/negative_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/zero_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/non-numeric_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/negative_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/zero_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/over-limit_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/non-numeric_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/both_invalid (0.00s)
=== RUN   TestAPIUsersSearch_SizeLimit
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14430}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001602] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37218 - 200 1156B in 4.618977ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001603] "GET http://localhost:19090/api/v1/admin/users/search?size=200 HTTP/1.1" from [::1]:37228 - 200 137001B in 2.130987ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001604] "GET http://localhost:19090/api/v1/admin/users/search?size=201 HTTP/1.1" from [::1]:37242 - 200 6928B in 1.798038ms
--- PASS: TestAPIUsersSearch_SizeLimit (0.02s)
=== RUN   TestAPIUsersSearch_NoResults
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14431}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001605] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37246 - 200 1156B in 4.690682ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001606] "GET http://localhost:19090/api/v1/admin/users/search?query=nonexistent-user-12345 HTTP/1.1" from [::1]:37248 - 200 77B in 10.629373ms
--- PASS: TestAPIUsersSearch_NoResults (0.03s)
=== RUN   TestAPIUsersSearch_SpecialCharacters
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14432}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001607] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37262 - 200 1156B in 5.04871ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/empty_query
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001608] "GET http://localhost:19090/api/v1/admin/users/search?query= HTTP/1.1" from [::1]:37272 - 200 6928B in 1.331876ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/space_query
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001609] "GET http://localhost:19090/api/v1/admin/users/search?query=%20 HTTP/1.1" from [::1]:37284 - 200 2132B in 12.540585ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/at_symbol
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001610] "GET http://localhost:19090/api/v1/admin/users/search?query=john%40doe HTTP/1.1" from [::1]:37292 - 200 63B in 12.127344ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/plus_symbol
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001611] "GET http://localhost:19090/api/v1/admin/users/search?query=john%2Bdoe HTTP/1.1" from [::1]:37294 - 200 63B in 8.503527ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/special_chars
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001612] "GET http://localhost:19090/api/v1/admin/users/search?query=%21%40%23%24 HTTP/1.1" from [::1]:37310 - 200 59B in 12.390742ms
--- PASS: TestAPIUsersSearch_SpecialCharacters (0.07s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/empty_query (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/space_query (0.01s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/at_symbol (0.01s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/plus_symbol (0.01s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/special_chars (0.01s)
=== RUN   TestAPIUsersSearch_MultiplePages
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14433}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001613] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37322 - 200 1156B in 5.47258ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001614] "GET http://localhost:19090/api/v1/admin/users/search?size=5&page=1 HTTP/1.1" from [::1]:37330 - 200 3520B in 1.115117ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001615] "GET http://localhost:19090/api/v1/admin/users/search?size=5&page=2 HTTP/1.1" from [::1]:37334 - 200 3460B in 722.695Âµs
--- PASS: TestAPIUsersSearch_MultiplePages (0.04s)
=== RUN   TestAPIUserSessionsGet_Success
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14434}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001616] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37340 - 200 1156B in 5.224211ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001617] "GET http://localhost:19090/api/v1/admin/users/11798/sessions HTTP/1.1" from [::1]:37348 - 200 1471B in 1.908997ms
--- PASS: TestAPIUserSessionsGet_Success (0.03s)
=== RUN   TestAPIUserSessionsGet_EmptySessions
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14436}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001618] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37364 - 200 1156B in 4.742761ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001619] "GET http://localhost:19090/api/v1/admin/users/11799/sessions HTTP/1.1" from [::1]:37374 - 200 16B in 780.615Âµs
--- PASS: TestAPIUserSessionsGet_EmptySessions (0.01s)
=== RUN   TestAPIUserSessionsGet_UserNotFound
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14437}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001620] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37390 - 200 1156B in 4.748943ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001621] "GET http://localhost:19090/api/v1/admin/users/99999/sessions HTTP/1.1" from [::1]:37400 - 404 63B in 499.624Âµs
--- PASS: TestAPIUserSessionsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserSessionsGet_InvalidId
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14438}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001622] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37406 - 200 1156B in 4.491306ms
=== RUN   TestAPIUserSessionsGet_InvalidId/non-numeric_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001623] "GET http://localhost:19090/api/v1/admin/users/abc/sessions HTTP/1.1" from [::1]:37412 - 400 72B in 431.105Âµs
=== RUN   TestAPIUserSessionsGet_InvalidId/empty_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001624] "GET http://localhost:19090/api/v1/admin/users//sessions HTTP/1.1" from [::1]:37426 - 400 70B in 327.168Âµs
=== RUN   TestAPIUserSessionsGet_InvalidId/negative_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001625] "GET http://localhost:19090/api/v1/admin/users/-1/sessions HTTP/1.1" from [::1]:37438 - 404 63B in 393.464Âµs
--- PASS: TestAPIUserSessionsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserSessionsGet_Unauthorized
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001626] "GET http://localhost:19090/api/v1/admin/users/11800/sessions HTTP/1.1" from [::1]:37446 - 401 22B in 128.603Âµs
--- PASS: TestAPIUserSessionsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserSessionsGet_SessionsWithNoClients
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14439}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001627] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37460 - 200 1156B in 4.584202ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001628] "GET http://localhost:19090/api/v1/admin/users/11801/sessions HTTP/1.1" from [::1]:37466 - 200 712B in 1.620001ms
--- PASS: TestAPIUserSessionsGet_SessionsWithNoClients (0.02s)
=== RUN   TestAPIUserSessionDelete_Success
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14440}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001629] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37470 - 200 1156B in 5.014876ms
2025/11/25 13:25:48 INFO {"audit_event":"deleted_user_session","details":{"loggedInUser":"","userSessionId":11858}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001630] "DELETE http://localhost:19090/api/v1/admin/user-sessions/11858 HTTP/1.1" from [::1]:37476 - 200 17B in 2.303582ms
--- PASS: TestAPIUserSessionDelete_Success (0.02s)
=== RUN   TestAPIUserSessionDelete_NotFound
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14441}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001631] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37488 - 200 1156B in 5.142476ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001632] "DELETE http://localhost:19090/api/v1/admin/user-sessions/99999 HTTP/1.1" from [::1]:37498 - 404 79B in 701.385Âµs
--- PASS: TestAPIUserSessionDelete_NotFound (0.01s)
=== RUN   TestAPIUserSessionDelete_InvalidId
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14442}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001633] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37504 - 200 1156B in 6.118972ms
=== RUN   TestAPIUserSessionDelete_InvalidId/non-numeric_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001634] "DELETE http://localhost:19090/api/v1/admin/user-sessions/abc HTTP/1.1" from [::1]:37520 - 400 88B in 519.742Âµs
=== RUN   TestAPIUserSessionDelete_InvalidId/empty_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001635] "DELETE http://localhost:19090/api/v1/admin/user-sessions/ HTTP/1.1" from [::1]:37536 - 404 2447B in 625.512Âµs
=== RUN   TestAPIUserSessionDelete_InvalidId/negative_ID
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001636] "DELETE http://localhost:19090/api/v1/admin/user-sessions/-1 HTTP/1.1" from [::1]:37540 - 404 79B in 506.136Âµs
--- PASS: TestAPIUserSessionDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserSessionDelete_Unauthorized
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001637] "DELETE http://localhost:19090/api/v1/admin/user-sessions/11859 HTTP/1.1" from [::1]:37548 - 401 22B in 210.517Âµs
--- PASS: TestAPIUserSessionDelete_Unauthorized (0.01s)
=== RUN   TestAPIUserSessionDelete_InvalidToken
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001638] "DELETE http://localhost:19090/api/v1/admin/user-sessions/11860 HTTP/1.1" from [::1]:37552 - 401 22B in 482.081Âµs
--- PASS: TestAPIUserSessionDelete_InvalidToken (0.01s)
=== RUN   TestAPIUserSessionsGet_OnlyValidSessions
2025/11/25 13:25:48 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14443}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001639] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:37568 - 200 1156B in 5.172614ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001640] "GET http://localhost:19090/api/v1/admin/users/11805/sessions HTTP/1.1" from [::1]:37582 - 200 719B in 1.173247ms
--- PASS: TestAPIUserSessionsGet_OnlyValidSessions (0.03s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientIdIsMissing
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001641] "GET http://localhost:19090/auth/authorize/ HTTP/1.1" from [::1]:37592 - 200 2129B in 696.736Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientIdIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotExist
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001642] "GET http://localhost:19090/auth/authorize/?client_id=does_not_exist HTTP/1.1" from [::1]:37604 - 200 2149B in 4.966584ms
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotExist (0.01s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientIsDisabled
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001643] "GET http://localhost:19090/auth/authorize/?client_id=test-client-rXUMfIXE HTTP/1.1" from [::1]:37606 - 200 2146B in 1.456583ms
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientIsDisabled (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotSupportTheAuthorizationCodeFlow
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001644] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SFXdFwVI HTTP/1.1" from [::1]:37616 - 200 2179B in 608.71Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotSupportTheAuthorizationCodeFlow (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_RedirectURIIsMissing
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001645] "GET http://localhost:19090/auth/authorize/?client_id=test-client-rUbwqOUR HTTP/1.1" from [::1]:37626 - 200 2132B in 560.018Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_RedirectURIIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotHaveRedirectURI
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001646] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gkNRnSzz&redirect_uri=https://www.futureimplement.org/repurpose/users HTTP/1.1" from [::1]:37632 - 200 2180B in 626.964Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotHaveRedirectURI (0.00s)
=== RUN   TestAuthorize_ValidateRequest_ResponseTypeIsMissing
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001647] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YorgkQCO&redirect_uri=http://www.directb2c.com/b2c/orchestrate/optimize HTTP/1.1" from [::1]:37642 - 302 194B in 617.647Âµs
--- PASS: TestAuthorize_ValidateRequest_ResponseTypeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_ResponseTypeIsInvalid
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001648] "GET http://localhost:19090/auth/authorize/?client_id=test-client-DXQhmdsG&redirect_uri=http://www.directintegrate.name/drive&response_type=invalid HTTP/1.1" from [::1]:37654 - 302 182B in 587.059Âµs
--- PASS: TestAuthorize_ValidateRequest_ResponseTypeIsInvalid (0.01s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeMethodIsMissing
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001649] "GET http://localhost:19090/auth/authorize/?client_id=test-client-mVitjypc&redirect_uri=https://www.customerengage.info/killer/plug-and-play/innovate&response_type=code HTTP/1.1" from [::1]:37670 - 302 197B in 506.547Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeMethodIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeMethodIsInvalid
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001650] "GET http://localhost:19090/auth/authorize/?client_id=test-client-NUKlvOyI&redirect_uri=https://www.districtviral.name/reintermediate/interfaces/vertical/engineer&response_type=code&code_challenge_method=invalid HTTP/1.1" from [::1]:37680 - 302 210B in 600.415Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeMethodIsInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeIsMissing
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001651] "GET http://localhost:19090/auth/authorize/?client_id=test-client-QCbAKbvz&redirect_uri=https://www.investorincentivize.org/synergies/applications/extend&response_type=code&code_challenge_method=S256 HTTP/1.1" from [::1]:37696 - 302 233B in 498.803Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeInvalid
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001652] "GET http://localhost:19090/auth/authorize/?client_id=test-client-exvNfJMX&redirect_uri=http://www.forwardeyeballs.name/innovative/back-end/infrastructures/synthesize&response_type=code&code_challenge_method=S256&code_challenge=vHOmPGFehXiPniueiYNdYfTDhHkSnRSxLBExnwtBaD HTTP/1.1" from [::1]:37704 - 302 246B in 417.118Âµs
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001653] "GET http://localhost:19090/auth/authorize/?client_id=test-client-IYlxxBUm&redirect_uri=http://www.regionalengineer.io/enable/enterprise&response_type=code&code_challenge_method=S256&code_challenge=LWNSeEBrOwyvqpXGJeiuttBuDuzYiIjaGMmchQIFbixJLkHVWAfgfQWYatJnpvClojMscPfrbESzBteHgnbRDkOUBkxrjJkXlttQlYJhDhKBVcLltfZGSIwlZDnQNIXBh HTTP/1.1" from [::1]:37720 - 302 216B in 471.801Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeInvalid (0.01s)
=== RUN   TestAuthorize_ValidateRequest_InvalidResponseMode
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001654] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ZTDpTJlk&redirect_uri=http://www.principal24-7.biz/content/matrix/streamline&response_type=code&code_challenge_method=S256&code_challenge=tFMIBxISeASsYKLCPaqhrAzwytwZWvruMIqzyhrpepl&response_mode=invalid HTTP/1.1" from [::1]:37724 - 302 210B in 496.869Âµs
--- PASS: TestAuthorize_ValidateRequest_InvalidResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_QueryResponseMode
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001655] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LykBvmyK&redirect_uri=https://www.nationalubiquitous.io/deliverables/roi/web-readiness/deliverables&response_type=code&code_challenge_method=S256&code_challenge=OTHuPGyHLszVHXAzOjwHeRqCVWssHVCzVvyYNxwgDRu&response_mode=query&scope=invalid_scope HTTP/1.1" from [::1]:37730 - 302 315B in 454.569Âµs
--- PASS: TestAuthorize_ValidateRequest_QueryResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_FragmentResponseMode
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001656] "GET http://localhost:19090/auth/authorize/?client_id=test-client-eecGrghS&redirect_uri=https://www.forwardenvisioneer.com/incubate/impactful/deploy&response_type=code&code_challenge_method=S256&code_challenge=IJIxDOmrxnMmFLUSEnAjLLzdnYTRFgLZAGHEsrVOLwU&response_mode=fragment&scope=invalid_scope HTTP/1.1" from [::1]:37732 - 302 298B in 407.199Âµs
--- PASS: TestAuthorize_ValidateRequest_FragmentResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_FormPostResponseMode
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001657] "GET http://localhost:19090/auth/authorize/?client_id=test-client-AzcJkMtB&redirect_uri=http://www.dynamicseamless.net/whiteboard/facilitate/evolve/exploit&response_type=code&code_challenge_method=S256&code_challenge=dJleDEpdDhPqdXwuewaNozGdREaGScmRrPWHpskmIba&response_mode=form_post&scope=invalid_scope HTTP/1.1" from [::1]:37748 - 200 690B in 1.690454ms
--- PASS: TestAuthorize_ValidateRequest_FormPostResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ScopeIsMissing
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001658] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FUFipwqV&redirect_uri=http://www.corporatemetrics.biz/distributed&response_type=code&code_challenge_method=S256&code_challenge=SPPPGxsarbpusSliAcbhYhmLIOQnwTvwVpBJXFMUHis HTTP/1.1" from [::1]:37764 - 302 307B in 514.162Âµs
--- PASS: TestAuthorize_ValidateScopes_ScopeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateScopes_UserInfoShouldNotBeIncluded
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001659] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ppjFPqhC&code_challenge=MKsIPYyIxFOFDNWWKxOhnZIKqIiMyCxGQZaNeOADXdI&code_challenge_method=S256&redirect_uri=https%3A%2F%2Fwww.nationalexperiences.name%2Fexpedite%2Fe-business%2Fe-business&response_type=code&scope=openid+profile+authserver%3Auserinfo HTTP/1.1" from [::1]:37778 - 302 337B in 686.818Âµs
--- PASS: TestAuthorize_ValidateScopes_UserInfoShouldNotBeIncluded (0.00s)
=== RUN   TestAuthorize_ValidateScopes_InvalidScope
=== RUN   TestAuthorize_ValidateScopes_InvalidScope/Invalid_single_scope
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001660] "GET http://localhost:19090/auth/authorize/?client_id=test-client-wkdWmivx&redirect_uri=https%3A%2F%2Fwww.globalenterprise.info%2F24-7%2Frobust%2Fdot-com&response_type=code&code_challenge_method=S256&code_challenge=ODyIjQHiGVSzjCJlBqwhsWphYFSzUCTQLcPKSNAsqbM&scope=my_scope HTTP/1.1" from [::1]:37794 - 302 286B in 483.413Âµs
=== RUN   TestAuthorize_ValidateScopes_InvalidScope/Invalid_complex_scope
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001661] "GET http://localhost:19090/auth/authorize/?client_id=test-client-wkdWmivx&redirect_uri=https%3A%2F%2Fwww.globalenterprise.info%2F24-7%2Frobust%2Fdot-com&response_type=code&code_challenge_method=S256&code_challenge=OxiMWHsPMhYcSTmsvLYDSOrsJrXPDAGSWIkZrzFATXJ&scope=my_resource%3Amy_scope%3Asomething HTTP/1.1" from [::1]:37800 - 302 312B in 360.632Âµs
--- PASS: TestAuthorize_ValidateScopes_InvalidScope (0.00s)
    --- PASS: TestAuthorize_ValidateScopes_InvalidScope/Invalid_single_scope (0.00s)
    --- PASS: TestAuthorize_ValidateScopes_InvalidScope/Invalid_complex_scope (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ResourceDoesNotExist
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001662] "GET http://localhost:19090/auth/authorize/?client_id=test-client-npsmsQBn&redirect_uri=http%3A%2F%2Fwww.corporatevisualize.io%2Frevolutionary%2Finfomediaries&response_type=code&code_challenge_method=S256&code_challenge=ZecYlmjWfQzGLnddXOktOBBZiZlRJOnwdzgBJmpqpga&scope=non_existent_resource%3Aread HTTP/1.1" from [::1]:37816 - 302 249B in 960.375Âµs
--- PASS: TestAuthorize_ValidateScopes_ResourceDoesNotExist (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ResourceDoesNotHavePermissionAssociated
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001663] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nFbJxXRp&redirect_uri=http%3A%2F%2Fwww.globaldeploy.name%2Fincubate%2Fkiller%2Frobust&response_type=code&code_challenge_method=S256&code_challenge=CuSzOwbQuLUqRyZxQYkjjJKdYwssHYciZOPrOIeABYq&scope=test-resource-dEpMcCTj%3Anon_existent_permission HTTP/1.1" from [::1]:37830 - 302 319B in 1.084268ms
--- PASS: TestAuthorize_ValidateScopes_ResourceDoesNotHavePermissionAssociated (0.00s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001664] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qHXMwIwR&redirect_uri=http%3A%2F%2Fwww.seniorcollaborative.info%2Fe-enable&response_type=code&code_challenge_method=S256&code_challenge=wcRQxKNQsKqSAwcpSdGBhgaFilDHFRKVYLzMzYQyXMC&scope=openid+profile+email&state=VzSvuGAG&nonce=jdmrCGxl HTTP/1.1" from [::1]:37844 - 302 57B in 622.066Âµs
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001665] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:37852 - 302 54B in 235.775Âµs
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001666] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37866 - 200 2949B in 358.658Âµs
2025/11/25 13:25:48 INFO {"audit_event":"auth_success_pwd","details":{"userId":11806}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001667] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37866 - 302 0B in 35.628118ms
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001668] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:37866 - 302 60B in 459.468Âµs
2025/11/25 13:25:48 INFO {"audit_event":"started_new_user_session","details":{"clientId":14464,"userId":11806}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001669] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:37870 - 302 56B in 3.340742ms
2025/11/25 13:25:48 INFO {"audit_event":"created_auth_code","details":{"clientId":14464,"codeId":10806,"userId":11806}}
2025/11/25 13:25:48 [a357f2e3b56e/a04mE72Kgg-001670] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:37886 - 302 220B in 2.639418ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsNotRequired
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001671] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YEWwkpoL&redirect_uri=http%3A%2F%2Fwww.future24-7.name%2Fmindshare&response_type=code&code_challenge_method=S256&code_challenge=WXydmuIYwmgFygUqBFRbJcHOAGJJsegtfihRXZwhpHp&scope=openid+profile+email&state=aCrSxxQP&nonce=CkfYVeAA HTTP/1.1" from [::1]:37888 - 302 57B in 836.972Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001672] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:37904 - 302 54B in 246.746Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001673] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37906 - 200 2949B in 415.384Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11807}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001674] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37906 - 302 0B in 35.90979ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001675] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:37906 - 302 57B in 690.625Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001676] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:37916 - 302 60B in 583.252Âµs
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14465,"userId":11807}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001677] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:37926 - 302 56B in 2.971094ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14465,"codeId":10807,"userId":11807}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001678] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:37942 - 302 212B in 3.26556ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsNotRequired
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001679] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PKhBProy&redirect_uri=https%3A%2F%2Fwww.districtcustomized.com%2Forchestrate%2Finfrastructures&response_type=code&code_challenge_method=S256&code_challenge=rUbqBovcxPSAKAIqrBQUMwTvwrWJpxjhXDMgVQnZFUG&scope=openid+profile+email&state=ukLejHKU&nonce=xxjtvXIW HTTP/1.1" from [::1]:37948 - 302 57B in 983.649Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001680] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:37952 - 302 54B in 285.44Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001681] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37964 - 200 2949B in 362.234Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11808}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001682] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:37964 - 302 0B in 36.732204ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001683] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:37964 - 302 57B in 792.417Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001684] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:37968 - 302 54B in 629.4Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001685] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:37970 - 200 2471B in 571.91Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_otp","details":{"userId":11808}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001686] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:37970 - 302 0B in 319.614Âµs
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14466,"userId":11808}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001687] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:37970 - 302 56B in 3.324562ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14466,"codeId":10808,"userId":11808}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001688] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:37978 - 302 238B in 2.75229ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001689] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YDdDrEiu&redirect_uri=https%3A%2F%2Fwww.investorincentivize.com%2Fe-services%2Fvertical%2Fvisionary&response_type=code&code_challenge_method=S256&code_challenge=sfZWWawOuSvHdlDQpEmatHDhmrOFavpxMYjtzBFOAOi&scope=openid+profile+email&state=VYQvKIav&nonce=UYelJbmy HTTP/1.1" from [::1]:37990 - 302 57B in 1.13253ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001690] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38006 - 302 54B in 348.949Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001691] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38020 - 200 2949B in 341.065Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11809}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001692] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38020 - 302 0B in 36.552654ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001693] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38020 - 302 57B in 810.662Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001694] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38026 - 302 54B in 499.324Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001695] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38036 - 200 6202B in 3.744665ms
2025/11/25 13:25:49 INFO {"audit_event":"enabled_otp","details":{"userId":11809}}
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_otp","details":{"userId":11809}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001696] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38036 - 302 0B in 5.363013ms
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14467,"userId":11809}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001697] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38036 - 302 56B in 3.380798ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14467,"codeId":10809,"userId":11809}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001698] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38040 - 302 241B in 2.883809ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001699] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xpwgkLow&redirect_uri=http%3A%2F%2Fwww.regionalviral.biz%2Fend-to-end%2Fwhiteboard%2Fschemas&response_type=code&code_challenge_method=S256&code_challenge=jrMpcBHstRLLjpneilOTsnlZGlOCLqZlktdGoLZsekV&scope=openid+profile+email&state=jvHVXlsL&nonce=BXgQtNbk HTTP/1.1" from [::1]:38052 - 302 57B in 1.065853ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001700] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38064 - 302 54B in 267.245Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001701] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38080 - 200 2949B in 420.014Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11810}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001702] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38080 - 302 0B in 36.875565ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001703] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38080 - 302 57B in 687.168Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001704] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38082 - 302 54B in 534.851Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001705] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38096 - 200 2471B in 801.244Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_otp","details":{"userId":11810}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001706] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38096 - 302 0B in 528.909Âµs
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14468,"userId":11810}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001707] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38096 - 302 56B in 3.698548ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14468,"codeId":10810,"userId":11810}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001708] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38112 - 302 234B in 3.039723ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001709] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LUrhxdau&redirect_uri=http%3A%2F%2Fwww.districtvalue-added.net%2Fgenerate%2Fcontent%2Ffunctionalities&response_type=code&code_challenge_method=S256&code_challenge=thflGsPDIReFUcBjPvHXFVanzoMrMlOOpFrXjPpiZVX&scope=openid+profile+email+res-orQdWhiw%3Aperm-EvheaJKu+res-BcniTbny%3Aperm-FDwroReC&state=NMLSOWro&nonce=xoCkFDju HTTP/1.1" from [::1]:38114 - 302 57B in 1.85245ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001710] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38116 - 302 54B in 251.906Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001711] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38124 - 200 2949B in 465.349Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11811}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001712] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38124 - 302 0B in 36.118945ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001713] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38124 - 302 60B in 616.665Âµs
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14469,"userId":11811}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001714] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38128 - 302 58B in 3.32355ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001715] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38140 - 200 4699B in 787.859Âµs
2025/11/25 13:25:49 INFO {"audit_event":"saved_consent","details":{"clientId":14469,"consentId":10140,"userId":11811}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001716] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38140 - 302 0B in 2.562171ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14469,"codeId":10811,"userId":11811}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001717] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38140 - 302 243B in 2.632735ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsFullyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001718] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PHmJyXGq&redirect_uri=https%3A%2F%2Fwww.corporatedrive.info%2Fb2c%2Foptimize%2Fout-of-the-box&response_type=code&code_challenge_method=S256&code_challenge=hGOdBmeGUZPpdAZlQkYNkrMnmXzFPNCmUngttZtVQYZ&scope=openid+profile+email+res-PiSJlvyu%3Aperm-yShhOYbG+res-CsGThCUN%3Aperm-OFJNxkQr&state=zaXRMKHb&nonce=sHLIhRkY HTTP/1.1" from [::1]:38154 - 302 57B in 1.324062ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001719] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38166 - 302 54B in 282.433Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001720] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38182 - 200 2949B in 383.084Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11812}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001721] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38182 - 302 0B in 36.531845ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001722] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38182 - 302 60B in 772.961Âµs
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14470,"userId":11812}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001723] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38188 - 302 58B in 4.163467ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001724] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38196 - 200 4699B in 703.328Âµs
2025/11/25 13:25:49 INFO {"audit_event":"saved_consent","details":{"clientId":14470,"consentId":10141,"userId":11812}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001725] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38196 - 302 0B in 2.812605ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14470,"codeId":10812,"userId":11812}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001726] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38196 - 302 235B in 2.799479ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsPartiallyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001727] "GET http://localhost:19090/auth/authorize/?client_id=test-client-WxsVCIFX&redirect_uri=https%3A%2F%2Fwww.leadrepurpose.net%2Fholistic%2Fuser-centric&response_type=code&code_challenge_method=S256&code_challenge=fvuyxeugjDPMzIHyRQZCnUbtOnXXJLQgVGGBOnMFdAc&scope=openid+profile+email+res-NbqkMxfU%3Aperm-qaqoBKto+res-LPYPyzeX%3Aperm-dKJfluRT&state=Nldhhmle&nonce=juOYTphp HTTP/1.1" from [::1]:38202 - 302 57B in 1.119265ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001728] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38214 - 302 54B in 257.126Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001729] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38222 - 200 2949B in 383.304Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11813}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001730] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38222 - 302 0B in 36.003156ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001731] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38222 - 302 57B in 561.33Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001732] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38238 - 302 60B in 466.822Âµs
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14471,"userId":11813}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001733] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38248 - 302 58B in 2.935346ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001734] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38260 - 200 4699B in 620.653Âµs
2025/11/25 13:25:49 INFO {"audit_event":"saved_consent","details":{"clientId":14471,"consentId":10142,"userId":11813}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001735] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38260 - 302 0B in 1.617626ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14471,"codeId":10813,"userId":11813}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001736] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38260 - 302 227B in 2.95887ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001737] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kvQEKBwM&redirect_uri=https%3A%2F%2Fwww.legacymagnetic.biz%2Frich%2F24-7%2Fenvisioneer&response_type=code&code_challenge_method=S256&code_challenge=SMtwwjcMXmXCHJpNyZDWaMLnJJkwWjoeEdYCkZkYtqK&scope=openid+profile+email+res-KMPKFElh%3Aperm-VYMZPHOv+res-ptKKLHyh%3Aperm-OEQeoSiZ&state=wqJmLfTM&nonce=FdjGRMMY HTTP/1.1" from [::1]:38268 - 302 57B in 1.15371ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001738] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38284 - 302 54B in 302.081Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001739] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38300 - 200 2949B in 316.919Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11814}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001740] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38300 - 302 0B in 36.47094ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001741] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38300 - 302 57B in 824.188Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001742] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38316 - 302 60B in 481.239Âµs
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14472,"userId":11814}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001743] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38328 - 302 58B in 3.177424ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001744] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38340 - 200 4699B in 671.679Âµs
2025/11/25 13:25:49 INFO {"audit_event":"saved_consent","details":{"clientId":14472,"consentId":10143,"userId":11814}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001745] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38340 - 302 0B in 1.707907ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14472,"codeId":10814,"userId":11814}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001746] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38340 - 302 228B in 3.026769ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001747] "GET http://localhost:19090/auth/authorize/?client_id=test-client-fBLXvfIg&redirect_uri=http%3A%2F%2Fwww.globale-enable.biz%2Fstrategic%2Fimplement%2Foptimize%2Fseamless&response_type=code&code_challenge_method=S256&code_challenge=PYgaYnLSBXpovycOaiDlYIRVEpwWmVFmyQIWauUJuPZ&scope=openid+profile+email+res-KSmUVUhh%3Aperm-bDnZbJoM+res-RwDJNTLn%3Aperm-aPnIOhHP&state=EAvPfTsI&nonce=miXcKcjo HTTP/1.1" from [::1]:38344 - 302 57B in 1.146816ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001748] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38352 - 302 54B in 257.897Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001749] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38358 - 200 2949B in 363.167Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11815}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001750] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38358 - 302 0B in 35.383796ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001751] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38358 - 302 57B in 358.487Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001752] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38364 - 302 54B in 447.476Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001753] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38370 - 200 2471B in 610.554Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_otp","details":{"userId":11815}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001754] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38370 - 302 0B in 1.08488ms
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14473,"userId":11815}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001755] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38370 - 302 58B in 3.202671ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001756] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38372 - 200 4699B in 772.53Âµs
2025/11/25 13:25:49 INFO {"audit_event":"saved_consent","details":{"clientId":14473,"consentId":10144,"userId":11815}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001757] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38372 - 302 0B in 1.617927ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14473,"codeId":10815,"userId":11815}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001758] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38372 - 302 243B in 2.887937ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001759] "GET http://localhost:19090/auth/authorize/?client_id=test-client-mthnFyQE&redirect_uri=http%3A%2F%2Fwww.productempower.io%2Faction-items%2Fmorph&response_type=code&code_challenge_method=S256&code_challenge=htZEJiUFMnYiFtgXzXjXjvnUVrwdzsFvWeSrUjwungX&scope=openid+profile+email+res-zyNbvQgd%3Aperm-SZUQOLRf+res-EeZZyqWh%3Aperm-WiwAfPNe&state=oQFGXYKP&nonce=lxhMZslm HTTP/1.1" from [::1]:38378 - 302 57B in 1.236246ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001760] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38388 - 302 54B in 355.782Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001761] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38390 - 200 2949B in 358.838Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_pwd","details":{"userId":11816}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001762] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38390 - 302 0B in 36.230155ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001763] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38390 - 302 57B in 815.611Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001764] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38398 - 302 54B in 528.228Âµs
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001765] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38406 - 200 2471B in 435.873Âµs
2025/11/25 13:25:49 INFO {"audit_event":"auth_success_otp","details":{"userId":11816}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001766] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38406 - 302 0B in 306.79Âµs
2025/11/25 13:25:49 INFO {"audit_event":"started_new_user_session","details":{"clientId":14474,"userId":11816}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001767] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38406 - 302 58B in 2.965794ms
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001768] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38416 - 200 4699B in 656.43Âµs
2025/11/25 13:25:49 INFO {"audit_event":"saved_consent","details":{"clientId":14474,"consentId":10145,"userId":11816}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001769] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38416 - 302 0B in 1.731982ms
2025/11/25 13:25:49 INFO {"audit_event":"created_auth_code","details":{"clientId":14474,"codeId":10816,"userId":11816}}
2025/11/25 13:25:49 [a357f2e3b56e/a04mE72Kgg-001770] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38416 - 302 223B in 2.911892ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001771] "GET http://localhost:19090/auth/authorize/?client_id=test-client-BbepPlkn&redirect_uri=http%3A%2F%2Fwww.legacygrow.name%2Fenvisioneer%2Fplatforms%2Fleading-edge&response_type=code&code_challenge_method=S256&code_challenge=RQTTeDIyUCXXwVficFkUVhbQAHNlHfeTQSocajsKXZQ&scope=openid+profile+email+res-UVcdHLmV%3Aperm-wXgyPNWA+res-UsAwaOoJ%3Aperm-jQEkdzUH&state=cwGqhKQf&nonce=SjszNKeA HTTP/1.1" from [::1]:38422 - 302 57B in 1.278867ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001772] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38434 - 302 54B in 315.867Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001773] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38442 - 200 2949B in 366.222Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11817}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001774] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38442 - 302 0B in 35.922464ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001775] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38442 - 302 57B in 552.213Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001776] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38448 - 302 54B in 524.201Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001777] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38450 - 200 6218B in 3.626662ms
2025/11/25 13:25:50 INFO {"audit_event":"enabled_otp","details":{"userId":11817}}
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_otp","details":{"userId":11817}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001778] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38450 - 302 0B in 4.77389ms
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14475,"userId":11817}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001779] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38450 - 302 58B in 3.22807ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001780] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38452 - 200 4699B in 672.13Âµs
2025/11/25 13:25:50 INFO {"audit_event":"saved_consent","details":{"clientId":14475,"consentId":10146,"userId":11817}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001781] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38452 - 302 0B in 1.587499ms
2025/11/25 13:25:50 INFO {"audit_event":"created_auth_code","details":{"clientId":14475,"codeId":10817,"userId":11817}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001782] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38452 - 302 237B in 2.781024ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted (0.11s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001783] "GET http://localhost:19090/auth/authorize/?client_id=test-client-QmsTYPyi&redirect_uri=https%3A%2F%2Fwww.customersynergistic.biz%2Ffront-end%2Fpartnerships%2Fmarkets%2Fcontent&response_type=code&code_challenge_method=S256&code_challenge=KVbkexKmaVbXVQeNySkyUQVGXWjZQAEwUVgThBanKDJ&scope=openid+profile+email+res-PJgcpEJC%3Aperm-lLzoGWyF+res-HEYTHrjl%3Aperm-mmJjtNlf&state=gLqgMUTO&nonce=fCXloniH HTTP/1.1" from [::1]:38464 - 302 57B in 1.166915ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001784] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38478 - 302 54B in 309.966Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001785] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38494 - 200 2949B in 344.611Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11818}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001786] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38494 - 302 0B in 35.870406ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001787] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38494 - 302 57B in 620.543Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001788] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38506 - 302 54B in 1.421055ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001789] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38512 - 200 6190B in 3.828795ms
2025/11/25 13:25:50 INFO {"audit_event":"enabled_otp","details":{"userId":11818}}
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_otp","details":{"userId":11818}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001790] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38512 - 302 0B in 5.016068ms
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14476,"userId":11818}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001791] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38512 - 302 58B in 2.965183ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001792] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38522 - 200 4699B in 660.208Âµs
2025/11/25 13:25:50 INFO {"audit_event":"saved_consent","details":{"clientId":14476,"consentId":10147,"userId":11818}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001793] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38522 - 302 0B in 1.644998ms
2025/11/25 13:25:50 INFO {"audit_event":"created_auth_code","details":{"clientId":14476,"codeId":10818,"userId":11818}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001794] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38522 - 302 250B in 2.722334ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.11s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001795] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qCgPYzQE&redirect_uri=https%3A%2F%2Fwww.corporatefunctionalities.biz%2Fdeploy%2Fseize%2Fenable&response_type=code&code_challenge_method=S256&code_challenge=uSIcJfnEdgcXcqbajOEEHoSqkKfsZbVfGWXcjPWENsg&scope=openid+profile+email+res-DGtOuPfB%3Aperm-wHkCcnxT+res-GjOEMUGQ%3Aperm-cIewMQtw&state=cTsViAWy&nonce=hbWUFTZZ HTTP/1.1" from [::1]:38532 - 302 57B in 1.091181ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001796] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38538 - 302 54B in 291.872Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001797] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38550 - 200 2949B in 372.053Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11819}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001798] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38550 - 302 0B in 36.233983ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001799] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38550 - 302 57B in 454.419Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001800] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38560 - 302 54B in 586.408Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001801] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38562 - 200 2471B in 589.564Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_otp","details":{"userId":11819}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001802] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38562 - 302 0B in 378.646Âµs
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14477,"userId":11819}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001803] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38562 - 302 58B in 2.692367ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001804] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38568 - 200 4699B in 619.931Âµs
2025/11/25 13:25:50 INFO {"audit_event":"saved_consent","details":{"clientId":14477,"consentId":10148,"userId":11819}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001805] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38568 - 302 0B in 1.626834ms
2025/11/25 13:25:50 INFO {"audit_event":"created_auth_code","details":{"clientId":14477,"codeId":10819,"userId":11819}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001806] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38568 - 302 236B in 2.830989ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001807] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ErDWHBfH&redirect_uri=https%3A%2F%2Fwww.districtopen-source.org%2Fsynergistic%2Fleverage%2Fstrategize%2Fmorph&response_type=code&code_challenge_method=S256&code_challenge=WhSJlerjOYcOTTJWPgwLukFxXkwlLWacAXTjkOaKDhL&scope=openid+profile+email+res-trBfweWg%3Aperm-gtsGUwtF+res-xKRgjjWl%3Aperm-QAUMBnnj&state=XCXXHLta&nonce=tPesuSnV HTTP/1.1" from [::1]:38582 - 302 57B in 1.585055ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001808] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38598 - 302 54B in 285.219Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001809] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38608 - 200 2949B in 324.984Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11820}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001810] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38608 - 302 0B in 36.594544ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001811] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38608 - 302 57B in 951.899Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001812] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38614 - 302 54B in 1.053991ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001813] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38624 - 200 2471B in 951.558Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_otp","details":{"userId":11820}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001814] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38624 - 302 0B in 561.712Âµs
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14478,"userId":11820}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001815] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38624 - 302 58B in 3.68909ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001816] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38626 - 200 4699B in 842.311Âµs
2025/11/25 13:25:50 INFO {"audit_event":"saved_consent","details":{"clientId":14478,"consentId":10149,"userId":11820}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001817] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38626 - 302 0B in 1.752301ms
2025/11/25 13:25:50 INFO {"audit_event":"created_auth_code","details":{"clientId":14478,"codeId":10820,"userId":11820}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001818] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:38626 - 302 249B in 3.019746ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001819] "GET http://localhost:19090/auth/authorize/?client_id=test-client-fIVuuWFV&redirect_uri=http%3A%2F%2Fwww.centralniches.name%2Foptimize%2Fmodels%2Fmarkets%2Fclicks-and-mortar&response_type=code&code_challenge_method=S256&code_challenge=uxriWYsnzDrJiVWBvypUTSDQFJRQQJgTbbycLudrdMB&scope=openid+profile+email+res-OqOsfLUm%3Aperm-BVuzPZUK+res-UaUAGPaX%3Aperm-IpUtTDfw&state=GsJOVesy&nonce=WkSnFpMd HTTP/1.1" from [::1]:38628 - 302 57B in 954.503Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001820] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38634 - 302 54B in 559.116Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001821] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38638 - 200 2949B in 395.067Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11821}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001822] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38638 - 302 0B in 36.620363ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001823] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38638 - 302 60B in 667.651Âµs
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14479,"userId":11821}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001824] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38650 - 302 58B in 3.351132ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001825] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38656 - 200 4699B in 735.89Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001826] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38656 - 302 0B in 279.227Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsCancelled (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001827] "GET http://localhost:19090/auth/authorize/?client_id=test-client-KKTYGYSa&redirect_uri=https%3A%2F%2Fwww.dynamicout-of-the-box.org%2Fcross-platform%2Farchitect%2Fscalable&response_type=code&code_challenge_method=S256&code_challenge=eMdrJzLNHFBJwAlRJxztirFWbqpvPGVxZUmEvBQzFXq&scope=openid+profile+email+res-fHukdDDV%3Aperm-ErxBLRMw+res-HsbnKvbD%3Aperm-WdqLgFnu&state=JzeYxFOr&nonce=uucHNGIh HTTP/1.1" from [::1]:38666 - 302 57B in 1.139604ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001828] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38668 - 302 54B in 306.378Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001829] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38682 - 200 2949B in 340.864Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11822}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001830] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38682 - 302 0B in 37.593291ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001831] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38682 - 302 57B in 571.87Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001832] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38698 - 302 60B in 712.376Âµs
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14480,"userId":11822}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001833] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38700 - 302 58B in 3.098004ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001834] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38708 - 200 4699B in 868.832Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001835] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38708 - 302 0B in 239.021Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001836] "GET http://localhost:19090/auth/authorize/?client_id=test-client-wEAxHagT&redirect_uri=https%3A%2F%2Fwww.seniormethodologies.io%2Fmaximize%2Fembrace&response_type=code&code_challenge_method=S256&code_challenge=OSegIXbfTSOcfAbVQumOdYatebFdyPFxTejBwStsrXa&scope=openid+profile+email+res-ajglScvg%3Aperm-VrhiUjZe+res-nmJZDiKD%3Aperm-PHbzButC&state=zNqduqdV&nonce=hsZnrSir HTTP/1.1" from [::1]:38722 - 302 57B in 1.183726ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001837] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38724 - 302 54B in 236.987Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001838] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38738 - 200 2949B in 413.291Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11823}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001839] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38738 - 302 0B in 35.551804ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001840] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38738 - 302 57B in 412.569Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001841] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38754 - 302 54B in 532.086Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001842] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38758 - 200 2471B in 585.836Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_otp","details":{"userId":11823}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001843] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38758 - 302 0B in 651.33Âµs
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14481,"userId":11823}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001844] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38758 - 302 58B in 3.343167ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001845] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38766 - 200 4699B in 641.141Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001846] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38766 - 302 0B in 2.135655ms
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001847] "GET http://localhost:19090/auth/authorize/?client_id=test-client-pwkSbDPu&redirect_uri=https%3A%2F%2Fwww.futureusers.biz%2Fmodels%2Fmonetize&response_type=code&code_challenge_method=S256&code_challenge=VZBaNiIPBSGJRYqrcTvfYCUrXUueFeaGzSahTtxtBaX&scope=openid+profile+email+res-baorlzQX%3Aperm-DVZNxCRH+res-FKluPgRg%3Aperm-GNuigdMI&state=xgysZFYz&nonce=GvPIAdey HTTP/1.1" from [::1]:38778 - 302 57B in 1.192042ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001848] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38784 - 302 54B in 260.181Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001849] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38792 - 200 2949B in 322.249Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11824}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001850] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38792 - 302 0B in 36.048482ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001851] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38792 - 302 57B in 755.758Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001852] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38794 - 302 54B in 492.45Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001853] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38806 - 200 6214B in 3.788878ms
2025/11/25 13:25:50 INFO {"audit_event":"enabled_otp","details":{"userId":11824}}
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_otp","details":{"userId":11824}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001854] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38806 - 302 0B in 2.189507ms
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14482,"userId":11824}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001855] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38806 - 302 58B in 3.34478ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001856] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38810 - 200 4699B in 1.865935ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001857] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38810 - 302 0B in 636.202Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled (0.10s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001858] "GET http://localhost:19090/auth/authorize/?client_id=test-client-UFjdtxUQ&redirect_uri=http%3A%2F%2Fwww.seniorcommunities.net%2Fe-business%2Fdisintermediate%2Fengineer&response_type=code&code_challenge_method=S256&code_challenge=TfEtGOQEvHUaYLlRvYXdkPbTKbKOugeWmnOpSVCQQxE&scope=openid+profile+email+res-lSdwMOqx%3Aperm-SevDcfDJ+res-pbDWJFxv%3Aperm-LTIZldIx&state=NdYvtpGf&nonce=OdaYCVID HTTP/1.1" from [::1]:38812 - 302 57B in 1.486609ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001859] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38826 - 302 54B in 303.594Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001860] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38834 - 200 2949B in 393.182Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_pwd","details":{"userId":11825}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001861] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38834 - 302 0B in 36.047891ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001862] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38834 - 302 57B in 646.081Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001863] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38842 - 302 54B in 493.973Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001864] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38852 - 200 2471B in 503.531Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_success_otp","details":{"userId":11825}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001865] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38852 - 302 0B in 424.442Âµs
2025/11/25 13:25:50 INFO {"audit_event":"started_new_user_session","details":{"clientId":14483,"userId":11825}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001866] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38852 - 302 58B in 3.360239ms
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001867] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38860 - 200 4699B in 652.624Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001868] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:38860 - 302 0B in 221.509Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled (0.09s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired_PasswordIsIncorrect
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001869] "GET http://localhost:19090/auth/authorize/?client_id=test-client-uSSgKqfy&redirect_uri=https%3A%2F%2Fwww.nationalturn-key.name%2Frelationships%2Fintegrated%2Ffrictionless%2Fmethodologies&response_type=code&code_challenge_method=S256&code_challenge=RSVggUxBXsNMXUSBorXxTLDmcSaOAjbEPEjDYhlNDxh&scope=openid+profile+email&state=ewLDAXDg&nonce=SjZOkGrh HTTP/1.1" from [::1]:38866 - 302 57B in 900.571Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001870] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38876 - 302 54B in 318.682Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001871] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38888 - 200 2949B in 356.975Âµs
2025/11/25 13:25:50 INFO {"audit_event":"auth_failed_pwd","details":{"email":"pascaleturner@frami.name"}}
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001872] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38888 - 200 3012B in 37.302091ms
2025/11/25 13:25:50 ERROR authContext.AuthState 'level1_password' does not match any required state
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthLevel1CompletedGet.3
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_level1.go:78
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthLevel1CompletedGet.3
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_level1.go:78
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/a04mE72Kgg-001873
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001873] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38888 - 500 2303B in 615.473Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired_PasswordIsIncorrect (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired_OtpCodeIsIncorrect
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001874] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ksTjWlAK&redirect_uri=https%3A%2F%2Fwww.nationalmorph.org%2Ffront-end%2Finitiatives%2Fchannels&response_type=code&code_challenge_method=S256&code_challenge=blcGBXcNPrhWIDvOhLrHWtdeWgKhDxEetEnidBMEzYw&scope=openid+profile+email&state=ftJTXxgt&nonce=LtESOWco HTTP/1.1" from [::1]:38898 - 302 57B in 921.261Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001875] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38912 - 302 54B in 332.729Âµs
2025/11/25 13:25:50 [a357f2e3b56e/a04mE72Kgg-001876] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38926 - 200 2949B in 387.983Âµs
2025/11/25 13:25:51 INFO {"audit_event":"auth_success_pwd","details":{"userId":11827}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001877] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38926 - 302 0B in 35.684655ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001878] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38926 - 302 57B in 579.735Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001879] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:38942 - 302 54B in 515.755Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001880] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38954 - 200 6174B in 3.625971ms
2025/11/25 13:25:51 INFO {"audit_event":"auth_failed_otp","details":{"userId":11827}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001881] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:38954 - 200 6401B in 527.317Âµs
2025/11/25 13:25:51 ERROR authContext.AuthState is not authentication_completed
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/a04mE72Kgg-001882
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001882] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:38954 - 500 2303B in 348.82Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired_OtpCodeIsIncorrect (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired_OtpIsIncorrect
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001883] "GET http://localhost:19090/auth/authorize/?client_id=test-client-RPzSxRHR&redirect_uri=https%3A%2F%2Fwww.principalintuitive.name%2Fpartnerships%2Fbandwidth%2Fuser-centric&response_type=code&code_challenge_method=S256&code_challenge=nGoxSYXMVHTTVRADeGNAzKVuTbgUusNJuPwyMeozZNy&scope=openid+profile+email&state=qvXyZHuX&nonce=xneGAAkw HTTP/1.1" from [::1]:38966 - 302 57B in 1.052759ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001884] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:38980 - 302 54B in 237.519Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001885] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38996 - 200 2949B in 345.844Âµs
2025/11/25 13:25:51 INFO {"audit_event":"auth_success_pwd","details":{"userId":11828}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001886] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:38996 - 302 0B in 35.610134ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001887] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:38996 - 302 57B in 606.636Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001888] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39002 - 302 54B in 556.281Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001889] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39014 - 200 2471B in 589.734Âµs
2025/11/25 13:25:51 INFO {"audit_event":"auth_failed_otp","details":{"userId":11828}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001890] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39014 - 200 2698B in 472.193Âµs
2025/11/25 13:25:51 ERROR authContext.AuthState is not authentication_completed
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/a04mE72Kgg-001891
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001891] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39014 - 500 2303B in 365.701Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired_OtpIsIncorrect (0.08s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel1Request
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001892] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PSYESRro&redirect_uri=http%3A%2F%2Fwww.nationaldistributed.biz%2Fstrategize%2Fgranular&response_type=code&code_challenge_method=S256&code_challenge=lbQFsQHQeASuJQJAdhbxsSNzGMIpxMpezhhNiZyWwGi&scope=openid+profile+email&state=MhqcoMPQ&nonce=glIRPSam HTTP/1.1" from [::1]:39026 - 302 57B in 720.602Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001893] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39036 - 302 54B in 309.125Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001894] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39052 - 200 2949B in 312.36Âµs
2025/11/25 13:25:51 INFO {"audit_event":"auth_success_pwd","details":{"userId":11829}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001895] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39052 - 302 0B in 35.491981ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001896] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39052 - 302 60B in 420.465Âµs
2025/11/25 13:25:51 INFO {"audit_event":"started_new_user_session","details":{"clientId":14487,"userId":11829}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001897] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39062 - 302 56B in 3.03241ms
2025/11/25 13:25:51 INFO {"audit_event":"created_auth_code","details":{"clientId":14487,"codeId":10821,"userId":11829}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001898] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39076 - 302 230B in 2.854693ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001899] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PSYESRro&redirect_uri=http%3A%2F%2Fwww.nationaldistributed.biz%2Fstrategize%2Fgranular&response_type=code&code_challenge_method=S256&code_challenge=gQMFPEFeaFDjrvwShTLECJhsGEHllEzfMWaNOWTBYue&scope=openid+profile+email&state=mgmcFFFx&nonce=wlpAEXDm&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:39082 - 302 66B in 1.722776ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001900] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39090 - 302 60B in 1.788709ms
2025/11/25 13:25:51 INFO {"audit_event":"bumped_user_session","details":{"clientId":14487,"userId":11829}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001901] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39098 - 302 56B in 5.168125ms
2025/11/25 13:25:51 INFO {"audit_event":"created_auth_code","details":{"clientId":14487,"codeId":10822,"userId":11829}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001902] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39104 - 302 230B in 1.620933ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel1Request (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001903] "GET http://localhost:19090/auth/authorize/?client_id=test-client-UgbnXkvZ&redirect_uri=http%3A%2F%2Fwww.leadsynthesize.io%2Fengage%2Fb2b&response_type=code&code_challenge_method=S256&code_challenge=UPwCPFCMnAFlkAXDDymLzSGzxaRBVakPernilOdGGpS&scope=openid+profile+email&state=WQYlqCtU&nonce=mVvInaVR HTTP/1.1" from [::1]:39108 - 302 57B in 749.626Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001904] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39114 - 302 54B in 269.419Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001905] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39122 - 200 2949B in 311.098Âµs
2025/11/25 13:25:51 INFO {"audit_event":"auth_success_pwd","details":{"userId":11830}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001906] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39122 - 302 0B in 35.553787ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001907] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39122 - 302 60B in 544.829Âµs
2025/11/25 13:25:51 INFO {"audit_event":"started_new_user_session","details":{"clientId":14488,"userId":11830}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001908] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39126 - 302 56B in 2.145343ms
2025/11/25 13:25:51 INFO {"audit_event":"created_auth_code","details":{"clientId":14488,"codeId":10823,"userId":11830}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001909] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39134 - 302 215B in 2.923604ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001910] "GET http://localhost:19090/auth/authorize/?client_id=test-client-UgbnXkvZ&redirect_uri=http%3A%2F%2Fwww.leadsynthesize.io%2Fengage%2Fb2b&response_type=code&code_challenge_method=S256&code_challenge=yhMKmkymXLgNuGjiRUzPufBzWKIQViGKcTCEzxvCUfO&scope=openid+profile+email&state=zcBtKqcz&nonce=nXXxlMVd&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:39142 - 302 66B in 1.573844ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001911] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39156 - 302 57B in 446.563Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001912] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39162 - 302 60B in 409.404Âµs
2025/11/25 13:25:51 INFO {"audit_event":"bumped_user_session","details":{"clientId":14488,"userId":11830}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001913] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39172 - 302 56B in 4.925887ms
2025/11/25 13:25:51 INFO {"audit_event":"created_auth_code","details":{"clientId":14488,"codeId":10824,"userId":11830}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001914] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39182 - 302 215B in 2.961034ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpDisabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001915] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SuAxtDLR&redirect_uri=https%3A%2F%2Fwww.centralsynergies.com%2Fefficient&response_type=code&code_challenge_method=S256&code_challenge=QdUzoyuatHBkbPFYqSJYnKffbwRMAFobYSyymsGgPWR&scope=openid+profile+email&state=NIpvgMyE&nonce=yDeqwrFl HTTP/1.1" from [::1]:39190 - 302 57B in 598.14Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001916] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39204 - 302 54B in 222.621Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001917] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39208 - 200 2949B in 386.66Âµs
2025/11/25 13:25:51 INFO {"audit_event":"auth_success_pwd","details":{"userId":11831}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001918] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39208 - 302 0B in 35.210268ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001919] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39208 - 302 60B in 438.679Âµs
2025/11/25 13:25:51 INFO {"audit_event":"started_new_user_session","details":{"clientId":14489,"userId":11831}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001920] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39214 - 302 56B in 2.124775ms
2025/11/25 13:25:51 INFO {"audit_event":"created_auth_code","details":{"clientId":14489,"codeId":10825,"userId":11831}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001921] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39228 - 302 218B in 2.683971ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001922] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SuAxtDLR&redirect_uri=https%3A%2F%2Fwww.centralsynergies.com%2Fefficient&response_type=code&code_challenge_method=S256&code_challenge=wzRekoHyXkwRFzihLlQbwkKGfvYhQzVoynecGtasrdD&scope=openid+profile+email&state=TFkUexoM&nonce=GWVOUjNV&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:39234 - 302 66B in 1.516736ms
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001923] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39250 - 302 57B in 549.519Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001924] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39266 - 302 54B in 384.847Âµs
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001925] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39280 - 200 2471B in 464.558Âµs
2025/11/25 13:25:51 INFO {"audit_event":"auth_success_otp","details":{"userId":11831}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001926] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39280 - 302 0B in 297.502Âµs
2025/11/25 13:25:51 INFO {"audit_event":"bumped_user_session","details":{"clientId":14489,"userId":11831}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001927] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39280 - 302 56B in 5.711352ms
2025/11/25 13:25:51 INFO {"audit_event":"created_auth_code","details":{"clientId":14489,"codeId":10826,"userId":11831}}
2025/11/25 13:25:51 [a357f2e3b56e/a04mE72Kgg-001928] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39296 - 302 218B in 2.985361ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpEnabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001929] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iPtPBeQd&redirect_uri=https%3A%2F%2Fwww.dynamicgenerate.io%2Fmission-critical%2Fincentivize%2Fincentivize&response_type=code&code_challenge_method=S256&code_challenge=adbLqNVyYZgjUtwUkvOmGQJNzfjtzErOxuUbIwzovLb&scope=openid+profile+email&state=GAyTAcWq&nonce=YDJzsplf HTTP/1.1" from [::1]:39302 - 302 57B in 866.027Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001930] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39306 - 302 54B in 173.468Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001931] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39320 - 200 2949B in 311.668Âµs
2025/11/25 13:25:52 INFO {"audit_event":"auth_success_pwd","details":{"userId":11832}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001932] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39320 - 302 0B in 35.989691ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001933] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39320 - 302 60B in 609.342Âµs
2025/11/25 13:25:52 INFO {"audit_event":"started_new_user_session","details":{"clientId":14490,"userId":11832}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001934] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39326 - 302 56B in 2.028493ms
2025/11/25 13:25:52 INFO {"audit_event":"created_auth_code","details":{"clientId":14490,"codeId":10827,"userId":11832}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001935] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39334 - 302 247B in 3.659484ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001936] "GET http://localhost:19090/auth/authorize/?client_id=test-client-iPtPBeQd&redirect_uri=https%3A%2F%2Fwww.dynamicgenerate.io%2Fmission-critical%2Fincentivize%2Fincentivize&response_type=code&code_challenge_method=S256&code_challenge=HPPwNvbIVcTdWUTTRXgdiVIUKrvJcXnsQcFlONyVSXC&scope=openid+profile+email&state=fKAiqmgg&nonce=kgLzyGju&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:39350 - 302 66B in 1.483603ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001937] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39364 - 302 57B in 533.428Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001938] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39374 - 302 54B in 446.584Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001939] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39382 - 200 6162B in 4.669843ms
2025/11/25 13:25:52 INFO {"audit_event":"enabled_otp","details":{"userId":11832}}
2025/11/25 13:25:52 INFO {"audit_event":"auth_success_otp","details":{"userId":11832}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001940] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39382 - 302 0B in 7.522964ms
2025/11/25 13:25:52 INFO {"audit_event":"bumped_user_session","details":{"clientId":14490,"userId":11832}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001941] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39382 - 302 56B in 2.299114ms
2025/11/25 13:25:52 INFO {"audit_event":"created_auth_code","details":{"clientId":14490,"codeId":10828,"userId":11832}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001942] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39384 - 302 247B in 2.94243ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpDisabled (0.31s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001943] "GET http://localhost:19090/auth/authorize/?client_id=test-client-uSYaBFcg&redirect_uri=http%3A%2F%2Fwww.investordrive.name%2Fimpactful%2Fdot-com%2Fcontent%2Fweb-enabled&response_type=code&code_challenge_method=S256&code_challenge=ZaZHEmbBoeWcwtjozqUrfatsBVgbKQlqPwFKgpADRnm&scope=openid+profile+email&state=aAHbFqjT&nonce=lZqhKfLa HTTP/1.1" from [::1]:39394 - 302 57B in 877.638Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001944] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39396 - 302 54B in 295.709Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001945] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39408 - 200 2949B in 315.957Âµs
2025/11/25 13:25:52 INFO {"audit_event":"auth_success_pwd","details":{"userId":11833}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001946] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39408 - 302 0B in 35.646142ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001947] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39408 - 302 60B in 446.394Âµs
2025/11/25 13:25:52 INFO {"audit_event":"started_new_user_session","details":{"clientId":14491,"userId":11833}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001948] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39414 - 302 56B in 3.051977ms
2025/11/25 13:25:52 INFO {"audit_event":"created_auth_code","details":{"clientId":14491,"codeId":10829,"userId":11833}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001949] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39416 - 302 243B in 2.551982ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001950] "GET http://localhost:19090/auth/authorize/?client_id=test-client-uSYaBFcg&redirect_uri=http%3A%2F%2Fwww.investordrive.name%2Fimpactful%2Fdot-com%2Fcontent%2Fweb-enabled&response_type=code&code_challenge_method=S256&code_challenge=AWkbytHLUzVyCCuOWaERcCwmYyrflVmJXPNWpRwvbDF&scope=openid+profile+email&state=mXRobXqQ&nonce=HDDRMMIi&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:39432 - 302 66B in 1.701345ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001951] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39438 - 302 57B in 548.356Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001952] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39446 - 302 54B in 595.545Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001953] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39460 - 200 2471B in 515.735Âµs
2025/11/25 13:25:52 INFO {"audit_event":"auth_success_otp","details":{"userId":11833}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001954] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39460 - 302 0B in 443.097Âµs
2025/11/25 13:25:52 INFO {"audit_event":"bumped_user_session","details":{"clientId":14491,"userId":11833}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001955] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39460 - 302 56B in 4.735588ms
2025/11/25 13:25:52 INFO {"audit_event":"created_auth_code","details":{"clientId":14491,"codeId":10830,"userId":11833}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001956] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39468 - 302 243B in 2.94835ms
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpEnabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel1Request
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001957] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JFyaQJsy&redirect_uri=http%3A%2F%2Fwww.customerengage.info%2Fend-to-end%2Fsolutions%2Fuser-centric%2Fe-commerce&response_type=code&code_challenge_method=S256&code_challenge=zRPGltZSItzRzRkCpvweHeDIfQGJQhgaHUtUPkmHjlM&scope=openid+profile+email&state=zjmnFkSm&nonce=UlumeEmA HTTP/1.1" from [::1]:39482 - 302 57B in 982.716Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001958] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39492 - 302 54B in 231.177Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001959] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39494 - 200 2949B in 354.089Âµs
2025/11/25 13:25:52 INFO {"audit_event":"auth_success_pwd","details":{"userId":11834}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001960] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39494 - 302 0B in 35.478284ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001961] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39494 - 302 57B in 479.326Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001962] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39508 - 302 60B in 491.87Âµs
2025/11/25 13:25:52 INFO {"audit_event":"started_new_user_session","details":{"clientId":14492,"userId":11834}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001963] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39516 - 302 56B in 1.916812ms
2025/11/25 13:25:52 INFO {"audit_event":"created_auth_code","details":{"clientId":14492,"codeId":10831,"userId":11834}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001964] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39532 - 302 251B in 2.589633ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001965] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JFyaQJsy&redirect_uri=http%3A%2F%2Fwww.customerengage.info%2Fend-to-end%2Fsolutions%2Fuser-centric%2Fe-commerce&response_type=code&code_challenge_method=S256&code_challenge=qpxjlQFldZodcdCkJgZZQhTBVcBehWwzZgQijeqnrbc&scope=openid+profile+email&state=qqMvkHTu&nonce=sRIhlrTZ&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:39536 - 302 66B in 1.667611ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001966] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39552 - 302 60B in 549.929Âµs
2025/11/25 13:25:52 INFO {"audit_event":"bumped_user_session","details":{"clientId":14492,"userId":11834}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001967] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39560 - 302 56B in 4.751327ms
2025/11/25 13:25:52 INFO {"audit_event":"created_auth_code","details":{"clientId":14492,"codeId":10832,"userId":11834}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001968] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39572 - 302 251B in 1.798728ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel1Request (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001969] "GET http://localhost:19090/auth/authorize/?client_id=test-client-QWAxYKii&redirect_uri=https%3A%2F%2Fwww.dynamiceyeballs.net%2Fout-of-the-box%2Fbleeding-edge%2Fmodels&response_type=code&code_challenge_method=S256&code_challenge=ObWGMYYhwoFQSbQhwUQJOKWxxQptkvVimdwNSWwevJX&scope=openid+profile+email&state=WhXsQBsR&nonce=czierKVn HTTP/1.1" from [::1]:39584 - 302 57B in 1.027822ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001970] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39592 - 302 54B in 233.742Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001971] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39594 - 200 2949B in 320.496Âµs
2025/11/25 13:25:52 INFO {"audit_event":"auth_success_pwd","details":{"userId":11835}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001972] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39594 - 302 0B in 35.28027ms
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001973] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39594 - 302 57B in 522.707Âµs
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001974] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39604 - 302 60B in 422.428Âµs
2025/11/25 13:25:52 INFO {"audit_event":"started_new_user_session","details":{"clientId":14493,"userId":11835}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001975] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39614 - 302 56B in 2.118413ms
2025/11/25 13:25:52 INFO {"audit_event":"created_auth_code","details":{"clientId":14493,"codeId":10833,"userId":11835}}
2025/11/25 13:25:52 [a357f2e3b56e/a04mE72Kgg-001976] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39622 - 302 243B in 2.922392ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001977] "GET http://localhost:19090/auth/authorize/?client_id=test-client-QWAxYKii&redirect_uri=https%3A%2F%2Fwww.dynamiceyeballs.net%2Fout-of-the-box%2Fbleeding-edge%2Fmodels&response_type=code&code_challenge_method=S256&code_challenge=zIBhSFzVLxXfdcLVLgUluxTpuBbfJlwuLcRedaNioqL&scope=openid+profile+email&state=gtOnADat&nonce=WsQyPsMr&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:39638 - 302 66B in 1.655498ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001978] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39648 - 302 60B in 492.741Âµs
2025/11/25 13:25:53 INFO {"audit_event":"bumped_user_session","details":{"clientId":14493,"userId":11835}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001979] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39662 - 302 56B in 4.769973ms
2025/11/25 13:25:53 INFO {"audit_event":"created_auth_code","details":{"clientId":14493,"codeId":10834,"userId":11835}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001980] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39666 - 302 243B in 1.668532ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpDisabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001981] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oLyCcpGG&redirect_uri=http%3A%2F%2Fwww.customeruser-centric.name%2Finnovate%2Fusers%2Fe-business&response_type=code&code_challenge_method=S256&code_challenge=COVhfgIqqsiLFhSRkpDCpZeVeItDnCPxmbKHrUgTMYM&scope=openid+profile+email&state=TLeFIjDi&nonce=bFCuGBTx HTTP/1.1" from [::1]:39682 - 302 57B in 649.979Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001982] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39690 - 302 54B in 226.268Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001983] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39694 - 200 2949B in 328.1Âµs
2025/11/25 13:25:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":11836}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001984] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39694 - 302 0B in 35.207773ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001985] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39694 - 302 57B in 448.447Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001986] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39700 - 302 60B in 410.957Âµs
2025/11/25 13:25:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":14494,"userId":11836}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001987] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39712 - 302 56B in 2.620892ms
2025/11/25 13:25:53 INFO {"audit_event":"created_auth_code","details":{"clientId":14494,"codeId":10835,"userId":11836}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001988] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39728 - 302 238B in 3.166833ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001989] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oLyCcpGG&redirect_uri=http%3A%2F%2Fwww.customeruser-centric.name%2Finnovate%2Fusers%2Fe-business&response_type=code&code_challenge_method=S256&code_challenge=zbJQbGAiACLwWRRFxeAvukpGrnnPSKMGVULnqTRRXlT&scope=openid+profile+email&state=SNjuingO&nonce=ItTQMDaI&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:39734 - 302 66B in 1.853181ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001990] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39744 - 302 57B in 4.404432ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001991] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39754 - 302 54B in 599.753Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001992] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39758 - 200 2471B in 509.322Âµs
2025/11/25 13:25:53 INFO {"audit_event":"auth_success_otp","details":{"userId":11836}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001993] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39758 - 302 0B in 438.829Âµs
2025/11/25 13:25:53 INFO {"audit_event":"bumped_user_session","details":{"clientId":14494,"userId":11836}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001994] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39758 - 302 56B in 2.467051ms
2025/11/25 13:25:53 INFO {"audit_event":"created_auth_code","details":{"clientId":14494,"codeId":10836,"userId":11836}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001995] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39770 - 302 238B in 1.57727ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpEnabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001996] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PVpHRBgD&redirect_uri=https%3A%2F%2Fwww.chiefvisionary.net%2Finfomediaries%2Fsyndicate&response_type=code&code_challenge_method=S256&code_challenge=grZKlTPoXvVaAAQfhOxurEChFzdUGtAxLJAdLDNaSyB&scope=openid+profile+email&state=QyJLLxyq&nonce=bVPEExzB HTTP/1.1" from [::1]:39772 - 302 57B in 936.971Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001997] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39786 - 302 54B in 300.167Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001998] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39796 - 200 2949B in 354.3Âµs
2025/11/25 13:25:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":11837}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-001999] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39796 - 302 0B in 35.962711ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002000] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39796 - 302 57B in 556.341Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002001] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39802 - 302 60B in 502.549Âµs
2025/11/25 13:25:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":14495,"userId":11837}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002002] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39806 - 302 56B in 2.063489ms
2025/11/25 13:25:53 INFO {"audit_event":"created_auth_code","details":{"clientId":14495,"codeId":10837,"userId":11837}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002003] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39812 - 302 230B in 2.839966ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002004] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PVpHRBgD&redirect_uri=https%3A%2F%2Fwww.chiefvisionary.net%2Finfomediaries%2Fsyndicate&response_type=code&code_challenge_method=S256&code_challenge=xDHQrfvLKhTdGuCvOMzegnsJtfPrNWtTKqTIoOsUjYh&scope=openid+profile+email&state=wIfCijpB&nonce=sdYxnrqu&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:39824 - 302 66B in 1.615723ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002005] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39840 - 302 57B in 710.402Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002006] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39850 - 302 54B in 457.053Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002007] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39866 - 200 6158B in 3.650037ms
2025/11/25 13:25:53 INFO {"audit_event":"enabled_otp","details":{"userId":11837}}
2025/11/25 13:25:53 INFO {"audit_event":"auth_success_otp","details":{"userId":11837}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002008] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39866 - 302 0B in 4.479764ms
2025/11/25 13:25:53 INFO {"audit_event":"bumped_user_session","details":{"clientId":14495,"userId":11837}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002009] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39866 - 302 56B in 2.209725ms
2025/11/25 13:25:53 INFO {"audit_event":"created_auth_code","details":{"clientId":14495,"codeId":10838,"userId":11837}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002010] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39880 - 302 230B in 2.981804ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpDisabled (0.31s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002011] "GET http://localhost:19090/auth/authorize/?client_id=test-client-WmVCJcVn&redirect_uri=https%3A%2F%2Fwww.productintegrate.info%2Fproductize%2Farchitectures%2Fmonetize&response_type=code&code_challenge_method=S256&code_challenge=RoSCdVRZJRqFeysGmOfemvceWeQFViNRjuYwvTMcnRy&scope=openid+profile+email&state=JrTZyowk&nonce=tyetGNGT HTTP/1.1" from [::1]:39884 - 302 57B in 895.613Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002012] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39900 - 302 54B in 224.013Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002013] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39910 - 200 2949B in 279.408Âµs
2025/11/25 13:25:53 INFO {"audit_event":"auth_success_pwd","details":{"userId":11838}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002014] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:39910 - 302 0B in 35.293746ms
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002015] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39910 - 302 57B in 476.841Âµs
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002016] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39922 - 302 60B in 562.283Âµs
2025/11/25 13:25:53 INFO {"audit_event":"started_new_user_session","details":{"clientId":14496,"userId":11838}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002017] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39928 - 302 56B in 1.9637ms
2025/11/25 13:25:53 INFO {"audit_event":"created_auth_code","details":{"clientId":14496,"codeId":10839,"userId":11838}}
2025/11/25 13:25:53 [a357f2e3b56e/a04mE72Kgg-002018] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39938 - 302 243B in 1.479104ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002019] "GET http://localhost:19090/auth/authorize/?client_id=test-client-WmVCJcVn&redirect_uri=https%3A%2F%2Fwww.productintegrate.info%2Fproductize%2Farchitectures%2Fmonetize&response_type=code&code_challenge_method=S256&code_challenge=hLyJHYznrjQhBajRXdzBVfoICSZurpZUBpEgJViUwoj&scope=openid+profile+email&state=wSGxYzzA&nonce=eUXbkGOD&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:39948 - 302 66B in 1.760326ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002020] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:39960 - 302 57B in 566.27Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002021] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:39968 - 302 54B in 519.742Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002022] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39974 - 200 2471B in 585.386Âµs
2025/11/25 13:25:54 INFO {"audit_event":"auth_success_otp","details":{"userId":11838}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002023] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:39974 - 302 0B in 432.388Âµs
2025/11/25 13:25:54 INFO {"audit_event":"bumped_user_session","details":{"clientId":14496,"userId":11838}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002024] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:39974 - 302 56B in 5.149981ms
2025/11/25 13:25:54 INFO {"audit_event":"created_auth_code","details":{"clientId":14496,"codeId":10840,"userId":11838}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002025] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:39986 - 302 243B in 2.038642ms
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpEnabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel1Request
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002026] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nyNApEzz&redirect_uri=http%3A%2F%2Fwww.legacydeliver.io%2Fsystems%2Fincubate%2Freinvent%2Fwireless&response_type=code&code_challenge_method=S256&code_challenge=VUSbvAUqOaCUfidqXLNvnwSdnzPxTNeWrepIKkCqSXG&scope=openid+profile+email&state=wVEklxJn&nonce=JfLgTLGh HTTP/1.1" from [::1]:39994 - 302 57B in 1.796845ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002027] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:39998 - 302 54B in 504.352Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002028] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:40004 - 200 2949B in 731.583Âµs
2025/11/25 13:25:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":11839}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002029] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:40004 - 302 0B in 37.478444ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002030] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:40004 - 302 57B in 596.066Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002031] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:40018 - 302 54B in 648.696Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002032] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:40026 - 200 2471B in 532.416Âµs
2025/11/25 13:25:54 INFO {"audit_event":"auth_success_otp","details":{"userId":11839}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002033] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:40026 - 302 0B in 406.288Âµs
2025/11/25 13:25:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":14497,"userId":11839}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002034] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:40026 - 302 56B in 2.145083ms
2025/11/25 13:25:54 INFO {"audit_event":"created_auth_code","details":{"clientId":14497,"codeId":10841,"userId":11839}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002035] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:40030 - 302 238B in 3.044853ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002036] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nyNApEzz&redirect_uri=http%3A%2F%2Fwww.legacydeliver.io%2Fsystems%2Fincubate%2Freinvent%2Fwireless&response_type=code&code_challenge_method=S256&code_challenge=GFXBMrAdVveYzdAAxTwuVxQczRVyDvsgmWBwbMODnlp&scope=openid+profile+email&state=LmbmawzF&nonce=xEgvpvIH&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:46376 - 302 66B in 1.483543ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002037] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46378 - 302 60B in 484.676Âµs
2025/11/25 13:25:54 INFO {"audit_event":"bumped_user_session","details":{"clientId":14497,"userId":11839}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002038] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46390 - 302 56B in 6.352623ms
2025/11/25 13:25:54 INFO {"audit_event":"created_auth_code","details":{"clientId":14497,"codeId":10842,"userId":11839}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002039] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46396 - 302 238B in 1.589544ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel1Request (0.31s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002040] "GET http://localhost:19090/auth/authorize/?client_id=test-client-sTBlTzyU&redirect_uri=http%3A%2F%2Fwww.legacybrand.com%2Fmetrics&response_type=code&code_challenge_method=S256&code_challenge=ERPINoCVWtephFLzVdGJdXTMeUMfsWRVqlHKAxJyOHA&scope=openid+profile+email&state=qtnuMqvQ&nonce=ueFrtySl HTTP/1.1" from [::1]:46404 - 302 57B in 712.105Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002041] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46406 - 302 54B in 188.857Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002042] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46418 - 200 2949B in 374.859Âµs
2025/11/25 13:25:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":11840}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002043] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46418 - 302 0B in 35.929808ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002044] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46418 - 302 57B in 484.927Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002045] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46428 - 302 54B in 453.005Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002046] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46442 - 200 2471B in 444.69Âµs
2025/11/25 13:25:54 INFO {"audit_event":"auth_success_otp","details":{"userId":11840}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002047] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46442 - 302 0B in 294.546Âµs
2025/11/25 13:25:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":14498,"userId":11840}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002048] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46442 - 302 56B in 1.951267ms
2025/11/25 13:25:54 INFO {"audit_event":"created_auth_code","details":{"clientId":14498,"codeId":10843,"userId":11840}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002049] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46452 - 302 210B in 2.720731ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002050] "GET http://localhost:19090/auth/authorize/?client_id=test-client-sTBlTzyU&redirect_uri=http%3A%2F%2Fwww.legacybrand.com%2Fmetrics&response_type=code&code_challenge_method=S256&code_challenge=lDebkKXPnXjWtoxuMdOXwvQIRfGAiRTAZPRvnlJbWbd&scope=openid+profile+email&state=oMkIiHHB&nonce=ejIhhMsA&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:46464 - 302 66B in 1.486038ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002051] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46476 - 302 60B in 506.757Âµs
2025/11/25 13:25:54 INFO {"audit_event":"bumped_user_session","details":{"clientId":14498,"userId":11840}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002052] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46484 - 302 56B in 4.787987ms
2025/11/25 13:25:54 INFO {"audit_event":"created_auth_code","details":{"clientId":14498,"codeId":10844,"userId":11840}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002053] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46488 - 302 210B in 1.772219ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpDisabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002054] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LxjTFYoa&redirect_uri=https%3A%2F%2Fwww.districtfront-end.name%2Fenterprise&response_type=code&code_challenge_method=S256&code_challenge=mmbYmKVdOQDlNOmULohTbBSZQLEDdxlSoRXYekXqWyh&scope=openid+profile+email&state=ywafEjnn&nonce=ktklcOrN HTTP/1.1" from [::1]:46500 - 302 57B in 802.335Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002055] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46510 - 302 54B in 288.735Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002056] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46524 - 200 2949B in 395.116Âµs
2025/11/25 13:25:54 INFO {"audit_event":"auth_success_pwd","details":{"userId":11841}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002057] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46524 - 302 0B in 35.432297ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002058] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46524 - 302 57B in 382.683Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002059] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46536 - 302 54B in 412.63Âµs
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002060] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46542 - 200 2471B in 490.276Âµs
2025/11/25 13:25:54 INFO {"audit_event":"auth_success_otp","details":{"userId":11841}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002061] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46542 - 302 0B in 326.817Âµs
2025/11/25 13:25:54 INFO {"audit_event":"started_new_user_session","details":{"clientId":14499,"userId":11841}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002062] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46542 - 302 56B in 2.197041ms
2025/11/25 13:25:54 INFO {"audit_event":"created_auth_code","details":{"clientId":14499,"codeId":10845,"userId":11841}}
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002063] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46554 - 302 221B in 2.789931ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002064] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LxjTFYoa&redirect_uri=https%3A%2F%2Fwww.districtfront-end.name%2Fenterprise&response_type=code&code_challenge_method=S256&code_challenge=SPlHqjtEqxkqJQsJScyDybrzFFjTuyuDaDyTHvIrqeh&scope=openid+profile+email&state=bxPdyrJa&nonce=oeCCiEbr&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:46556 - 302 66B in 1.474746ms
2025/11/25 13:25:54 [a357f2e3b56e/a04mE72Kgg-002065] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46570 - 302 60B in 529.4Âµs
2025/11/25 13:25:55 INFO {"audit_event":"bumped_user_session","details":{"clientId":14499,"userId":11841}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002066] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46580 - 302 56B in 4.75271ms
2025/11/25 13:25:55 INFO {"audit_event":"created_auth_code","details":{"clientId":14499,"codeId":10846,"userId":11841}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002067] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46584 - 302 221B in 1.715ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpEnabled (0.30s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002068] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LEzzXtdv&redirect_uri=http%3A%2F%2Fwww.customercontent.name%2Finteractive%2Fubiquitous%2Fmindshare%2Fsexy&response_type=code&code_challenge_method=S256&code_challenge=sylaJvkIynWXqEhHXPoHuCvuFxUODBqNUrpOZFRqlUJ&scope=openid+profile+email&state=ZkdUEBpg&nonce=CGLloBjT HTTP/1.1" from [::1]:46586 - 302 57B in 660.638Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002069] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46598 - 302 54B in 228.732Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002070] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46602 - 200 2949B in 325.465Âµs
2025/11/25 13:25:55 INFO {"audit_event":"auth_success_pwd","details":{"userId":11842}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002071] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46602 - 302 0B in 35.892848ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002072] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46602 - 302 57B in 390.989Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002073] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46610 - 302 54B in 410.546Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002074] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46612 - 200 2471B in 415.775Âµs
2025/11/25 13:25:55 INFO {"audit_event":"auth_success_otp","details":{"userId":11842}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002075] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46612 - 302 0B in 262.335Âµs
2025/11/25 13:25:55 INFO {"audit_event":"started_new_user_session","details":{"clientId":14500,"userId":11842}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002076] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46612 - 302 56B in 2.021981ms
2025/11/25 13:25:55 INFO {"audit_event":"created_auth_code","details":{"clientId":14500,"codeId":10847,"userId":11842}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002077] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46616 - 302 245B in 2.85285ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002078] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LEzzXtdv&redirect_uri=http%3A%2F%2Fwww.customercontent.name%2Finteractive%2Fubiquitous%2Fmindshare%2Fsexy&response_type=code&code_challenge_method=S256&code_challenge=ltonHfNpPQpPPnuhczhXEAWmJRxWwvvszlGWjkHyTKG&scope=openid+profile+email&state=awceGlin&nonce=RZTxhsbN&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:46628 - 302 66B in 1.551311ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002079] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46636 - 302 57B in 3.11695ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002080] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46642 - 302 54B in 585.636Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002081] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46644 - 200 6198B in 3.839445ms
2025/11/25 13:25:55 INFO {"audit_event":"enabled_otp","details":{"userId":11842}}
2025/11/25 13:25:55 INFO {"audit_event":"auth_success_otp","details":{"userId":11842}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002082] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46644 - 302 0B in 4.746058ms
2025/11/25 13:25:55 INFO {"audit_event":"bumped_user_session","details":{"clientId":14500,"userId":11842}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002083] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46644 - 302 56B in 2.134323ms
2025/11/25 13:25:55 INFO {"audit_event":"created_auth_code","details":{"clientId":14500,"codeId":10848,"userId":11842}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002084] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46652 - 302 245B in 1.705092ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpDisabled (0.31s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002085] "GET http://localhost:19090/auth/authorize/?client_id=test-client-hhduqkMB&redirect_uri=https%3A%2F%2Fwww.leaddeliver.com%2Fworld-class%2Finterfaces%2Fexperiences&response_type=code&code_challenge_method=S256&code_challenge=whvwQbKNzZJJuNFZdahycpveAFQKDtwwdeOzcvNrbIP&scope=openid+profile+email&state=ouRLIUNs&nonce=tFbJKBYT HTTP/1.1" from [::1]:46666 - 302 57B in 635.341Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002086] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46682 - 302 54B in 211.88Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002087] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46692 - 200 2949B in 302.371Âµs
2025/11/25 13:25:55 INFO {"audit_event":"auth_success_pwd","details":{"userId":11843}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002088] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46692 - 302 0B in 35.352166ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002089] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46692 - 302 57B in 470.62Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002090] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46706 - 302 54B in 561.601Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002091] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46714 - 200 2471B in 421.516Âµs
2025/11/25 13:25:55 INFO {"audit_event":"auth_success_otp","details":{"userId":11843}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002092] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:46714 - 302 0B in 259.68Âµs
2025/11/25 13:25:55 INFO {"audit_event":"started_new_user_session","details":{"clientId":14501,"userId":11843}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002093] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46714 - 302 56B in 2.107372ms
2025/11/25 13:25:55 INFO {"audit_event":"created_auth_code","details":{"clientId":14501,"codeId":10849,"userId":11843}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002094] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46726 - 302 238B in 1.57677ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002095] "GET http://localhost:19090/auth/authorize/?client_id=test-client-hhduqkMB&redirect_uri=https%3A%2F%2Fwww.leaddeliver.com%2Fworld-class%2Finterfaces%2Fexperiences&response_type=code&code_challenge_method=S256&code_challenge=bRXgcyqzbTTeShJMgIvaQFnvkIWTKCVnxYrJDzQFIvH&scope=openid+profile+email&state=XuSXAlqZ&nonce=HbntWmqU&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:46740 - 302 66B in 1.541142ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002096] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46746 - 302 60B in 471.561Âµs
2025/11/25 13:25:55 INFO {"audit_event":"bumped_user_session","details":{"clientId":14501,"userId":11843}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002097] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46756 - 302 56B in 5.138639ms
2025/11/25 13:25:55 INFO {"audit_event":"created_auth_code","details":{"clientId":14501,"codeId":10850,"userId":11843}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002098] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46770 - 302 238B in 1.885863ms
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpEnabled (0.30s)
=== RUN   TestDCR_Disabled_Returns403
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002099] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46776 - 403 91B in 148.681Âµs
--- PASS: TestDCR_Disabled_Returns403 (0.00s)
=== RUN   TestDCR_PublicClient_MCP_UseCase_Success
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14502,"clientIdentifier":"dcr_eba7ebb2-d507-4752-ac1d-c167cc7e124e","grantTypes":["authorization_code","refresh_token"],"isPublic":true,"sourceIP":"[::1]:46784"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002100] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46784 - 201 293B in 3.680755ms
--- PASS: TestDCR_PublicClient_MCP_UseCase_Success (0.01s)
=== RUN   TestDCR_ConfidentialClient_Success
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14503,"clientIdentifier":"dcr_72de3749-7532-48b8-9c91-3e2c6702ef25","grantTypes":["authorization_code","client_credentials","refresh_token"],"isPublic":false,"sourceIP":"[::1]:46798"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002101] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46798 - 201 408B in 3.991993ms
--- PASS: TestDCR_ConfidentialClient_Success (0.01s)
=== RUN   TestDCR_DefaultValues_Applied
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14504,"clientIdentifier":"dcr_284cb955-9d1c-42bf-827c-3d25a1fecb97","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46802"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002102] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46802 - 201 370B in 3.103665ms
--- PASS: TestDCR_DefaultValues_Applied (0.01s)
=== RUN   TestDCR_RedirectURI_Validation
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_localhost_HTTP_allowed
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14505,"clientIdentifier":"dcr_e214e1d6-c685-448b-be37-05a4b8b77a7e","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46810"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002103] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46810 - 201 298B in 3.194756ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_127.0.0.1_HTTP_allowed
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14506,"clientIdentifier":"dcr_70767b4f-1f1e-46b9-9e34-534a1c40b626","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46824"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002104] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46824 - 201 298B in 2.433418ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_IPv6_localhost_allowed
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14507,"clientIdentifier":"dcr_50183cf5-fdfd-4d51-8bb5-cb7426e4ec3d","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46838"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002105] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46838 - 201 294B in 3.046106ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_custom_scheme_allowed
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14508,"clientIdentifier":"dcr_4fa37e21-f49e-4bda-98ee-9db28e7be100","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46842"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002106] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46842 - 201 283B in 3.518328ms
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_HTTPS_rejected_(security)
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002107] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46854 - 400 143B in 148.791Âµs
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_non-localhost_HTTP_rejected
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002108] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46868 - 400 116B in 102.163Âµs
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_HTTPS_allowed
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14509,"clientIdentifier":"dcr_de87e27e-af58-4bec-93a2-792227f8e031","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46884"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002109] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46884 - 201 390B in 2.975522ms
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_localhost_HTTP_allowed
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14510,"clientIdentifier":"dcr_f61bcd9a-a438-4d57-89b9-7c91ad6eae95","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46900"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002110] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46900 - 201 397B in 3.007673ms
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_non-localhost_HTTP_rejected
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002111] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46908 - 400 93B in 145.034Âµs
=== RUN   TestDCR_RedirectURI_Validation/Missing_redirect_uris_for_authorization_code
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002112] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46916 - 400 112B in 121.58Âµs
=== RUN   TestDCR_RedirectURI_Validation/Client_credentials_-_no_redirect_uris_required
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14511,"clientIdentifier":"dcr_bf2fddd3-8911-4105-9ee9-bab640e74e5f","grantTypes":["client_credentials"],"isPublic":false,"sourceIP":"[::1]:46928"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002113] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46928 - 201 348B in 1.901893ms
=== RUN   TestDCR_RedirectURI_Validation/Invalid_URI_format
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002114] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46940 - 400 100B in 153.69Âµs
--- PASS: TestDCR_RedirectURI_Validation (0.03s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_localhost_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_127.0.0.1_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_IPv6_localhost_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_custom_scheme_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_HTTPS_rejected_(security) (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_non-localhost_HTTP_rejected (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_HTTPS_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_localhost_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_non-localhost_HTTP_rejected (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Missing_redirect_uris_for_authorization_code (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Client_credentials_-_no_redirect_uris_required (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Invalid_URI_format (0.00s)
=== RUN   TestDCR_GrantType_Validation
=== RUN   TestDCR_GrantType_Validation/Valid_grant_types
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14512,"clientIdentifier":"dcr_63ab1ff3-fbe5-495e-bf13-00dfe9e10585","grantTypes":["authorization_code","client_credentials","refresh_token"],"isPublic":false,"sourceIP":"[::1]:46952"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002115] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46952 - 201 409B in 3.041738ms
=== RUN   TestDCR_GrantType_Validation/Unsupported_grant_type
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002116] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46962 - 400 91B in 155.644Âµs
=== RUN   TestDCR_GrantType_Validation/Unsupported_implicit_grant
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002117] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46968 - 400 91B in 98.236Âµs
=== RUN   TestDCR_GrantType_Validation/Mixed_valid_and_invalid
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002118] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46984 - 400 91B in 108.054Âµs
--- PASS: TestDCR_GrantType_Validation (0.01s)
    --- PASS: TestDCR_GrantType_Validation/Valid_grant_types (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Unsupported_grant_type (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Unsupported_implicit_grant (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Mixed_valid_and_invalid (0.00s)
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/none_-_public_client
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14513,"clientIdentifier":"dcr_f45ecb38-e3f8-4767-a5c7-bc5591c46149","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46992"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002119] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46992 - 201 280B in 3.986772ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/client_secret_basic
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14514,"clientIdentifier":"dcr_690e3dea-fb20-4a71-94b3-da7d18c13914","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:47000"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002120] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47000 - 201 373B in 3.005639ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/client_secret_post
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14515,"clientIdentifier":"dcr_8ae86822-2b67-45a3-91b7-f4c27aecf17e","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:47014"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002121] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47014 - 201 371B in 3.077234ms
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_method
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002122] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47022 - 400 116B in 119.175Âµs
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_private_key_jwt
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002123] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47032 - 400 114B in 81.133Âµs
--- PASS: TestDCR_TokenEndpointAuthMethod_Validation (0.01s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/none_-_public_client (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/client_secret_basic (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/client_secret_post (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_method (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_private_key_jwt (0.00s)
=== RUN   TestDCR_ClientName_Validation
=== RUN   TestDCR_ClientName_Validation/Normal_name
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14516,"clientIdentifier":"dcr_6d326dc1-6cc3-4e5f-a737-e44f6fb27155","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:47044"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002124] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47044 - 201 274B in 2.948481ms
=== RUN   TestDCR_ClientName_Validation/Empty_name_allowed
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14517,"clientIdentifier":"dcr_c1e1c301-8f06-4656-a65a-37aad79826f9","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:47048"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002125] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47048 - 201 243B in 2.991002ms
=== RUN   TestDCR_ClientName_Validation/Max_length_(128_chars)
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14518,"clientIdentifier":"dcr_3b891fe4-fbd8-4786-a62f-9017124dbeec","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:47050"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002126] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47050 - 201 388B in 2.891173ms
=== RUN   TestDCR_ClientName_Validation/Too_long_(129_chars)
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002127] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47066 - 400 99B in 112.112Âµs
--- PASS: TestDCR_ClientName_Validation (0.01s)
    --- PASS: TestDCR_ClientName_Validation/Normal_name (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Empty_name_allowed (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Max_length_(128_chars) (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Too_long_(129_chars) (0.00s)
=== RUN   TestDCR_WellKnown_Metadata
=== RUN   TestDCR_WellKnown_Metadata/DCR_enabled_-_registration_endpoint_present
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002128] "GET http://localhost:19090/.well-known/openid-configuration HTTP/1.1" from [::1]:47074 - 200 1275B in 210.377Âµs
=== RUN   TestDCR_WellKnown_Metadata/DCR_disabled_-_registration_endpoint_absent
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002129] "GET http://localhost:19090/.well-known/openid-configuration HTTP/1.1" from [::1]:47086 - 200 1209B in 122.271Âµs
--- PASS: TestDCR_WellKnown_Metadata (0.01s)
    --- PASS: TestDCR_WellKnown_Metadata/DCR_enabled_-_registration_endpoint_present (0.00s)
    --- PASS: TestDCR_WellKnown_Metadata/DCR_disabled_-_registration_endpoint_absent (0.00s)
=== RUN   TestDCR_MultipleRedirectURIs
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14519,"clientIdentifier":"dcr_d10fd5a1-6ab0-49d5-9248-dc6eed0ad08b","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:47096"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002130] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47096 - 201 338B in 5.158347ms
--- PASS: TestDCR_MultipleRedirectURIs (0.01s)
=== RUN   TestDCR_ConfidentialClient_DefaultAcrLevel
2025/11/25 13:25:55 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":14520,"clientIdentifier":"dcr_62ef3c87-7fe4-4e4f-aadf-af48e2ef977c","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:47102"}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002131] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:47102 - 201 371B in 2.296009ms
--- PASS: TestDCR_ConfidentialClient_DefaultAcrLevel (0.01s)
=== RUN   TestToken_ClientIdIsMissing
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002132] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47118 - 400 88B in 149.703Âµs
--- PASS: TestToken_ClientIdIsMissing (0.00s)
=== RUN   TestToken_ClientDoesNotExist
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002133] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47126 - 400 73B in 836.3Âµs
--- PASS: TestToken_ClientDoesNotExist (0.00s)
=== RUN   TestToken_InvalidGrantType
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002134] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47128 - 400 81B in 290.349Âµs
--- PASS: TestToken_InvalidGrantType (0.00s)
=== RUN   TestToken_AuthCode_MissingCode
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002135] "GET http://localhost:19090/auth/authorize/?client_id=test-client-UBbHvjDo&redirect_uri=https%3A%2F%2Fwww.forwardharness.info%2Freal-time&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=jXzefmgw&nonce=iYXiSvVr HTTP/1.1" from [::1]:47138 - 302 57B in 1.109677ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002136] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47150 - 302 54B in 376.681Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002137] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47160 - 200 2949B in 508.671Âµs
2025/11/25 13:25:55 INFO {"audit_event":"auth_success_pwd","details":{"userId":11844}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002138] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47160 - 302 0B in 36.622767ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002139] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47160 - 302 57B in 733.606Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002140] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47166 - 302 60B in 493.272Âµs
2025/11/25 13:25:55 INFO {"audit_event":"started_new_user_session","details":{"clientId":14522,"userId":11844}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002141] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47178 - 302 56B in 2.127159ms
2025/11/25 13:25:55 INFO {"audit_event":"created_auth_code","details":{"clientId":14522,"codeId":10851,"userId":11844}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002142] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47188 - 302 217B in 3.192332ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002143] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47192 - 400 83B in 365.46Âµs
--- PASS: TestToken_AuthCode_MissingCode (0.09s)
=== RUN   TestToken_AuthCode_MissingRedirectURI
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002144] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xgXQwYax&redirect_uri=http%3A%2F%2Fwww.dynamicwhiteboard.name%2Fconvergence%2Ffront-end&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=ORLoaUfJ&nonce=tOkraFqD HTTP/1.1" from [::1]:47204 - 302 57B in 944.034Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002145] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47218 - 302 54B in 254.29Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002146] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47222 - 200 2949B in 329.182Âµs
2025/11/25 13:25:55 INFO {"audit_event":"auth_success_pwd","details":{"userId":11845}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002147] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47222 - 302 0B in 36.7514ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002148] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47222 - 302 57B in 1.692949ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002149] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47238 - 302 60B in 743.575Âµs
2025/11/25 13:25:55 INFO {"audit_event":"started_new_user_session","details":{"clientId":14523,"userId":11845}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002150] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47244 - 302 56B in 3.295828ms
2025/11/25 13:25:55 INFO {"audit_event":"created_auth_code","details":{"clientId":14523,"codeId":10852,"userId":11845}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002151] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47254 - 302 231B in 3.320143ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002152] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47266 - 400 91B in 417.589Âµs
--- PASS: TestToken_AuthCode_MissingRedirectURI (0.09s)
=== RUN   TestToken_AuthCode_MissingCodeVerifier
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002153] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LUkfrxHZ&redirect_uri=http%3A%2F%2Fwww.investorend-to-end.com%2Fmethodologies%2Foptimize%2Fbenchmark&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=bFjvfPQV&nonce=EryPwtgI HTTP/1.1" from [::1]:47284 - 302 57B in 1.017192ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002154] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47288 - 302 54B in 349.67Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002155] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47298 - 200 2949B in 420.965Âµs
2025/11/25 13:25:55 INFO {"audit_event":"auth_success_pwd","details":{"userId":11846}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002156] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47298 - 302 0B in 36.053682ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002157] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47298 - 302 57B in 748.354Âµs
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002158] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47304 - 302 60B in 453.036Âµs
2025/11/25 13:25:55 INFO {"audit_event":"started_new_user_session","details":{"clientId":14524,"userId":11846}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002159] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47314 - 302 56B in 2.126388ms
2025/11/25 13:25:55 INFO {"audit_event":"created_auth_code","details":{"clientId":14524,"codeId":10853,"userId":11846}}
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002160] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47316 - 302 242B in 2.895872ms
2025/11/25 13:25:55 [a357f2e3b56e/a04mE72Kgg-002161] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47324 - 400 92B in 542.214Âµs
--- PASS: TestToken_AuthCode_MissingCodeVerifier (0.09s)
=== RUN   TestToken_AuthCode_ClientDoesNotExist
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002162] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MhSziNUQ&redirect_uri=https%3A%2F%2Fwww.internationaldeliver.biz%2Fsyndicate%2Frobust%2Fenhance&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=pUghVBZt&nonce=rLfniGXZ HTTP/1.1" from [::1]:47330 - 302 57B in 751.04Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002163] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47346 - 302 54B in 246.125Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002164] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47350 - 200 2949B in 316.799Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11847}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002165] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47350 - 302 0B in 36.300969ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002166] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47350 - 302 57B in 741.521Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002167] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47364 - 302 60B in 497.48Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14525,"userId":11847}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002168] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47368 - 302 56B in 2.319262ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14525,"codeId":10854,"userId":11847}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002169] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47372 - 302 237B in 3.245232ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002170] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47386 - 400 73B in 1.242988ms
--- PASS: TestToken_AuthCode_ClientDoesNotExist (0.09s)
=== RUN   TestToken_AuthCode_CodeIsInvalid
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002171] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XXuDXjnA&redirect_uri=http%3A%2F%2Fwww.dynamice-commerce.com%2Funleash%2Fe-tailers%2Fmorph&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=rfJUEQux&nonce=XfeqhBmD HTTP/1.1" from [::1]:47398 - 302 57B in 856.939Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002172] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47400 - 302 54B in 230.756Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002173] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47406 - 200 2949B in 310.297Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11848}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002174] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47406 - 302 0B in 35.587161ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002175] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47406 - 302 57B in 460.781Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002176] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47412 - 302 60B in 416.166Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14526,"userId":11848}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002177] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47424 - 302 56B in 2.24412ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14526,"codeId":10855,"userId":11848}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002178] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47430 - 302 232B in 2.878509ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002179] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47440 - 400 65B in 410.426Âµs
--- PASS: TestToken_AuthCode_CodeIsInvalid (0.09s)
=== RUN   TestToken_AuthCode_RedirectURIIsInvalid
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002180] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xOFlNekY&redirect_uri=http%3A%2F%2Fwww.customervirtual.name%2Fcross-media%2Fapplications&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=csigvdwe&nonce=dMHCkkDK HTTP/1.1" from [::1]:47448 - 302 57B in 836.01Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002181] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47456 - 302 54B in 216.63Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002182] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47464 - 200 2949B in 288.024Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11849}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002183] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47464 - 302 0B in 35.628939ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002184] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47464 - 302 57B in 407.851Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002185] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47468 - 302 60B in 471.701Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14527,"userId":11849}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002186] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47474 - 302 56B in 2.096201ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14527,"codeId":10856,"userId":11849}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002187] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47488 - 302 232B in 1.971575ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002188] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47500 - 400 70B in 413.602Âµs
--- PASS: TestToken_AuthCode_RedirectURIIsInvalid (0.08s)
=== RUN   TestToken_AuthCode_WrongClient
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002189] "GET http://localhost:19090/auth/authorize/?client_id=test-client-wCeeolmE&redirect_uri=https%3A%2F%2Fwww.directuser-centric.org%2Fclicks-and-mortar&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=JBoGbFoO&nonce=mvCdtfLt HTTP/1.1" from [::1]:47508 - 302 57B in 700.394Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002190] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47516 - 302 54B in 217.16Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002191] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47522 - 200 2949B in 319.664Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11850}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002192] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47522 - 302 0B in 35.877709ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002193] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47522 - 302 57B in 378.865Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002194] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47532 - 302 60B in 367.935Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14528,"userId":11850}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002195] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47540 - 302 56B in 2.019075ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14528,"codeId":10857,"userId":11850}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002196] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47544 - 302 228B in 3.038432ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002197] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47546 - 400 111B in 642.915Âµs
--- PASS: TestToken_AuthCode_WrongClient (0.09s)
=== RUN   TestToken_AuthCode_ConfidentialClient_NoClientSecret
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002198] "GET http://localhost:19090/auth/authorize/?client_id=test-client-huodJzAu&redirect_uri=http%3A%2F%2Fwww.chiefparadigms.com%2Fvisionary%2Fstreamline&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=QBmFBNtC&nonce=BAVBtwBK HTTP/1.1" from [::1]:47552 - 302 57B in 779.733Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002199] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47566 - 302 54B in 236.197Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002200] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47582 - 200 2949B in 320.796Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11851}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002201] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47582 - 302 0B in 35.409655ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002202] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47582 - 302 57B in 451.503Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002203] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47594 - 302 60B in 351.774Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14530,"userId":11851}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002204] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47600 - 302 56B in 2.018293ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14530,"codeId":10858,"userId":11851}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002205] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47608 - 302 226B in 2.867999ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002206] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47610 - 400 215B in 596.958Âµs
--- PASS: TestToken_AuthCode_ConfidentialClient_NoClientSecret (0.09s)
=== RUN   TestToken_AuthCode_ConfidentialClient_ClientAuthFailed
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002207] "GET http://localhost:19090/auth/authorize/?client_id=test-client-wjgsbJJF&redirect_uri=http%3A%2F%2Fwww.nationalgenerate.org%2Fubiquitous%2Fintuitive&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=SxRnRLRC&nonce=TiODevil HTTP/1.1" from [::1]:47616 - 302 57B in 703.71Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002208] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47620 - 302 54B in 235.966Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002209] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47640 - 200 2949B in 569.897Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11852}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002210] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47640 - 302 0B in 36.63499ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002211] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47640 - 302 57B in 503.612Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002212] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47642 - 302 60B in 681.228Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14531,"userId":11852}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002213] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47654 - 302 56B in 2.133752ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14531,"codeId":10859,"userId":11852}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002214] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47670 - 302 228B in 1.673011ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002215] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47676 - 400 112B in 614.141Âµs
--- PASS: TestToken_AuthCode_ConfidentialClient_ClientAuthFailed (0.09s)
=== RUN   TestToken_AuthCode_InvalidCodeVerifier
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002216] "GET http://localhost:19090/auth/authorize/?client_id=test-client-llFFpgUw&redirect_uri=https%3A%2F%2Fwww.customerwireless.biz%2Fengage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=DyilxBdo&nonce=pxgZweNA HTTP/1.1" from [::1]:47686 - 302 57B in 735.13Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002217] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47692 - 302 54B in 217.05Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002218] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47700 - 200 2949B in 295.288Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11853}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002219] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47700 - 302 0B in 35.362175ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002220] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47700 - 302 57B in 638.707Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002221] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47716 - 302 60B in 591.438Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14532,"userId":11853}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002222] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47722 - 302 56B in 2.229162ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14532,"codeId":10860,"userId":11853}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002223] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47736 - 302 215B in 1.696756ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002224] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47746 - 400 78B in 649.127Âµs
--- PASS: TestToken_AuthCode_InvalidCodeVerifier (0.08s)
=== RUN   TestToken_AuthCode_SuccessPath
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002225] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FIFVOfGA&redirect_uri=http%3A%2F%2Fwww.globalintegrate.org%2Fplug-and-play%2Fsynergies%2Fsexy&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=pZxmSSwO&nonce=lmFCTnSv HTTP/1.1" from [::1]:47748 - 302 57B in 840.939Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002226] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47756 - 302 54B in 227.29Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002227] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47758 - 200 2949B in 311.098Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11854}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002228] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47758 - 302 0B in 35.786988ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002229] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47758 - 302 57B in 471.661Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002230] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47760 - 302 60B in 453.287Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14533,"userId":11854}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002231] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47772 - 302 56B in 2.10693ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14533,"codeId":10861,"userId":11854}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002232] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47786 - 302 235B in 2.986052ms
2025/11/25 13:25:56 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10861}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002233] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47802 - 200 4226B in 19.829406ms
--- PASS: TestToken_AuthCode_SuccessPath (0.11s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_Success
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002234] "GET http://localhost:19090/auth/authorize/?client_id=test-client-Dzrtxkya&redirect_uri=https%3A%2F%2Fwww.regionaldeliverables.biz%2Futilize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=ACZdbYBe&nonce=zQsgleTO HTTP/1.1" from [::1]:47810 - 302 57B in 756.86Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002235] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47826 - 302 54B in 278.516Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002236] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47830 - 200 2949B in 334.111Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11855}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002237] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47830 - 302 0B in 35.23214ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002238] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47830 - 302 57B in 470.499Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002239] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47842 - 302 60B in 380.879Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14534,"userId":11855}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002240] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47850 - 302 56B in 2.254711ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14534,"codeId":10862,"userId":11855}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002241] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47864 - 302 220B in 2.775735ms
2025/11/25 13:25:56 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10862}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47870 - 200 4226B in 15.834689ms
--- PASS: TestToken_AuthCode_ClientSecretBasic_Success (0.10s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_WrongSecret
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002243] "GET http://localhost:19090/auth/authorize/?client_id=test-client-lQOJBXHm&redirect_uri=https%3A%2F%2Fwww.forwardenterprise.biz%2Fcustomized%2Fdistributed%2Fdot-com&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=LMdPMijj&nonce=QHlYvzWn HTTP/1.1" from [::1]:47876 - 302 57B in 653.786Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002244] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47880 - 302 54B in 215.528Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002245] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47896 - 200 2949B in 340.954Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11856}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002246] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47896 - 302 0B in 35.250524ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002247] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47896 - 302 57B in 502.389Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002248] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47908 - 302 60B in 417.779Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14535,"userId":11856}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002249] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47918 - 302 56B in 2.05919ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14535,"codeId":10863,"userId":11856}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002250] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47924 - 302 240B in 2.778059ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002251] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47928 - 400 112B in 599.994Âµs
--- PASS: TestToken_AuthCode_ClientSecretBasic_WrongSecret (0.08s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_BothMethodsProvided
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002252] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FyseSSzQ&redirect_uri=https%3A%2F%2Fwww.regionalunleash.net%2Fb2b%2Fvalue-added&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=cHBhcRPK&nonce=KuefdGMP HTTP/1.1" from [::1]:47930 - 302 57B in 904.589Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002253] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47934 - 302 54B in 222.55Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002254] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47948 - 200 2949B in 320.356Âµs
2025/11/25 13:25:56 INFO {"audit_event":"auth_success_pwd","details":{"userId":11857}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002255] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47948 - 302 0B in 35.68768ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002256] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47948 - 302 57B in 611.947Âµs
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002257] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47954 - 302 60B in 619.491Âµs
2025/11/25 13:25:56 INFO {"audit_event":"started_new_user_session","details":{"clientId":14536,"userId":11857}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002258] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47962 - 302 56B in 2.198915ms
2025/11/25 13:25:56 INFO {"audit_event":"created_auth_code","details":{"clientId":14536,"codeId":10864,"userId":11857}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002259] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47970 - 302 223B in 2.903305ms
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002260] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47980 - 400 211B in 257.596Âµs
--- PASS: TestToken_AuthCode_ClientSecretBasic_BothMethodsProvided (0.09s)
=== RUN   TestToken_ClientCred_ClientSecretBasic_Success
2025/11/25 13:25:56 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14537}}
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002261] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47996 - 200 1213B in 4.756066ms
--- PASS: TestToken_ClientCred_ClientSecretBasic_Success (0.01s)
=== RUN   TestToken_ClientCred_ClientSecretBasic_WrongSecret
2025/11/25 13:25:56 [a357f2e3b56e/a04mE72Kgg-002262] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48006 - 401 79B in 300.458Âµs
--- PASS: TestToken_ClientCred_ClientSecretBasic_WrongSecret (0.00s)
=== RUN   TestToken_Refresh_ClientSecretBasic_Success
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002263] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SyUbaqfa&redirect_uri=https%3A%2F%2Fwww.forwardempower.biz%2Fb2b%2Finteractive&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=XQwAiWOb&nonce=NIVQwXvJ HTTP/1.1" from [::1]:48010 - 302 57B in 950.756Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002264] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48012 - 302 54B in 246.626Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002265] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48020 - 200 2949B in 403.011Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11858}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002266] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48020 - 302 0B in 37.182414ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002267] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48020 - 302 57B in 670.998Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002268] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48036 - 302 60B in 571.871Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14539,"userId":11858}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002269] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48046 - 302 56B in 2.240062ms
2025/11/25 13:25:57 INFO {"audit_event":"created_auth_code","details":{"clientId":14539,"codeId":10865,"userId":11858}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002270] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48052 - 302 222B in 2.84213ms
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10865}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002271] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48064 - 200 4232B in 16.027533ms
2025/11/25 13:25:57 INFO {"audit_event":"bumped_user_session","details":{"clientId":14539,"userId":11858}}
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":10865,"refreshTokenJti":"20de7f04-eec2-4063-800b-5e5553097455"}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002272] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48064 - 200 4232B in 19.732052ms
--- PASS: TestToken_Refresh_ClientSecretBasic_Success (0.12s)
=== RUN   TestToken_Refresh_ClientSecretBasic_WrongSecret
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002273] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FatXRHat&redirect_uri=https%3A%2F%2Fwww.directconvergence.name%2Finnovate%2Fviral%2Fembrace%2Finfrastructures&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=pEpGLnif&nonce=cbqZBPxL HTTP/1.1" from [::1]:48080 - 302 57B in 1.506827ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002274] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48086 - 302 54B in 466.111Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002275] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48088 - 200 2949B in 457.394Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11859}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002276] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48088 - 302 0B in 36.140746ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002277] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48088 - 302 57B in 714.319Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002278] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48094 - 302 60B in 440.723Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14540,"userId":11859}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002279] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48100 - 302 56B in 2.085701ms
2025/11/25 13:25:57 INFO {"audit_event":"created_auth_code","details":{"clientId":14540,"codeId":10866,"userId":11859}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002280] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48106 - 302 249B in 2.907924ms
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10866}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002281] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48112 - 200 4240B in 16.045237ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002282] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48112 - 400 112B in 360.512Âµs
--- PASS: TestToken_Refresh_ClientSecretBasic_WrongSecret (0.10s)
=== RUN   TestToken_ClientCred_FlowIsNotEnabled
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002283] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48114 - 400 146B in 244.171Âµs
--- PASS: TestToken_ClientCred_FlowIsNotEnabled (0.00s)
=== RUN   TestToken_ClientCred_ClientSecretIsMissing
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002284] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48126 - 400 215B in 199.778Âµs
--- PASS: TestToken_ClientCred_ClientSecretIsMissing (0.00s)
=== RUN   TestToken_ClientCred_ClientAuthFailed
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002285] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48128 - 401 79B in 192.814Âµs
--- PASS: TestToken_ClientCred_ClientAuthFailed (0.00s)
=== RUN   TestToken_ClientCred_InvalidScope
=== RUN   TestToken_ClientCred_InvalidScope/openid
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002286] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48142 - 400 269B in 456.061Âµs
=== RUN   TestToken_ClientCred_InvalidScope/groups
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002287] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48150 - 400 269B in 354.66Âµs
=== RUN   TestToken_ClientCred_InvalidScope/aaa
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002288] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48158 - 400 199B in 281.472Âµs
=== RUN   TestToken_ClientCred_InvalidScope/invalid:perm
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002289] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48160 - 400 132B in 810.421Âµs
=== RUN   TestToken_ClientCred_InvalidScope/backend-svcA-wFyEawZa:perm
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002290] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48174 - 400 190B in 465.82Âµs
=== RUN   TestToken_ClientCred_InvalidScope/backend-svcA-wFyEawZa:read-product-EQPtPqEu
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002291] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48190 - 400 151B in 373.626Âµs
--- PASS: TestToken_ClientCred_InvalidScope (0.01s)
    --- PASS: TestToken_ClientCred_InvalidScope/openid (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/groups (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/aaa (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/invalid:perm (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/backend-svcA-wFyEawZa:perm (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/backend-svcA-wFyEawZa:read-product-EQPtPqEu (0.00s)
=== RUN   TestToken_ClientCred_NoScopesGiven
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14545}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002292] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48198 - 200 1359B in 4.65243ms
--- PASS: TestToken_ClientCred_NoScopesGiven (0.01s)
=== RUN   TestToken_ClientCred_SpecificScope
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":14546}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002293] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48210 - 200 1228B in 4.706142ms
--- PASS: TestToken_ClientCred_SpecificScope (0.01s)
=== RUN   TestToken_Refresh_ClientSecretIsMissing
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002294] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48216 - 400 215B in 252.156Âµs
--- PASS: TestToken_Refresh_ClientSecretIsMissing (0.00s)
=== RUN   TestToken_Refresh_ClientAuthFailed
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002295] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XNaXmKti&redirect_uri=http%3A%2F%2Fwww.corporatescale.io%2Fproactive%2Fexpedite&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=nxeNUygZ&nonce=EWWZidrZ HTTP/1.1" from [::1]:48234 - 302 57B in 621.364Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002296] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48238 - 302 54B in 241.747Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002297] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48250 - 200 2949B in 317.089Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11860}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002298] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48250 - 302 0B in 35.361544ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002299] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48250 - 302 57B in 481.119Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002300] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48262 - 302 60B in 410.686Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14548,"userId":11860}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002301] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48274 - 302 56B in 1.969521ms
2025/11/25 13:25:57 INFO {"audit_event":"created_auth_code","details":{"clientId":14548,"codeId":10867,"userId":11860}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002302] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48280 - 302 223B in 1.57705ms
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10867}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002303] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48296 - 200 4234B in 15.867401ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002304] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48296 - 400 112B in 348.378Âµs
--- PASS: TestToken_Refresh_ClientAuthFailed (0.10s)
=== RUN   TestToken_Refresh_MissingRefreshToken
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002305] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nyhoyjeE&redirect_uri=http%3A%2F%2Fwww.nationaliterate.biz%2Ffacilitate%2Fmonetize%2Fe-business%2Fgranular&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=rMLFMGDE&nonce=RPccmoyJ HTTP/1.1" from [::1]:48302 - 302 57B in 797.968Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002306] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48316 - 302 54B in 256.034Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002307] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48320 - 200 2949B in 311.639Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11861}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002308] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48320 - 302 0B in 35.733106ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002309] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48320 - 302 57B in 424.241Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002310] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48322 - 302 60B in 491.719Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14549,"userId":11861}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002311] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48336 - 302 56B in 2.015678ms
2025/11/25 13:25:57 INFO {"audit_event":"created_auth_code","details":{"clientId":14549,"codeId":10868,"userId":11861}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002312] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48340 - 302 246B in 3.16468ms
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10868}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002313] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48354 - 200 4222B in 15.592982ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002314] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48354 - 400 92B in 360.692Âµs
--- PASS: TestToken_Refresh_MissingRefreshToken (0.10s)
=== RUN   TestToken_Refresh_TokenWithBadSignature
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002315] "GET http://localhost:19090/auth/authorize/?client_id=test-client-wIOrIvuR&redirect_uri=https%3A%2F%2Fwww.futurewhiteboard.info%2Fengage%2Fe-enable&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=PaawuzIk&nonce=IDwVzJNa HTTP/1.1" from [::1]:48370 - 302 57B in 782.879Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002316] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48380 - 302 54B in 294.647Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002317] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48396 - 200 2949B in 359.719Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11862}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002318] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48396 - 302 0B in 36.288305ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002319] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48396 - 302 57B in 626.624Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002320] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48410 - 302 60B in 663.985Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14550,"userId":11862}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002321] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48420 - 302 56B in 2.129253ms
2025/11/25 13:25:57 INFO {"audit_event":"created_auth_code","details":{"clientId":14550,"codeId":10869,"userId":11862}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002322] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48434 - 302 225B in 4.226596ms
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10869}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002323] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48450 - 200 4242B in 15.806025ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002324] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48450 - 400 139B in 1.00031ms
--- PASS: TestToken_Refresh_TokenWithBadSignature (0.11s)
=== RUN   TestToken_Refresh_TokenExpired
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002325] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:48466 - 400 123B in 498.472Âµs
--- PASS: TestToken_Refresh_TokenExpired (0.01s)
=== RUN   TestToken_Refresh_WrongClient
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002326] "GET http://localhost:19090/auth/authorize/?client_id=test-client-utQBuBcz&redirect_uri=http%3A%2F%2Fwww.dynamicmodels.biz%2Fmodels%2Fvisualize%2Frobust%2Fsyndicate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=poRSleWB&nonce=UyoEZhHn HTTP/1.1" from [::1]:48482 - 302 57B in 1.070793ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002327] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48484 - 302 54B in 341.495Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002328] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48486 - 200 2949B in 452.054Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11863}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002329] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48486 - 302 0B in 36.681458ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002330] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48486 - 302 57B in 1.099146ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002331] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48498 - 302 60B in 817.635Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14552,"userId":11863}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002332] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48512 - 302 56B in 2.866415ms
2025/11/25 13:25:57 INFO {"audit_event":"created_auth_code","details":{"clientId":14552,"codeId":10870,"userId":11863}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002333] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48520 - 302 238B in 1.929606ms
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10870}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002334] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48534 - 200 4230B in 19.818967ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002335] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48534 - 400 121B in 1.097633ms
--- PASS: TestToken_Refresh_WrongClient (0.11s)
=== RUN   TestToken_Refresh_WithAdditionalScope
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002336] "GET http://localhost:19090/auth/authorize/?client_id=test-client-hjODiGoY&redirect_uri=https%3A%2F%2Fwww.internationalexperiences.biz%2Fsticky&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=EUCIzoFt&nonce=ClhrxlcO HTTP/1.1" from [::1]:48546 - 302 57B in 943.132Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002337] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48550 - 302 54B in 234.212Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002338] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48564 - 200 2949B in 312.681Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11864}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002339] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48564 - 302 0B in 35.6399ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002340] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48564 - 302 57B in 399.695Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002341] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48572 - 302 60B in 406.778Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14554,"userId":11864}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002342] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48580 - 302 56B in 3.575035ms
2025/11/25 13:25:57 INFO {"audit_event":"created_auth_code","details":{"clientId":14554,"codeId":10871,"userId":11864}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002343] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48582 - 302 223B in 1.70952ms
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10871}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002344] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48596 - 200 4234B in 14.046019ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002345] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48596 - 400 220B in 1.168568ms
2025/11/25 13:25:57 INFO {"audit_event":"bumped_user_session","details":{"clientId":14554,"userId":11864}}
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":10871,"refreshTokenJti":"aeceee83-47b7-462b-a237-a9c5eb078201"}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002346] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48596 - 200 4234B in 16.192385ms
--- PASS: TestToken_Refresh_WithAdditionalScope (0.12s)
=== RUN   TestToken_Refresh_ConsentRemoved
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002347] "GET http://localhost:19090/auth/authorize/?client_id=test-client-savOvSbE&redirect_uri=http%3A%2F%2Fwww.nationaldrive.io%2Fe-business&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+res-NrlQaiNc%3Aperm-ZkROGcTi&state=UEznDCNy&nonce=xjzKOhUS HTTP/1.1" from [::1]:48604 - 302 57B in 998.527Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002348] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48616 - 302 54B in 221.428Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002349] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48622 - 200 2949B in 354.509Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11865}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002350] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48622 - 302 0B in 35.644349ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002351] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48622 - 302 60B in 429.401Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14555,"userId":11865}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002352] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48638 - 302 58B in 2.377963ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002353] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:48640 - 200 4267B in 605.615Âµs
2025/11/25 13:25:57 INFO {"audit_event":"saved_consent","details":{"clientId":14555,"consentId":10150,"userId":11865}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002354] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:48640 - 302 0B in 2.531133ms
2025/11/25 13:25:57 INFO {"audit_event":"created_auth_code","details":{"clientId":14555,"codeId":10872,"userId":11865}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002355] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48640 - 302 214B in 3.598118ms
2025/11/25 13:25:57 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10872}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002356] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:48648 - 200 4335B in 16.884582ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002357] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:48648 - 400 153B in 1.23844ms
--- PASS: TestToken_Refresh_ConsentRemoved (0.11s)
=== RUN   TestToken_Refresh_ConsentDoesNotIncludeScope
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002358] "GET http://localhost:19090/auth/authorize/?client_id=test-client-VdOPMaiP&redirect_uri=http%3A%2F%2Fwww.customerunleash.org%2Fe-tailers%2Fincubate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=XyXpWBnC&nonce=bjpwJjBG HTTP/1.1" from [::1]:48664 - 302 57B in 714.239Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002359] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48678 - 302 54B in 234.804Âµs
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002360] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48682 - 200 2949B in 506.066Âµs
2025/11/25 13:25:57 INFO {"audit_event":"auth_success_pwd","details":{"userId":11866}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002361] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48682 - 302 0B in 35.795163ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002362] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48682 - 302 60B in 359.769Âµs
2025/11/25 13:25:57 INFO {"audit_event":"started_new_user_session","details":{"clientId":14556,"userId":11866}}
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002363] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48686 - 302 58B in 2.07478ms
2025/11/25 13:25:57 [a357f2e3b56e/a04mE72Kgg-002364] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:48702 - 200 3835B in 583.673Âµs
2025/11/25 13:25:58 INFO {"audit_event":"saved_consent","details":{"clientId":14556,"consentId":10151,"userId":11866}}
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002365] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:48702 - 302 0B in 1.621764ms
2025/11/25 13:25:58 INFO {"audit_event":"created_auth_code","details":{"clientId":14556,"codeId":10873,"userId":11866}}
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002366] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48702 - 302 225B in 2.886344ms
2025/11/25 13:25:58 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10873}}
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002367] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:48704 - 200 4202B in 18.302361ms
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002368] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:48704 - 400 188B in 1.05321ms
--- PASS: TestToken_Refresh_ConsentDoesNotIncludeScope (0.11s)
=== RUN   TestToken_Refresh_TokenMarkedAsUsed
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002369] "GET http://localhost:19090/auth/authorize/?client_id=test-client-lnLMQNvb&redirect_uri=http%3A%2F%2Fwww.districtcultivate.name%2Fmagnetic%2Fincubate%2Freinvent&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=CZKajJVX&nonce=AZRLtSrr HTTP/1.1" from [::1]:48718 - 302 57B in 759.646Âµs
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002370] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48730 - 302 54B in 206.36Âµs
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002371] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48746 - 200 2949B in 308.573Âµs
2025/11/25 13:25:58 INFO {"audit_event":"auth_success_pwd","details":{"userId":11867}}
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002372] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48746 - 302 0B in 35.39153ms
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002373] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48746 - 302 57B in 515.775Âµs
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002374] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48762 - 302 60B in 519.151Âµs
2025/11/25 13:25:58 INFO {"audit_event":"started_new_user_session","details":{"clientId":14557,"userId":11867}}
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002375] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48778 - 302 56B in 3.127559ms
2025/11/25 13:25:58 INFO {"audit_event":"created_auth_code","details":{"clientId":14557,"codeId":10874,"userId":11867}}
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002376] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48794 - 302 236B in 3.029454ms
2025/11/25 13:25:58 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10874}}
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002377] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48800 - 200 4218B in 16.716926ms
2025/11/25 13:25:58 INFO {"audit_event":"bumped_user_session","details":{"clientId":14557,"userId":11867}}
2025/11/25 13:25:58 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":10874,"refreshTokenJti":"f864be5d-44b7-4460-9e2d-fc49f287d8be"}}
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002378] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48800 - 200 4218B in 16.458778ms
2025/11/25 13:25:58 [a357f2e3b56e/a04mE72Kgg-002379] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48800 - 400 85B in 1.025428ms
--- PASS: TestToken_Refresh_TokenMarkedAsUsed (0.12s)
PASS
ok  	github.com/leodip/goiabada/authserver/tests/integration	31.660s
Tests finished. Killing the server...
Checking for processes on port 19090...
Found processes listening on port 19090: 133081
Killing process 133081 on port 19090
Checking for processes on port 19091...
No processes found on port 19091
./run-tests.sh: line 78: 133081 Killed                  ./tmp/goiabada-authserver
Port 19090 is now free
Port 19091 is now free
=== Completed integration tests with mssql ===

=== Running integration tests with sqlite ===
Configuring for database: sqlite
Started server with PID: 133396
Waiting for the server to start...
BROWSER=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/bin/helpers/browser.sh
COLORTERM=truecolor
DEBIAN_FRONTEND=noninteractive
DISPLAY=:0
DOCKER_BUILDKIT=1
GIT_ASKPASS=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/extensions/git/dist/askpass.sh
GOIABADA_ADMINCONSOLE_BASEURL=http://localhost:19091
GOIABADA_ADMINCONSOLE_CERTFILE=
GOIABADA_ADMINCONSOLE_KEYFILE=
GOIABADA_ADMINCONSOLE_LISTEN_HOST_HTTP=0.0.0.0
GOIABADA_ADMINCONSOLE_LISTEN_HOST_HTTPS=0.0.0.0
GOIABADA_ADMINCONSOLE_LISTEN_PORT_HTTP=19091
GOIABADA_ADMINCONSOLE_LISTEN_PORT_HTTPS=19444
GOIABADA_ADMINCONSOLE_LOG_HTTP_REQUESTS=true
GOIABADA_ADMINCONSOLE_OAUTH_CLIENT_ID=admin-console-client
GOIABADA_ADMINCONSOLE_OAUTH_CLIENT_SECRET=devcontainer-admin-console-secret-0123456789abcdef
GOIABADA_ADMINCONSOLE_SESSION_AUTHENTICATION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210
GOIABADA_ADMINCONSOLE_SESSION_ENCRYPTION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210
GOIABADA_ADMINCONSOLE_STATICDIR=
GOIABADA_ADMINCONSOLE_TEMPLATEDIR=
GOIABADA_ADMINCONSOLE_TRUST_PROXY_HEADERS=false
GOIABADA_ADMIN_EMAIL=admin@example.com
GOIABADA_ADMIN_PASSWORD=changeme
GOIABADA_APPNAME=Goiabada
GOIABADA_AUTHSERVER_AUDIT_LOGS_IN_CONSOLE=true
GOIABADA_AUTHSERVER_BASEURL=http://localhost:19090
GOIABADA_AUTHSERVER_CERTFILE=
GOIABADA_AUTHSERVER_DEBUG_API_REQUESTS=false
GOIABADA_AUTHSERVER_INTERNALBASEURL=
GOIABADA_AUTHSERVER_KEYFILE=
GOIABADA_AUTHSERVER_LISTEN_HOST_HTTP=0.0.0.0
GOIABADA_AUTHSERVER_LISTEN_HOST_HTTPS=0.0.0.0
GOIABADA_AUTHSERVER_LISTEN_PORT_HTTP=19090
GOIABADA_AUTHSERVER_LISTEN_PORT_HTTPS=19443
GOIABADA_AUTHSERVER_LOG_HTTP_REQUESTS=true
GOIABADA_AUTHSERVER_LOG_SQL=false
GOIABADA_AUTHSERVER_RATELIMITER_ENABLED=false
GOIABADA_AUTHSERVER_SESSION_AUTHENTICATION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
GOIABADA_AUTHSERVER_SESSION_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
GOIABADA_AUTHSERVER_STATICDIR=
GOIABADA_AUTHSERVER_TEMPLATEDIR=
GOIABADA_AUTHSERVER_TRUST_PROXY_HEADERS=false
GOIABADA_DB_DSN=/tmp/goiabada_integration.db
GOIABADA_DB_HOST=
GOIABADA_DB_NAME=
GOIABADA_DB_PASSWORD=
GOIABADA_DB_PORT=
GOIABADA_DB_TYPE=sqlite
GOIABADA_DB_USERNAME=
HOME=/root
HOSTNAME=a357f2e3b56e
LANG=en_US.UTF-8
LESSCLOSE=/usr/bin/lesspipe %s %s
LESSOPEN=| /usr/bin/lesspipe %s
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=00:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.avif=01;35:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:*~=00;90:*#=00;90:*.bak=00;90:*.crdownload=00;90:*.dpkg-dist=00;90:*.dpkg-new=00;90:*.dpkg-old=00;90:*.dpkg-tmp=00;90:*.old=00;90:*.orig=00;90:*.part=00;90:*.rej=00;90:*.rpmnew=00;90:*.rpmorig=00;90:*.rpmsave=00;90:*.swp=00;90:*.tmp=00;90:*.ucf-dist=00;90:*.ucf-new=00;90:*.ucf-old=00;90:
OLDPWD=/workspaces/goiabada/src
PATH=/opt/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/go/bin:/root/go/bin
PWD=/workspaces/goiabada/src/authserver
REMOTE_CONTAINERS=true
REMOTE_CONTAINERS_DISPLAY_SOCK=/tmp/.X11-unix/X0
REMOTE_CONTAINERS_IPC=/tmp/vscode-remote-containers-ipc-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock
REMOTE_CONTAINERS_SOCKETS=["/tmp/vscode-ssh-auth-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock","/tmp/.X11-unix/X0","/root/.gnupg/S.gpg-agent"]
SHELL=/bin/bash
SHLVL=3
SSH_AUTH_SOCK=/tmp/vscode-ssh-auth-c3be9a64-5964-4b2b-81c4-c75677f94e92.sock
TERM=xterm-256color
TERM_PROGRAM=vscode
TERM_PROGRAM_VERSION=1.106.2
TZ=Europe/Lisbon
VSCODE_GIT_ASKPASS_EXTRA_ARGS=
VSCODE_GIT_ASKPASS_MAIN=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/extensions/git/dist/askpass-main.js
VSCODE_GIT_ASKPASS_NODE=/vscode/vscode-server/bin/linux-x64/1e3c50d64110be466c0b4a45222e81d2c9352888/node
VSCODE_GIT_IPC_HANDLE=/tmp/user/0/vscode-git-27ddbaf538.sock
VSCODE_IPC_HOOK_CLI=/tmp/vscode-ipc-8cdca7a1-b8b6-4c1d-9f11-9fd95bbdc4c8.sock
VSCODE_PYTHON_AUTOACTIVATE_GUARD=1
WAYLAND_DISPLAY=vscode-wayland-7cc23a66-0244-472f-8cfe-838db66f3a44.sock
XDG_RUNTIME_DIR=/tmp/user/0
_=/usr/bin/env
2025/11/25 13:26:00 INFO auth server started
2025/11/25 13:26:00 INFO goiabada version: development
2025/11/25 13:26:00 INFO build date: development
2025/11/25 13:26:00 INFO git commit: development
2025/11/25 13:26:00 INFO config loaded
2025/11/25 13:26:00 INFO auth server base URL: http://localhost:19090
2025/11/25 13:26:00 INFO auth server internal base URL: 
2025/11/25 13:26:00 INFO admin console base URL: http://localhost:19091
2025/11/25 13:26:00 INFO debug API requests: false
2025/11/25 13:26:00 INFO current working directory: /workspaces/goiabada/src/authserver
2025/11/25 13:26:00 INFO timezones loaded
2025/11/25 13:26:00 INFO current time zone is: Europe/Lisbon
2025/11/25 13:26:00 INFO current local time is: 2025-11-25 13:26:00.186170086 +0000 WET m=+0.002615402
2025/11/25 13:26:00 INFO current UTC time is: 2025-11-25 13:26:00.186176168 +0000 UTC
2025/11/25 13:26:00 INFO db type is sqlite
2025/11/25 13:26:00 INFO creating sqlite database
2025/11/25 13:26:00 INFO using database sqlite
2025/11/25 13:26:00 INFO db dsn: /tmp/goiabada_integration.db
2025/11/25 13:26:00 INFO connected to sqlite database with required PRAGMA settings
Server is not ready yet. Retrying...
2025/11/25 13:26:00 INFO created database connection
2025/11/25 13:26:00 INFO database is empty, performing initial bootstrap
2025/11/25 13:26:00 INFO OAuth client secret provided - using single-step setup mode
2025/11/25 13:26:00 INFO using pre-generated OAuth client secret from environment
2025/11/25 13:26:00 INFO client 'admin-console-client' created
2025/11/25 13:26:00 INFO redirect URI 'http://localhost:19091/auth/callback' created
2025/11/25 13:26:00 INFO redirect URI 'http://localhost:19091' created
2025/11/25 13:26:00 INFO user 'admin@example.com' created
2025/11/25 13:26:00 INFO resource 'authserver' created
2025/11/25 13:26:00 INFO permission 'userinfo' created
2025/11/25 13:26:00 INFO permission 'manage-account' created
2025/11/25 13:26:00 INFO permission 'manage' created
2025/11/25 13:26:00 INFO user 'admin@example.com' granted permission 'manage-account'
2025/11/25 13:26:00 INFO user 'admin@example.com' granted permission 'manage'
2025/11/25 13:26:00 INFO key pair 'cfaa68f1-3886-489f-9d3d-e16dd6c4da8b' (current) created
2025/11/25 13:26:00 INFO key pair 'e25b42f5-7cbb-4410-a838-3ac2aafda5f8' (next) created
2025/11/25 13:26:00 INFO settings created
2025/11/25 13:26:00 INFO database seeded
2025/11/25 13:26:00 INFO ================================================================================
2025/11/25 13:26:00 INFO DATABASE SEEDED SUCCESSFULLY
2025/11/25 13:26:00 INFO ================================================================================
2025/11/25 13:26:00 INFO Continuing with normal startup...
2025/11/25 13:26:00 INFO session keys validated
2025/11/25 13:26:00 INFO set cookie secure: false
2025/11/25 13:26:00 INFO initialized chunked cookie session store
2025/11/25 13:26:00 INFO using embedded static files directory
2025/11/25 13:26:00 INFO using embedded template files directory
2025/11/25 13:26:00 INFO background worker service started
2025/11/25 13:26:00 INFO initializing middleware
2025/11/25 13:26:00 INFO not adding real ip middleware
2025/11/25 13:26:00 INFO http request logging enabled
2025/11/25 13:26:00 INFO CSRF middleware configured trustedOrigins="[localhost:19090 localhost:19091]" secure=false
2025/11/25 13:26:00 INFO finished initializing middleware
2025/11/25 13:26:00 INFO listen host https: 0.0.0.0
2025/11/25 13:26:00 INFO listen port https: 19443
2025/11/25 13:26:00 INFO cert file: 
2025/11/25 13:26:00 INFO key file: 
2025/11/25 13:26:00 INFO https enabled: false
2025/11/25 13:26:00 INFO listen host http: 0.0.0.0
2025/11/25 13:26:00 INFO listen port http: 19090
2025/11/25 13:26:00 INFO http enabled: true
2025/11/25 13:26:00 WARN === WARNING ===
2025/11/25 13:26:00 WARN You are running the auth server with HTTP (without TLS/HTTPS).
2025/11/25 13:26:00 WARN This is HIGHLY INSECURE unless you are:
2025/11/25 13:26:00 WARN   1. Only doing development/testing, OR
2025/11/25 13:26:00 WARN   2. Running behind a reverse proxy that handles HTTPS
2025/11/25 13:26:00 WARN 
2025/11/25 13:26:00 WARN In production environments, you should either:
2025/11/25 13:26:00 WARN   - Enable HTTPS configuration, OR
2025/11/25 13:26:00 WARN   - Ensure your reverse proxy handles HTTPS properly
2025/11/25 13:26:00 WARN ===============
2025/11/25 13:26:00 INFO starting HTTP server on 0.0.0.0:19090
Server is up and running
Running integration tests...
2025/11/25 13:26:01 INFO running TestMain
2025/11/25 13:26:01 INFO config.DBDSN=/tmp/goiabada_integration.db
2025/11/25 13:26:01 INFO db type is sqlite
2025/11/25 13:26:01 INFO creating sqlite database
2025/11/25 13:26:01 INFO using database sqlite
2025/11/25 13:26:01 INFO db dsn: /tmp/goiabada_integration.db
2025/11/25 13:26:01 INFO connected to sqlite database with required PRAGMA settings
2025/11/25 13:26:01 INFO no need to migrate the database
=== RUN   TestAPIAccountAddressPut_Success
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000002] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-bftFroPz&redirect_uri=https%3A%2F%2Fwww.nationalnext-generation.org%2Fsynergies&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=RAsNplNK&nonce=eUUnzCAA HTTP/1.1" from [::1]:48826 - 302 57B in 668.774Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000003] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48838 - 302 54B in 207.512Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000004] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48840 - 200 2955B in 291.221Âµs
2025/11/25 13:26:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":2}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000005] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48840 - 302 0B in 35.42799ms
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000006] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48840 - 302 57B in 307.801Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000007] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48842 - 302 60B in 363.797Âµs
2025/11/25 13:26:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":2,"userId":2}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000008] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48858 - 302 56B in 1.618778ms
2025/11/25 13:26:01 INFO {"audit_event":"created_auth_code","details":{"clientId":2,"codeId":1,"userId":2}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000009] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48862 - 302 225B in 791.095Âµs
2025/11/25 13:26:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":1}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000010] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48874 - 200 4201B in 13.639562ms
2025/11/25 13:26:01 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"a006334b-feee-47d3-b5fd-f2f3b461f14e","userId":2}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000011] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:48880 - 200 734B in 1.972537ms
--- PASS: TestAPIAccountAddressPut_Success (0.10s)
=== RUN   TestAPIAccountAddressPut_PartialAddress
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000012] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-fdxnirIO&redirect_uri=http%3A%2F%2Fwww.districtend-to-end.biz%2Fb2b&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=hgtwhKys&nonce=RCnnWrGm HTTP/1.1" from [::1]:48886 - 302 57B in 729.829Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000013] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48898 - 302 54B in 232.819Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000014] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48904 - 200 2955B in 326.878Âµs
2025/11/25 13:26:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":3}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000015] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48904 - 302 0B in 35.368557ms
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000016] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48904 - 302 57B in 933.254Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000017] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48910 - 302 60B in 365.821Âµs
2025/11/25 13:26:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":3,"userId":3}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000018] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:48922 - 302 56B in 719.56Âµs
2025/11/25 13:26:01 INFO {"audit_event":"created_auth_code","details":{"clientId":3,"codeId":2,"userId":3}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000019] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:48936 - 302 213B in 687.399Âµs
2025/11/25 13:26:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":2}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000020] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48946 - 200 4202B in 11.655653ms
2025/11/25 13:26:01 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"7200450a-663c-4bba-b5da-23d82fb347b0","userId":3}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000021] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:48960 - 200 716B in 557.022Âµs
--- PASS: TestAPIAccountAddressPut_PartialAddress (0.09s)
=== RUN   TestAPIAccountAddressPut_ClearAllFields
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000022] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-CYaqvwVB&redirect_uri=http%3A%2F%2Fwww.humanredefine.com%2Fstrategic%2Fbricks-and-clicks%2Finnovative%2Fincentivize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=RWcAhpLy&nonce=JZmtntsz HTTP/1.1" from [::1]:48962 - 302 57B in 589.895Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000023] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:48970 - 302 54B in 268.327Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000024] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48980 - 200 2955B in 446.935Âµs
2025/11/25 13:26:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":4}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000025] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:48980 - 302 0B in 36.427298ms
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000026] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:48980 - 302 57B in 499.194Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000027] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:48992 - 302 60B in 388.364Âµs
2025/11/25 13:26:01 INFO {"audit_event":"started_new_user_session","details":{"clientId":4,"userId":4}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000028] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49000 - 302 56B in 1.047359ms
2025/11/25 13:26:01 INFO {"audit_event":"created_auth_code","details":{"clientId":4,"codeId":3,"userId":4}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000029] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49012 - 302 255B in 350.742Âµs
2025/11/25 13:26:01 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":3}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000030] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49024 - 200 4202B in 12.103048ms
2025/11/25 13:26:01 INFO {"audit_event":"updated_own_address","details":{"loggedInUser":"038b464b-0304-472f-9ee5-a5cdcd9235ac","userId":4}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000031] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49030 - 200 697B in 592.229Âµs
--- PASS: TestAPIAccountAddressPut_ClearAllFields (0.09s)
=== RUN   TestAPIAccountAddressPut_ValidationErrors
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000032] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-PdBxUzxR&redirect_uri=http%3A%2F%2Fwww.internationalnetworks.io%2Fmission-critical%2Finitiatives&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=paYwWMWR&nonce=HufYIKeZ HTTP/1.1" from [::1]:49040 - 302 57B in 662.712Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000033] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49050 - 302 54B in 332.118Âµs
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000034] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49054 - 200 2955B in 352.035Âµs
2025/11/25 13:26:01 INFO {"audit_event":"auth_success_pwd","details":{"userId":5}}
2025/11/25 13:26:01 [a357f2e3b56e/FBsnpuLk6O-000035] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49054 - 302 0B in 37.344931ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000036] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49054 - 302 57B in 473.505Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000037] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49068 - 302 60B in 336.125Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":5,"userId":5}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000038] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49084 - 302 56B in 633.467Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":5,"codeId":4,"userId":5}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000039] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49096 - 302 240B in 801.114Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":4}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000040] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49102 - 200 4208B in 12.322002ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000041] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49116 - 400 116B in 388.474Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000042] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49118 - 400 116B in 325.084Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000043] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49134 - 400 110B in 1.068549ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000044] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49146 - 400 108B in 515.214Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000045] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49156 - 400 113B in 371.753Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000046] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49162 - 400 67B in 603.471Âµs
--- PASS: TestAPIAccountAddressPut_ValidationErrors (0.10s)
=== RUN   TestAPIAccountAddressPut_UnauthorizedAndScope
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000047] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49174 - 401 22B in 111.811Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000048] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49188 - 401 22B in 161.566Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":6}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000049] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49204 - 200 1177B in 3.917121ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000050] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49210 - 403 19B in 276.032Âµs
--- PASS: TestAPIAccountAddressPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountAddressPut_InvalidRequestBody
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000051] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-KhGbBJLm&redirect_uri=http%3A%2F%2Fwww.leadincubate.biz%2Fmesh%2Fengage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=pITjHVFf&nonce=PbIYIvVR HTTP/1.1" from [::1]:49220 - 302 57B in 663.554Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000052] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49228 - 302 54B in 183.867Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000053] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49240 - 200 2955B in 294.918Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":6}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000054] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49240 - 302 0B in 35.534872ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000055] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49240 - 302 57B in 346.525Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000056] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49254 - 302 60B in 365.581Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":7,"userId":6}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000057] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49270 - 302 56B in 687.469Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":7,"codeId":5,"userId":6}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000058] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49284 - 302 215B in 751.52Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":5}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000059] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49296 - 200 4209B in 12.127504ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000060] "PUT http://localhost:19090/api/v1/account/address HTTP/1.1" from [::1]:49300 - 400 75B in 644.157Âµs
--- PASS: TestAPIAccountAddressPut_InvalidRequestBody (0.09s)
=== RUN   TestAPIAccountConsentsGet_Success
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000061] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-QzqpNiGm&redirect_uri=http%3A%2F%2Fwww.investorbenchmark.org%2Fsyndicate%2Fextend%2Fsynergistic&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=pVFMygdo&nonce=egipaqRe HTTP/1.1" from [::1]:49302 - 302 57B in 642.273Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000062] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49318 - 302 54B in 208.434Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000063] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49326 - 200 2955B in 441.334Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":7}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000064] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49326 - 302 0B in 35.286683ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000065] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49326 - 302 57B in 428.319Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000066] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49330 - 302 60B in 860.165Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":8,"userId":7}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000067] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49334 - 302 56B in 656.25Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":8,"codeId":6,"userId":7}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000068] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49350 - 302 237B in 392.451Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":6}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000069] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49352 - 200 4198B in 11.245718ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000070] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:49358 - 200 316B in 517.478Âµs
--- PASS: TestAPIAccountConsentsGet_Success (0.09s)
=== RUN   TestAPIAccountConsentsGet_UnauthorizedAndScope
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000071] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:49362 - 401 22B in 90.662Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000072] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:49366 - 401 22B in 220.597Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":10}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000073] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49374 - 200 1177B in 4.422977ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000074] "GET http://localhost:19090/api/v1/account/consents HTTP/1.1" from [::1]:49386 - 403 19B in 511.847Âµs
--- PASS: TestAPIAccountConsentsGet_UnauthorizedAndScope (0.02s)
=== RUN   TestAPIAccountConsentDelete_Success
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000075] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-yinHtdch&redirect_uri=http%3A%2F%2Fwww.internationalvalue-added.com%2Fmarkets%2Fdisintermediate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=fkoXFjLF&nonce=HKuKCSrf HTTP/1.1" from [::1]:49400 - 302 57B in 414.534Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000076] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49406 - 302 54B in 194.748Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000077] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49418 - 200 2955B in 295.909Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":8}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000078] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49418 - 302 0B in 35.388946ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000079] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49418 - 302 57B in 282.012Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000080] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49424 - 302 60B in 298.274Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":11,"userId":8}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000081] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49438 - 302 56B in 663.323Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":11,"codeId":7,"userId":8}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000082] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49454 - 302 239B in 419.102Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":7}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000083] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49468 - 200 4205B in 11.81296ms
2025/11/25 13:26:02 INFO {"audit_event":"deleted_own_user_consent","details":{"consentId":2,"loggedInUser":"4817ee3a-1b9e-459c-92cc-607554ac402e","userId":8}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000084] "DELETE http://localhost:19090/api/v1/account/consents/2 HTTP/1.1" from [::1]:49476 - 200 17B in 499.173Âµs
--- PASS: TestAPIAccountConsentDelete_Success (0.09s)
=== RUN   TestAPIAccountConsentDelete_ForbiddenOnOtherUser
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000085] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-bLHAjclR&redirect_uri=https%3A%2F%2Fwww.customerfunctionalities.com%2Ftarget%2Fgenerate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=DjFuzKuj&nonce=jLhRlaOQ HTTP/1.1" from [::1]:49480 - 302 57B in 440.543Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000086] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49492 - 302 54B in 174.78Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000087] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49496 - 200 2955B in 310.847Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":9}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000088] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49496 - 302 0B in 36.328982ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000089] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49496 - 302 57B in 322.98Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000090] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49506 - 302 60B in 542.465Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":13,"userId":9}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000091] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49508 - 302 56B in 1.204746ms
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":13,"codeId":8,"userId":9}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000092] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49522 - 302 231B in 382.212Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":8}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000093] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49530 - 200 4205B in 11.5219ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000094] "DELETE http://localhost:19090/api/v1/account/consents/3 HTTP/1.1" from [::1]:49544 - 403 53B in 491.278Âµs
--- PASS: TestAPIAccountConsentDelete_ForbiddenOnOtherUser (0.09s)
=== RUN   TestAPIAccountConsentDelete_NotFoundAndBadId
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000095] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-TDJBPTLW&redirect_uri=https%3A%2F%2Fwww.chiefgenerate.biz%2Fmatrix&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=LPyMpERU&nonce=MoJuExeC HTTP/1.1" from [::1]:49554 - 302 57B in 591.858Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000096] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49564 - 302 54B in 293.164Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000097] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49574 - 200 2955B in 361.302Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":11}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000098] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49574 - 302 0B in 36.361593ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000099] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49574 - 302 57B in 452.956Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000100] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49578 - 302 60B in 407.56Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":15,"userId":11}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000101] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49590 - 302 56B in 756.128Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":15,"codeId":9,"userId":11}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000102] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49594 - 302 212B in 338.74Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":9}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000103] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49600 - 200 4212B in 11.276176ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000104] "DELETE http://localhost:19090/api/v1/account/consents/999999999 HTTP/1.1" from [::1]:49602 - 404 61B in 452.024Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000105] "DELETE http://localhost:19090/api/v1/account/consents/abc HTTP/1.1" from [::1]:49604 - 400 76B in 620.071Âµs
--- PASS: TestAPIAccountConsentDelete_NotFoundAndBadId (0.09s)
=== RUN   TestAPIAccountEmailPut_Success
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000106] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-eAFLbuUt&redirect_uri=http%3A%2F%2Fwww.legacyvirtual.io%2Fproductize%2Fiterate%2Fwebservices%2Fsynergize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=cVrRojBN&nonce=TGcXNDyY HTTP/1.1" from [::1]:49614 - 302 57B in 397.732Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000107] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49628 - 302 54B in 216.55Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000108] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49632 - 200 2955B in 261.253Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":12}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000109] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49632 - 302 0B in 35.910972ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000110] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49632 - 302 57B in 455.491Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000111] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49646 - 302 60B in 311.909Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":16,"userId":12}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000112] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49650 - 302 56B in 604.181Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":16,"codeId":10,"userId":12}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000113] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49662 - 302 244B in 297.983Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":10}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000114] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49678 - 200 4201B in 12.174403ms
2025/11/25 13:26:02 INFO {"audit_event":"updated_own_email","details":{"loggedInUser":"d82b3d6b-6bde-44b3-87ae-6318964d68ba","userId":12}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000115] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:49688 - 200 695B in 663.313Âµs
--- PASS: TestAPIAccountEmailPut_Success (0.09s)
=== RUN   TestAPIAccountEmailPut_ValidationErrors
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000116] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-TMeTvXXe&redirect_uri=http%3A%2F%2Fwww.customerseize.io%2Fapplications&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=WTwMiEgo&nonce=iDqrtdjI HTTP/1.1" from [::1]:49698 - 302 57B in 747.021Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000117] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49714 - 302 54B in 413.501Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000118] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49718 - 200 2955B in 458.105Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":13}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000119] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49718 - 302 0B in 36.771559ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000120] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49718 - 302 57B in 318.542Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000121] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49722 - 302 60B in 690.225Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":17,"userId":13}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000122] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49732 - 302 56B in 791.576Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":17,"codeId":11,"userId":13}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000123] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49742 - 302 216B in 699.461Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":11}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000124] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49748 - 200 4202B in 11.371737ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000125] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:49756 - 400 81B in 387.212Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000126] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:49760 - 400 86B in 395.998Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000127] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:49764 - 400 117B in 422.748Âµs
--- PASS: TestAPIAccountEmailPut_ValidationErrors (0.09s)
=== RUN   TestAPIAccountEmailPut_EmailAlreadyExists
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000128] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-VQyhChtd&redirect_uri=http%3A%2F%2Fwww.globalorchestrate.com%2Fcultivate%2F24-365%2Fplug-and-play%2Fe-business&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=jCPkKlDE&nonce=uKqtzDDs HTTP/1.1" from [::1]:49776 - 302 57B in 367.945Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000129] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49778 - 302 54B in 310.366Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000130] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49794 - 200 2955B in 288.665Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":14}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000131] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49794 - 302 0B in 35.543177ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000132] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49794 - 302 57B in 625Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000133] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49802 - 302 60B in 306.369Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":18,"userId":14}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000134] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49818 - 302 56B in 663.113Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":18,"codeId":12,"userId":14}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000135] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49820 - 302 250B in 343.539Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":12}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000136] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49830 - 200 4204B in 11.365315ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000137] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:49838 - 400 107B in 535.001Âµs
--- PASS: TestAPIAccountEmailPut_EmailAlreadyExists (0.09s)
=== RUN   TestAPIAccountEmailPut_UnauthorizedAndScope
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000138] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:49852 - 401 22B in 81.875Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":19}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000139] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49856 - 200 1177B in 3.963709ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000140] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:49860 - 403 19B in 532.245Âµs
--- PASS: TestAPIAccountEmailPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountEmailPut_InvalidRequestBody
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000141] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-GPxlGjEH&redirect_uri=http%3A%2F%2Fwww.productfrictionless.net%2Fcollaborative%2Fstrategic&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=KYaqnJnK&nonce=pDtlMzPB HTTP/1.1" from [::1]:49872 - 302 57B in 417.258Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000142] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49888 - 302 54B in 186.052Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000143] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49894 - 200 2955B in 250.554Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":16}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000144] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49894 - 302 0B in 35.376191ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000145] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49894 - 302 57B in 421.827Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000146] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49900 - 302 60B in 648.886Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":20,"userId":16}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000147] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49904 - 302 56B in 721.192Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":20,"codeId":13,"userId":16}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000148] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49906 - 302 234B in 621.464Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":13}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000149] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49916 - 200 4201B in 12.073563ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000150] "PUT http://localhost:19090/api/v1/account/email HTTP/1.1" from [::1]:49920 - 400 75B in 362.334Âµs
--- PASS: TestAPIAccountEmailPut_InvalidRequestBody (0.09s)
=== RUN   TestAPIAccountEmailVerificationSend_Success
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000151] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-rsrDJlUR&redirect_uri=http%3A%2F%2Fwww.customerglobal.org%2Frelationships%2Funleash&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=rNEMlDNu&nonce=VJsrDyYv HTTP/1.1" from [::1]:49932 - 302 57B in 527.647Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000152] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:49948 - 302 54B in 260.652Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000153] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49962 - 200 2955B in 301.84Âµs
2025/11/25 13:26:02 INFO {"audit_event":"auth_success_pwd","details":{"userId":17}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000154] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:49962 - 302 0B in 35.943825ms
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000155] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:49962 - 302 57B in 402.64Âµs
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000156] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:49966 - 302 60B in 382.593Âµs
2025/11/25 13:26:02 INFO {"audit_event":"started_new_user_session","details":{"clientId":21,"userId":17}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000157] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:49968 - 302 56B in 671.829Âµs
2025/11/25 13:26:02 INFO {"audit_event":"created_auth_code","details":{"clientId":21,"codeId":14,"userId":17}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000158] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:49976 - 302 227B in 365.14Âµs
2025/11/25 13:26:02 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":14}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000159] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49978 - 200 4212B in 11.800547ms
2025/11/25 13:26:02 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"kennedihodkiewicz@ondricka.org","loggedInUser":"cf406aff-284c-4c19-b6ce-1fb169f52f71","userId":17}}
2025/11/25 13:26:02 [a357f2e3b56e/FBsnpuLk6O-000160] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:49992 - 200 147B in 2.089849ms
--- PASS: TestAPIAccountEmailVerificationSend_Success (0.11s)
=== RUN   TestAPIAccountEmailVerificationSend_TooManyRequests
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000161] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-kZLAaCSU&redirect_uri=https%3A%2F%2Fwww.futuremaximize.com%2Fintegrate%2Fsynergistic&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=SbZetCUq&nonce=vWLWFLPo HTTP/1.1" from [::1]:50004 - 302 57B in 448.577Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000162] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50006 - 302 54B in 243.029Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000163] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50012 - 200 2955B in 319.193Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":18}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000164] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50012 - 302 0B in 35.831402ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000165] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50012 - 302 57B in 356.353Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000166] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50028 - 302 60B in 482.522Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":22,"userId":18}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000167] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50038 - 302 56B in 716.955Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":22,"codeId":15,"userId":18}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000168] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50052 - 302 228B in 569.125Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":15}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000169] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50062 - 200 4212B in 11.260757ms
2025/11/25 13:26:03 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"germainejakubowski@schmitt.org","loggedInUser":"c8d3530d-dc0b-40ee-bece-8dc6078d6bc7","userId":18}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000170] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:50074 - 200 147B in 1.311488ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000171] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:50090 - 200 118B in 367.534Âµs
--- PASS: TestAPIAccountEmailVerificationSend_TooManyRequests (0.09s)
=== RUN   TestAPIAccountEmailVerificationSend_AlreadyVerified
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000172] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-BigjTkiy&redirect_uri=http%3A%2F%2Fwww.internalfacilitate.org%2Fgranular%2Frich%2Fredefine%2Fproductize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ZdAUBiDw&nonce=PjyhzDOR HTTP/1.1" from [::1]:50098 - 302 57B in 387.192Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000173] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50108 - 302 54B in 222.31Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000174] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50114 - 200 2955B in 255.813Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":19}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000175] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50114 - 302 0B in 35.946409ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000176] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50114 - 302 57B in 542.505Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000177] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50126 - 302 60B in 336.325Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":23,"userId":19}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000178] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50140 - 302 56B in 909.188Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":23,"codeId":16,"userId":19}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000179] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50144 - 302 243B in 355.762Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":16}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000180] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50152 - 200 4204B in 11.291946ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000181] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:50164 - 200 117B in 429.912Âµs
--- PASS: TestAPIAccountEmailVerificationSend_AlreadyVerified (0.09s)
=== RUN   TestAPIAccountEmailVerificationSend_SMTPDisabled
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000182] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-hPrkwNqG&redirect_uri=http%3A%2F%2Fwww.globaldrive.io%2Ffrictionless%2Ftransition%2Freintermediate%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=pWAsqNzl&nonce=MLNcWlpC HTTP/1.1" from [::1]:50178 - 302 57B in 602.398Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000183] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50180 - 302 54B in 218.904Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000184] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50184 - 200 2955B in 262.336Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":20}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000185] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50184 - 302 0B in 35.393133ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000186] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50184 - 302 57B in 480.117Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000187] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50186 - 302 60B in 309.294Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":24,"userId":20}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000188] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50196 - 302 56B in 696.286Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":24,"codeId":17,"userId":20}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000189] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50208 - 302 248B in 348.969Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":17}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000190] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50214 - 200 4200B in 11.286616ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000191] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:50228 - 400 70B in 309.354Âµs
--- PASS: TestAPIAccountEmailVerificationSend_SMTPDisabled (0.09s)
=== RUN   TestAPIAccountEmailVerificationSend_Unauthorized
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000192] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:50244 - 401 22B in 109.637Âµs
--- PASS: TestAPIAccountEmailVerificationSend_Unauthorized (0.00s)
=== RUN   TestAPIAccountEmailVerification_VerifySuccess
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000193] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-eKXlqdSB&redirect_uri=https%3A%2F%2Fwww.legacyfacilitate.info%2Fdynamic&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=wMgTDMVh&nonce=lXyvAgXn HTTP/1.1" from [::1]:50248 - 302 57B in 348.96Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000194] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50258 - 302 54B in 573.825Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000195] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50264 - 200 2955B in 356.944Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":21}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000196] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50264 - 302 0B in 37.84156ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000197] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50264 - 302 57B in 261.655Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000198] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50280 - 302 60B in 650.479Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":25,"userId":21}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000199] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50294 - 302 56B in 688.842Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":25,"codeId":18,"userId":21}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000200] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50300 - 302 217B in 401.368Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":18}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000201] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50310 - 200 4201B in 11.731987ms
2025/11/25 13:26:03 INFO {"audit_event":"sent_email_verification_message","details":{"emailDestination":"jarrellkris@moore.info","loggedInUser":"7bf915eb-bb57-45a1-ba5f-6bcf7519cf5c","userId":21}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000202] "POST http://localhost:19090/api/v1/account/email/verification/send HTTP/1.1" from [::1]:50320 - 200 139B in 1.403592ms
2025/11/25 13:26:03 INFO {"audit_event":"verified_email","details":{"loggedInUser":"7bf915eb-bb57-45a1-ba5f-6bcf7519cf5c","userId":21}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000203] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:50334 - 200 696B in 501.447Âµs
--- PASS: TestAPIAccountEmailVerification_VerifySuccess (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifyInvalidCode
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000204] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-xNKmpTBr&redirect_uri=http%3A%2F%2Fwww.directsupply-chains.info%2Fbenchmark%2Foptimize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=eYZlluCN&nonce=dfPWMvMQ HTTP/1.1" from [::1]:50350 - 302 57B in 594.053Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000205] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50362 - 302 54B in 197.523Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000206] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50376 - 200 2955B in 258.228Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":22}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000207] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50376 - 302 0B in 36.431926ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000208] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50376 - 302 57B in 327.739Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000209] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50392 - 302 60B in 362.094Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":26,"userId":22}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000210] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50406 - 302 56B in 775.966Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":26,"codeId":19,"userId":22}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000211] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50414 - 302 230B in 409.534Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":19}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000212] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50418 - 200 4206B in 11.769117ms
2025/11/25 13:26:03 INFO {"audit_event":"failed_email_verification_code","details":{"loggedInUser":"564170ee-69d1-46e3-afe8-6bd8d30f28c8","userId":22}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000213] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:50420 - 400 107B in 541.153Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyInvalidCode (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifyExpiredCode
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000214] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-yERJDLMU&redirect_uri=http%3A%2F%2Fwww.humane-tailers.info%2Fimpactful%2Fenable&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=BziLAKKN&nonce=jGbCTEAS HTTP/1.1" from [::1]:50430 - 302 57B in 544.719Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000215] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50440 - 302 54B in 218.142Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000216] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50448 - 200 2955B in 326.597Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":23}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000217] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50448 - 302 0B in 36.053501ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000218] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50448 - 302 57B in 310.476Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000219] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50462 - 302 60B in 301.239Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":27,"userId":23}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000220] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50470 - 302 56B in 664.876Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":27,"codeId":20,"userId":23}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000221] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50478 - 302 223B in 416.046Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":20}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000222] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50486 - 200 4204B in 11.533652ms
2025/11/25 13:26:03 INFO {"audit_event":"failed_email_verification_code","details":{"loggedInUser":"be5deb0a-ebca-4326-ace7-13fdd8ee94cc","userId":23}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000223] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:50500 - 400 107B in 458.166Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyExpiredCode (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifyAlreadyVerified
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000224] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-IJjgnbwn&redirect_uri=http%3A%2F%2Fwww.legacyharness.net%2Fsyndicate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=kuGiPFsy&nonce=proWZjhI HTTP/1.1" from [::1]:50514 - 302 57B in 536.614Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000225] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50530 - 302 54B in 196.17Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000226] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50534 - 200 2955B in 298.644Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":24}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000227] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50534 - 302 0B in 35.38026ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000228] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50534 - 302 57B in 264.079Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000229] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50536 - 302 60B in 319.373Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":28,"userId":24}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000230] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50548 - 302 56B in 701.695Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":28,"codeId":21,"userId":24}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000231] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50558 - 302 214B in 330.865Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":21}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000232] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50568 - 200 4202B in 11.505519ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000233] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:50580 - 200 697B in 438.168Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyAlreadyVerified (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifySMTPDisabled
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000234] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-pXhONxZK&redirect_uri=https%3A%2F%2Fwww.customermonetize.io%2Fseamless%2Ffront-end&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ypbzbKXL&nonce=dDPsaaXN HTTP/1.1" from [::1]:50590 - 302 57B in 762.271Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000235] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50592 - 302 54B in 232.87Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000236] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50602 - 200 2955B in 693.51Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":25}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000237] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50602 - 302 0B in 35.742494ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000238] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50602 - 302 57B in 485.297Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000239] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50610 - 302 60B in 328.35Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":29,"userId":25}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000240] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50612 - 302 56B in 705.853Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":29,"codeId":22,"userId":25}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000241] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50622 - 302 226B in 454.179Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":22}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50638 - 200 4200B in 11.406622ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000243] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:50646 - 400 70B in 333.079Âµs
--- PASS: TestAPIAccountEmailVerification_VerifySMTPDisabled (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifyInvalidRequestBody
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000244] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-sUAcqeSj&redirect_uri=https%3A%2F%2Fwww.districteyeballs.name%2Fevolve&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=WXabrtuV&nonce=EHGexgcP HTTP/1.1" from [::1]:50658 - 302 57B in 459.508Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000245] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50660 - 302 54B in 328.099Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000246] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50672 - 200 2955B in 284.137Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":26}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000247] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50672 - 302 0B in 35.487493ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000248] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50672 - 302 57B in 235.405Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000249] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50682 - 302 60B in 279.278Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":30,"userId":26}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000250] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50694 - 302 56B in 684.523Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":30,"codeId":23,"userId":26}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000251] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50702 - 302 216B in 745.93Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":23}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000252] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50718 - 200 4208B in 11.290693ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000253] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:50728 - 400 75B in 382.984Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyInvalidRequestBody (0.09s)
=== RUN   TestAPIAccountEmailVerification_VerifyUnauthorized
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000254] "POST http://localhost:19090/api/v1/account/email/verification HTTP/1.1" from [::1]:50738 - 401 22B in 86.714Âµs
--- PASS: TestAPIAccountEmailVerification_VerifyUnauthorized (0.00s)
=== RUN   TestAPIAccountLogoutRequest_Success_And_LogoutFlow_WithAndWithoutCookie
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000255] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-EiCucCrb&redirect_uri=https%3A%2F%2Fwww.chiefunleash.info%2Fvortals%2Fleverage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=ICRLkxZi&nonce=AiAAbLJK HTTP/1.1" from [::1]:50744 - 302 57B in 509.643Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000256] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50754 - 302 54B in 172.045Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000257] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50770 - 200 2955B in 307.22Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":27}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000258] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50770 - 302 0B in 35.446765ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000259] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50770 - 302 57B in 340.614Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000260] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50778 - 302 60B in 320.726Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":31,"userId":27}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000261] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50794 - 302 56B in 685.605Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":31,"codeId":24,"userId":27}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000262] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50802 - 302 222B in 296.009Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":24}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000263] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50818 - 200 4214B in 11.449874ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000264] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:50824 - 200 1226B in 5.362181ms
2025/11/25 13:26:03 INFO {"audit_event":"deleted_user_session_client","details":{"clientId":31,"loggedInUser":"","userId":27,"userSessionId":24}}
2025/11/25 13:26:03 INFO {"audit_event":"logout","details":{"loggedInUser":"","sessionIdentifier":"a2f255ea-1c76-4643-8bc2-1f0564e0ffd1","userId":27}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000265] "GET http://localhost:19090/auth/logout?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6ImNmYWE2OGYxLTM4ODYtNDg5Zi05ZDNkLWUxNmRkNmM0ZGE4YiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhY2N0c2NvcGUtY2xpZW50LUVpQ3VjQ3JiIiwiZXhwIjoxNzY0MDc3MjIzLCJpYXQiOjE3NjQwNzcxNjMsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6MTkwOTAiLCJzaWQiOiJhMmYyNTVlYS0xYzc2LTQ2NDMtOGJjMi0xZjA1NjRlMGZmZDEiLCJzdWIiOiI2OGRkMjZlZC0zNDRhLTQ3Y2UtODUzOS1jN2JkY2Q0MGY0NzciLCJ0eXAiOiJJRCJ9.pTxjj6pJ2TilVyTN6zOXKsWGPUXqoi_YzfPlS3p_nXUIyVupuqb86FJXWdXjKjC2Ps4HRFdWtRd9FqbhaExqaU9K2JgsPqOy21hJtVyT7yw2XnV7kwK89VBZ0k2JoS9i2-lEEtu9iE3dQR0V8QVYnbpxsRiB9SI5ygRgyDCupEpInYCsnAb7u64PmzLlPX7K7ONDn897Ohm5paGskGUeq4zYclc9_xoHPz-9_Dof7P-Ahx_LwxqxTpvA_JhTRM0-ha8ZkT91qYqgOhUYtKgX5G4DXHyvU6ibJwu2CCA_Ztz3ffrhNzevqrD9bIksfsrogRDEXXllW958DhnM5lfBkGx_qOHvGF4Yp1zrmAe6RLwxSi_6bTcWAEWTLI2j9Ngolm73Ore8OTNGh_IfaqRXmpii-4999a2-i_8KRTmAnEuMnMw5xJFNREv5HB2wnVdpgcLRuJCItFldejHCpn3xxT9xVCvMF0bSbi7t39Q8pOx-o9307GCZxMxUFR-bDpUh-HawQJPbtiDAo6Bhjkxc7JihWrvv9QsEkoO173c1aEDJajYFn65klXrPMBirnpCuqn07cK6QkEIzIskHkaIFaYItTDV614vd232mX86W32yTMjRet4kZwCalVn7P9MEtoDnmhiCfrZdTyU3H_oh-TglDMIt8sJKpF1lG4-hxWI0&post_logout_redirect_uri=https%3A%2F%2Fwww.chiefunleash.info%2Fvortals%2Fleverage&state=QRLwzwJvxOWb HTTP/1.1" from [::1]:50818 - 302 133B in 589.453Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000266] "GET http://localhost:19090/auth/logout?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6ImNmYWE2OGYxLTM4ODYtNDg5Zi05ZDNkLWUxNmRkNmM0ZGE4YiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhY2N0c2NvcGUtY2xpZW50LUVpQ3VjQ3JiIiwiZXhwIjoxNzY0MDc3MjIzLCJpYXQiOjE3NjQwNzcxNjMsImlzcyI6Imh0dHA6Ly9sb2NhbGhvc3Q6MTkwOTAiLCJzaWQiOiJhMmYyNTVlYS0xYzc2LTQ2NDMtOGJjMi0xZjA1NjRlMGZmZDEiLCJzdWIiOiI2OGRkMjZlZC0zNDRhLTQ3Y2UtODUzOS1jN2JkY2Q0MGY0NzciLCJ0eXAiOiJJRCJ9.pTxjj6pJ2TilVyTN6zOXKsWGPUXqoi_YzfPlS3p_nXUIyVupuqb86FJXWdXjKjC2Ps4HRFdWtRd9FqbhaExqaU9K2JgsPqOy21hJtVyT7yw2XnV7kwK89VBZ0k2JoS9i2-lEEtu9iE3dQR0V8QVYnbpxsRiB9SI5ygRgyDCupEpInYCsnAb7u64PmzLlPX7K7ONDn897Ohm5paGskGUeq4zYclc9_xoHPz-9_Dof7P-Ahx_LwxqxTpvA_JhTRM0-ha8ZkT91qYqgOhUYtKgX5G4DXHyvU6ibJwu2CCA_Ztz3ffrhNzevqrD9bIksfsrogRDEXXllW958DhnM5lfBkGx_qOHvGF4Yp1zrmAe6RLwxSi_6bTcWAEWTLI2j9Ngolm73Ore8OTNGh_IfaqRXmpii-4999a2-i_8KRTmAnEuMnMw5xJFNREv5HB2wnVdpgcLRuJCItFldejHCpn3xxT9xVCvMF0bSbi7t39Q8pOx-o9307GCZxMxUFR-bDpUh-HawQJPbtiDAo6Bhjkxc7JihWrvv9QsEkoO173c1aEDJajYFn65klXrPMBirnpCuqn07cK6QkEIzIskHkaIFaYItTDV614vd232mX86W32yTMjRet4kZwCalVn7P9MEtoDnmhiCfrZdTyU3H_oh-TglDMIt8sJKpF1lG4-hxWI0&post_logout_redirect_uri=https%3A%2F%2Fwww.chiefunleash.info%2Fvortals%2Fleverage&state=QRLwzwJvxOWb HTTP/1.1" from [::1]:50834 - 302 133B in 332.558Âµs
--- PASS: TestAPIAccountLogoutRequest_Success_And_LogoutFlow_WithAndWithoutCookie (0.09s)
=== RUN   TestAPIAccountLogoutRequest_ValidationErrors_And_Scope
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000267] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-hvQgnKzG&redirect_uri=http%3A%2F%2Fwww.futuree-enable.net%2Fleverage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JsFlJnBl&nonce=DviAobRF HTTP/1.1" from [::1]:50850 - 302 57B in 617.938Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000268] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50860 - 302 54B in 271.383Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000269] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50868 - 200 2955B in 348.138Âµs
2025/11/25 13:26:03 INFO {"audit_event":"auth_success_pwd","details":{"userId":28}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000270] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50868 - 302 0B in 36.234343ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000271] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50868 - 302 57B in 581.489Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000272] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50878 - 302 60B in 610.694Âµs
2025/11/25 13:26:03 INFO {"audit_event":"started_new_user_session","details":{"clientId":32,"userId":28}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000273] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50880 - 302 56B in 900.982Âµs
2025/11/25 13:26:03 INFO {"audit_event":"created_auth_code","details":{"clientId":32,"codeId":25,"userId":28}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000274] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50884 - 302 214B in 483.042Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":25}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50890 - 200 4202B in 11.357079ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000276] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:50904 - 400 84B in 618.298Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000277] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:50918 - 400 128B in 734.918Âµs
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000278] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:50934 - 401 22B in 76.375Âµs
2025/11/25 13:26:03 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":33}}
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50942 - 200 1177B in 4.00129ms
2025/11/25 13:26:03 [a357f2e3b56e/FBsnpuLk6O-000280] "POST http://localhost:19090/api/v1/account/logout-request HTTP/1.1" from [::1]:50944 - 403 19B in 423.531Âµs
--- PASS: TestAPIAccountLogoutRequest_ValidationErrors_And_Scope (0.10s)
=== RUN   TestAPIAccountOTPEnrollmentGet_Success
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000281] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-gZpKHZGq&redirect_uri=http%3A%2F%2Fwww.corporatemethodologies.info%2Ftransition&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=qkPiCCnp&nonce=dCrviObj HTTP/1.1" from [::1]:50954 - 302 57B in 332.449Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000282] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:50966 - 302 54B in 170.452Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000283] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50968 - 200 2955B in 266.343Âµs
2025/11/25 13:26:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":29}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000284] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:50968 - 302 0B in 35.546283ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000285] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:50968 - 302 57B in 249.04Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000286] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:50972 - 302 60B in 323.361Âµs
2025/11/25 13:26:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":34,"userId":29}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000287] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:50980 - 302 56B in 636.653Âµs
2025/11/25 13:26:04 INFO {"audit_event":"created_auth_code","details":{"clientId":34,"codeId":26,"userId":29}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000288] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:50984 - 302 225B in 376.421Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":26}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000289] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51000 - 200 4202B in 11.497464ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000290] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:51006 - 200 698B in 370.35Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000291] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:51008 - 200 2174B in 3.848071ms
--- PASS: TestAPIAccountOTPEnrollmentGet_Success (0.09s)
=== RUN   TestAPIAccountOTPEnrollmentGet_AlreadyEnabled
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000292] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-zSrIsEpY&redirect_uri=http%3A%2F%2Fwww.dynamicrobust.info%2Fintegrate%2Ftransform%2Fvisionary&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=fTHucRDl&nonce=FRqsJHZz HTTP/1.1" from [::1]:51016 - 302 57B in 325.445Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000293] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:51020 - 302 54B in 378.505Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000294] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:51022 - 200 2955B in 289.357Âµs
2025/11/25 13:26:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":30}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000295] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:51022 - 302 0B in 35.723708ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000296] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:51022 - 302 57B in 400.577Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000297] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:51036 - 302 60B in 255.172Âµs
2025/11/25 13:26:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":35,"userId":30}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000298] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:51042 - 302 56B in 868.43Âµs
2025/11/25 13:26:04 INFO {"audit_event":"created_auth_code","details":{"clientId":35,"codeId":27,"userId":30}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000299] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:51044 - 302 235B in 296.26Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":27}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000300] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51046 - 200 4206B in 12.535495ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000301] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:51060 - 200 701B in 379.998Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000302] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:51070 - 400 76B in 396.359Âµs
--- PASS: TestAPIAccountOTPEnrollmentGet_AlreadyEnabled (0.09s)
=== RUN   TestAPIAccountOTPEnrollmentGet_UnauthorizedAndScope
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000303] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:51078 - 401 22B in 407.95Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000304] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:51086 - 401 22B in 191.372Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":36}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000305] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51090 - 200 1177B in 3.988696ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000306] "GET http://localhost:19090/api/v1/account/otp/enrollment HTTP/1.1" from [::1]:51100 - 403 19B in 278.576Âµs
--- PASS: TestAPIAccountOTPEnrollmentGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountOTPPut_Enable_Success
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000307] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-tqHBMDpe&redirect_uri=https%3A%2F%2Fwww.internalexpedite.com%2Fscalable&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=cHayNRAy&nonce=TzKqQerT HTTP/1.1" from [::1]:51116 - 302 57B in 340.133Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000308] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:51132 - 302 54B in 273.286Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000309] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:51148 - 200 2955B in 294.937Âµs
2025/11/25 13:26:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":31}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000310] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:51148 - 302 0B in 35.747182ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000311] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:51148 - 302 57B in 232.72Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000312] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:51156 - 302 60B in 581.329Âµs
2025/11/25 13:26:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":37,"userId":31}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000313] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:51168 - 302 56B in 628.588Âµs
2025/11/25 13:26:04 INFO {"audit_event":"created_auth_code","details":{"clientId":37,"codeId":28,"userId":31}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000314] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:51174 - 302 217B in 324.133Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":28}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000315] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51190 - 200 4209B in 11.545425ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000316] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:51202 - 200 703B in 757.781Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":38}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000317] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51216 - 200 1168B in 4.805821ms
2025/11/25 13:26:04 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-eWFtkRPw","userId":31}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000318] "PUT http://localhost:19090/api/v1/admin/users/31/password HTTP/1.1" from [::1]:51228 - 200 702B in 36.796505ms
2025/11/25 13:26:04 INFO {"audit_event":"enabled_otp","details":{"userId":31}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000319] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:51240 - 200 702B in 37.07937ms
--- PASS: TestAPIAccountOTPPut_Enable_Success (0.21s)
=== RUN   TestAPIAccountOTPPut_Enable_AuthFailed
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000320] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-yhCaCxPK&redirect_uri=http%3A%2F%2Fwww.internalinfomediaries.net%2Fgrow%2Ftechnologies%2Fcutting-edge%2Fsyndicate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=iwAgHtpR&nonce=mjBBMQax HTTP/1.1" from [::1]:41462 - 302 57B in 616.575Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000321] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:41472 - 302 54B in 214.055Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000322] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41484 - 200 2955B in 288.515Âµs
2025/11/25 13:26:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":32}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000323] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41484 - 302 0B in 35.81483ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000324] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:41484 - 302 57B in 400.777Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000325] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:41492 - 302 60B in 428.078Âµs
2025/11/25 13:26:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":39,"userId":32}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000326] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:41500 - 302 56B in 698.058Âµs
2025/11/25 13:26:04 INFO {"audit_event":"created_auth_code","details":{"clientId":39,"codeId":29,"userId":32}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000327] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:41506 - 302 253B in 417.97Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":29}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000328] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41512 - 200 4208B in 11.980667ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000329] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:41516 - 200 702B in 590.446Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":40}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41520 - 200 1168B in 4.259058ms
2025/11/25 13:26:04 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-jmpVYfOx","userId":32}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000331] "PUT http://localhost:19090/api/v1/admin/users/32/password HTTP/1.1" from [::1]:41524 - 200 702B in 36.918436ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000332] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:41540 - 400 113B in 35.725972ms
--- PASS: TestAPIAccountOTPPut_Enable_AuthFailed (0.21s)
=== RUN   TestAPIAccountOTPPut_Enable_InvalidFormats
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000333] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-JVKNVzAs&redirect_uri=https%3A%2F%2Fwww.corporatee-tailers.biz%2Fbandwidth%2Fgrow%2Fvirtual%2Fseamless&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=biSayhKS&nonce=OlBwsKaF HTTP/1.1" from [::1]:41554 - 302 57B in 683.992Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000334] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:41570 - 302 54B in 243.951Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000335] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41586 - 200 2955B in 1.054393ms
2025/11/25 13:26:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":33}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000336] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41586 - 302 0B in 37.166214ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000337] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:41586 - 302 57B in 298.304Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000338] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:41594 - 302 60B in 301.209Âµs
2025/11/25 13:26:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":41,"userId":33}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000339] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:41604 - 302 56B in 871.626Âµs
2025/11/25 13:26:04 INFO {"audit_event":"created_auth_code","details":{"clientId":41,"codeId":30,"userId":33}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000340] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:41614 - 302 242B in 385.829Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":30}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000341] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41624 - 200 4202B in 11.76021ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000342] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:41636 - 200 698B in 686.678Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":42}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000343] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41648 - 200 1168B in 4.076281ms
2025/11/25 13:26:04 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-vCQuAzHt","userId":33}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000344] "PUT http://localhost:19090/api/v1/admin/users/33/password HTTP/1.1" from [::1]:41652 - 200 698B in 36.061196ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000345] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:41668 - 400 68B in 35.434342ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000346] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:41676 - 400 79B in 36.066406ms
--- PASS: TestAPIAccountOTPPut_Enable_InvalidFormats (0.27s)
=== RUN   TestAPIAccountOTPPut_Enable_WrongCode
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000347] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-nvsOWQmK&redirect_uri=http%3A%2F%2Fwww.regionalnetworks.io%2Fdeliver%2Fenterprise%2F24-7%2Fimpactful&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=AcHExTZH&nonce=YoBgQtOY HTTP/1.1" from [::1]:41678 - 302 57B in 788.28Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000348] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:41692 - 302 54B in 268.627Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000349] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41702 - 200 2955B in 345.122Âµs
2025/11/25 13:26:04 INFO {"audit_event":"auth_success_pwd","details":{"userId":34}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000350] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41702 - 302 0B in 35.399155ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000351] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:41702 - 302 57B in 300.397Âµs
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000352] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:41708 - 302 60B in 832.152Âµs
2025/11/25 13:26:04 INFO {"audit_event":"started_new_user_session","details":{"clientId":43,"userId":34}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000353] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:41716 - 302 56B in 738.725Âµs
2025/11/25 13:26:04 INFO {"audit_event":"created_auth_code","details":{"clientId":43,"codeId":31,"userId":34}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000354] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:41730 - 302 240B in 392.962Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":31}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000355] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41740 - 200 4208B in 11.373048ms
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000356] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:41748 - 200 702B in 367.585Âµs
2025/11/25 13:26:04 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":44}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000357] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41762 - 200 1168B in 3.964681ms
2025/11/25 13:26:04 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-iPWCmpOP","userId":34}}
2025/11/25 13:26:04 [a357f2e3b56e/FBsnpuLk6O-000358] "PUT http://localhost:19090/api/v1/admin/users/34/password HTTP/1.1" from [::1]:41776 - 200 702B in 35.922103ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000359] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:41786 - 400 209B in 35.768343ms
--- PASS: TestAPIAccountOTPPut_Enable_WrongCode (0.20s)
=== RUN   TestAPIAccountOTPPut_Disable_Success
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000360] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-kIeCafgW&redirect_uri=https%3A%2F%2Fwww.chiefmethodologies.info%2Fcommunities&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=GgpHBJaa&nonce=dRYLfImb HTTP/1.1" from [::1]:41790 - 302 57B in 747.713Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000361] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:41792 - 302 54B in 239.191Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000362] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41794 - 200 2955B in 282.905Âµs
2025/11/25 13:26:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":35}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000363] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41794 - 302 0B in 35.49133ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000364] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:41794 - 302 57B in 491.458Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000365] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:41798 - 302 60B in 531.064Âµs
2025/11/25 13:26:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":45,"userId":35}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000366] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:41808 - 302 56B in 764.544Âµs
2025/11/25 13:26:05 INFO {"audit_event":"created_auth_code","details":{"clientId":45,"codeId":32,"userId":35}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000367] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:41818 - 302 223B in 549.759Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":32}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000368] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41834 - 200 4196B in 12.606229ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000369] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:41840 - 200 693B in 706.835Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":46}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000370] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41854 - 200 1168B in 4.264357ms
2025/11/25 13:26:05 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-AWDFnTIg","userId":35}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000371] "PUT http://localhost:19090/api/v1/admin/users/35/password HTTP/1.1" from [::1]:41860 - 200 693B in 36.935157ms
2025/11/25 13:26:05 INFO {"audit_event":"disabled_otp","details":{"userId":35}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000372] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:41866 - 200 693B in 36.860125ms
--- PASS: TestAPIAccountOTPPut_Disable_Success (0.21s)
=== RUN   TestAPIAccountOTPPut_Enable_SetsSessionFlag
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000373] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-XyLfatNd&redirect_uri=http%3A%2F%2Fwww.leadweb-enabled.info%2Fconvergence%2Fportals%2Fengage&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=LwufDrkM&nonce=IBLhRmjd HTTP/1.1" from [::1]:41870 - 302 57B in 631.002Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000374] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:41878 - 302 54B in 240.354Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000375] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41890 - 200 2955B in 291.741Âµs
2025/11/25 13:26:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":36}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000376] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41890 - 302 0B in 36.138793ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000377] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:41890 - 302 57B in 525.082Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000378] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:41902 - 302 60B in 316.999Âµs
2025/11/25 13:26:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":47,"userId":36}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000379] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:41912 - 302 56B in 878.45Âµs
2025/11/25 13:26:05 INFO {"audit_event":"created_auth_code","details":{"clientId":47,"codeId":33,"userId":36}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000380] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:41916 - 302 234B in 378.175Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":33}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000381] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41930 - 200 4204B in 12.587403ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000382] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:41942 - 200 699B in 479.917Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":48}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:41944 - 200 1168B in 4.231064ms
2025/11/25 13:26:05 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-dXGZknMj","userId":36}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000384] "PUT http://localhost:19090/api/v1/admin/users/36/password HTTP/1.1" from [::1]:41950 - 200 699B in 37.681147ms
2025/11/25 13:26:05 INFO {"audit_event":"enabled_otp","details":{"userId":36}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000385] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:41962 - 200 698B in 37.440081ms
--- PASS: TestAPIAccountOTPPut_Enable_SetsSessionFlag (0.21s)
=== RUN   TestAPIAccountOTPPut_Disable_SetsSessionFlag
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000386] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-XQZenQiU&redirect_uri=http%3A%2F%2Fwww.investorgrow.com%2Fdrive%2Fembrace&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=zwptBAUu&nonce=SyTjJXqG HTTP/1.1" from [::1]:41968 - 302 57B in 698.73Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000387] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:41978 - 302 54B in 459.619Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000388] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41982 - 200 2955B in 318.993Âµs
2025/11/25 13:26:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":37}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000389] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:41982 - 302 0B in 35.779213ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000390] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:41982 - 302 57B in 454.94Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000391] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:41994 - 302 60B in 422.759Âµs
2025/11/25 13:26:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":49,"userId":37}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000392] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42010 - 302 56B in 766.328Âµs
2025/11/25 13:26:05 INFO {"audit_event":"created_auth_code","details":{"clientId":49,"codeId":34,"userId":37}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000393] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42024 - 302 217B in 373.866Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":34}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000394] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42030 - 200 4202B in 11.380343ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000395] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:42040 - 200 698B in 408.682Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":50}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000396] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42052 - 200 1168B in 3.960994ms
2025/11/25 13:26:05 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-lvfSWINi","userId":37}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000397] "PUT http://localhost:19090/api/v1/admin/users/37/password HTTP/1.1" from [::1]:42066 - 200 698B in 36.554018ms
2025/11/25 13:26:05 INFO {"audit_event":"disabled_otp","details":{"userId":37}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000398] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:42076 - 200 698B in 36.37525ms
--- PASS: TestAPIAccountOTPPut_Disable_SetsSessionFlag (0.21s)
=== RUN   TestAPIAccountOTPPut_Disable_NotEnabled
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000399] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-yRGMaEhe&redirect_uri=https%3A%2F%2Fwww.productparadigms.info%2Fuser-centric%2Fmission-critical&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=kGUoFIkO&nonce=nvfysXeL HTTP/1.1" from [::1]:42082 - 302 57B in 358.657Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000400] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42098 - 302 54B in 217.682Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000401] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42100 - 200 2955B in 308.954Âµs
2025/11/25 13:26:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":38}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000402] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42100 - 302 0B in 35.581169ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000403] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42100 - 302 57B in 430.113Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000404] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42106 - 302 60B in 414.454Âµs
2025/11/25 13:26:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":51,"userId":38}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000405] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42110 - 302 56B in 738.765Âµs
2025/11/25 13:26:05 INFO {"audit_event":"created_auth_code","details":{"clientId":51,"codeId":35,"userId":38}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000406] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42126 - 302 239B in 345.112Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":35}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000407] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42128 - 200 4201B in 11.672985ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000408] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:42134 - 200 697B in 450.02Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":52}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000409] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42140 - 200 1168B in 4.072906ms
2025/11/25 13:26:05 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-GafBNZZz","userId":38}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000410] "PUT http://localhost:19090/api/v1/admin/users/38/password HTTP/1.1" from [::1]:42146 - 200 697B in 35.922974ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000411] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:42156 - 400 80B in 35.719531ms
--- PASS: TestAPIAccountOTPPut_Disable_NotEnabled (0.20s)
=== RUN   TestAPIAccountOTPPut_UnauthorizedAndScope
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000412] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:42170 - 401 22B in 205.759Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":53}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000413] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42180 - 200 1177B in 3.936658ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000414] "PUT http://localhost:19090/api/v1/account/otp HTTP/1.1" from [::1]:42186 - 403 19B in 503.23Âµs
--- PASS: TestAPIAccountOTPPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPasswordPut_Success
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000415] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-TUabHQks&redirect_uri=http%3A%2F%2Fwww.directmaximize.net%2Fmonetize%2Fe-markets&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=XYsyZkQW&nonce=vWbyHVdn HTTP/1.1" from [::1]:42192 - 302 57B in 353.598Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000416] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42194 - 302 54B in 337.788Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000417] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42200 - 200 2955B in 487.481Âµs
2025/11/25 13:26:05 INFO {"audit_event":"auth_success_pwd","details":{"userId":39}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000418] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42200 - 302 0B in 35.707719ms
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000419] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42200 - 302 57B in 633.477Âµs
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000420] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42206 - 302 60B in 329.653Âµs
2025/11/25 13:26:05 INFO {"audit_event":"started_new_user_session","details":{"clientId":54,"userId":39}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000421] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42220 - 302 56B in 739.347Âµs
2025/11/25 13:26:05 INFO {"audit_event":"created_auth_code","details":{"clientId":54,"codeId":36,"userId":39}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000422] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42230 - 302 224B in 378.004Âµs
2025/11/25 13:26:05 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":36}}
2025/11/25 13:26:05 [a357f2e3b56e/FBsnpuLk6O-000423] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42238 - 200 4205B in 11.475963ms
2025/11/25 13:26:06 INFO {"audit_event":"changed_password","details":{"loggedInUser":"d8a3bab2-8970-4ddb-9e8d-fff92261b50f","userId":39}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000424] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42240 - 200 700B in 70.217753ms
--- PASS: TestAPIAccountPasswordPut_Success (0.23s)
=== RUN   TestAPIAccountPasswordPut_WrongCurrentPassword
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000425] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-BebOdrKG&redirect_uri=https%3A%2F%2Fwww.districtmatrix.io%2Fproductize%2Fcustomized%2Fembrace%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=JymQkIug&nonce=fdgiADkD HTTP/1.1" from [::1]:42250 - 302 57B in 695.865Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000426] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42266 - 302 54B in 273.988Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000427] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42272 - 200 2955B in 587.069Âµs
2025/11/25 13:26:06 INFO {"audit_event":"auth_success_pwd","details":{"userId":40}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000428] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42272 - 302 0B in 36.99992ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000429] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42272 - 302 57B in 393.153Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000430] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42286 - 302 60B in 483.704Âµs
2025/11/25 13:26:06 INFO {"audit_event":"started_new_user_session","details":{"clientId":55,"userId":40}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000431] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42296 - 302 56B in 1.162787ms
2025/11/25 13:26:06 INFO {"audit_event":"created_auth_code","details":{"clientId":55,"codeId":37,"userId":40}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000432] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42304 - 302 243B in 481.81Âµs
2025/11/25 13:26:06 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":37}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000433] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42310 - 200 4206B in 11.350846ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000434] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42318 - 400 121B in 38.557964ms
--- PASS: TestAPIAccountPasswordPut_WrongCurrentPassword (0.17s)
=== RUN   TestAPIAccountPasswordPut_ValidationErrors
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000435] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-TksHEKPC&redirect_uri=https%3A%2F%2Fwww.investorrich.org%2F24-7%2Fglobal&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=pZjJvCXN&nonce=vyspOFOC HTTP/1.1" from [::1]:42328 - 302 57B in 566.14Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000436] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42334 - 302 54B in 413.832Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000437] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42340 - 200 2955B in 331.777Âµs
2025/11/25 13:26:06 INFO {"audit_event":"auth_success_pwd","details":{"userId":41}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000438] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42340 - 302 0B in 35.762903ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000439] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42340 - 302 57B in 401.93Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000440] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42356 - 302 60B in 378.065Âµs
2025/11/25 13:26:06 INFO {"audit_event":"started_new_user_session","details":{"clientId":56,"userId":41}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000441] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42368 - 302 56B in 742.764Âµs
2025/11/25 13:26:06 INFO {"audit_event":"created_auth_code","details":{"clientId":56,"codeId":38,"userId":41}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000442] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42372 - 302 216B in 327.589Âµs
2025/11/25 13:26:06 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":38}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000443] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42386 - 200 4205B in 11.526449ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000444] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42388 - 400 89B in 539.118Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000445] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42394 - 400 77B in 525.733Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000446] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42398 - 400 102B in 35.577833ms
--- PASS: TestAPIAccountPasswordPut_ValidationErrors (0.16s)
=== RUN   TestAPIAccountPasswordPut_UnauthorizedAndScope
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000447] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42410 - 401 22B in 246.095Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000448] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42424 - 401 22B in 190.771Âµs
2025/11/25 13:26:06 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":57}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000449] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42432 - 200 1177B in 3.930436ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000450] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42446 - 403 19B in 244.943Âµs
--- PASS: TestAPIAccountPasswordPut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPasswordPut_InvalidRequestBody
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000451] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-oJumLdLw&redirect_uri=http%3A%2F%2Fwww.regionalrelationships.io%2Finnovative&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=rFjDvxqT&nonce=FIwclRWP HTTP/1.1" from [::1]:42456 - 302 57B in 681.939Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000452] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42466 - 302 54B in 228.482Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000453] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42468 - 200 2955B in 271.713Âµs
2025/11/25 13:26:06 INFO {"audit_event":"auth_success_pwd","details":{"userId":42}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000454] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42468 - 302 0B in 36.033634ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000455] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42468 - 302 57B in 454.448Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000456] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42472 - 302 60B in 402.66Âµs
2025/11/25 13:26:06 INFO {"audit_event":"started_new_user_session","details":{"clientId":58,"userId":42}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000457] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42474 - 302 56B in 1.606045ms
2025/11/25 13:26:06 INFO {"audit_event":"created_auth_code","details":{"clientId":58,"codeId":39,"userId":42}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000458] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42488 - 302 222B in 402.761Âµs
2025/11/25 13:26:06 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":39}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000459] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42504 - 200 4205B in 11.386745ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000460] "PUT http://localhost:19090/api/v1/account/password HTTP/1.1" from [::1]:42508 - 400 75B in 569.466Âµs
--- PASS: TestAPIAccountPasswordPut_InvalidRequestBody (0.09s)
=== RUN   TestAPIAccountPhonePut_Success
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000461] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-zPnRSdHA&redirect_uri=https%3A%2F%2Fwww.nationalenterprise.info%2Frepurpose%2Fdrive%2Fe-commerce%2Fcutting-edge&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=GLKevBae&nonce=cgSfOuNO HTTP/1.1" from [::1]:42522 - 302 57B in 412.499Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000462] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42524 - 302 54B in 208.023Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000463] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42526 - 200 2955B in 291.07Âµs
2025/11/25 13:26:06 INFO {"audit_event":"auth_success_pwd","details":{"userId":43}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000464] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42526 - 302 0B in 35.621134ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000465] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42526 - 302 57B in 264.821Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000466] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42540 - 302 60B in 321.849Âµs
2025/11/25 13:26:06 INFO {"audit_event":"started_new_user_session","details":{"clientId":59,"userId":43}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000467] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42550 - 302 56B in 650.97Âµs
2025/11/25 13:26:06 INFO {"audit_event":"created_auth_code","details":{"clientId":59,"codeId":40,"userId":43}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000468] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42564 - 302 251B in 320.997Âµs
2025/11/25 13:26:06 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":40}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000469] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42572 - 200 4208B in 11.275244ms
2025/11/25 13:26:06 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"85c6bc36-7091-402d-b57b-3fa0a52161ee","userId":43}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000470] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42588 - 200 721B in 130.522636ms
--- PASS: TestAPIAccountPhonePut_Success (0.22s)
=== RUN   TestAPIAccountPhonePut_ClearPhone
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000471] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-PHQOzPSk&redirect_uri=https%3A%2F%2Fwww.corporateharness.io%2Faggregate%2Fholistic%2Frevolutionary%2Fmarkets&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=cRBCCzmx&nonce=pIVuKQsu HTTP/1.1" from [::1]:42596 - 302 57B in 665.698Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000472] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42598 - 302 54B in 529.029Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000473] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42606 - 200 2955B in 552.574Âµs
2025/11/25 13:26:06 INFO {"audit_event":"auth_success_pwd","details":{"userId":44}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000474] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42606 - 302 0B in 37.07425ms
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000475] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42606 - 302 57B in 393.453Âµs
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000476] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42618 - 302 60B in 444.63Âµs
2025/11/25 13:26:06 INFO {"audit_event":"started_new_user_session","details":{"clientId":60,"userId":44}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000477] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42624 - 302 56B in 1.345993ms
2025/11/25 13:26:06 INFO {"audit_event":"created_auth_code","details":{"clientId":60,"codeId":41,"userId":44}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000478] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42640 - 302 248B in 343.629Âµs
2025/11/25 13:26:06 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":41}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000479] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42642 - 200 4201B in 11.198629ms
2025/11/25 13:26:06 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"7fa79eff-7452-445e-b223-205d3007690c","userId":44}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000480] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42654 - 200 716B in 129.883489ms
2025/11/25 13:26:06 INFO {"audit_event":"updated_own_phone","details":{"loggedInUser":"7fa79eff-7452-445e-b223-205d3007690c","userId":44}}
2025/11/25 13:26:06 [a357f2e3b56e/FBsnpuLk6O-000481] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42656 - 200 697B in 697.448Âµs
--- PASS: TestAPIAccountPhonePut_ClearPhone (0.22s)
=== RUN   TestAPIAccountPhonePut_ValidationErrors
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000482] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-bxeaChNn&redirect_uri=https%3A%2F%2Fwww.nationaluser-centric.biz%2Fcommunities%2Ftarget%2Forchestrate%2Fsolutions&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=thmWPAEj&nonce=vDhOrkNn HTTP/1.1" from [::1]:42662 - 302 57B in 669.505Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000483] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42666 - 302 54B in 397.271Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000484] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42678 - 200 2955B in 984.861Âµs
2025/11/25 13:26:07 INFO {"audit_event":"auth_success_pwd","details":{"userId":45}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000485] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42678 - 302 0B in 36.117904ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000486] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42678 - 302 57B in 615.092Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000487] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42694 - 302 60B in 362.445Âµs
2025/11/25 13:26:07 INFO {"audit_event":"started_new_user_session","details":{"clientId":61,"userId":45}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000488] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42708 - 302 56B in 1.035988ms
2025/11/25 13:26:07 INFO {"audit_event":"created_auth_code","details":{"clientId":61,"codeId":42,"userId":45}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000489] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42716 - 302 253B in 637.996Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":42}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000490] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42730 - 200 4210B in 11.714514ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000491] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42746 - 400 99B in 415.946Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000492] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42760 - 400 266B in 65.558049ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000493] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42768 - 400 99B in 64.484561ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000494] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42780 - 400 114B in 70.113216ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000495] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42796 - 400 174B in 68.973332ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000496] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42812 - 400 76B in 66.003921ms
--- PASS: TestAPIAccountPhonePut_ValidationErrors (0.43s)
=== RUN   TestAPIAccountPhonePut_UnauthorizedAndScope
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000497] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42826 - 401 22B in 155.263Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000498] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42830 - 401 22B in 250.183Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":62}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000499] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42840 - 200 1177B in 4.061374ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000500] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42842 - 403 19B in 583.172Âµs
--- PASS: TestAPIAccountPhonePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountPhonePut_InvalidRequestBody
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000501] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-WmGPamrh&redirect_uri=http%3A%2F%2Fwww.corporateportals.biz%2Finfrastructures%2Fmarkets&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=yGjgbBDb&nonce=dqJUFqqg HTTP/1.1" from [::1]:42846 - 302 57B in 719.52Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000502] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42860 - 302 54B in 405.786Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000503] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42870 - 200 2955B in 510.796Âµs
2025/11/25 13:26:07 INFO {"audit_event":"auth_success_pwd","details":{"userId":46}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000504] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42870 - 302 0B in 36.806274ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000505] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42870 - 302 57B in 396.72Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000506] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42886 - 302 60B in 458.977Âµs
2025/11/25 13:26:07 INFO {"audit_event":"started_new_user_session","details":{"clientId":63,"userId":46}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000507] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42890 - 302 56B in 1.251495ms
2025/11/25 13:26:07 INFO {"audit_event":"created_auth_code","details":{"clientId":63,"codeId":43,"userId":46}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000508] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42906 - 302 231B in 605.985Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":43}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000509] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42914 - 200 4208B in 11.850802ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000510] "PUT http://localhost:19090/api/v1/account/phone HTTP/1.1" from [::1]:42916 - 400 75B in 418.772Âµs
--- PASS: TestAPIAccountPhonePut_InvalidRequestBody (0.09s)
=== RUN   TestAPIAccountProfileGet_Success
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000511] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-vUWiZToM&redirect_uri=http%3A%2F%2Fwww.dynamiccollaborative.net%2Fweb-enabled%2Fcommunities%2Fdot-com&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=TYfzBynY&nonce=MXQgarWs HTTP/1.1" from [::1]:42924 - 302 57B in 681.217Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000512] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:42928 - 302 54B in 398.213Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000513] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42942 - 200 2955B in 336.526Âµs
2025/11/25 13:26:07 INFO {"audit_event":"auth_success_pwd","details":{"userId":47}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000514] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:42942 - 302 0B in 36.387111ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000515] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:42942 - 302 57B in 250.674Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000516] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:42946 - 302 60B in 272.565Âµs
2025/11/25 13:26:07 INFO {"audit_event":"started_new_user_session","details":{"clientId":64,"userId":47}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000517] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:42950 - 302 56B in 725.311Âµs
2025/11/25 13:26:07 INFO {"audit_event":"created_auth_code","details":{"clientId":64,"codeId":44,"userId":47}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000518] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:42966 - 302 243B in 402.741Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":44}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000519] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:42970 - 200 4202B in 11.253453ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000520] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:42976 - 200 696B in 409.043Âµs
--- PASS: TestAPIAccountProfileGet_Success (0.09s)
=== RUN   TestAPIAccountProfileGet_UnauthorizedAndScope
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000521] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:42992 - 401 22B in 81.805Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000522] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:42996 - 401 22B in 206.7Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":65}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000523] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43004 - 200 1177B in 3.954362ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000524] "GET http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43016 - 403 19B in 292.002Âµs
--- PASS: TestAPIAccountProfileGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountProfilePut_Success
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000525] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-bGsmaQOg&redirect_uri=https%3A%2F%2Fwww.internationalfacilitate.net%2Fmesh%2Fvertical%2Fsticky%2Frevolutionary&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=wWVPTiHL&nonce=NSNsZqvO HTTP/1.1" from [::1]:43030 - 302 57B in 581.388Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000526] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43046 - 302 54B in 207.813Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000527] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43050 - 200 2955B in 542.836Âµs
2025/11/25 13:26:07 INFO {"audit_event":"auth_success_pwd","details":{"userId":48}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000528] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43050 - 302 0B in 35.397402ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000529] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43050 - 302 57B in 601.166Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000530] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43066 - 302 60B in 273.286Âµs
2025/11/25 13:26:07 INFO {"audit_event":"started_new_user_session","details":{"clientId":66,"userId":48}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000531] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43074 - 302 56B in 644.157Âµs
2025/11/25 13:26:07 INFO {"audit_event":"created_auth_code","details":{"clientId":66,"codeId":45,"userId":48}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000532] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43086 - 302 250B in 369.569Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":45}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000533] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43098 - 200 4202B in 11.448161ms
2025/11/25 13:26:07 INFO {"audit_event":"updated_own_profile","details":{"loggedInUser":"18c049a7-c6b3-4618-af05-583693ecb6a8","userId":48}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000534] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43114 - 200 800B in 1.894329ms
--- PASS: TestAPIAccountProfilePut_Success (0.09s)
=== RUN   TestAPIAccountProfilePut_ValidationErrors
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000535] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-ySbIeosv&redirect_uri=https%3A%2F%2Fwww.humanstrategic.info%2Ftransparent%2Fsystems%2Fharness%2Fbenchmark&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=eQIGgOaH&nonce=ergmYwji HTTP/1.1" from [::1]:43130 - 302 57B in 645.68Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000536] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43132 - 302 54B in 181.694Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000537] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43146 - 200 2955B in 414.914Âµs
2025/11/25 13:26:07 INFO {"audit_event":"auth_success_pwd","details":{"userId":49}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000538] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43146 - 302 0B in 35.090933ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000539] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43146 - 302 57B in 866.106Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000540] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43158 - 302 60B in 315.477Âµs
2025/11/25 13:26:07 INFO {"audit_event":"started_new_user_session","details":{"clientId":67,"userId":49}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000541] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43174 - 302 56B in 610.805Âµs
2025/11/25 13:26:07 INFO {"audit_event":"created_auth_code","details":{"clientId":67,"codeId":46,"userId":49}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000542] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43186 - 302 245B in 383.074Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":46}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000543] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43190 - 200 4209B in 11.56946ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000544] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43192 - 400 69B in 1.813577ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000545] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43200 - 400 114B in 1.265151ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000546] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43216 - 400 76B in 1.044984ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000547] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43226 - 400 73B in 1.215196ms
--- PASS: TestAPIAccountProfilePut_ValidationErrors (0.09s)
=== RUN   TestAPIAccountProfilePut_UnauthorizedAndScope
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000548] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43232 - 401 22B in 139.003Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":68}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000549] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43240 - 200 1177B in 4.513448ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000550] "PUT http://localhost:19090/api/v1/account/profile HTTP/1.1" from [::1]:43252 - 403 19B in 313.923Âµs
--- PASS: TestAPIAccountProfilePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountSessionsGet_Success_IncludesIsCurrent
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000551] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-VXGzZhzh&redirect_uri=https%3A%2F%2Fwww.humancompelling.name%2Foptimize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=CkFHXGOe&nonce=OSdBJrKT HTTP/1.1" from [::1]:43266 - 302 57B in 499.043Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000552] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43272 - 302 54B in 207.222Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000553] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43280 - 200 2955B in 391.099Âµs
2025/11/25 13:26:07 INFO {"audit_event":"auth_success_pwd","details":{"userId":50}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000554] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43280 - 302 0B in 35.611106ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000555] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43280 - 302 57B in 248.339Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000556] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43282 - 302 60B in 571.589Âµs
2025/11/25 13:26:07 INFO {"audit_event":"started_new_user_session","details":{"clientId":69,"userId":50}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000557] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43294 - 302 56B in 677.27Âµs
2025/11/25 13:26:07 INFO {"audit_event":"created_auth_code","details":{"clientId":69,"codeId":47,"userId":50}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000558] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43306 - 302 217B in 659.105Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":47}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000559] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43316 - 200 4202B in 11.267529ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000560] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43326 - 200 2208B in 669.605Âµs
--- PASS: TestAPIAccountSessionsGet_Success_IncludesIsCurrent (0.09s)
=== RUN   TestAPIAccountSessionsGet_OnlyValidSessions
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000561] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-wrawRWrk&redirect_uri=http%3A%2F%2Fwww.globalscalable.io%2Fdeploy&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=KCsISUoK&nonce=CQUCwUJd HTTP/1.1" from [::1]:43334 - 302 57B in 507.379Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000562] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43338 - 302 54B in 211.179Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000563] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43346 - 200 2955B in 265.11Âµs
2025/11/25 13:26:07 INFO {"audit_event":"auth_success_pwd","details":{"userId":51}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000564] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43346 - 302 0B in 35.198085ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000565] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43346 - 302 57B in 506.938Âµs
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000566] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43348 - 302 60B in 320.806Âµs
2025/11/25 13:26:07 INFO {"audit_event":"started_new_user_session","details":{"clientId":71,"userId":51}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000567] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43352 - 302 56B in 693.931Âµs
2025/11/25 13:26:07 INFO {"audit_event":"created_auth_code","details":{"clientId":71,"codeId":48,"userId":51}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000568] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43366 - 302 211B in 720.001Âµs
2025/11/25 13:26:07 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":48}}
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000569] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43372 - 200 4206B in 11.391804ms
2025/11/25 13:26:07 [a357f2e3b56e/FBsnpuLk6O-000570] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43382 - 200 1451B in 639.398Âµs
--- PASS: TestAPIAccountSessionsGet_OnlyValidSessions (0.09s)
=== RUN   TestAPIAccountSessionDelete_Success
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000571] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-XXYsMIrf&redirect_uri=http%3A%2F%2Fwww.customerkiller.biz%2Fdot-com%2Fgranular%2Fmonetize&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=vwJIhgyl&nonce=DhkSzXdl HTTP/1.1" from [::1]:43386 - 302 57B in 925.679Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000572] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43396 - 302 54B in 298.374Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000573] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43410 - 200 2955B in 392.241Âµs
2025/11/25 13:26:08 INFO {"audit_event":"auth_success_pwd","details":{"userId":52}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000574] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43410 - 302 0B in 36.019817ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000575] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43410 - 302 57B in 374.578Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000576] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43420 - 302 60B in 371.802Âµs
2025/11/25 13:26:08 INFO {"audit_event":"started_new_user_session","details":{"clientId":72,"userId":52}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000577] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43422 - 302 56B in 758.714Âµs
2025/11/25 13:26:08 INFO {"audit_event":"created_auth_code","details":{"clientId":72,"codeId":49,"userId":52}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000578] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43426 - 302 231B in 703.88Âµs
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":49}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000579] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43432 - 200 4198B in 11.47395ms
2025/11/25 13:26:08 INFO {"audit_event":"deleted_user_session","details":{"loggedInUser":"","userSessionId":54}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000580] "DELETE http://localhost:19090/api/v1/account/sessions/54 HTTP/1.1" from [::1]:43440 - 200 17B in 476.17Âµs
--- PASS: TestAPIAccountSessionDelete_Success (0.09s)
=== RUN   TestAPIAccountSessionDelete_ForbiddenOnOtherUsersSession
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000581] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-KuznzLnq&redirect_uri=http%3A%2F%2Fwww.legacyreinvent.biz%2Fbleeding-edge%2Finnovative&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=AmBVjwzZ&nonce=ywJTtDqw HTTP/1.1" from [::1]:43444 - 302 57B in 627.946Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000582] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43452 - 302 54B in 400.837Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000583] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43460 - 200 2955B in 341.485Âµs
2025/11/25 13:26:08 INFO {"audit_event":"auth_success_pwd","details":{"userId":53}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000584] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43460 - 302 0B in 37.133532ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000585] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43460 - 302 57B in 483.123Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000586] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43472 - 302 60B in 1.059351ms
2025/11/25 13:26:08 INFO {"audit_event":"started_new_user_session","details":{"clientId":73,"userId":53}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000587] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43488 - 302 56B in 696.686Âµs
2025/11/25 13:26:08 INFO {"audit_event":"created_auth_code","details":{"clientId":73,"codeId":50,"userId":53}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000588] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43490 - 302 230B in 432.327Âµs
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":50}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000589] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43502 - 200 4201B in 11.343914ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000590] "DELETE http://localhost:19090/api/v1/account/sessions/56 HTTP/1.1" from [::1]:43516 - 403 53B in 467.173Âµs
--- PASS: TestAPIAccountSessionDelete_ForbiddenOnOtherUsersSession (0.09s)
=== RUN   TestAPIAccountSessions_UnauthorizedAndScope
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000591] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43524 - 401 22B in 123.053Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000592] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43526 - 401 22B in 165.953Âµs
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":74}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000593] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43540 - 200 1177B in 3.999958ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000594] "GET http://localhost:19090/api/v1/account/sessions HTTP/1.1" from [::1]:43546 - 403 19B in 259.922Âµs
--- PASS: TestAPIAccountSessions_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIAccountSessionDelete_UnauthorizedAndInvalidId
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000595] "DELETE http://localhost:19090/api/v1/account/sessions/123 HTTP/1.1" from [::1]:43556 - 401 22B in 125.678Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000596] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-dsGmXaes&redirect_uri=https%3A%2F%2Fwww.corporatereal-time.net%2Fiterate%2Fvertical%2Fgrow%2Frobust&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=nWgsvhwt&nonce=aemqtCMW HTTP/1.1" from [::1]:43560 - 302 57B in 590.546Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000597] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43568 - 302 54B in 334.021Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000598] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43584 - 200 2955B in 284.237Âµs
2025/11/25 13:26:08 INFO {"audit_event":"auth_success_pwd","details":{"userId":55}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000599] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43584 - 302 0B in 35.320135ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000600] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43584 - 302 57B in 450.712Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000601] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43598 - 302 60B in 309.976Âµs
2025/11/25 13:26:08 INFO {"audit_event":"started_new_user_session","details":{"clientId":75,"userId":55}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000602] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43604 - 302 56B in 636.603Âµs
2025/11/25 13:26:08 INFO {"audit_event":"created_auth_code","details":{"clientId":75,"codeId":51,"userId":55}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000603] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43606 - 302 239B in 377.193Âµs
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":51}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000604] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43608 - 200 4198B in 11.250648ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000605] "DELETE http://localhost:19090/api/v1/account/sessions/abc HTTP/1.1" from [::1]:43612 - 400 86B in 276.933Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000606] "DELETE http://localhost:19090/api/v1/account/sessions/-1 HTTP/1.1" from [::1]:43618 - 400 86B in 257.136Âµs
--- PASS: TestAPIAccountSessionDelete_UnauthorizedAndInvalidId (0.09s)
=== RUN   TestAPIAccountSessionDelete_NotFound
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000607] "GET http://localhost:19090/auth/authorize/?client_id=acctscope-client-eonoMzXx&redirect_uri=https%3A%2F%2Fwww.forwardvisualize.info%2Fscalable%2Ftransparent%2Fsynergize%2Fscale&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+authserver%3Amanage-account&state=tvmlbesx&nonce=hoyOMmeR HTTP/1.1" from [::1]:43626 - 302 57B in 794.06Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000608] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:43642 - 302 54B in 199.477Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000609] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43658 - 200 2955B in 285.599Âµs
2025/11/25 13:26:08 INFO {"audit_event":"auth_success_pwd","details":{"userId":56}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000610] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:43658 - 302 0B in 35.270302ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000611] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:43658 - 302 57B in 1.131668ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000612] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:43670 - 302 60B in 327.178Âµs
2025/11/25 13:26:08 INFO {"audit_event":"started_new_user_session","details":{"clientId":76,"userId":56}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000613] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:43674 - 302 56B in 646.902Âµs
2025/11/25 13:26:08 INFO {"audit_event":"created_auth_code","details":{"clientId":76,"codeId":52,"userId":56}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000614] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:43676 - 302 246B in 333.971Âµs
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":52}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000615] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43682 - 200 4209B in 11.330759ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000616] "DELETE http://localhost:19090/api/v1/account/sessions/99999999 HTTP/1.1" from [::1]:43692 - 404 79B in 317.409Âµs
--- PASS: TestAPIAccountSessionDelete_NotFound (0.09s)
=== RUN   TestAPIClientPermissions_Get_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":77}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000617] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43694 - 200 1168B in 3.907433ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000618] "GET http://localhost:19090/api/v1/admin/clients/78/permissions HTTP/1.1" from [::1]:43708 - 200 728B in 440.001Âµs
--- PASS: TestAPIClientPermissions_Get_Success (0.01s)
=== RUN   TestAPIClientPermissions_Get_Errors
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":79}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000619] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43710 - 200 1168B in 3.906862ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000620] "GET http://localhost:19090/api/v1/admin/clients/abc/permissions HTTP/1.1" from [::1]:43722 - 400 75B in 556.06Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000621] "GET http://localhost:19090/api/v1/admin/clients/9999999/permissions HTTP/1.1" from [::1]:43732 - 404 60B in 327.088Âµs
--- PASS: TestAPIClientPermissions_Get_Errors (0.01s)
=== RUN   TestAPIClientPermissions_Put_AddRemove
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":80}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000622] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43746 - 200 1168B in 4.12813ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_permissions","details":{"clientId":81,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000623] "PUT http://localhost:19090/api/v1/admin/clients/81/permissions HTTP/1.1" from [::1]:43754 - 200 17B in 398.753Âµs
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_permissions","details":{"clientId":81,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000624] "PUT http://localhost:19090/api/v1/admin/clients/81/permissions HTTP/1.1" from [::1]:43760 - 200 17B in 401.158Âµs
--- PASS: TestAPIClientPermissions_Put_AddRemove (0.01s)
=== RUN   TestAPIClientPermissions_Put_Idempotent
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":82}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000625] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43770 - 200 1168B in 3.909828ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_permissions","details":{"clientId":83,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000626] "PUT http://localhost:19090/api/v1/admin/clients/83/permissions HTTP/1.1" from [::1]:43784 - 200 17B in 371.903Âµs
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_permissions","details":{"clientId":83,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000627] "PUT http://localhost:19090/api/v1/admin/clients/83/permissions HTTP/1.1" from [::1]:43798 - 200 17B in 386.19Âµs
--- PASS: TestAPIClientPermissions_Put_Idempotent (0.01s)
=== RUN   TestAPIClientPermissions_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000628] "GET http://localhost:19090/api/v1/admin/clients/84/permissions HTTP/1.1" from [::1]:43802 - 401 22B in 109.136Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000629] "PUT http://localhost:19090/api/v1/admin/clients/84/permissions HTTP/1.1" from [::1]:43802 - 401 22B in 64.272Âµs
--- PASS: TestAPIClientPermissions_Unauthorized (0.00s)
=== RUN   TestAPIClientPermissions_Put_ClientCredentialsDisabled
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":85}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000630] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43806 - 200 1168B in 3.848582ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000631] "PUT http://localhost:19090/api/v1/admin/clients/86/permissions HTTP/1.1" from [::1]:43814 - 400 132B in 305.798Âµs
--- PASS: TestAPIClientPermissions_Put_ClientCredentialsDisabled (0.00s)
=== RUN   TestAPIClientPermissions_Put_SystemLevelRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":87}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000632] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43820 - 200 1168B in 3.922081ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000633] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43826 - 200 52886B in 3.062206ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000634] "PUT http://localhost:19090/api/v1/admin/clients/1/permissions HTTP/1.1" from [::1]:43830 - 400 87B in 351.444Âµs
--- PASS: TestAPIClientPermissions_Put_SystemLevelRejected (0.01s)
=== RUN   TestAPIClientPermissions_Put_PermissionNotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":88}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000635] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43842 - 200 1168B in 3.983407ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000636] "PUT http://localhost:19090/api/v1/admin/clients/89/permissions HTTP/1.1" from [::1]:43848 - 404 64B in 374.298Âµs
--- PASS: TestAPIClientPermissions_Put_PermissionNotFound (0.01s)
=== RUN   TestAPIClientPermissions_Put_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":90}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000637] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43858 - 200 1172B in 3.943391ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000638] "PUT http://localhost:19090/api/v1/admin/clients/91/permissions HTTP/1.1" from [::1]:43866 - 403 19B in 283.786Âµs
--- PASS: TestAPIClientPermissions_Put_InsufficientScope (0.00s)
=== RUN   TestAPIClientAuthenticationPut_ConfidentialToPublic_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":92}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000639] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43874 - 200 1168B in 3.867367ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_authentication","details":{"clientId":93,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000640] "PUT http://localhost:19090/api/v1/admin/clients/93/authentication HTTP/1.1" from [::1]:43880 - 200 560B in 922.713Âµs
--- PASS: TestAPIClientAuthenticationPut_ConfidentialToPublic_Success (0.01s)
=== RUN   TestAPIClientAuthenticationPut_PublicToConfidential_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":94}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000641] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43884 - 200 1168B in 4.088655ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_authentication","details":{"clientId":95,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000642] "PUT http://localhost:19090/api/v1/admin/clients/95/authentication HTTP/1.1" from [::1]:43890 - 200 559B in 487.852Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000643] "GET http://localhost:19090/api/v1/admin/clients/95 HTTP/1.1" from [::1]:43902 - 200 637B in 330.755Âµs
--- PASS: TestAPIClientAuthenticationPut_PublicToConfidential_Success (0.01s)
=== RUN   TestAPIClientAuthenticationPut_InvalidSecret_TooShort
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":96}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000644] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43906 - 200 1168B in 4.056926ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000645] "PUT http://localhost:19090/api/v1/admin/clients/97/authentication HTTP/1.1" from [::1]:43910 - 400 100B in 320.465Âµs
--- PASS: TestAPIClientAuthenticationPut_InvalidSecret_TooShort (0.01s)
=== RUN   TestAPIClientAuthenticationPut_InvalidSecret_BadChars
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":98}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000646] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43920 - 200 1168B in 4.004556ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000647] "PUT http://localhost:19090/api/v1/admin/clients/99/authentication HTTP/1.1" from [::1]:43934 - 400 100B in 290.849Âµs
--- PASS: TestAPIClientAuthenticationPut_InvalidSecret_BadChars (0.01s)
=== RUN   TestAPIClientAuthenticationPut_NotFoundAndInvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":100}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000648] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43946 - 200 1168B in 3.914887ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000649] "PUT http://localhost:19090/api/v1/admin/clients/999999/authentication HTTP/1.1" from [::1]:43960 - 404 60B in 288.845Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000650] "PUT http://localhost:19090/api/v1/admin/clients/abc/authentication HTTP/1.1" from [::1]:43972 - 400 68B in 275.721Âµs
--- PASS: TestAPIClientAuthenticationPut_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientAuthenticationPut_SystemLevelClientRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":101}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000651] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:43980 - 200 1168B in 3.853471ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000652] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:43988 - 200 56759B in 2.692838ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000653] "PUT http://localhost:19090/api/v1/admin/clients/1/authentication HTTP/1.1" from [::1]:43998 - 400 87B in 412.67Âµs
--- PASS: TestAPIClientAuthenticationPut_SystemLevelClientRejected (0.01s)
=== RUN   TestAPIClientAuthenticationPut_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":102}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000654] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44002 - 200 1166B in 4.346803ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000655] "PUT http://localhost:19090/api/v1/admin/clients/103/authentication HTTP/1.1" from [::1]:44006 - 403 19B in 318.532Âµs
--- PASS: TestAPIClientAuthenticationPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientCreate_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":104}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000656] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44008 - 200 1168B in 3.931488ms
2025/11/25 13:26:08 INFO {"audit_event":"created_client","details":{"clientId":105,"clientIdentifier":"client-qhucbbsm","loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000657] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44022 - 201 600B in 435.123Âµs
--- PASS: TestAPIClientCreate_Success (0.00s)
=== RUN   TestAPIClientCreate_Validation
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":106}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000658] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44028 - 200 1168B in 3.901331ms
=== RUN   TestAPIClientCreate_Validation/Empty_client_identifier
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000659] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44042 - 400 81B in 244.782Âµs
=== RUN   TestAPIClientCreate_Validation/Client_identifier_too_short
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000660] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44044 - 400 101B in 242.348Âµs
=== RUN   TestAPIClientCreate_Validation/Client_identifier_too_long
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000661] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44050 - 400 114B in 272.906Âµs
=== RUN   TestAPIClientCreate_Validation/Invalid_client_identifier_characters
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000662] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44066 - 400 250B in 277.975Âµs
=== RUN   TestAPIClientCreate_Validation/Description_too_long
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000663] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44068 - 400 116B in 487.712Âµs
--- PASS: TestAPIClientCreate_Validation (0.01s)
    --- PASS: TestAPIClientCreate_Validation/Empty_client_identifier (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Client_identifier_too_short (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Client_identifier_too_long (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Invalid_client_identifier_characters (0.00s)
    --- PASS: TestAPIClientCreate_Validation/Description_too_long (0.00s)
=== RUN   TestAPIClientCreate_Duplicate
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":107}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000664] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44074 - 200 1168B in 3.868489ms
2025/11/25 13:26:08 INFO {"audit_event":"created_client","details":{"clientId":108,"clientIdentifier":"client-kuabtzlg","loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000665] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44080 - 201 595B in 418.952Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000666] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44092 - 400 91B in 287.233Âµs
--- PASS: TestAPIClientCreate_Duplicate (0.01s)
=== RUN   TestAPIClientCreate_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000667] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44100 - 401 22B in 59.162Âµs
--- PASS: TestAPIClientCreate_Unauthorized (0.00s)
=== RUN   TestAPIClientCreate_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":109}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000668] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44116 - 200 1169B in 3.825949ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000669] "POST http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44130 - 403 19B in 253.499Âµs
--- PASS: TestAPIClientCreate_InsufficientScope (0.00s)
=== RUN   TestAPIClientDelete_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":110}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000670] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44134 - 200 1168B in 3.910088ms
2025/11/25 13:26:08 INFO {"audit_event":"deleted_client","details":{"clientId":111,"clientIdentifier":"del-client-FxOzSoOG","loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000671] "DELETE http://localhost:19090/api/v1/admin/clients/111 HTTP/1.1" from [::1]:44148 - 200 17B in 954.684Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000672] "GET http://localhost:19090/api/v1/admin/clients/111 HTTP/1.1" from [::1]:44164 - 404 60B in 328.14Âµs
--- PASS: TestAPIClientDelete_Success (0.01s)
=== RUN   TestAPIClientDelete_SystemLevelRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":112}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000673] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44170 - 200 1168B in 3.960553ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000674] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44178 - 200 61253B in 2.475497ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000675] "DELETE http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44180 - 400 89B in 328.731Âµs
--- PASS: TestAPIClientDelete_SystemLevelRejected (0.01s)
=== RUN   TestAPIClientDelete_NotFoundAndInvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":113}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000676] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44182 - 200 1168B in 3.902994ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000677] "DELETE http://localhost:19090/api/v1/admin/clients/9999999 HTTP/1.1" from [::1]:44198 - 404 60B in 372.454Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000678] "DELETE http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:44202 - 400 68B in 421.837Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000679] "DELETE http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44208 - 401 22B in 127.551Âµs
--- PASS: TestAPIClientDelete_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientGetPermissions_IncludesPermissions
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":114}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000680] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44220 - 200 1168B in 3.918013ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000681] "GET http://localhost:19090/api/v1/admin/clients/115/permissions HTTP/1.1" from [::1]:44222 - 200 730B in 437.507Âµs
--- PASS: TestAPIClientGetPermissions_IncludesPermissions (0.01s)
=== RUN   TestAPIClientDelete_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":116}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000682] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44232 - 200 1169B in 3.980421ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000683] "DELETE http://localhost:19090/api/v1/admin/clients/117 HTTP/1.1" from [::1]:44242 - 403 19B in 333.911Âµs
--- PASS: TestAPIClientDelete_InsufficientScope (0.01s)
=== RUN   TestAPIClientDelete_CascadesLinkedData
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":118}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000684] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44244 - 200 1168B in 4.067426ms
2025/11/25 13:26:08 INFO {"audit_event":"deleted_client","details":{"clientId":119,"clientIdentifier":"cascade-client-lWnCZB","loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000685] "DELETE http://localhost:19090/api/v1/admin/clients/119 HTTP/1.1" from [::1]:44258 - 200 17B in 450.291Âµs
--- PASS: TestAPIClientDelete_CascadesLinkedData (0.01s)
=== RUN   TestAPIClientGet_ConfidentialIncludesSecretInDetailButNotList
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":120}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000686] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44260 - 200 1168B in 4.460188ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000687] "GET http://localhost:19090/api/v1/admin/clients/121 HTTP/1.1" from [::1]:44276 - 200 611B in 408.753Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000688] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44288 - 200 64019B in 2.429331ms
--- PASS: TestAPIClientGet_ConfidentialIncludesSecretInDetailButNotList (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_Success_PublicClient_ForcesNoClientCredentials
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":122}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000689] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44304 - 200 1168B in 4.002903ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":123,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000690] "PUT http://localhost:19090/api/v1/admin/clients/123/oauth2-flows HTTP/1.1" from [::1]:44316 - 200 559B in 530.894Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_Success_PublicClient_ForcesNoClientCredentials (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_Success_ConfidentialClient_ToggleBoth
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":124}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000691] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44332 - 200 1168B in 4.047808ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":125,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000692] "PUT http://localhost:19090/api/v1/admin/clients/125/oauth2-flows HTTP/1.1" from [::1]:44346 - 200 558B in 506.197Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_Success_ConfidentialClient_ToggleBoth (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_SystemLevelClientRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":126}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000693] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44348 - 200 1168B in 4.054491ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000694] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44362 - 200 65131B in 2.8367ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000695] "PUT http://localhost:19090/api/v1/admin/clients/1/oauth2-flows HTTP/1.1" from [::1]:44368 - 400 87B in 882.257Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_SystemLevelClientRejected (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_NotFoundAndInvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":127}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000696] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44384 - 200 1168B in 4.095648ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000697] "PUT http://localhost:19090/api/v1/admin/clients/999999/oauth2-flows HTTP/1.1" from [::1]:44398 - 404 60B in 687.92Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000698] "PUT http://localhost:19090/api/v1/admin/clients/abc/oauth2-flows HTTP/1.1" from [::1]:44400 - 400 68B in 717.806Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_NotFoundAndInvalidId (0.03s)
=== RUN   TestAPIClientOAuth2FlowsPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":128}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000699] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44404 - 200 1168B in 6.000658ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000700] "PUT http://localhost:19090/api/v1/admin/clients/129/oauth2-flows HTTP/1.1" from [::1]:44414 - 400 70B in 546.322Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000701] "PUT http://localhost:19090/api/v1/admin/clients/129/oauth2-flows HTTP/1.1" from [::1]:44414 - 401 22B in 151.797Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":130}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000702] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44430 - 200 1168B in 5.500864ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000703] "PUT http://localhost:19090/api/v1/admin/clients/131/oauth2-flows HTTP/1.1" from [::1]:44432 - 403 19B in 341.926Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientOAuth2FlowsPut_BothDisabledAllowed
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":132}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000704] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44444 - 200 1168B in 4.100879ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_oauth2_flows","details":{"clientId":133,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000705] "PUT http://localhost:19090/api/v1/admin/clients/133/oauth2-flows HTTP/1.1" from [::1]:44450 - 200 562B in 873.07Âµs
--- PASS: TestAPIClientOAuth2FlowsPut_BothDisabledAllowed (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_Success_AddRemoveAndTrim
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":134}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000706] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44452 - 200 1168B in 5.324961ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_redirect_uris","details":{"clientId":135,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000707] "PUT http://localhost:19090/api/v1/admin/clients/135/redirect-uris HTTP/1.1" from [::1]:44458 - 200 815B in 680.857Âµs
--- PASS: TestAPIClientRedirectURIsPut_Success_AddRemoveAndTrim (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_AuthCodeDisabledRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":136}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000708] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44462 - 200 1168B in 4.03787ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000709] "PUT http://localhost:19090/api/v1/admin/clients/137/redirect-uris HTTP/1.1" from [::1]:44470 - 400 103B in 341.745Âµs
--- PASS: TestAPIClientRedirectURIsPut_AuthCodeDisabledRejected (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_SystemLevelClientRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":138}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000710] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44482 - 200 1168B in 4.002573ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000711] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44486 - 200 68455B in 2.775163ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000712] "PUT http://localhost:19090/api/v1/admin/clients/1/redirect-uris HTTP/1.1" from [::1]:44500 - 400 87B in 323.501Âµs
--- PASS: TestAPIClientRedirectURIsPut_SystemLevelClientRejected (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_DuplicateAndInvalidURLs
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":139}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000713] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44504 - 200 1168B in 3.968618ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000714] "PUT http://localhost:19090/api/v1/admin/clients/140/redirect-uris HTTP/1.1" from [::1]:44520 - 400 90B in 354.6Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000715] "PUT http://localhost:19090/api/v1/admin/clients/140/redirect-uris HTTP/1.1" from [::1]:44532 - 400 82B in 338.7Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000716] "PUT http://localhost:19090/api/v1/admin/clients/140/redirect-uris HTTP/1.1" from [::1]:44542 - 400 79B in 293.555Âµs
--- PASS: TestAPIClientRedirectURIsPut_DuplicateAndInvalidURLs (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_NotFound_InvalidId_InvalidBody_Unauthorized
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":141}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000717] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44554 - 200 1168B in 3.927701ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000718] "PUT http://localhost:19090/api/v1/admin/clients/999999/redirect-uris HTTP/1.1" from [::1]:44564 - 404 60B in 306.279Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000719] "PUT http://localhost:19090/api/v1/admin/clients/abc/redirect-uris HTTP/1.1" from [::1]:44566 - 400 68B in 284.467Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000720] "PUT http://localhost:19090/api/v1/admin/clients/142/redirect-uris HTTP/1.1" from [::1]:44568 - 400 70B in 315.346Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000721] "PUT http://localhost:19090/api/v1/admin/clients/142/redirect-uris HTTP/1.1" from [::1]:44568 - 401 22B in 61.687Âµs
--- PASS: TestAPIClientRedirectURIsPut_NotFound_InvalidId_InvalidBody_Unauthorized (0.01s)
=== RUN   TestAPIClientRedirectURIsPut_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":143}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000722] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44580 - 200 1168B in 4.373073ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000723] "PUT http://localhost:19090/api/v1/admin/clients/144/redirect-uris HTTP/1.1" from [::1]:44592 - 403 19B in 277.735Âµs
--- PASS: TestAPIClientRedirectURIsPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientSessionsGet_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":145}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000724] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44594 - 200 1168B in 3.954743ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000725] "GET http://localhost:19090/api/v1/admin/clients/146/sessions HTTP/1.1" from [::1]:44606 - 200 1489B in 543.687Âµs
--- PASS: TestAPIClientSessionsGet_Success (0.01s)
=== RUN   TestAPIClientSessionsGet_EmptySessions
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":147}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000726] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44612 - 200 1168B in 3.933783ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000727] "GET http://localhost:19090/api/v1/admin/clients/148/sessions HTTP/1.1" from [::1]:44624 - 200 16B in 401.799Âµs
--- PASS: TestAPIClientSessionsGet_EmptySessions (0.01s)
=== RUN   TestAPIClientSessionsGet_ClientNotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":149}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000728] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44628 - 200 1168B in 4.201919ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000729] "GET http://localhost:19090/api/v1/admin/clients/999999/sessions HTTP/1.1" from [::1]:44642 - 404 67B in 320.325Âµs
--- PASS: TestAPIClientSessionsGet_ClientNotFound (0.01s)
=== RUN   TestAPIClientSessionsGet_InvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":150}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000730] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44652 - 200 1168B in 3.965592ms
=== RUN   TestAPIClientSessionsGet_InvalidId/non-numeric
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000731] "GET http://localhost:19090/api/v1/admin/clients/abc/sessions HTTP/1.1" from [::1]:44660 - 400 76B in 259.891Âµs
=== RUN   TestAPIClientSessionsGet_InvalidId/negative
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000732] "GET http://localhost:19090/api/v1/admin/clients/-1/sessions HTTP/1.1" from [::1]:44676 - 404 67B in 317.981Âµs
--- PASS: TestAPIClientSessionsGet_InvalidId (0.01s)
    --- PASS: TestAPIClientSessionsGet_InvalidId/non-numeric (0.00s)
    --- PASS: TestAPIClientSessionsGet_InvalidId/negative (0.00s)
=== RUN   TestAPIClientSessionsGet_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000733] "GET http://localhost:19090/api/v1/admin/clients/151/sessions HTTP/1.1" from [::1]:44678 - 401 22B in 78.679Âµs
--- PASS: TestAPIClientSessionsGet_Unauthorized (0.00s)
=== RUN   TestAPIClientSessionsGet_OnlyValidSessions
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":152}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000734] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44680 - 200 1168B in 4.096059ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000735] "GET http://localhost:19090/api/v1/admin/clients/153/sessions HTTP/1.1" from [::1]:44686 - 200 756B in 482.982Âµs
--- PASS: TestAPIClientSessionsGet_OnlyValidSessions (0.01s)
=== RUN   TestAPIClientSessionsGet_PaginationDefaultAndCap
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":154}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000736] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44694 - 200 1168B in 3.979209ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000737] "GET http://localhost:19090/api/v1/admin/clients/155/sessions HTTP/1.1" from [::1]:44700 - 200 36622B in 2.256364ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000738] "GET http://localhost:19090/api/v1/admin/clients/155/sessions?size=200 HTTP/1.1" from [::1]:44702 - 200 73264B in 4.761487ms
--- PASS: TestAPIClientSessionsGet_PaginationDefaultAndCap (0.02s)
=== RUN   TestAPIClientsGet_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":156}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000739] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44718 - 200 1168B in 3.929344ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000740] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44732 - 200 73439B in 2.859713ms
--- PASS: TestAPIClientsGet_Success (0.01s)
=== RUN   TestAPIClientsGet_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000741] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44738 - 401 22B in 87.736Âµs
--- PASS: TestAPIClientsGet_Unauthorized (0.00s)
=== RUN   TestAPIClientGet_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":157}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000742] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44754 - 200 1168B in 3.925937ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000743] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44768 - 200 73993B in 2.727423ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000744] "GET http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44772 - 200 946B in 324.173Âµs
--- PASS: TestAPIClientGet_Success (0.01s)
=== RUN   TestAPIClientGet_NotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":158}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000745] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44786 - 200 1168B in 3.881273ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000746] "GET http://localhost:19090/api/v1/admin/clients/99999 HTTP/1.1" from [::1]:44790 - 404 60B in 314.514Âµs
--- PASS: TestAPIClientGet_NotFound (0.00s)
=== RUN   TestAPIClientGet_InvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":159}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000747] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44806 - 200 1168B in 3.877958ms
=== RUN   TestAPIClientGet_InvalidId/non-numeric_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000748] "GET http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:44814 - 400 68B in 354.46Âµs
=== RUN   TestAPIClientGet_InvalidId/negative_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000749] "GET http://localhost:19090/api/v1/admin/clients/-1 HTTP/1.1" from [::1]:44816 - 404 60B in 374.297Âµs
--- PASS: TestAPIClientGet_InvalidId (0.01s)
    --- PASS: TestAPIClientGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIClientGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIClientGet_EmptyId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":160}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000750] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44822 - 200 1168B in 4.032119ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000751] "GET http://localhost:19090/api/v1/admin/clients/ HTTP/1.1" from [::1]:44834 - 200 75655B in 2.917302ms
--- PASS: TestAPIClientGet_EmptyId (0.01s)
=== RUN   TestAPIClientGet_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000752] "GET http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:44842 - 401 22B in 81.784Âµs
--- PASS: TestAPIClientGet_Unauthorized (0.00s)
=== RUN   TestAPIClientTokensPut_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":161}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000753] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44850 - 200 1168B in 3.944212ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_tokens","details":{"clientId":162,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000754] "PUT http://localhost:19090/api/v1/admin/clients/162/tokens HTTP/1.1" from [::1]:44864 - 200 610B in 433.919Âµs
--- PASS: TestAPIClientTokensPut_Success (0.01s)
=== RUN   TestAPIClientTokensPut_ValidationErrors
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":163}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000755] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44868 - 200 1168B in 3.920176ms
=== RUN   TestAPIClientTokensPut_ValidationErrors/token_exp_too_large
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000756] "PUT http://localhost:19090/api/v1/admin/clients/164/tokens HTTP/1.1" from [::1]:44878 - 400 111B in 339.541Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/idle_too_large
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000757] "PUT http://localhost:19090/api/v1/admin/clients/164/tokens HTTP/1.1" from [::1]:44890 - 400 131B in 281.812Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/maxlife_too_large
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000758] "PUT http://localhost:19090/api/v1/admin/clients/164/tokens HTTP/1.1" from [::1]:44906 - 400 131B in 264.149Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/idle_gt_maxlife
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000759] "PUT http://localhost:19090/api/v1/admin/clients/164/tokens HTTP/1.1" from [::1]:44922 - 400 124B in 256.054Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/invalid_three_state
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000760] "PUT http://localhost:19090/api/v1/admin/clients/164/tokens HTTP/1.1" from [::1]:44928 - 400 109B in 279.538Âµs
=== RUN   TestAPIClientTokensPut_ValidationErrors/negatives_rejected
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000761] "PUT http://localhost:19090/api/v1/admin/clients/164/tokens HTTP/1.1" from [::1]:44932 - 400 111B in 332.308Âµs
--- PASS: TestAPIClientTokensPut_ValidationErrors (0.01s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/token_exp_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/idle_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/maxlife_too_large (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/idle_gt_maxlife (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/invalid_three_state (0.00s)
    --- PASS: TestAPIClientTokensPut_ValidationErrors/negatives_rejected (0.00s)
=== RUN   TestAPIClientTokensPut_NotFoundAndInvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":165}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000762] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44948 - 200 1168B in 3.910669ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000763] "PUT http://localhost:19090/api/v1/admin/clients/999999/tokens HTTP/1.1" from [::1]:44964 - 404 60B in 328.32Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000764] "PUT http://localhost:19090/api/v1/admin/clients/abc/tokens HTTP/1.1" from [::1]:44980 - 400 68B in 287.734Âµs
--- PASS: TestAPIClientTokensPut_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIClientTokensPut_SystemLevelClientRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":166}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000765] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:44990 - 200 1168B in 4.139512ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000766] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:44992 - 200 77871B in 3.436222ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000767] "PUT http://localhost:19090/api/v1/admin/clients/1/tokens HTTP/1.1" from [::1]:44998 - 400 87B in 372.504Âµs
--- PASS: TestAPIClientTokensPut_SystemLevelClientRejected (0.01s)
=== RUN   TestAPIClientTokensPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":167}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000768] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45000 - 200 1168B in 3.944934ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000769] "PUT http://localhost:19090/api/v1/admin/clients/168/tokens HTTP/1.1" from [::1]:45004 - 400 70B in 347.056Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000770] "PUT http://localhost:19090/api/v1/admin/clients/168/tokens HTTP/1.1" from [::1]:45004 - 401 22B in 92.204Âµs
--- PASS: TestAPIClientTokensPut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPIClientTokensPut_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":169}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000771] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45010 - 200 1169B in 3.978667ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000772] "PUT http://localhost:19090/api/v1/admin/clients/170/tokens HTTP/1.1" from [::1]:45016 - 403 19B in 296.46Âµs
--- PASS: TestAPIClientTokensPut_InsufficientScope (0.01s)
=== RUN   TestAPIClientUpdatePut_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":171}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000773] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45020 - 200 1168B in 4.286169ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_settings","details":{"clientId":172,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000774] "PUT http://localhost:19090/api/v1/admin/clients/172 HTTP/1.1" from [::1]:45036 - 200 602B in 991.093Âµs
--- PASS: TestAPIClientUpdatePut_Success (0.01s)
=== RUN   TestAPIClientUpdatePut_ValidationErrors
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":173}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000775] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45042 - 200 1168B in 4.400575ms
=== RUN   TestAPIClientUpdatePut_ValidationErrors/empty_identifier
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000776] "PUT http://localhost:19090/api/v1/admin/clients/174 HTTP/1.1" from [::1]:45058 - 400 81B in 332.719Âµs
=== RUN   TestAPIClientUpdatePut_ValidationErrors/desc_too_long
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000777] "PUT http://localhost:19090/api/v1/admin/clients/174 HTTP/1.1" from [::1]:45066 - 400 116B in 319.373Âµs
=== RUN   TestAPIClientUpdatePut_ValidationErrors/invalid_identifier_format
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000778] "PUT http://localhost:19090/api/v1/admin/clients/174 HTTP/1.1" from [::1]:45068 - 400 250B in 684.814Âµs
--- PASS: TestAPIClientUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/empty_identifier (0.00s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/desc_too_long (0.00s)
    --- PASS: TestAPIClientUpdatePut_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIClientUpdatePut_DuplicateIdentifier
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":175}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000779] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45074 - 200 1168B in 4.052747ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000780] "PUT http://localhost:19090/api/v1/admin/clients/177 HTTP/1.1" from [::1]:45082 - 400 91B in 356.644Âµs
--- PASS: TestAPIClientUpdatePut_DuplicateIdentifier (0.01s)
=== RUN   TestAPIClientUpdatePut_SameIdentifierAllowed
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":178}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000781] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45090 - 200 1168B in 4.479023ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_settings","details":{"clientId":179,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000782] "PUT http://localhost:19090/api/v1/admin/clients/179 HTTP/1.1" from [::1]:45094 - 200 595B in 547.334Âµs
--- PASS: TestAPIClientUpdatePut_SameIdentifierAllowed (0.01s)
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":180}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000783] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45096 - 200 1168B in 4.287381ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000784] "PUT http://localhost:19090/api/v1/admin/clients/99999 HTTP/1.1" from [::1]:45108 - 404 60B in 349.511Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/non-numeric
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000785] "PUT http://localhost:19090/api/v1/admin/clients/abc HTTP/1.1" from [::1]:45120 - 400 68B in 290.459Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/empty
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000786] "PUT http://localhost:19090/api/v1/admin/clients/ HTTP/1.1" from [::1]:45128 - 405 0B in 253.589Âµs
=== RUN   TestAPIClientUpdatePut_NotFoundAndInvalidId/negative
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000787] "PUT http://localhost:19090/api/v1/admin/clients/-1 HTTP/1.1" from [::1]:45138 - 404 60B in 266.654Âµs
--- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId (0.01s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/non-numeric (0.00s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/empty (0.00s)
    --- PASS: TestAPIClientUpdatePut_NotFoundAndInvalidId/negative (0.00s)
=== RUN   TestAPIClientUpdatePut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":181}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000788] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45142 - 200 1168B in 3.889689ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000789] "PUT http://localhost:19090/api/v1/admin/clients/182 HTTP/1.1" from [::1]:45146 - 400 70B in 295.779Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000790] "PUT http://localhost:19090/api/v1/admin/clients/182 HTTP/1.1" from [::1]:45146 - 401 22B in 68.429Âµs
--- PASS: TestAPIClientUpdatePut_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPIClientUpdatePut_ACRRuleEnforcement
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":183}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000791] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45158 - 200 1168B in 3.918714ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000792] "PUT http://localhost:19090/api/v1/admin/clients/184 HTTP/1.1" from [::1]:45166 - 400 128B in 380.479Âµs
--- PASS: TestAPIClientUpdatePut_ACRRuleEnforcement (0.00s)
=== RUN   TestAPIClientUpdatePut_WhitespaceHandling
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":185}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000793] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45174 - 200 1168B in 3.973778ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000794] "PUT http://localhost:19090/api/v1/admin/clients/186 HTTP/1.1" from [::1]:45188 - 400 250B in 347.326Âµs
2025/11/25 13:26:08 INFO {"audit_event":"updated_client_settings","details":{"clientId":186,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000795] "PUT http://localhost:19090/api/v1/admin/clients/186 HTTP/1.1" from [::1]:45194 - 200 600B in 548.406Âµs
--- PASS: TestAPIClientUpdatePut_WhitespaceHandling (0.01s)
=== RUN   TestAPIClientUpdatePut_SystemLevelClientRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":187}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000796] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45210 - 200 1168B in 4.015297ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000797] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:45218 - 200 83409B in 3.959992ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000798] "PUT http://localhost:19090/api/v1/admin/clients/1 HTTP/1.1" from [::1]:45226 - 400 87B in 344.742Âµs
--- PASS: TestAPIClientUpdatePut_SystemLevelClientRejected (0.01s)
=== RUN   TestAPIClientUpdatePut_InvalidDefaultAcrLevelValue
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":188}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000799] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45238 - 200 1168B in 3.950224ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000800] "PUT http://localhost:19090/api/v1/admin/clients/189 HTTP/1.1" from [::1]:45244 - 400 76B in 409.173Âµs
--- PASS: TestAPIClientUpdatePut_InvalidDefaultAcrLevelValue (0.01s)
=== RUN   TestAPIClientUpdatePut_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":190}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000801] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45250 - 200 1169B in 3.879249ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000802] "PUT http://localhost:19090/api/v1/admin/clients/191 HTTP/1.1" from [::1]:45266 - 403 19B in 318.392Âµs
--- PASS: TestAPIClientUpdatePut_InsufficientScope (0.01s)
=== RUN   TestAPIClientWebOriginsPut_Success_AddRemoveAndNormalize
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":192}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000803] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45276 - 200 1168B in 3.897073ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_web_origins","details":{"clientId":193,"loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000804] "PUT http://localhost:19090/api/v1/admin/clients/193/web-origins HTTP/1.1" from [::1]:45292 - 200 805B in 439.09Âµs
--- PASS: TestAPIClientWebOriginsPut_Success_AddRemoveAndNormalize (0.01s)
=== RUN   TestAPIClientWebOriginsPut_AuthCodeDisabledRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":194}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000805] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45308 - 200 1168B in 4.184096ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000806] "PUT http://localhost:19090/api/v1/admin/clients/195/web-origins HTTP/1.1" from [::1]:45310 - 400 103B in 319.513Âµs
--- PASS: TestAPIClientWebOriginsPut_AuthCodeDisabledRejected (0.01s)
=== RUN   TestAPIClientWebOriginsPut_SystemLevelClientRejected
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":196}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000807] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45314 - 200 1168B in 3.894728ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000808] "GET http://localhost:19090/api/v1/admin/clients HTTP/1.1" from [::1]:45316 - 200 85625B in 3.200858ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000809] "PUT http://localhost:19090/api/v1/admin/clients/1/web-origins HTTP/1.1" from [::1]:45324 - 400 87B in 332.869Âµs
--- PASS: TestAPIClientWebOriginsPut_SystemLevelClientRejected (0.01s)
=== RUN   TestAPIClientWebOriginsPut_DuplicateInvalidWrongSchemeAndEmpty
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":197}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000810] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45330 - 200 1168B in 4.509441ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000811] "PUT http://localhost:19090/api/v1/admin/clients/198/web-origins HTTP/1.1" from [::1]:45340 - 400 88B in 306.69Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000812] "PUT http://localhost:19090/api/v1/admin/clients/198/web-origins HTTP/1.1" from [::1]:45350 - 400 80B in 277.825Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000813] "PUT http://localhost:19090/api/v1/admin/clients/198/web-origins HTTP/1.1" from [::1]:45354 - 400 91B in 257.166Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000814] "PUT http://localhost:19090/api/v1/admin/clients/198/web-origins HTTP/1.1" from [::1]:45368 - 400 77B in 265.942Âµs
--- PASS: TestAPIClientWebOriginsPut_DuplicateInvalidWrongSchemeAndEmpty (0.01s)
=== RUN   TestAPIClientWebOriginsPut_NotFound_InvalidId_InvalidBody_Unauthorized
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":199}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000815] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45382 - 200 1168B in 3.929054ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000816] "PUT http://localhost:19090/api/v1/admin/clients/999999/web-origins HTTP/1.1" from [::1]:45384 - 404 60B in 312.411Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000817] "PUT http://localhost:19090/api/v1/admin/clients/abc/web-origins HTTP/1.1" from [::1]:45394 - 400 68B in 263.548Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000818] "PUT http://localhost:19090/api/v1/admin/clients/200/web-origins HTTP/1.1" from [::1]:45398 - 400 70B in 332.317Âµs
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000819] "PUT http://localhost:19090/api/v1/admin/clients/200/web-origins HTTP/1.1" from [::1]:45398 - 401 22B in 78.829Âµs
--- PASS: TestAPIClientWebOriginsPut_NotFound_InvalidId_InvalidBody_Unauthorized (0.01s)
=== RUN   TestAPIClientWebOriginsPut_InsufficientScope
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":201}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000820] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45412 - 200 1170B in 3.924435ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000821] "PUT http://localhost:19090/api/v1/admin/clients/202/web-origins HTTP/1.1" from [::1]:45418 - 403 19B in 290.228Âµs
--- PASS: TestAPIClientWebOriginsPut_InsufficientScope (0.00s)
=== RUN   TestAPIGroupMembersGet_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":203}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000822] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45432 - 200 1168B in 3.888397ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000823] "GET http://localhost:19090/api/v1/admin/groups/1/members HTTP/1.1" from [::1]:45444 - 200 1427B in 533.187Âµs
--- PASS: TestAPIGroupMembersGet_Success (0.01s)
=== RUN   TestAPIGroupMembersGet_EmptyGroup
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":204}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000824] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45452 - 200 1168B in 3.986573ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000825] "GET http://localhost:19090/api/v1/admin/groups/2/members HTTP/1.1" from [::1]:45464 - 200 46B in 450.371Âµs
--- PASS: TestAPIGroupMembersGet_EmptyGroup (0.01s)
=== RUN   TestAPIGroupMembersGet_Pagination
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":205}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000826] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45476 - 200 1168B in 3.894468ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000827] "GET http://localhost:19090/api/v1/admin/groups/3/members?page=1&size=2 HTTP/1.1" from [::1]:45488 - 200 1430B in 501.718Âµs
--- PASS: TestAPIGroupMembersGet_Pagination (0.01s)
=== RUN   TestAPIGroupMembersGet_GroupNotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":206}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000828] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45502 - 200 1168B in 3.913405ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000829] "GET http://localhost:19090/api/v1/admin/groups/99999/members HTTP/1.1" from [::1]:45506 - 404 59B in 287.934Âµs
--- PASS: TestAPIGroupMembersGet_GroupNotFound (0.00s)
=== RUN   TestAPIGroupMembersGet_InvalidGroupId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":207}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000830] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45510 - 200 1168B in 3.983597ms
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/non-numeric_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000831] "GET http://localhost:19090/api/v1/admin/groups/abc/members HTTP/1.1" from [::1]:45516 - 400 67B in 477.953Âµs
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/empty_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000832] "GET http://localhost:19090/api/v1/admin/groups//members HTTP/1.1" from [::1]:45530 - 400 71B in 312.21Âµs
=== RUN   TestAPIGroupMembersGet_InvalidGroupId/negative_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000833] "GET http://localhost:19090/api/v1/admin/groups/-1/members HTTP/1.1" from [::1]:45538 - 404 59B in 261.083Âµs
--- PASS: TestAPIGroupMembersGet_InvalidGroupId (0.01s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/empty_ID (0.00s)
    --- PASS: TestAPIGroupMembersGet_InvalidGroupId/negative_ID (0.00s)
=== RUN   TestAPIGroupMemberAdd_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":208}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000834] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45552 - 200 1168B in 3.905419ms
2025/11/25 13:26:08 INFO {"audit_event":"user_added_to_group","details":{"groupId":4,"loggedInUser":"","userId":66}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000835] "POST http://localhost:19090/api/v1/admin/groups/4/members HTTP/1.1" from [::1]:45562 - 201 17B in 451.253Âµs
--- PASS: TestAPIGroupMemberAdd_Success (0.01s)
=== RUN   TestAPIGroupMemberAdd_UserAlreadyInGroup
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":209}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000836] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45564 - 200 1168B in 4.072625ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000837] "POST http://localhost:19090/api/v1/admin/groups/5/members HTTP/1.1" from [::1]:45570 - 400 89B in 450.782Âµs
--- PASS: TestAPIGroupMemberAdd_UserAlreadyInGroup (0.01s)
=== RUN   TestAPIGroupMemberAdd_UserNotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":210}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000838] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45582 - 200 1168B in 4.47763ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000839] "POST http://localhost:19090/api/v1/admin/groups/6/members HTTP/1.1" from [::1]:45588 - 404 63B in 390.528Âµs
--- PASS: TestAPIGroupMemberAdd_UserNotFound (0.01s)
=== RUN   TestAPIGroupMemberAdd_GroupNotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":211}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000840] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45600 - 200 1168B in 3.949752ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000841] "POST http://localhost:19090/api/v1/admin/groups/99999/members HTTP/1.1" from [::1]:45608 - 404 59B in 314.284Âµs
--- PASS: TestAPIGroupMemberAdd_GroupNotFound (0.00s)
=== RUN   TestAPIGroupMemberAdd_InvalidRequestBody
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":212}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000842] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45610 - 200 1168B in 3.966735ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000843] "POST http://localhost:19090/api/v1/admin/groups/7/members HTTP/1.1" from [::1]:45626 - 400 70B in 322.6Âµs
--- PASS: TestAPIGroupMemberAdd_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupMemberRemove_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":213}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000844] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45628 - 200 1168B in 3.968789ms
2025/11/25 13:26:08 INFO {"audit_event":"user_removed_from_group","details":{"groupId":8,"loggedInUser":"","userId":68}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000845] "DELETE http://localhost:19090/api/v1/admin/groups/8/members/68 HTTP/1.1" from [::1]:45630 - 200 17B in 450.722Âµs
--- PASS: TestAPIGroupMemberRemove_Success (0.01s)
=== RUN   TestAPIGroupMemberRemove_UserNotInGroup
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":214}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000846] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45638 - 200 1168B in 3.920377ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000847] "DELETE http://localhost:19090/api/v1/admin/groups/9/members/69 HTTP/1.1" from [::1]:45654 - 400 85B in 716.854Âµs
--- PASS: TestAPIGroupMemberRemove_UserNotInGroup (0.01s)
=== RUN   TestAPIGroupMemberRemove_UserNotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":215}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000848] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45660 - 200 1168B in 4.003244ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000849] "DELETE http://localhost:19090/api/v1/admin/groups/10/members/99999 HTTP/1.1" from [::1]:45674 - 404 63B in 625.271Âµs
--- PASS: TestAPIGroupMemberRemove_UserNotFound (0.01s)
=== RUN   TestAPIGroupMemberRemove_GroupNotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":216}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000850] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45678 - 200 1168B in 3.987124ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000851] "DELETE http://localhost:19090/api/v1/admin/groups/99999/members/1 HTTP/1.1" from [::1]:45686 - 404 59B in 445.872Âµs
--- PASS: TestAPIGroupMemberRemove_GroupNotFound (0.01s)
=== RUN   TestAPIGroupMemberRemove_InvalidIds
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":217}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000852] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45696 - 200 1168B in 4.397679ms
=== RUN   TestAPIGroupMemberRemove_InvalidIds/non-numeric_group_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000853] "DELETE http://localhost:19090/api/v1/admin/groups/abc/members/1 HTTP/1.1" from [::1]:45706 - 400 67B in 292.683Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/non-numeric_user_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000854] "DELETE http://localhost:19090/api/v1/admin/groups/1/members/abc HTTP/1.1" from [::1]:45720 - 400 66B in 275.27Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/negative_group_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000855] "DELETE http://localhost:19090/api/v1/admin/groups/-1/members/1 HTTP/1.1" from [::1]:45736 - 404 59B in 279.268Âµs
=== RUN   TestAPIGroupMemberRemove_InvalidIds/negative_user_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000856] "DELETE http://localhost:19090/api/v1/admin/groups/1/members/-1 HTTP/1.1" from [::1]:45742 - 404 59B in 327.478Âµs
--- PASS: TestAPIGroupMemberRemove_InvalidIds (0.01s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/non-numeric_group_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/non-numeric_user_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/negative_group_ID (0.00s)
    --- PASS: TestAPIGroupMemberRemove_InvalidIds/negative_user_ID (0.00s)
=== RUN   TestAPIGroupMembers_Unauthorized
=== RUN   TestAPIGroupMembers_Unauthorized/GET_members
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000857] "GET http://localhost:19090/api/v1/admin/groups/11/members HTTP/1.1" from [::1]:45748 - 401 22B in 118.033Âµs
=== RUN   TestAPIGroupMembers_Unauthorized/POST_add_member
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000858] "POST http://localhost:19090/api/v1/admin/groups/11/members HTTP/1.1" from [::1]:45758 - 401 22B in 104.938Âµs
=== RUN   TestAPIGroupMembers_Unauthorized/DELETE_remove_member
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000859] "DELETE http://localhost:19090/api/v1/admin/groups/11/members/1 HTTP/1.1" from [::1]:45764 - 401 22B in 126.249Âµs
--- PASS: TestAPIGroupMembers_Unauthorized (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/GET_members (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/POST_add_member (0.00s)
    --- PASS: TestAPIGroupMembers_Unauthorized/DELETE_remove_member (0.00s)
=== RUN   TestAPIGroupAttributesGet_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":218}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000860] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45766 - 200 1168B in 4.370618ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000861] "GET http://localhost:19090/api/v1/admin/groups/12/attributes HTTP/1.1" from [::1]:45772 - 200 421B in 424.462Âµs
--- PASS: TestAPIGroupAttributesGet_Success (0.01s)
=== RUN   TestAPIGroupAttributesGet_EmptyAttributes
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":219}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000862] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45784 - 200 1168B in 3.984478ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000863] "GET http://localhost:19090/api/v1/admin/groups/13/attributes HTTP/1.1" from [::1]:45786 - 200 18B in 377.964Âµs
--- PASS: TestAPIGroupAttributesGet_EmptyAttributes (0.01s)
=== RUN   TestAPIGroupAttributesGet_GroupNotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":220}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000864] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45790 - 200 1168B in 3.957938ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000865] "GET http://localhost:19090/api/v1/admin/groups/99999/attributes HTTP/1.1" from [::1]:45796 - 404 59B in 323.492Âµs
--- PASS: TestAPIGroupAttributesGet_GroupNotFound (0.00s)
=== RUN   TestAPIGroupAttributesGet_InvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":221}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000866] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45798 - 200 1168B in 3.908665ms
=== RUN   TestAPIGroupAttributesGet_InvalidId/non-numeric_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000867] "GET http://localhost:19090/api/v1/admin/groups/abc/attributes HTTP/1.1" from [::1]:45802 - 400 67B in 250.554Âµs
=== RUN   TestAPIGroupAttributesGet_InvalidId/empty_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000868] "GET http://localhost:19090/api/v1/admin/groups//attributes HTTP/1.1" from [::1]:45812 - 400 71B in 284.788Âµs
=== RUN   TestAPIGroupAttributesGet_InvalidId/negative_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000869] "GET http://localhost:19090/api/v1/admin/groups/-1/attributes HTTP/1.1" from [::1]:45814 - 404 59B in 268.477Âµs
--- PASS: TestAPIGroupAttributesGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributesGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributesGet_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000870] "GET http://localhost:19090/api/v1/admin/groups/14/attributes HTTP/1.1" from [::1]:45816 - 401 22B in 83.949Âµs
--- PASS: TestAPIGroupAttributesGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeGet_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":222}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000871] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45822 - 200 1168B in 3.881584ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000872] "GET http://localhost:19090/api/v1/admin/group-attributes/3 HTTP/1.1" from [::1]:45838 - 200 210B in 338.57Âµs
--- PASS: TestAPIGroupAttributeGet_Success (0.00s)
=== RUN   TestAPIGroupAttributeGet_NotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":223}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000873] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45848 - 200 1168B in 3.904548ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000874] "GET http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:45860 - 404 69B in 321.297Âµs
--- PASS: TestAPIGroupAttributeGet_NotFound (0.00s)
=== RUN   TestAPIGroupAttributeGet_InvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":224}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000875] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45868 - 200 1168B in 3.887425ms
=== RUN   TestAPIGroupAttributeGet_InvalidId/non-numeric_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000876] "GET http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:45870 - 400 77B in 247.357Âµs
=== RUN   TestAPIGroupAttributeGet_InvalidId/empty_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000877] "GET http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:45884 - 405 0B in 287.673Âµs
=== RUN   TestAPIGroupAttributeGet_InvalidId/negative_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000878] "GET http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:45886 - 404 69B in 235.134Âµs
--- PASS: TestAPIGroupAttributeGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeGet_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000879] "GET http://localhost:19090/api/v1/admin/group-attributes/4 HTTP/1.1" from [::1]:45902 - 401 22B in 113.424Âµs
--- PASS: TestAPIGroupAttributeGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeCreatePost_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":225}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000880] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45912 - 200 1168B in 3.897665ms
2025/11/25 13:26:08 INFO {"audit_event":"added_group_attribute","details":{"groupAttributeId":5,"groupId":17,"groupIdentifier":"test-group-b72f09bb","loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000881] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45922 - 201 219B in 374.828Âµs
--- PASS: TestAPIGroupAttributeCreatePost_Success (0.01s)
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":226}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000882] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45932 - 200 1168B in 3.907012ms
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/missing_key
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000883] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45944 - 400 76B in 269.8Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/empty_key
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000884] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45950 - 400 76B in 249.982Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/value_too_long
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000885] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45952 - 400 119B in 312.19Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/invalid_key_format
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000886] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45962 - 400 250B in 268.137Âµs
=== RUN   TestAPIGroupAttributeCreatePost_ValidationErrors/group_not_found
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000887] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:45978 - 404 59B in 283.636Âµs
--- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/invalid_key_format (0.00s)
    --- PASS: TestAPIGroupAttributeCreatePost_ValidationErrors/group_not_found (0.00s)
=== RUN   TestAPIGroupAttributeCreatePost_InvalidRequestBody
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":227}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000888] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:45986 - 200 1168B in 3.986543ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000889] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46002 - 400 70B in 256.835Âµs
--- PASS: TestAPIGroupAttributeCreatePost_InvalidRequestBody (0.00s)
=== RUN   TestAPIGroupAttributeCreatePost_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000890] "POST http://localhost:19090/api/v1/admin/group-attributes HTTP/1.1" from [::1]:46014 - 401 22B in 89.739Âµs
--- PASS: TestAPIGroupAttributeCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_Success
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":228}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000891] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46016 - 200 1168B in 3.91652ms
2025/11/25 13:26:08 INFO {"audit_event":"updated_group_attribute","details":{"groupAttributeId":6,"groupId":19,"groupIdentifier":"test-group-3905b080","loggedInUser":""}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000892] "PUT http://localhost:19090/api/v1/admin/group-attributes/6 HTTP/1.1" from [::1]:46024 - 200 213B in 391.41Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_Success (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_NotFound
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":229}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000893] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46036 - 200 1168B in 4.076201ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000894] "PUT http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:46040 - 404 69B in 874.713Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":230}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000895] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46054 - 200 1168B in 3.933612ms
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/missing_key
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000896] "PUT http://localhost:19090/api/v1/admin/group-attributes/7 HTTP/1.1" from [::1]:46068 - 400 76B in 369.217Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/empty_key
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000897] "PUT http://localhost:19090/api/v1/admin/group-attributes/7 HTTP/1.1" from [::1]:46076 - 400 76B in 311.809Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/value_too_long
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000898] "PUT http://localhost:19090/api/v1/admin/group-attributes/7 HTTP/1.1" from [::1]:46090 - 400 119B in 339.492Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_ValidationErrors/invalid_key_format
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000899] "PUT http://localhost:19090/api/v1/admin/group-attributes/7 HTTP/1.1" from [::1]:46096 - 400 250B in 273.396Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_ValidationErrors/invalid_key_format (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":231}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000900] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46100 - 200 1168B in 4.06499ms
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000901] "PUT http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:46110 - 400 77B in 310.757Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/empty_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000902] "PUT http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:46122 - 405 0B in 290.118Âµs
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidId/negative_ID
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000903] "PUT http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:46124 - 404 69B in 289.898Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeUpdatePut_InvalidRequestBody
2025/11/25 13:26:08 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":232}}
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000904] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46140 - 200 1168B in 4.596725ms
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000905] "PUT http://localhost:19090/api/v1/admin/group-attributes/8 HTTP/1.1" from [::1]:46154 - 400 70B in 331.346Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupAttributeUpdatePut_Unauthorized
2025/11/25 13:26:08 [a357f2e3b56e/FBsnpuLk6O-000906] "PUT http://localhost:19090/api/v1/admin/group-attributes/9 HTTP/1.1" from [::1]:46166 - 401 22B in 141.327Âµs
--- PASS: TestAPIGroupAttributeUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIGroupAttributeDelete_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":233}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000907] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46182 - 200 1168B in 4.440981ms
2025/11/25 13:26:09 INFO {"audit_event":"deleted_group_attribute","details":{"groupAttributeId":10,"groupId":23,"groupIdentifier":"test-group-cf457d63","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000908] "DELETE http://localhost:19090/api/v1/admin/group-attributes/10 HTTP/1.1" from [::1]:46190 - 200 17B in 941.509Âµs
--- PASS: TestAPIGroupAttributeDelete_Success (0.01s)
=== RUN   TestAPIGroupAttributeDelete_NotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":234}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000909] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46194 - 200 1168B in 4.112681ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000910] "DELETE http://localhost:19090/api/v1/admin/group-attributes/99999 HTTP/1.1" from [::1]:46196 - 404 69B in 283.866Âµs
--- PASS: TestAPIGroupAttributeDelete_NotFound (0.01s)
=== RUN   TestAPIGroupAttributeDelete_InvalidId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":235}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000911] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46210 - 200 1168B in 4.109385ms
=== RUN   TestAPIGroupAttributeDelete_InvalidId/non-numeric_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000912] "DELETE http://localhost:19090/api/v1/admin/group-attributes/abc HTTP/1.1" from [::1]:46226 - 400 77B in 353.589Âµs
=== RUN   TestAPIGroupAttributeDelete_InvalidId/empty_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000913] "DELETE http://localhost:19090/api/v1/admin/group-attributes/ HTTP/1.1" from [::1]:46238 - 405 0B in 266.904Âµs
=== RUN   TestAPIGroupAttributeDelete_InvalidId/negative_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000914] "DELETE http://localhost:19090/api/v1/admin/group-attributes/-1 HTTP/1.1" from [::1]:46248 - 404 69B in 326.677Âµs
--- PASS: TestAPIGroupAttributeDelete_InvalidId (0.01s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupAttributeDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupAttributeDelete_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000915] "DELETE http://localhost:19090/api/v1/admin/group-attributes/11 HTTP/1.1" from [::1]:46252 - 401 22B in 147.84Âµs
--- PASS: TestAPIGroupAttributeDelete_Unauthorized (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":236}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000916] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46254 - 200 1168B in 4.082274ms
2025/11/25 13:26:09 INFO {"audit_event":"created_group","details":{"groupId":25,"groupIdentifier":"test-group-dCiYTM","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000917] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46266 - 201 256B in 497.87Âµs
--- PASS: TestHandleAPIGroupCreatePost_Success (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":237}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000918] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46272 - 200 1168B in 4.098304ms
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Empty_group_identifier
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000919] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46288 - 400 79B in 377.763Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_short
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000920] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46290 - 400 101B in 304.125Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_long
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000921] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46300 - 400 114B in 377.363Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Invalid_group_identifier_characters
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000922] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46304 - 400 250B in 520.844Âµs
=== RUN   TestHandleAPIGroupCreatePost_ValidationErrors/Description_too_long
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000923] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46316 - 400 115B in 433.499Âµs
--- PASS: TestHandleAPIGroupCreatePost_ValidationErrors (0.01s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Empty_group_identifier (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_short (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Group_identifier_too_long (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Invalid_group_identifier_characters (0.00s)
    --- PASS: TestHandleAPIGroupCreatePost_ValidationErrors/Description_too_long (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_DuplicateGroupIdentifier
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":238}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000924] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46322 - 200 1168B in 4.151083ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000925] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46326 - 400 89B in 386.05Âµs
--- PASS: TestHandleAPIGroupCreatePost_DuplicateGroupIdentifier (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_InputSanitization
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":239}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000926] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46342 - 200 1168B in 4.063688ms
2025/11/25 13:26:09 INFO {"audit_event":"created_group","details":{"groupId":27,"groupIdentifier":"test-group-shKSUt","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000927] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46354 - 201 248B in 463.315Âµs
--- PASS: TestHandleAPIGroupCreatePost_InputSanitization (0.01s)
=== RUN   TestHandleAPIGroupCreatePost_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000928] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46360 - 401 22B in 254.05Âµs
--- PASS: TestHandleAPIGroupCreatePost_Unauthorized (0.00s)
=== RUN   TestHandleAPIGroupCreatePost_InvalidJSON
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":240}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000929] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46376 - 200 1168B in 4.572569ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000930] "POST http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46378 - 400 70B in 309.405Âµs
--- PASS: TestHandleAPIGroupCreatePost_InvalidJSON (0.01s)
=== RUN   TestAPIGroupDelete_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":241}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000931] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46382 - 200 1168B in 3.973768ms
2025/11/25 13:26:09 INFO {"audit_event":"deleted_group","details":{"groupId":28,"groupIdentifier":"test-group-73ab4ee3","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000932] "DELETE http://localhost:19090/api/v1/admin/groups/28 HTTP/1.1" from [::1]:46386 - 200 17B in 358.137Âµs
--- PASS: TestAPIGroupDelete_Success (0.01s)
=== RUN   TestAPIGroupDelete_SuccessWithMembers
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":242}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000933] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46396 - 200 1168B in 3.966414ms
2025/11/25 13:26:09 INFO {"audit_event":"deleted_group","details":{"groupId":29,"groupIdentifier":"test-group-56e6acd4","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000934] "DELETE http://localhost:19090/api/v1/admin/groups/29 HTTP/1.1" from [::1]:46404 - 200 17B in 387.202Âµs
--- PASS: TestAPIGroupDelete_SuccessWithMembers (0.01s)
=== RUN   TestAPIGroupDelete_NotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":243}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000935] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46414 - 200 1168B in 3.963038ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000936] "DELETE http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:46420 - 404 59B in 467.323Âµs
--- PASS: TestAPIGroupDelete_NotFound (0.00s)
=== RUN   TestAPIGroupDelete_InvalidId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":244}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000937] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46422 - 200 1168B in 3.963439ms
=== RUN   TestAPIGroupDelete_InvalidId/non-numeric_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000938] "DELETE http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:46438 - 400 67B in 241.847Âµs
=== RUN   TestAPIGroupDelete_InvalidId/empty_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000939] "DELETE http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:46448 - 405 0B in 267.756Âµs
=== RUN   TestAPIGroupDelete_InvalidId/negative_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000940] "DELETE http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:46452 - 404 59B in 281.311Âµs
--- PASS: TestAPIGroupDelete_InvalidId (0.01s)
    --- PASS: TestAPIGroupDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupDelete_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000941] "DELETE http://localhost:19090/api/v1/admin/groups/30 HTTP/1.1" from [::1]:46462 - 401 22B in 140.386Âµs
--- PASS: TestAPIGroupDelete_Unauthorized (0.00s)
=== RUN   TestAPIGroupDelete_InvalidToken
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000942] "DELETE http://localhost:19090/api/v1/admin/groups/31 HTTP/1.1" from [::1]:46476 - 401 22B in 164.801Âµs
--- PASS: TestAPIGroupDelete_InvalidToken (0.00s)
=== RUN   TestAPIGroupDelete_WithGroupPermissions
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":245}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000943] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46492 - 200 1168B in 4.061113ms
2025/11/25 13:26:09 INFO {"audit_event":"deleted_group","details":{"groupId":32,"groupIdentifier":"test-group-f61d6bce","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000944] "DELETE http://localhost:19090/api/v1/admin/groups/32 HTTP/1.1" from [::1]:46496 - 200 17B in 752.962Âµs
--- PASS: TestAPIGroupDelete_WithGroupPermissions (0.01s)
=== RUN   TestAPIGroupDelete_ResponseStructure
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":246}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000945] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46502 - 200 1168B in 3.952678ms
2025/11/25 13:26:09 INFO {"audit_event":"deleted_group","details":{"groupId":33,"groupIdentifier":"test-group-184d15fb","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000946] "DELETE http://localhost:19090/api/v1/admin/groups/33 HTTP/1.1" from [::1]:46508 - 200 17B in 438.108Âµs
--- PASS: TestAPIGroupDelete_ResponseStructure (0.01s)
=== RUN   TestAPIGroupsGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":247}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000947] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46514 - 200 1168B in 4.401948ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000948] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46520 - 200 475B in 359.389Âµs
--- PASS: TestAPIGroupsGet_Success (0.01s)
=== RUN   TestAPIGroupsGet_EmptyGroups
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":248}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000949] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46532 - 200 1168B in 4.056746ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000950] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46540 - 200 14B in 304.636Âµs
    api_groups_get_test.go:113: Raw response body: {"groups":[]}
    api_groups_get_test.go:121: Response Groups: []
    api_groups_get_test.go:122: Groups is nil: false
    api_groups_get_test.go:123: Groups length: 0
    api_groups_get_test.go:129: Raw map parsing - groups value: []
    api_groups_get_test.go:130: Raw map parsing - groups type: []interface {}
--- PASS: TestAPIGroupsGet_EmptyGroups (0.00s)
=== RUN   TestAPIGroupsGet_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000951] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46544 - 401 22B in 117.853Âµs
--- PASS: TestAPIGroupsGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupsGet_InvalidToken
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000952] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46554 - 401 22B in 199.587Âµs
--- PASS: TestAPIGroupsGet_InvalidToken (0.00s)
=== RUN   TestAPIGroupsGet_EnhancedResponseStructure
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":249}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000953] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46568 - 200 1168B in 4.031778ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000954] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46574 - 200 257B in 344.421Âµs
--- PASS: TestAPIGroupsGet_EnhancedResponseStructure (0.01s)
=== RUN   TestAPIGroupsGet_MixedTokenInclusion
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":250}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000955] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46576 - 200 1168B in 4.058989ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000956] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46590 - 200 1003B in 693.08Âµs
--- PASS: TestAPIGroupsGet_MixedTokenInclusion (0.01s)
=== RUN   TestAPIGroupsGet_MemberCountAccuracy
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":251}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000957] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46606 - 200 1168B in 3.93266ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000958] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46616 - 200 249B in 339.903Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000959] "GET http://localhost:19090/api/v1/admin/groups HTTP/1.1" from [::1]:46632 - 200 249B in 330.926Âµs
--- PASS: TestAPIGroupsGet_MemberCountAccuracy (0.01s)
=== RUN   TestAPIGroupPermissionsGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":252}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000960] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46638 - 200 1168B in 3.986192ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000961] "GET http://localhost:19090/api/v1/admin/groups/42/permissions HTTP/1.1" from [::1]:46644 - 200 636B in 433.94Âµs
--- PASS: TestAPIGroupPermissionsGet_Success (0.01s)
=== RUN   TestAPIGroupPermissionsGet_GroupNotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":253}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000962] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46646 - 200 1168B in 4.107411ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000963] "GET http://localhost:19090/api/v1/admin/groups/99999/permissions HTTP/1.1" from [::1]:46658 - 404 59B in 332.559Âµs
--- PASS: TestAPIGroupPermissionsGet_GroupNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsGet_InvalidGroupId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":254}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000964] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46664 - 200 1168B in 4.138269ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000965] "GET http://localhost:19090/api/v1/admin/groups/invalid/permissions HTTP/1.1" from [::1]:46674 - 400 74B in 303.152Âµs
--- PASS: TestAPIGroupPermissionsGet_InvalidGroupId (0.01s)
=== RUN   TestAPIGroupPermissionsGet_NoPermissions
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":255}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000966] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46676 - 200 1168B in 4.106009ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000967] "GET http://localhost:19090/api/v1/admin/groups/43/permissions HTTP/1.1" from [::1]:46678 - 200 263B in 360.912Âµs
--- PASS: TestAPIGroupPermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIGroupPermissionsGet_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000968] "GET http://localhost:19090/api/v1/admin/groups/44/permissions HTTP/1.1" from [::1]:46694 - 401 22B in 122.131Âµs
--- PASS: TestAPIGroupPermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupPermissionsPut_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":256}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000969] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46698 - 200 1168B in 4.728715ms
2025/11/25 13:26:09 INFO {"audit_event":"added_group_permission","details":{"groupId":45,"loggedInUser":"","permissionId":15}}
2025/11/25 13:26:09 INFO {"audit_event":"added_group_permission","details":{"groupId":45,"loggedInUser":"","permissionId":16}}
2025/11/25 13:26:09 INFO {"audit_event":"deleted_group_permission","details":{"groupId":45,"loggedInUser":"","permissionId":14}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000970] "PUT http://localhost:19090/api/v1/admin/groups/45/permissions HTTP/1.1" from [::1]:46702 - 200 17B in 591.287Âµs
--- PASS: TestAPIGroupPermissionsPut_Success (0.01s)
=== RUN   TestAPIGroupPermissionsPut_RemoveAllPermissions
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":257}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000971] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46710 - 200 1168B in 4.047297ms
2025/11/25 13:26:09 INFO {"audit_event":"deleted_group_permission","details":{"groupId":46,"loggedInUser":"","permissionId":17}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000972] "PUT http://localhost:19090/api/v1/admin/groups/46/permissions HTTP/1.1" from [::1]:46726 - 200 17B in 472.042Âµs
--- PASS: TestAPIGroupPermissionsPut_RemoveAllPermissions (0.01s)
=== RUN   TestAPIGroupPermissionsPut_AddPermissionsToEmptyGroup
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":258}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000973] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46732 - 200 1168B in 4.064199ms
2025/11/25 13:26:09 INFO {"audit_event":"added_group_permission","details":{"groupId":47,"loggedInUser":"","permissionId":18}}
2025/11/25 13:26:09 INFO {"audit_event":"added_group_permission","details":{"groupId":47,"loggedInUser":"","permissionId":19}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000974] "PUT http://localhost:19090/api/v1/admin/groups/47/permissions HTTP/1.1" from [::1]:46744 - 200 17B in 498.873Âµs
--- PASS: TestAPIGroupPermissionsPut_AddPermissionsToEmptyGroup (0.01s)
=== RUN   TestAPIGroupPermissionsPut_GroupNotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":259}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000975] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46750 - 200 1168B in 4.033011ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000976] "PUT http://localhost:19090/api/v1/admin/groups/99999/permissions HTTP/1.1" from [::1]:46752 - 404 59B in 618.659Âµs
--- PASS: TestAPIGroupPermissionsPut_GroupNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsPut_PermissionNotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":260}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000977] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46754 - 200 1168B in 3.915598ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000978] "PUT http://localhost:19090/api/v1/admin/groups/48/permissions HTTP/1.1" from [::1]:46756 - 404 64B in 392.913Âµs
--- PASS: TestAPIGroupPermissionsPut_PermissionNotFound (0.01s)
=== RUN   TestAPIGroupPermissionsPut_InvalidRequestBody
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":261}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000979] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46768 - 200 1168B in 4.009947ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000980] "PUT http://localhost:19090/api/v1/admin/groups/49/permissions HTTP/1.1" from [::1]:46778 - 400 71B in 358.968Âµs
--- PASS: TestAPIGroupPermissionsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":262}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000981] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46790 - 200 1168B in 4.109615ms
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/non-numeric_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000982] "PUT http://localhost:19090/api/v1/admin/groups/abc/permissions HTTP/1.1" from [::1]:46800 - 400 74B in 280.5Âµs
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/negative_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000983] "PUT http://localhost:19090/api/v1/admin/groups/-1/permissions HTTP/1.1" from [::1]:46812 - 404 59B in 303.904Âµs
=== RUN   TestAPIGroupPermissionsPut_InvalidGroupId/zero_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000984] "PUT http://localhost:19090/api/v1/admin/groups/0/permissions HTTP/1.1" from [::1]:46824 - 404 59B in 287.073Âµs
--- PASS: TestAPIGroupPermissionsPut_InvalidGroupId (0.01s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/negative_ID (0.00s)
    --- PASS: TestAPIGroupPermissionsPut_InvalidGroupId/zero_ID (0.00s)
=== RUN   TestAPIGroupPermissionsPut_DuplicatePermissionIds
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":263}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000985] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46836 - 200 1168B in 3.940966ms
2025/11/25 13:26:09 INFO {"audit_event":"added_group_permission","details":{"groupId":50,"loggedInUser":"","permissionId":20}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000986] "PUT http://localhost:19090/api/v1/admin/groups/50/permissions HTTP/1.1" from [::1]:46846 - 200 17B in 459.478Âµs
--- PASS: TestAPIGroupPermissionsPut_DuplicatePermissionIds (0.01s)
=== RUN   TestAPIGroupPermissionsPut_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000987] "PUT http://localhost:19090/api/v1/admin/groups/51/permissions HTTP/1.1" from [::1]:46848 - 401 22B in 195.079Âµs
--- PASS: TestAPIGroupPermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIGroupPermissionsPut_ComplexScenario
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":264}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000988] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46858 - 200 1168B in 4.121587ms
2025/11/25 13:26:09 INFO {"audit_event":"added_group_permission","details":{"groupId":52,"loggedInUser":"","permissionId":24}}
2025/11/25 13:26:09 INFO {"audit_event":"deleted_group_permission","details":{"groupId":52,"loggedInUser":"","permissionId":21}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000989] "PUT http://localhost:19090/api/v1/admin/groups/52/permissions HTTP/1.1" from [::1]:46870 - 200 17B in 645.72Âµs
--- PASS: TestAPIGroupPermissionsPut_ComplexScenario (0.01s)
=== RUN   TestAPIGroupsSearch_Annotated_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":265}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000990] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46876 - 200 1168B in 3.978758ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000991] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=25&page=1&size=200 HTTP/1.1" from [::1]:46886 - 200 815B in 881.856Âµs
--- PASS: TestAPIGroupsSearch_Annotated_Success (0.01s)
=== RUN   TestAPIGroupsSearch_MissingAnnotateParam
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":266}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000992] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46902 - 200 1168B in 4.010007ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000993] "GET http://localhost:19090/api/v1/admin/groups/search?page=1&size=10 HTTP/1.1" from [::1]:46906 - 400 83B in 287.202Âµs
--- PASS: TestAPIGroupsSearch_MissingAnnotateParam (0.00s)
=== RUN   TestAPIGroupsSearch_InvalidAnnotateParam
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":267}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000994] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46918 - 200 1168B in 4.106299ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000995] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=abc&page=1&size=10 HTTP/1.1" from [::1]:46930 - 400 79B in 455.871Âµs
--- PASS: TestAPIGroupsSearch_InvalidAnnotateParam (0.01s)
=== RUN   TestAPIGroupsSearch_PermissionNotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":268}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000996] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46942 - 200 1168B in 3.954091ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000997] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=9898105 HTTP/1.1" from [::1]:46948 - 404 64B in 298.334Âµs
--- PASS: TestAPIGroupsSearch_PermissionNotFound (0.00s)
=== RUN   TestAPIGroupsSearch_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000998] "GET http://localhost:19090/api/v1/admin/groups/search?annotatePermissionId=26 HTTP/1.1" from [::1]:46950 - 401 22B in 105.078Âµs
--- PASS: TestAPIGroupsSearch_Unauthorized (0.00s)
=== RUN   TestAPIGroupGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":269}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-000999] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46954 - 200 1168B in 3.989218ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001000] "GET http://localhost:19090/api/v1/admin/groups/56 HTTP/1.1" from [::1]:46964 - 200 246B in 653.996Âµs
--- PASS: TestAPIGroupGet_Success (0.01s)
=== RUN   TestAPIGroupGet_NotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":270}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001001] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46970 - 200 1168B in 3.986412ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001002] "GET http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:46984 - 404 59B in 302.121Âµs
--- PASS: TestAPIGroupGet_NotFound (0.01s)
=== RUN   TestAPIGroupGet_InvalidId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":271}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001003] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46992 - 200 1168B in 3.95372ms
=== RUN   TestAPIGroupGet_InvalidId/non-numeric_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001004] "GET http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:47006 - 400 67B in 257.166Âµs
=== RUN   TestAPIGroupGet_InvalidId/empty_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001005] "GET http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:47010 - 200 14B in 262.115Âµs
=== RUN   TestAPIGroupGet_InvalidId/negative_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001006] "GET http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:47018 - 404 59B in 316.247Âµs
--- PASS: TestAPIGroupGet_InvalidId (0.01s)
    --- PASS: TestAPIGroupGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupGet_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001007] "GET http://localhost:19090/api/v1/admin/groups/57 HTTP/1.1" from [::1]:47030 - 401 22B in 74.43Âµs
--- PASS: TestAPIGroupGet_Unauthorized (0.00s)
=== RUN   TestAPIGroupGet_MemberCountAccuracy
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":272}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001008] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47044 - 200 1168B in 4.103193ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001009] "GET http://localhost:19090/api/v1/admin/groups/58 HTTP/1.1" from [::1]:47052 - 200 246B in 678.953Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001010] "GET http://localhost:19090/api/v1/admin/groups/58 HTTP/1.1" from [::1]:47058 - 200 246B in 332.007Âµs
--- PASS: TestAPIGroupGet_MemberCountAccuracy (0.01s)
=== RUN   TestAPIGroupUpdatePut_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":273}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001011] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47070 - 200 1168B in 4.229772ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_group","details":{"groupId":59,"groupIdentifier":"updated-group-Stevzm","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001012] "PUT http://localhost:19090/api/v1/admin/groups/59 HTTP/1.1" from [::1]:47084 - 200 262B in 445.341Âµs
--- PASS: TestAPIGroupUpdatePut_Success (0.01s)
=== RUN   TestAPIGroupUpdatePut_ValidationErrors
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":274}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001013] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47094 - 200 1168B in 3.909978ms
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/empty_group_identifier
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001014] "PUT http://localhost:19090/api/v1/admin/groups/60 HTTP/1.1" from [::1]:47100 - 400 79B in 288.676Âµs
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/description_too_long
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001015] "PUT http://localhost:19090/api/v1/admin/groups/60 HTTP/1.1" from [::1]:47108 - 400 115B in 341.425Âµs
=== RUN   TestAPIGroupUpdatePut_ValidationErrors/invalid_identifier_format
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001016] "PUT http://localhost:19090/api/v1/admin/groups/60 HTTP/1.1" from [::1]:47112 - 400 250B in 327.038Âµs
--- PASS: TestAPIGroupUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/empty_group_identifier (0.00s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/description_too_long (0.00s)
    --- PASS: TestAPIGroupUpdatePut_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIGroupUpdatePut_DuplicateIdentifier
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":275}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001017] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47122 - 200 1168B in 3.929695ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001018] "PUT http://localhost:19090/api/v1/admin/groups/62 HTTP/1.1" from [::1]:47130 - 400 89B in 316.518Âµs
--- PASS: TestAPIGroupUpdatePut_DuplicateIdentifier (0.00s)
=== RUN   TestAPIGroupUpdatePut_SameIdentifier
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":276}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001019] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47134 - 200 1168B in 3.947859ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_group","details":{"groupId":63,"groupIdentifier":"test-group-67e877ce","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001020] "PUT http://localhost:19090/api/v1/admin/groups/63 HTTP/1.1" from [::1]:47150 - 200 255B in 393.935Âµs
--- PASS: TestAPIGroupUpdatePut_SameIdentifier (0.01s)
=== RUN   TestAPIGroupUpdatePut_NotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":277}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001021] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47164 - 200 1168B in 3.892264ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001022] "PUT http://localhost:19090/api/v1/admin/groups/99999 HTTP/1.1" from [::1]:47166 - 404 59B in 271.262Âµs
--- PASS: TestAPIGroupUpdatePut_NotFound (0.00s)
=== RUN   TestAPIGroupUpdatePut_InvalidId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":278}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001023] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47168 - 200 1168B in 3.923493ms
=== RUN   TestAPIGroupUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001024] "PUT http://localhost:19090/api/v1/admin/groups/abc HTTP/1.1" from [::1]:47184 - 400 67B in 262.706Âµs
=== RUN   TestAPIGroupUpdatePut_InvalidId/empty_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001025] "PUT http://localhost:19090/api/v1/admin/groups/ HTTP/1.1" from [::1]:47192 - 405 0B in 233.1Âµs
=== RUN   TestAPIGroupUpdatePut_InvalidId/negative_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001026] "PUT http://localhost:19090/api/v1/admin/groups/-1 HTTP/1.1" from [::1]:47198 - 404 59B in 270.371Âµs
--- PASS: TestAPIGroupUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIGroupUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIGroupUpdatePut_InvalidRequestBody
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":279}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001027] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47200 - 200 1168B in 3.980881ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001028] "PUT http://localhost:19090/api/v1/admin/groups/64 HTTP/1.1" from [::1]:47210 - 400 70B in 322.97Âµs
--- PASS: TestAPIGroupUpdatePut_InvalidRequestBody (0.00s)
=== RUN   TestAPIGroupUpdatePut_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001029] "PUT http://localhost:19090/api/v1/admin/groups/65 HTTP/1.1" from [::1]:47224 - 401 22B in 93.166Âµs
--- PASS: TestAPIGroupUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIGroupUpdatePut_WhitespaceHandling
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":280}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001030] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47234 - 200 1168B in 3.978006ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001031] "PUT http://localhost:19090/api/v1/admin/groups/66 HTTP/1.1" from [::1]:47246 - 400 250B in 347.887Âµs
2025/11/25 13:26:09 INFO {"audit_event":"updated_group","details":{"groupId":66,"groupIdentifier":"whitespace-identifier-Ktmm","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001032] "PUT http://localhost:19090/api/v1/admin/groups/66 HTTP/1.1" from [::1]:47256 - 200 265B in 373.145Âµs
--- PASS: TestAPIGroupUpdatePut_WhitespaceHandling (0.01s)
=== RUN   TestAPIGroupUpdatePut_BooleanFlags
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":281}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001033] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47272 - 200 1168B in 3.943962ms
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/both_false
2025/11/25 13:26:09 INFO {"audit_event":"updated_group","details":{"groupId":67,"groupIdentifier":"test-bool-group-nmuKMrKr","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001034] "PUT http://localhost:19090/api/v1/admin/groups/67 HTTP/1.1" from [::1]:47282 - 200 264B in 426.546Âµs
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/id_token_only
2025/11/25 13:26:09 INFO {"audit_event":"updated_group","details":{"groupId":67,"groupIdentifier":"test-bool-group-nmuKMrKr","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001035] "PUT http://localhost:19090/api/v1/admin/groups/67 HTTP/1.1" from [::1]:47292 - 200 266B in 371.852Âµs
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/access_token_only
2025/11/25 13:26:09 INFO {"audit_event":"updated_group","details":{"groupId":67,"groupIdentifier":"test-bool-group-nmuKMrKr","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001036] "PUT http://localhost:19090/api/v1/admin/groups/67 HTTP/1.1" from [::1]:47300 - 200 270B in 395.457Âµs
=== RUN   TestAPIGroupUpdatePut_BooleanFlags/both_true
2025/11/25 13:26:09 INFO {"audit_event":"updated_group","details":{"groupId":67,"groupIdentifier":"test-bool-group-nmuKMrKr","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001037] "PUT http://localhost:19090/api/v1/admin/groups/67 HTTP/1.1" from [::1]:47314 - 200 261B in 604.482Âµs
--- PASS: TestAPIGroupUpdatePut_BooleanFlags (0.01s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/both_false (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/id_token_only (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/access_token_only (0.00s)
    --- PASS: TestAPIGroupUpdatePut_BooleanFlags/both_true (0.00s)
=== RUN   TestAPIGroupUpdatePut_MemberCountInResponse
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":282}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001038] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47318 - 200 1168B in 4.151284ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_group","details":{"groupId":68,"groupIdentifier":"test-group-d87d3405-updated","loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001039] "PUT http://localhost:19090/api/v1/admin/groups/68 HTTP/1.1" from [::1]:47322 - 200 263B in 411.758Âµs
--- PASS: TestAPIGroupUpdatePut_MemberCountInResponse (0.01s)
=== RUN   TestAPIPermissionUsersGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":283}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001040] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47338 - 200 1168B in 4.232678ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001041] "GET http://localhost:19090/api/v1/admin/permissions/27/users?page=1&size=200 HTTP/1.1" from [::1]:47344 - 200 1460B in 564.386Âµs
--- PASS: TestAPIPermissionUsersGet_Success (0.01s)
=== RUN   TestAPIPermissionUsersGet_InvalidPermissionId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":284}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001042] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47356 - 200 1168B in 4.061754ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001043] "GET http://localhost:19090/api/v1/admin/permissions/invalid/users HTTP/1.1" from [::1]:47360 - 400 79B in 291.541Âµs
--- PASS: TestAPIPermissionUsersGet_InvalidPermissionId (0.00s)
=== RUN   TestAPIPermissionUsersGet_PermissionNotFound
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":285}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001044] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47368 - 200 1168B in 4.050102ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001045] "GET http://localhost:19090/api/v1/admin/permissions/7665333/users HTTP/1.1" from [::1]:47370 - 404 64B in 269.259Âµs
--- PASS: TestAPIPermissionUsersGet_PermissionNotFound (0.00s)
=== RUN   TestAPIPermissionUsersGet_UserinfoForbidden
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":286}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001046] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47380 - 200 1168B in 4.211628ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001047] "GET http://localhost:19090/api/v1/admin/permissions/1/users HTTP/1.1" from [::1]:47388 - 400 96B in 343.73Âµs
--- PASS: TestAPIPermissionUsersGet_UserinfoForbidden (0.01s)
=== RUN   TestAPIPermissionUsersGet_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001048] "GET http://localhost:19090/api/v1/admin/permissions/28/users HTTP/1.1" from [::1]:47398 - 401 22B in 120.198Âµs
--- PASS: TestAPIPermissionUsersGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcePermissionsGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":287}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001049] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47402 - 200 1168B in 3.891643ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001050] "GET http://localhost:19090/api/v1/admin/resources/18/permissions HTTP/1.1" from [::1]:47418 - 200 643B in 599.944Âµs
--- PASS: TestAPIResourcePermissionsGet_Success (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NoPermissions
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":288}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001051] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47422 - 200 1168B in 3.933552ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001052] "GET http://localhost:19090/api/v1/admin/resources/19/permissions HTTP/1.1" from [::1]:47432 - 200 19B in 323.16Âµs
--- PASS: TestAPIResourcePermissionsGet_NoPermissions (0.00s)
=== RUN   TestAPIResourcePermissionsGet_NonExistentResource
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":289}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001053] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47438 - 200 1168B in 3.926049ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001054] "GET http://localhost:19090/api/v1/admin/resources/99999/permissions HTTP/1.1" from [::1]:47444 - 200 19B in 274.619Âµs
--- PASS: TestAPIResourcePermissionsGet_NonExistentResource (0.00s)
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":290}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001055] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47452 - 200 1168B in 3.915137ms
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/non-numeric_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001056] "GET http://localhost:19090/api/v1/admin/resources/abc/permissions HTTP/1.1" from [::1]:47454 - 400 77B in 283.525Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/empty_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001057] "GET http://localhost:19090/api/v1/admin/resources//permissions HTTP/1.1" from [::1]:47462 - 400 74B in 303.273Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/negative_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001058] "GET http://localhost:19090/api/v1/admin/resources/-1/permissions HTTP/1.1" from [::1]:47476 - 200 19B in 263.188Âµs
=== RUN   TestAPIResourcePermissionsGet_InvalidResourceId/zero_ID
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001059] "GET http://localhost:19090/api/v1/admin/resources/0/permissions HTTP/1.1" from [::1]:47482 - 200 19B in 268.658Âµs
--- PASS: TestAPIResourcePermissionsGet_InvalidResourceId (0.01s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/non-numeric_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/empty_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/negative_ID (0.00s)
    --- PASS: TestAPIResourcePermissionsGet_InvalidResourceId/zero_ID (0.00s)
=== RUN   TestAPIResourcePermissionsGet_AuthServerResourceFiltersUserinfo
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":291}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001060] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47490 - 200 1168B in 3.947439ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001061] "GET http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:47506 - 200 491B in 320.165Âµs
--- PASS: TestAPIResourcePermissionsGet_AuthServerResourceFiltersUserinfo (0.00s)
=== RUN   TestAPIResourcePermissionsGet_AuthServerResourceIncludesOtherPermissions
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":292}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001062] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47510 - 200 1168B in 3.943541ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001063] "GET http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:47512 - 200 699B in 353.669Âµs
--- PASS: TestAPIResourcePermissionsGet_AuthServerResourceIncludesOtherPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_NonAuthServerResourceIncludesAllPermissions
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":293}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001064] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47516 - 200 1168B in 3.945174ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001065] "GET http://localhost:19090/api/v1/admin/resources/20/permissions HTTP/1.1" from [::1]:47528 - 200 454B in 336.686Âµs
--- PASS: TestAPIResourcePermissionsGet_NonAuthServerResourceIncludesAllPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsGet_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001066] "GET http://localhost:19090/api/v1/admin/resources/21/permissions HTTP/1.1" from [::1]:47540 - 401 22B in 78.248Âµs
--- PASS: TestAPIResourcePermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcePermissionsGet_InvalidAccessToken
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001067] "GET http://localhost:19090/api/v1/admin/resources/22/permissions HTTP/1.1" from [::1]:47556 - 401 22B in 170.051Âµs
--- PASS: TestAPIResourcePermissionsGet_InvalidAccessToken (0.00s)
=== RUN   TestAPIResourcePermissionsGet_LargeNumberOfPermissions
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":294}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001068] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47566 - 200 1168B in 3.922952ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001069] "GET http://localhost:19090/api/v1/admin/resources/23/permissions HTTP/1.1" from [::1]:47582 - 200 2318B in 319.704Âµs
--- PASS: TestAPIResourcePermissionsGet_LargeNumberOfPermissions (0.01s)
=== RUN   TestAPIResourcePermissionsPut_Success_CreateUpdateDelete
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":295}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001070] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47590 - 200 1168B in 3.875543ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_resource_permissions","details":{"loggedInUser":"","resourceId":24}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001071] "PUT http://localhost:19090/api/v1/admin/resources/24/permissions HTTP/1.1" from [::1]:47602 - 200 17B in 526.034Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001072] "GET http://localhost:19090/api/v1/admin/resources/24/permissions HTTP/1.1" from [::1]:47612 - 200 539B in 296.982Âµs
--- PASS: TestAPIResourcePermissionsPut_Success_CreateUpdateDelete (0.01s)
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":296}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001073] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47614 - 200 1168B in 4.127188ms
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/empty_identifier
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001074] "PUT http://localhost:19090/api/v1/admin/resources/25/permissions HTTP/1.1" from [::1]:47628 - 400 84B in 346.675Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/invalid_format
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001075] "PUT http://localhost:19090/api/v1/admin/resources/25/permissions HTTP/1.1" from [::1]:47642 - 400 250B in 381.01Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/html_in_description
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001076] "PUT http://localhost:19090/api/v1/admin/resources/25/permissions HTTP/1.1" from [::1]:47648 - 400 151B in 294.527Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/too_long_description
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001077] "PUT http://localhost:19090/api/v1/admin/resources/25/permissions HTTP/1.1" from [::1]:47658 - 400 116B in 353.969Âµs
=== RUN   TestAPIResourcePermissionsPut_ValidationErrors/duplicate_identifiers
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001078] "PUT http://localhost:19090/api/v1/admin/resources/25/permissions HTTP/1.1" from [::1]:47668 - 400 80B in 319.023Âµs
--- PASS: TestAPIResourcePermissionsPut_ValidationErrors (0.01s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/empty_identifier (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/invalid_format (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/html_in_description (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/too_long_description (0.00s)
    --- PASS: TestAPIResourcePermissionsPut_ValidationErrors/duplicate_identifiers (0.00s)
=== RUN   TestAPIResourcePermissionsPut_UpdateConflict
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":297}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001079] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47682 - 200 1168B in 4.069049ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001080] "PUT http://localhost:19090/api/v1/admin/resources/26/permissions HTTP/1.1" from [::1]:47690 - 400 95B in 387.973Âµs
--- PASS: TestAPIResourcePermissionsPut_UpdateConflict (0.01s)
=== RUN   TestAPIResourcePermissionsPut_SystemResourceDenied
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":298}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001081] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47694 - 200 1168B in 3.924766ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001082] "PUT http://localhost:19090/api/v1/admin/resources/1/permissions HTTP/1.1" from [::1]:47700 - 400 92B in 311.418Âµs
--- PASS: TestAPIResourcePermissionsPut_SystemResourceDenied (0.00s)
=== RUN   TestAPIResourcePermissionsPut_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001083] "PUT http://localhost:19090/api/v1/admin/resources/27/permissions HTTP/1.1" from [::1]:47710 - 401 22B in 91.523Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001084] "PUT http://localhost:19090/api/v1/admin/resources/27/permissions HTTP/1.1" from [::1]:47724 - 401 22B in 140.456Âµs
--- PASS: TestAPIResourcePermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIResourcesCreate_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":299}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001085] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47740 - 200 1168B in 3.935355ms
2025/11/25 13:26:09 INFO {"audit_event":"created_resource","details":{"loggedInUser":"","resourceId":28,"resourceIdentifier":"api-test-create-resource-gjEAsSag"}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001086] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47744 - 201 112B in 380.639Âµs
--- PASS: TestAPIResourcesCreate_Success (0.00s)
=== RUN   TestAPIResourcesCreate_ValidationErrors
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":300}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001087] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47746 - 200 1168B in 4.503669ms
=== RUN   TestAPIResourcesCreate_ValidationErrors/missing_identifier
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001088] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47750 - 400 82B in 297.913Âµs
=== RUN   TestAPIResourcesCreate_ValidationErrors/too_long_description
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001089] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47766 - 400 115B in 299.346Âµs
=== RUN   TestAPIResourcesCreate_ValidationErrors/invalid_identifier_format
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001090] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47778 - 400 250B in 268.587Âµs
--- PASS: TestAPIResourcesCreate_ValidationErrors (0.01s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/missing_identifier (0.00s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/too_long_description (0.00s)
    --- PASS: TestAPIResourcesCreate_ValidationErrors/invalid_identifier_format (0.00s)
=== RUN   TestAPIResourcesCreate_DuplicateIdentifier
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":301}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001091] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47792 - 200 1168B in 4.510132ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001092] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47796 - 400 92B in 353.137Âµs
--- PASS: TestAPIResourcesCreate_DuplicateIdentifier (0.01s)
=== RUN   TestAPIResourcesCreate_InvalidRequestBody
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":302}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001093] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47808 - 200 1168B in 4.025306ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001094] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47810 - 400 70B in 266.784Âµs
--- PASS: TestAPIResourcesCreate_InvalidRequestBody (0.00s)
=== RUN   TestAPIResourcesCreate_UnauthorizedAndScope
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001095] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47820 - 401 22B in 129.645Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001096] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47828 - 401 22B in 175.492Âµs
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":303}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001097] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47832 - 200 1177B in 4.04917ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001098] "POST http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:47846 - 403 19B in 302.792Âµs
--- PASS: TestAPIResourcesCreate_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceDelete_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":304}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001099] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47858 - 200 1168B in 4.448345ms
2025/11/25 13:26:09 INFO {"audit_event":"deleted_resource","details":{"loggedInUser":"","resourceId":30,"resourceIdentifier":"api-test-del-resource-svtFHq"}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001100] "DELETE http://localhost:19090/api/v1/admin/resources/30 HTTP/1.1" from [::1]:47872 - 200 17B in 365.771Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001101] "GET http://localhost:19090/api/v1/admin/resources/30 HTTP/1.1" from [::1]:47876 - 404 62B in 254.391Âµs
--- PASS: TestAPIResourceDelete_Success (0.01s)
=== RUN   TestAPIResourceDelete_NotFoundAndInvalidId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":305}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001102] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47880 - 200 1168B in 3.981884ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001103] "DELETE http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:47884 - 404 62B in 283.867Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001104] "DELETE http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:47886 - 400 70B in 261.224Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001105] "DELETE http://localhost:19090/api/v1/admin/resources/-1 HTTP/1.1" from [::1]:47896 - 404 62B in 248.67Âµs
--- PASS: TestAPIResourceDelete_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIResourceDelete_SystemLevelResource
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":306}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001106] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47904 - 200 1168B in 3.971314ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001107] "DELETE http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:47910 - 400 91B in 301.369Âµs
--- PASS: TestAPIResourceDelete_SystemLevelResource (0.00s)
=== RUN   TestAPIResourceDelete_UnauthorizedAndScope
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001108] "DELETE http://localhost:19090/api/v1/admin/resources/31 HTTP/1.1" from [::1]:47926 - 401 22B in 78.127Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001109] "DELETE http://localhost:19090/api/v1/admin/resources/31 HTTP/1.1" from [::1]:47936 - 401 22B in 142.338Âµs
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":307}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001110] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47944 - 200 1177B in 3.913645ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001111] "DELETE http://localhost:19090/api/v1/admin/resources/31 HTTP/1.1" from [::1]:47950 - 403 19B in 253.259Âµs
--- PASS: TestAPIResourceDelete_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":308}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001112] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47964 - 200 1168B in 3.966865ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001113] "GET http://localhost:19090/api/v1/admin/resources/32 HTTP/1.1" from [::1]:47970 - 200 104B in 281.441Âµs
--- PASS: TestAPIResourceGet_Success (0.00s)
=== RUN   TestAPIResourceGet_NotFoundAndInvalidId
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":309}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001114] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47982 - 200 1168B in 3.950795ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001115] "GET http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:47994 - 404 62B in 312.921Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001116] "GET http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:48004 - 400 70B in 233.842Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001117] "GET http://localhost:19090/api/v1/admin/resources/-1 HTTP/1.1" from [::1]:48016 - 404 62B in 299.817Âµs
--- PASS: TestAPIResourceGet_NotFoundAndInvalidId (0.01s)
=== RUN   TestAPIResourceGet_UnauthorizedAndScope
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001118] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:48030 - 401 22B in 75.723Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001119] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:48044 - 401 22B in 164.892Âµs
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":310}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001120] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48052 - 200 1177B in 3.886744ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001121] "GET http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:48060 - 403 19B in 251.135Âµs
--- PASS: TestAPIResourceGet_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourceUpdatePut_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":311}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001122] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48066 - 200 1168B in 4.000068ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_resource","details":{"loggedInUser":"","resourceId":33,"resourceIdentifier":"updated-resource-lXLKMv"}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001123] "PUT http://localhost:19090/api/v1/admin/resources/33 HTTP/1.1" from [::1]:48074 - 200 99B in 362.074Âµs
--- PASS: TestAPIResourceUpdatePut_Success (0.01s)
=== RUN   TestAPIResourceUpdatePut_ValidationErrors
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":312}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001124] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48086 - 200 1168B in 3.929224ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001125] "PUT http://localhost:19090/api/v1/admin/resources/34 HTTP/1.1" from [::1]:48096 - 400 82B in 274.208Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001126] "PUT http://localhost:19090/api/v1/admin/resources/34 HTTP/1.1" from [::1]:48104 - 400 115B in 249.462Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001127] "PUT http://localhost:19090/api/v1/admin/resources/34 HTTP/1.1" from [::1]:48112 - 400 250B in 248.329Âµs
--- PASS: TestAPIResourceUpdatePut_ValidationErrors (0.01s)
=== RUN   TestAPIResourceUpdatePut_DuplicateIdentifier
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":313}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001128] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48124 - 200 1168B in 3.894329ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001129] "PUT http://localhost:19090/api/v1/admin/resources/36 HTTP/1.1" from [::1]:48140 - 400 92B in 291.171Âµs
--- PASS: TestAPIResourceUpdatePut_DuplicateIdentifier (0.00s)
=== RUN   TestAPIResourceUpdatePut_SystemLevelResource
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":314}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001130] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48148 - 200 1168B in 4.007031ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001131] "PUT http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:48162 - 400 101B in 307.43Âµs
--- PASS: TestAPIResourceUpdatePut_SystemLevelResource (0.00s)
=== RUN   TestAPIResourceUpdatePut_InvalidIdAndBody
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":315}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001132] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48166 - 200 1168B in 3.95356ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001133] "PUT http://localhost:19090/api/v1/admin/resources/abc HTTP/1.1" from [::1]:48180 - 400 70B in 455.561Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001134] "PUT http://localhost:19090/api/v1/admin/resources/9999999 HTTP/1.1" from [::1]:48192 - 404 62B in 308.513Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001135] "PUT http://localhost:19090/api/v1/admin/resources/1 HTTP/1.1" from [::1]:48208 - 400 101B in 322.078Âµs
--- PASS: TestAPIResourceUpdatePut_InvalidIdAndBody (0.01s)
=== RUN   TestAPIResourceUpdatePut_UnauthorizedAndScope
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001136] "PUT http://localhost:19090/api/v1/admin/resources/37 HTTP/1.1" from [::1]:48218 - 401 22B in 83.097Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001137] "PUT http://localhost:19090/api/v1/admin/resources/37 HTTP/1.1" from [::1]:48228 - 401 22B in 178.718Âµs
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":316}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001138] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48234 - 200 1177B in 3.879169ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001139] "PUT http://localhost:19090/api/v1/admin/resources/37 HTTP/1.1" from [::1]:48242 - 403 19B in 277.053Âµs
--- PASS: TestAPIResourceUpdatePut_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIResourcesGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":317}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001140] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48254 - 200 1168B in 3.928612ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001141] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48270 - 200 913B in 307.311Âµs
--- PASS: TestAPIResourcesGet_Success (0.01s)
=== RUN   TestAPIResourcesGet_EmptyDatabase
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":318}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001142] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48274 - 200 1168B in 3.888247ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001143] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48278 - 200 735B in 385.959Âµs
--- PASS: TestAPIResourcesGet_EmptyDatabase (0.00s)
=== RUN   TestAPIResourcesGet_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001144] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48280 - 401 22B in 207.392Âµs
--- PASS: TestAPIResourcesGet_Unauthorized (0.00s)
=== RUN   TestAPIResourcesGet_InvalidToken
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001145] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48288 - 401 22B in 196.701Âµs
--- PASS: TestAPIResourcesGet_InvalidToken (0.00s)
=== RUN   TestAPIResourcesGet_InsufficientScope
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":319}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001146] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48300 - 200 1177B in 4.12792ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001147] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48304 - 403 19B in 312.33Âµs
--- PASS: TestAPIResourcesGet_InsufficientScope (0.01s)
=== RUN   TestAPIResourcesGet_ManyResources
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":320}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001148] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48312 - 200 1168B in 4.047989ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001149] "GET http://localhost:19090/api/v1/admin/resources HTTP/1.1" from [::1]:48322 - 200 1018B in 343.869Âµs
--- PASS: TestAPIResourcesGet_ManyResources (0.01s)
=== RUN   TestAPISettingsEmailGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":321}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001150] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48334 - 200 1168B in 4.055603ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001151] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48342 - 200 186B in 329.723Âµs
--- PASS: TestAPISettingsEmailGet_Success (0.01s)
=== RUN   TestAPISettingsEmailPut_EnableSuccess
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":322}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001152] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48348 - 200 1168B in 3.982244ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001153] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48364 - 200 190B in 869.392Âµs
--- PASS: TestAPISettingsEmailPut_EnableSuccess (0.01s)
=== RUN   TestAPISettingsEmailPut_DisableResetsFields
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":323}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001154] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48368 - 200 1168B in 4.132097ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001155] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48382 - 200 192B in 866.938Âµs
2025/11/25 13:26:09 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001156] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48388 - 200 152B in 378.034Âµs
--- PASS: TestAPISettingsEmailPut_DisableResetsFields (0.01s)
=== RUN   TestAPISettingsEmailPut_ValidationErrors
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":324}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001157] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48400 - 200 1168B in 4.0015ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001158] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48412 - 400 73B in 310.056Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001159] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48422 - 400 73B in 259.421Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001160] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48436 - 400 89B in 256.304Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001161] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48446 - 400 94B in 252.086Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001162] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48450 - 400 75B in 596.858Âµs
--- PASS: TestAPISettingsEmailPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsEmailPut_TCPConnectionFailure
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":325}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001163] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48466 - 200 1168B in 3.970402ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001164] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48482 - 400 142B in 415.455Âµs
--- PASS: TestAPISettingsEmailPut_TCPConnectionFailure (0.01s)
=== RUN   TestAPISettingsEmailPut_PasswordLifecycle
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":326}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001165] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48492 - 200 1168B in 4.024264ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001166] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48508 - 200 180B in 672.892Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001167] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48510 - 200 180B in 274.528Âµs
2025/11/25 13:26:09 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001168] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48522 - 200 181B in 525.042Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001169] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48530 - 200 181B in 271.292Âµs
--- PASS: TestAPISettingsEmailPut_PasswordLifecycle (0.01s)
=== RUN   TestAPISettingsEmailSendTest_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":327}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001170] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48536 - 200 1168B in 3.974891ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001171] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48540 - 200 181B in 524.1Âµs
2025/11/25 13:26:09 INFO {"audit_event":"sent_test_email","details":{"loggedInUser":"","to":"someone@example.com"}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001172] "POST http://localhost:19090/api/v1/admin/settings/email/send-test HTTP/1.1" from [::1]:48548 - 200 17B in 676.949Âµs
--- PASS: TestAPISettingsEmailSendTest_Success (0.01s)
=== RUN   TestAPISettingsEmailSendTest_SMTPDisabled
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":328}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001173] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48554 - 200 1168B in 3.942189ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_smtp_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001174] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48568 - 200 152B in 368.647Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001175] "POST http://localhost:19090/api/v1/admin/settings/email/send-test HTTP/1.1" from [::1]:48580 - 400 70B in 256.265Âµs
--- PASS: TestAPISettingsEmailSendTest_SMTPDisabled (0.01s)
=== RUN   TestAPISettingsEmail_Unauthorized
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001176] "GET http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48588 - 401 22B in 68.138Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001177] "PUT http://localhost:19090/api/v1/admin/settings/email HTTP/1.1" from [::1]:48588 - 401 22B in 96.453Âµs
--- PASS: TestAPISettingsEmail_Unauthorized (0.00s)
=== RUN   TestAPISettingsGeneralGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":329}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001178] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48594 - 200 1168B in 3.939344ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001179] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48598 - 200 223B in 263.248Âµs
--- PASS: TestAPISettingsGeneralGet_Success (0.00s)
=== RUN   TestAPISettingsGeneralPut_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":330}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001180] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48610 - 200 1168B in 3.919035ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001181] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48626 - 200 221B in 354.38Âµs
--- PASS: TestAPISettingsGeneralPut_Success (0.00s)
=== RUN   TestAPISettingsGeneralPut_DisableSelfRegForcesVerificationFalse
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":331}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001182] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48628 - 200 1164B in 3.977636ms
2025/11/25 13:26:09 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001183] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48632 - 200 210B in 354.981Âµs
2025/11/25 13:26:09 INFO {"audit_event":"updated_general_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001184] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48638 - 200 212B in 345.122Âµs
--- PASS: TestAPISettingsGeneralPut_DisableSelfRegForcesVerificationFalse (0.01s)
=== RUN   TestAPISettingsGeneralPut_ValidationErrors
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":332}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001185] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48642 - 200 1156B in 3.914376ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001186] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48654 - 400 109B in 287.854Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001187] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48664 - 400 92B in 278.155Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001188] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48666 - 400 239B in 264.069Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001189] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48680 - 400 239B in 278.016Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001190] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48694 - 400 107B in 256.424Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001191] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48710 - 400 107B in 243.931Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001192] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48720 - 400 74B in 304.595Âµs
--- PASS: TestAPISettingsGeneralPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsGeneral_UnauthorizedAndScope
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001193] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48722 - 401 22B in 71.575Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001194] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48724 - 401 22B in 152.579Âµs
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":333}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001195] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48730 - 200 1165B in 3.914116ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001196] "GET http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48734 - 403 19B in 238.11Âµs
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001197] "PUT http://localhost:19090/api/v1/admin/settings/general HTTP/1.1" from [::1]:48722 - 401 22B in 80.131Âµs
--- PASS: TestAPISettingsGeneral_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsKeysGet_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":334}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001198] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48738 - 200 1156B in 3.888587ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001199] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48748 - 200 5242B in 357.976Âµs
--- PASS: TestAPISettingsKeysGet_Success (0.00s)
=== RUN   TestAPISettingsKeysRotatePost_Success
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":335}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001200] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48764 - 200 1156B in 3.947789ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001201] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48776 - 200 5242B in 1.425874ms
2025/11/25 13:26:09 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001202] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48782 - 200 17B in 299.294262ms
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001203] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48784 - 200 7860B in 701.024Âµs
--- PASS: TestAPISettingsKeysRotatePost_Success (0.31s)
=== RUN   TestAPISettingsKeysRotatePost_DeletesPrevious
2025/11/25 13:26:09 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":336}}
2025/11/25 13:26:09 [a357f2e3b56e/FBsnpuLk6O-001204] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48788 - 200 1156B in 3.97974ms
2025/11/25 13:26:10 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001205] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48804 - 200 17B in 405.431753ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001206] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48808 - 200 7860B in 1.038823ms
2025/11/25 13:26:10 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001207] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48824 - 200 17B in 86.410018ms
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":337}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001208] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48844 - 200 1156B in 3.958659ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001209] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48854 - 200 7860B in 536.745Âµs
--- PASS: TestAPISettingsKeysRotatePost_DeletesPrevious (0.50s)
=== RUN   TestAPISettingsKeyDelete_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":338}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001210] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48864 - 200 1156B in 3.936578ms
2025/11/25 13:26:10 INFO {"audit_event":"rotated_keys","details":{"loggedInUser":""}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001211] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48872 - 200 17B in 325.836082ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001212] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48888 - 200 7860B in 810.442Âµs
2025/11/25 13:26:10 INFO {"audit_event":"revoked_key","details":{"keyId":"fe63f317-5cfa-448d-adf9-550e9ca44a8b","loggedInUser":""}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001213] "DELETE http://localhost:19090/api/v1/admin/settings/keys/4 HTTP/1.1" from [::1]:48902 - 200 17B in 606.285Âµs
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":339}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001214] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48916 - 200 1156B in 4.390445ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001215] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48926 - 200 5242B in 345.392Âµs
--- PASS: TestAPISettingsKeyDelete_Success (0.34s)
=== RUN   TestAPISettingsKeyDelete_ValidationAndUnauthorized
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":340}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001216] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:48936 - 200 1156B in 4.016218ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001217] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48952 - 200 5242B in 330.104Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001218] "DELETE http://localhost:19090/api/v1/admin/settings/keys/5 HTTP/1.1" from [::1]:48964 - 400 85B in 321.507Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001219] "DELETE http://localhost:19090/api/v1/admin/settings/keys/99999999 HTTP/1.1" from [::1]:48974 - 400 64B in 257.567Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001220] "GET http://localhost:19090/api/v1/admin/settings/keys HTTP/1.1" from [::1]:48986 - 401 22B in 109.888Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001221] "POST http://localhost:19090/api/v1/admin/settings/keys/rotate HTTP/1.1" from [::1]:48986 - 401 22B in 86.674Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001222] "DELETE http://localhost:19090/api/v1/admin/settings/keys/1 HTTP/1.1" from [::1]:49002 - 401 22B in 86.373Âµs
--- PASS: TestAPISettingsKeyDelete_ValidationAndUnauthorized (0.01s)
=== RUN   TestAPISettingsSessionsGet_Success
2025/11/25 13:26:10 INFO worker task started
2025/11/25 13:26:10 INFO deleted expired or revoked refresh tokens
2025/11/25 13:26:10 INFO deleted used codes without refresh tokens
2025/11/25 13:26:10 INFO deleted idle sessions (idle timeout: 7200 seconds)
2025/11/25 13:26:10 INFO deleted expired sessions (max lifetime: 86400 seconds)
2025/11/25 13:26:10 INFO worker task completed
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":341}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001223] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49008 - 200 1156B in 3.883858ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001224] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49014 - 200 81B in 256.003Âµs
--- PASS: TestAPISettingsSessionsGet_Success (0.00s)
=== RUN   TestAPISettingsSessionsPut_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":342}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001225] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49032 - 200 1156B in 3.908756ms
2025/11/25 13:26:10 INFO {"audit_event":"updated_sessions_settings","details":{"loggedInUser":""}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001226] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49036 - 200 80B in 343.62Âµs
--- PASS: TestAPISettingsSessionsPut_Success (0.00s)
=== RUN   TestAPISettingsSessionsPut_ValidationErrors
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":343}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001227] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49046 - 200 1156B in 4.015196ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001228] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49058 - 400 116B in 293.274Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001229] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49060 - 400 116B in 287.763Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001230] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49064 - 400 123B in 307.081Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001231] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49066 - 400 123B in 277.895Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001232] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49070 - 400 123B in 249.06Âµs
--- PASS: TestAPISettingsSessionsPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsSessionsPut_InvalidRequestBodyAndUnauthorized
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":344}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001233] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49082 - 200 1156B in 3.902133ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001234] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49086 - 400 70B in 288.786Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001235] "PUT http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49086 - 401 22B in 70.433Âµs
--- PASS: TestAPISettingsSessionsPut_InvalidRequestBodyAndUnauthorized (0.00s)
=== RUN   TestAPISettingsSessions_UnauthorizedAndScope
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001236] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49098 - 401 22B in 80.252Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001237] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49110 - 401 22B in 156.997Âµs
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":345}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001238] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49120 - 200 1165B in 3.964311ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001239] "GET http://localhost:19090/api/v1/admin/settings/sessions HTTP/1.1" from [::1]:49124 - 403 19B in 293.995Âµs
--- PASS: TestAPISettingsSessions_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsTokensGet_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":346}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001240] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49132 - 200 1156B in 3.901131ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001241] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49142 - 200 182B in 294.336Âµs
--- PASS: TestAPISettingsTokensGet_Success (0.00s)
=== RUN   TestAPISettingsTokensPut_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":347}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001242] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49144 - 200 1156B in 3.896813ms
2025/11/25 13:26:10 INFO {"audit_event":"updated_tokens_settings","details":{"loggedInUser":"","new":{"includeOpenIDConnectClaimsInAccessToken":true,"refreshTokenOfflineIdleTimeoutInSeconds":3600,"refreshTokenOfflineMaxLifetimeInSeconds":7200,"tokenExpirationInSeconds":600},"old":{"includeOpenIDConnectClaimsInAccessToken":false,"refreshTokenOfflineIdleTimeoutInSeconds":2592000,"refreshTokenOfflineMaxLifetimeInSeconds":31536000,"tokenExpirationInSeconds":300}}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001243] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49150 - 200 174B in 367.284Âµs
--- PASS: TestAPISettingsTokensPut_Success (0.00s)
=== RUN   TestAPISettingsTokensPut_ValidationErrors
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":348}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001244] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49164 - 200 1156B in 3.931558ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001245] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49166 - 400 105B in 290.789Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001246] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49170 - 400 112B in 264.931Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001247] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49176 - 400 125B in 249.582Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001248] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49190 - 400 132B in 245.284Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001249] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49192 - 400 125B in 257.717Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001250] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49206 - 400 132B in 235.344Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001251] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49218 - 400 124B in 234.032Âµs
--- PASS: TestAPISettingsTokensPut_ValidationErrors (0.01s)
=== RUN   TestAPISettingsTokens_InvalidRequestBodyAndUnauthorized
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":349}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001252] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49226 - 200 1156B in 4.004867ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001253] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49232 - 400 70B in 252.247Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001254] "PUT http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49232 - 401 22B in 75.182Âµs
--- PASS: TestAPISettingsTokens_InvalidRequestBodyAndUnauthorized (0.00s)
=== RUN   TestAPISettingsTokens_UnauthorizedAndScope
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001255] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49236 - 401 22B in 69.211Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001256] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49242 - 401 22B in 122.572Âµs
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":350}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001257] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49256 - 200 1165B in 3.965783ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001258] "GET http://localhost:19090/api/v1/admin/settings/tokens HTTP/1.1" from [::1]:49258 - 403 19B in 242.979Âµs
--- PASS: TestAPISettingsTokens_UnauthorizedAndScope (0.01s)
=== RUN   TestAPISettingsUIThemeGet_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":351}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001259] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49272 - 200 1156B in 3.904648ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001260] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49274 - 200 333B in 295.428Âµs
--- PASS: TestAPISettingsUIThemeGet_Success (0.00s)
=== RUN   TestAPISettingsUIThemePut_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":352}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001261] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49282 - 200 1156B in 3.952488ms
2025/11/25 13:26:10 INFO {"audit_event":"updated_ui_theme_settings","details":{"loggedInUser":"","newUITheme":"light","oldUITheme":""}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001262] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49284 - 200 338B in 341.766Âµs
2025/11/25 13:26:10 INFO {"audit_event":"updated_ui_theme_settings","details":{"loggedInUser":"","newUITheme":"","oldUITheme":"light"}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001263] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49298 - 200 333B in 387.002Âµs
--- PASS: TestAPISettingsUIThemePut_Success (0.01s)
=== RUN   TestAPISettingsUIThemePut_ValidationErrors
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":353}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001264] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49304 - 200 1156B in 3.983126ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001265] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49310 - 400 65B in 256.064Âµs
--- PASS: TestAPISettingsUIThemePut_ValidationErrors (0.00s)
=== RUN   TestAPISettingsUITheme_InvalidRequestBodyAndUnauthorized
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":354}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001266] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49320 - 200 1156B in 4.650787ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001267] "PUT http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49322 - 400 70B in 265.111Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001268] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49322 - 401 22B in 96.632Âµs
--- PASS: TestAPISettingsUITheme_InvalidRequestBodyAndUnauthorized (0.01s)
=== RUN   TestAPISettingsUITheme_UnauthorizedAndScope
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001269] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49336 - 401 22B in 80.613Âµs
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001270] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49350 - 401 22B in 192.594Âµs
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":355}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001271] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49364 - 200 1165B in 3.903996ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001272] "GET http://localhost:19090/api/v1/admin/settings/ui-theme HTTP/1.1" from [::1]:49376 - 403 19B in 261.254Âµs
--- PASS: TestAPISettingsUITheme_UnauthorizedAndScope (0.01s)
=== RUN   TestAPIUserGroupsGet_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":356}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001273] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49382 - 200 1156B in 4.02752ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001274] "GET http://localhost:19090/api/v1/admin/users/78/groups HTTP/1.1" from [::1]:49396 - 200 1258B in 413.851Âµs
--- PASS: TestAPIUserGroupsGet_Success (0.01s)
=== RUN   TestAPIUserGroupsGet_NoGroups
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":357}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49408 - 200 1156B in 3.934293ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001276] "GET http://localhost:19090/api/v1/admin/users/79/groups HTTP/1.1" from [::1]:49410 - 200 718B in 354.59Âµs
--- PASS: TestAPIUserGroupsGet_NoGroups (0.01s)
=== RUN   TestAPIUserGroupsGet_UserNotFound
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":358}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001277] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49426 - 200 1156B in 3.878027ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001278] "GET http://localhost:19090/api/v1/admin/users/99999/groups HTTP/1.1" from [::1]:49430 - 404 63B in 354.47Âµs
--- PASS: TestAPIUserGroupsGet_UserNotFound (0.00s)
=== RUN   TestAPIUserGroupsGet_InvalidId
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":359}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49436 - 200 1156B in 3.883758ms
=== RUN   TestAPIUserGroupsGet_InvalidId/non-numeric_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001280] "GET http://localhost:19090/api/v1/admin/users/abc/groups HTTP/1.1" from [::1]:49452 - 400 65B in 278.256Âµs
=== RUN   TestAPIUserGroupsGet_InvalidId/empty_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001281] "GET http://localhost:19090/api/v1/admin/users//groups HTTP/1.1" from [::1]:49454 - 400 69B in 248.77Âµs
=== RUN   TestAPIUserGroupsGet_InvalidId/negative_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001282] "GET http://localhost:19090/api/v1/admin/users/-1/groups HTTP/1.1" from [::1]:49462 - 404 63B in 327.198Âµs
--- PASS: TestAPIUserGroupsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGroupsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGroupsGet_Unauthorized
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001283] "GET http://localhost:19090/api/v1/admin/users/80/groups HTTP/1.1" from [::1]:49464 - 401 22B in 75.854Âµs
--- PASS: TestAPIUserGroupsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserGroupsPut_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":360}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001284] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49478 - 200 1156B in 3.890892ms
2025/11/25 13:26:10 INFO {"audit_event":"user_added_to_group","details":{"groupId":73,"loggedInUser":"","userId":81}}
2025/11/25 13:26:10 INFO {"audit_event":"user_removed_from_group","details":{"groupId":71,"loggedInUser":"","userId":81}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001285] "PUT http://localhost:19090/api/v1/admin/users/81/groups HTTP/1.1" from [::1]:49490 - 200 1821B in 592.048Âµs
--- PASS: TestAPIUserGroupsPut_Success (0.01s)
=== RUN   TestAPIUserGroupsPut_EmptyGroups
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":361}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001286] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49494 - 200 1156B in 3.917341ms
2025/11/25 13:26:10 INFO {"audit_event":"user_removed_from_group","details":{"groupId":74,"loggedInUser":"","userId":82}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001287] "PUT http://localhost:19090/api/v1/admin/users/82/groups HTTP/1.1" from [::1]:49504 - 200 721B in 492.58Âµs
--- PASS: TestAPIUserGroupsPut_EmptyGroups (0.01s)
=== RUN   TestAPIUserGroupsPut_NonExistentGroup
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":362}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001288] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49516 - 200 1156B in 3.89545ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001289] "PUT http://localhost:19090/api/v1/admin/users/83/groups HTTP/1.1" from [::1]:49532 - 400 79B in 394.315Âµs
--- PASS: TestAPIUserGroupsPut_NonExistentGroup (0.01s)
=== RUN   TestAPIUserGroupsPut_UserNotFound
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":363}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001290] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49540 - 200 1156B in 3.938242ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001291] "PUT http://localhost:19090/api/v1/admin/users/99999/groups HTTP/1.1" from [::1]:49548 - 404 63B in 322.389Âµs
--- PASS: TestAPIUserGroupsPut_UserNotFound (0.01s)
=== RUN   TestAPIUserGroupsPut_InvalidId
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":364}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001292] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49556 - 200 1156B in 3.931578ms
=== RUN   TestAPIUserGroupsPut_InvalidId/non-numeric_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001293] "PUT http://localhost:19090/api/v1/admin/users/abc/groups HTTP/1.1" from [::1]:49572 - 400 65B in 278.305Âµs
=== RUN   TestAPIUserGroupsPut_InvalidId/empty_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001294] "PUT http://localhost:19090/api/v1/admin/users//groups HTTP/1.1" from [::1]:49576 - 400 69B in 246.034Âµs
=== RUN   TestAPIUserGroupsPut_InvalidId/negative_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001295] "PUT http://localhost:19090/api/v1/admin/users/-1/groups HTTP/1.1" from [::1]:49582 - 404 63B in 347.277Âµs
--- PASS: TestAPIUserGroupsPut_InvalidId (0.01s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGroupsPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGroupsPut_InvalidRequestBody
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":365}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001296] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49592 - 200 1156B in 3.908485ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001297] "PUT http://localhost:19090/api/v1/admin/users/84/groups HTTP/1.1" from [::1]:49606 - 400 70B in 428.65Âµs
--- PASS: TestAPIUserGroupsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserGroupsPut_Unauthorized
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001298] "PUT http://localhost:19090/api/v1/admin/users/85/groups HTTP/1.1" from [::1]:49610 - 401 22B in 135.075Âµs
--- PASS: TestAPIUserGroupsPut_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributesGet_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":366}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001299] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49612 - 200 1156B in 4.122319ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001300] "GET http://localhost:19090/api/v1/admin/users/86/attributes HTTP/1.1" from [::1]:49616 - 200 419B in 384.166Âµs
--- PASS: TestAPIUserAttributesGet_Success (0.01s)
=== RUN   TestAPIUserAttributesGet_EmptyAttributes
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":367}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001301] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49626 - 200 1156B in 4.016859ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001302] "GET http://localhost:19090/api/v1/admin/users/87/attributes HTTP/1.1" from [::1]:49642 - 200 20B in 420.655Âµs
--- PASS: TestAPIUserAttributesGet_EmptyAttributes (0.01s)
=== RUN   TestAPIUserAttributesGet_UserNotFound
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":368}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001303] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49658 - 200 1156B in 4.058438ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001304] "GET http://localhost:19090/api/v1/admin/users/99999/attributes HTTP/1.1" from [::1]:49668 - 404 63B in 343.98Âµs
--- PASS: TestAPIUserAttributesGet_UserNotFound (0.00s)
=== RUN   TestAPIUserAttributesGet_InvalidId
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":369}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001305] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49680 - 200 1156B in 4.393631ms
=== RUN   TestAPIUserAttributesGet_InvalidId/non-numeric_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001306] "GET http://localhost:19090/api/v1/admin/users/abc/attributes HTTP/1.1" from [::1]:49696 - 400 65B in 303.984Âµs
=== RUN   TestAPIUserAttributesGet_InvalidId/empty_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001307] "GET http://localhost:19090/api/v1/admin/users//attributes HTTP/1.1" from [::1]:49704 - 400 70B in 234.003Âµs
=== RUN   TestAPIUserAttributesGet_InvalidId/negative_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001308] "GET http://localhost:19090/api/v1/admin/users/-1/attributes HTTP/1.1" from [::1]:49706 - 404 63B in 600.484Âµs
--- PASS: TestAPIUserAttributesGet_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributesGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributesGet_Unauthorized
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001309] "GET http://localhost:19090/api/v1/admin/users/88/attributes HTTP/1.1" from [::1]:49716 - 401 22B in 113.244Âµs
--- PASS: TestAPIUserAttributesGet_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeGet_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":370}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001310] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49730 - 200 1156B in 3.826891ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001311] "GET http://localhost:19090/api/v1/admin/user-attributes/3 HTTP/1.1" from [::1]:49742 - 200 209B in 341.435Âµs
--- PASS: TestAPIUserAttributeGet_Success (0.00s)
=== RUN   TestAPIUserAttributeGet_NotFound
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":371}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001312] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49744 - 200 1156B in 3.87962ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001313] "GET http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:49758 - 404 73B in 287.333Âµs
--- PASS: TestAPIUserAttributeGet_NotFound (0.00s)
=== RUN   TestAPIUserAttributeGet_InvalidId
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":372}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001314] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49766 - 200 1156B in 3.86926ms
=== RUN   TestAPIUserAttributeGet_InvalidId/non-numeric_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001315] "GET http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:49774 - 400 75B in 247.507Âµs
=== RUN   TestAPIUserAttributeGet_InvalidId/empty_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001316] "GET http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:49788 - 405 0B in 287.373Âµs
=== RUN   TestAPIUserAttributeGet_InvalidId/negative_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001317] "GET http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:49804 - 404 73B in 286.862Âµs
--- PASS: TestAPIUserAttributeGet_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeGet_Unauthorized
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001318] "GET http://localhost:19090/api/v1/admin/user-attributes/4 HTTP/1.1" from [::1]:49810 - 401 22B in 108.595Âµs
--- PASS: TestAPIUserAttributeGet_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeCreatePost_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":373}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001319] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49822 - 200 1156B in 3.891613ms
2025/11/25 13:26:10 INFO {"audit_event":"added_user_attribute","details":{"loggedInUser":"admin-test-client-kxylLBfd","userAttributeId":5,"userId":91}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001320] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49840 - 201 218B in 607.197Âµs
--- PASS: TestAPIUserAttributeCreatePost_Success (0.01s)
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":374}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001321] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49848 - 200 1156B in 3.920727ms
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/missing_key
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001322] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49850 - 400 72B in 304.435Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/empty_key
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001323] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49854 - 400 72B in 257.807Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/value_too_long
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001324] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49858 - 400 117B in 401.558Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/invalid_key_format
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001325] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49864 - 400 250B in 337.698Âµs
=== RUN   TestAPIUserAttributeCreatePost_ValidationErrors/user_not_found
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001326] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49874 - 404 63B in 302.993Âµs
--- PASS: TestAPIUserAttributeCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/invalid_key_format (0.00s)
    --- PASS: TestAPIUserAttributeCreatePost_ValidationErrors/user_not_found (0.00s)
=== RUN   TestAPIUserAttributeCreatePost_InvalidRequestBody
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":375}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001327] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49882 - 200 1156B in 3.914646ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001328] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49892 - 400 75B in 281.702Âµs
--- PASS: TestAPIUserAttributeCreatePost_InvalidRequestBody (0.00s)
=== RUN   TestAPIUserAttributeCreatePost_Unauthorized
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001329] "POST http://localhost:19090/api/v1/admin/user-attributes HTTP/1.1" from [::1]:49896 - 401 22B in 288.565Âµs
--- PASS: TestAPIUserAttributeCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":376}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49906 - 200 1156B in 3.982024ms
2025/11/25 13:26:10 INFO {"audit_event":"updated_user_attribute","details":{"loggedInUser":"admin-test-client-AqgDYBFN","userAttributeId":6,"userId":93}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001331] "PUT http://localhost:19090/api/v1/admin/user-attributes/6 HTTP/1.1" from [::1]:49922 - 200 212B in 363.427Âµs
--- PASS: TestAPIUserAttributeUpdatePut_Success (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_NotFound
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":377}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001332] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49930 - 200 1156B in 4.217388ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001333] "PUT http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:49944 - 404 73B in 313.543Âµs
--- PASS: TestAPIUserAttributeUpdatePut_NotFound (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":378}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001334] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:49954 - 200 1156B in 3.974429ms
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/missing_key
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001335] "PUT http://localhost:19090/api/v1/admin/user-attributes/7 HTTP/1.1" from [::1]:49964 - 400 72B in 311.409Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/empty_key
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001336] "PUT http://localhost:19090/api/v1/admin/user-attributes/7 HTTP/1.1" from [::1]:49972 - 400 72B in 299.546Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/value_too_long
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001337] "PUT http://localhost:19090/api/v1/admin/user-attributes/7 HTTP/1.1" from [::1]:49980 - 400 117B in 307.852Âµs
=== RUN   TestAPIUserAttributeUpdatePut_ValidationErrors/invalid_key_format
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001338] "PUT http://localhost:19090/api/v1/admin/user-attributes/7 HTTP/1.1" from [::1]:49994 - 400 250B in 282.133Âµs
--- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors (0.01s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/missing_key (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/empty_key (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/value_too_long (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_ValidationErrors/invalid_key_format (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":379}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001339] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50000 - 200 1156B in 3.981773ms
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/non-numeric_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001340] "PUT http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:50008 - 400 75B in 313.142Âµs
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/empty_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001341] "PUT http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:50010 - 405 0B in 270.972Âµs
=== RUN   TestAPIUserAttributeUpdatePut_InvalidId/negative_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001342] "PUT http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:50014 - 404 73B in 312.19Âµs
--- PASS: TestAPIUserAttributeUpdatePut_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeUpdatePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeUpdatePut_InvalidRequestBody
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":380}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001343] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50030 - 200 1156B in 4.072174ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001344] "PUT http://localhost:19090/api/v1/admin/user-attributes/8 HTTP/1.1" from [::1]:50040 - 400 75B in 305.718Âµs
--- PASS: TestAPIUserAttributeUpdatePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserAttributeUpdatePut_Unauthorized
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001345] "PUT http://localhost:19090/api/v1/admin/user-attributes/9 HTTP/1.1" from [::1]:50048 - 401 22B in 93.687Âµs
--- PASS: TestAPIUserAttributeUpdatePut_Unauthorized (0.00s)
=== RUN   TestAPIUserAttributeDelete_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":381}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001346] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50052 - 200 1156B in 3.952057ms
2025/11/25 13:26:10 INFO {"audit_event":"deleted_user_attribute","details":{"loggedInUser":"admin-test-client-HRIUBVPd","userAttributeId":10,"userId":97}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001347] "DELETE http://localhost:19090/api/v1/admin/user-attributes/10 HTTP/1.1" from [::1]:50064 - 200 17B in 313.763Âµs
--- PASS: TestAPIUserAttributeDelete_Success (0.01s)
=== RUN   TestAPIUserAttributeDelete_NotFound
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":382}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001348] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50072 - 200 1156B in 3.952739ms
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001349] "DELETE http://localhost:19090/api/v1/admin/user-attributes/99999 HTTP/1.1" from [::1]:50084 - 404 73B in 304.345Âµs
--- PASS: TestAPIUserAttributeDelete_NotFound (0.00s)
=== RUN   TestAPIUserAttributeDelete_InvalidId
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":383}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001350] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50100 - 200 1156B in 3.974059ms
=== RUN   TestAPIUserAttributeDelete_InvalidId/non-numeric_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001351] "DELETE http://localhost:19090/api/v1/admin/user-attributes/abc HTTP/1.1" from [::1]:50110 - 400 75B in 297.302Âµs
=== RUN   TestAPIUserAttributeDelete_InvalidId/empty_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001352] "DELETE http://localhost:19090/api/v1/admin/user-attributes/ HTTP/1.1" from [::1]:50118 - 405 0B in 284.989Âµs
=== RUN   TestAPIUserAttributeDelete_InvalidId/negative_ID
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001353] "DELETE http://localhost:19090/api/v1/admin/user-attributes/-1 HTTP/1.1" from [::1]:50124 - 404 73B in 292.854Âµs
--- PASS: TestAPIUserAttributeDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAttributeDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAttributeDelete_Unauthorized
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001354] "DELETE http://localhost:19090/api/v1/admin/user-attributes/11 HTTP/1.1" from [::1]:50134 - 401 22B in 118.174Âµs
--- PASS: TestAPIUserAttributeDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserPasswordPut_Success
2025/11/25 13:26:10 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":384}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001355] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50146 - 200 1156B in 3.977024ms
2025/11/25 13:26:10 INFO {"audit_event":"updated_user_authentication","details":{"loggedInUser":"admin-test-client-UjDqiyYE","userId":99}}
2025/11/25 13:26:10 [a357f2e3b56e/FBsnpuLk6O-001356] "PUT http://localhost:19090/api/v1/admin/users/99/password HTTP/1.1" from [::1]:50162 - 200 704B in 35.760859ms
--- PASS: TestAPIUserPasswordPut_Success (0.08s)
=== RUN   TestAPIUserPasswordPut_ValidationError
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":385}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001357] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50166 - 200 1156B in 4.324621ms
=== RUN   TestAPIUserPasswordPut_ValidationError/empty_password
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001358] "PUT http://localhost:19090/api/v1/admin/users/100/password HTTP/1.1" from [::1]:50176 - 400 76B in 391.39Âµs
=== RUN   TestAPIUserPasswordPut_ValidationError/too_short_password
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001359] "PUT http://localhost:19090/api/v1/admin/users/100/password HTTP/1.1" from [::1]:50182 - 400 102B in 421.366Âµs
=== RUN   TestAPIUserPasswordPut_ValidationError/too_long_password
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001360] "PUT http://localhost:19090/api/v1/admin/users/100/password HTTP/1.1" from [::1]:50188 - 400 103B in 373.115Âµs
--- PASS: TestAPIUserPasswordPut_ValidationError (0.01s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/empty_password (0.00s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/too_short_password (0.00s)
    --- PASS: TestAPIUserPasswordPut_ValidationError/too_long_password (0.00s)
=== RUN   TestAPIUserPasswordPut_UserNotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":386}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001361] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50202 - 200 1156B in 3.989448ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001362] "PUT http://localhost:19090/api/v1/admin/users/99999/password HTTP/1.1" from [::1]:50216 - 404 63B in 448.117Âµs
--- PASS: TestAPIUserPasswordPut_UserNotFound (0.01s)
=== RUN   TestAPIUserPasswordPut_InvalidUserId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":387}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001363] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50218 - 200 1156B in 4.104275ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001364] "PUT http://localhost:19090/api/v1/admin/users/invalid/password HTTP/1.1" from [::1]:50224 - 400 65B in 289.537Âµs
--- PASS: TestAPIUserPasswordPut_InvalidUserId (0.00s)
=== RUN   TestAPIUserOTPPut_DisableSuccess
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":388}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001365] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50240 - 200 1156B in 3.988676ms
2025/11/25 13:26:11 INFO {"audit_event":"disabled_otp","details":{"userId":101}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001366] "PUT http://localhost:19090/api/v1/admin/users/101/otp HTTP/1.1" from [::1]:50250 - 200 698B in 619.621Âµs
--- PASS: TestAPIUserOTPPut_DisableSuccess (0.01s)
=== RUN   TestAPIUserOTPPut_EnableNotSupported
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":389}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001367] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50254 - 200 1156B in 4.074239ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001368] "PUT http://localhost:19090/api/v1/admin/users/102/otp HTTP/1.1" from [::1]:50260 - 400 110B in 325.785Âµs
--- PASS: TestAPIUserOTPPut_EnableNotSupported (0.01s)
=== RUN   TestAPIUserOTPPut_UserNotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":390}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001369] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50270 - 200 1156B in 4.028752ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001370] "PUT http://localhost:19090/api/v1/admin/users/99999/otp HTTP/1.1" from [::1]:50274 - 404 63B in 383.014Âµs
--- PASS: TestAPIUserOTPPut_UserNotFound (0.00s)
=== RUN   TestAPIUserOTPPut_OTPNotEnabled
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":391}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001371] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50278 - 200 1156B in 3.958389ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001372] "PUT http://localhost:19090/api/v1/admin/users/103/otp HTTP/1.1" from [::1]:50296 - 400 80B in 377.703Âµs
--- PASS: TestAPIUserOTPPut_OTPNotEnabled (0.01s)
=== RUN   TestAPIUserSessionGet_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":392}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001373] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50304 - 200 1156B in 3.962577ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001374] "GET http://localhost:19090/api/v1/admin/user-sessions/cf2ccf7d-4ca9-4336-90bf-63083c4a5ee6 HTTP/1.1" from [::1]:50312 - 200 497B in 322.379Âµs
--- PASS: TestAPIUserSessionGet_Success (0.01s)
=== RUN   TestAPIUserSessionGet_NotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":393}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001375] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50328 - 200 1156B in 3.918504ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001376] "GET http://localhost:19090/api/v1/admin/user-sessions/nonexistent-session HTTP/1.1" from [::1]:50332 - 404 79B in 296.23Âµs
--- PASS: TestAPIUserSessionGet_NotFound (0.00s)
=== RUN   TestAPIUserSessionPut_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":394}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001377] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50344 - 200 1156B in 4.097652ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001378] "PUT http://localhost:19090/api/v1/admin/user-sessions/9d0a152c-591a-449c-b6aa-4bf59babf94a HTTP/1.1" from [::1]:50358 - 200 500B in 464.507Âµs
--- PASS: TestAPIUserSessionPut_Success (0.01s)
=== RUN   TestAPIUserSessionPut_NotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":395}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001379] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50364 - 200 1156B in 3.943611ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001380] "PUT http://localhost:19090/api/v1/admin/user-sessions/nonexistent-session HTTP/1.1" from [::1]:50374 - 404 79B in 296.62Âµs
--- PASS: TestAPIUserSessionPut_NotFound (0.00s)
=== RUN   TestAPIUserSessionPut_NilUpdate
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":396}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001381] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50382 - 200 1156B in 3.895ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001382] "PUT http://localhost:19090/api/v1/admin/user-sessions/933dcbef-28c3-489c-a34b-175e66fab7f4 HTTP/1.1" from [::1]:50390 - 200 501B in 395.327Âµs
--- PASS: TestAPIUserSessionPut_NilUpdate (0.01s)
=== RUN   TestAPIUserConsentsGet_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":397}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001383] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50394 - 200 1156B in 3.894829ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001384] "GET http://localhost:19090/api/v1/admin/users/107/consents HTTP/1.1" from [::1]:50404 - 200 585B in 470.348Âµs
--- PASS: TestAPIUserConsentsGet_Success (0.01s)
=== RUN   TestAPIUserConsentsGet_EmptyConsents
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":400}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001385] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50414 - 200 1156B in 3.914036ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001386] "GET http://localhost:19090/api/v1/admin/users/108/consents HTTP/1.1" from [::1]:50422 - 200 18B in 408.732Âµs
--- PASS: TestAPIUserConsentsGet_EmptyConsents (0.01s)
=== RUN   TestAPIUserConsentsGet_UserNotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":401}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001387] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50424 - 200 1156B in 5.199193ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001388] "GET http://localhost:19090/api/v1/admin/users/99999/consents HTTP/1.1" from [::1]:50438 - 404 58B in 384.817Âµs
--- PASS: TestAPIUserConsentsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserConsentsGet_InvalidId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":402}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001389] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50444 - 200 1156B in 3.981934ms
=== RUN   TestAPIUserConsentsGet_InvalidId/non-numeric_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001390] "GET http://localhost:19090/api/v1/admin/users/abc/consents HTTP/1.1" from [::1]:50456 - 400 73B in 309.315Âµs
=== RUN   TestAPIUserConsentsGet_InvalidId/empty_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001391] "GET http://localhost:19090/api/v1/admin/users//consents HTTP/1.1" from [::1]:50464 - 400 70B in 256.594Âµs
=== RUN   TestAPIUserConsentsGet_InvalidId/negative_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001392] "GET http://localhost:19090/api/v1/admin/users/-1/consents HTTP/1.1" from [::1]:50468 - 404 58B in 382.873Âµs
--- PASS: TestAPIUserConsentsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserConsentsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserConsentsGet_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001393] "GET http://localhost:19090/api/v1/admin/users/109/consents HTTP/1.1" from [::1]:50474 - 401 22B in 98.807Âµs
--- PASS: TestAPIUserConsentsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserConsentDelete_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":403}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001394] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50484 - 200 1156B in 3.968178ms
2025/11/25 13:26:11 INFO {"audit_event":"deleted_user_consent","details":{"consentId":7,"loggedInUser":null,"userId":110}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001395] "DELETE http://localhost:19090/api/v1/admin/user-consents/7 HTTP/1.1" from [::1]:50496 - 200 17B in 358.838Âµs
--- PASS: TestAPIUserConsentDelete_Success (0.01s)
=== RUN   TestAPIUserConsentDelete_NotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":405}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001396] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50508 - 200 1156B in 3.926018ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001397] "DELETE http://localhost:19090/api/v1/admin/user-consents/99999 HTTP/1.1" from [::1]:50516 - 404 61B in 398.844Âµs
--- PASS: TestAPIUserConsentDelete_NotFound (0.00s)
=== RUN   TestAPIUserConsentDelete_InvalidId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":406}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001398] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50528 - 200 1156B in 3.954091ms
=== RUN   TestAPIUserConsentDelete_InvalidId/non-numeric_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001399] "DELETE http://localhost:19090/api/v1/admin/user-consents/abc HTTP/1.1" from [::1]:50544 - 400 76B in 269.148Âµs
=== RUN   TestAPIUserConsentDelete_InvalidId/empty_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001400] "DELETE http://localhost:19090/api/v1/admin/user-consents/ HTTP/1.1" from [::1]:50546 - 404 2447B in 371.322Âµs
=== RUN   TestAPIUserConsentDelete_InvalidId/negative_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001401] "DELETE http://localhost:19090/api/v1/admin/user-consents/-1 HTTP/1.1" from [::1]:50552 - 404 61B in 347.447Âµs
--- PASS: TestAPIUserConsentDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserConsentDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserConsentDelete_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001402] "DELETE http://localhost:19090/api/v1/admin/user-consents/8 HTTP/1.1" from [::1]:50566 - 401 22B in 109.287Âµs
--- PASS: TestAPIUserConsentDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserConsentDelete_WithClientDetails
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":408}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001403] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50578 - 200 1156B in 3.941948ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001404] "GET http://localhost:19090/api/v1/admin/users/112/consents HTTP/1.1" from [::1]:50594 - 200 338B in 442.526Âµs
2025/11/25 13:26:11 INFO {"audit_event":"deleted_user_consent","details":{"consentId":9,"loggedInUser":null,"userId":112}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001405] "DELETE http://localhost:19090/api/v1/admin/user-consents/9 HTTP/1.1" from [::1]:50600 - 200 17B in 311.117Âµs
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001406] "GET http://localhost:19090/api/v1/admin/users/112/consents HTTP/1.1" from [::1]:50606 - 200 18B in 330.785Âµs
--- PASS: TestAPIUserConsentDelete_WithClientDetails (0.01s)
=== RUN   TestAPIUserGet_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":410}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001407] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50618 - 200 1156B in 3.97993ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001408] "GET http://localhost:19090/api/v1/admin/users/113 HTTP/1.1" from [::1]:50626 - 200 700B in 381.691Âµs
--- PASS: TestAPIUserGet_Success (0.01s)
=== RUN   TestAPIUserGet_NotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":411}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001409] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50640 - 200 1156B in 3.931438ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001410] "GET http://localhost:19090/api/v1/admin/users/99999 HTTP/1.1" from [::1]:50644 - 404 63B in 377.313Âµs
--- PASS: TestAPIUserGet_NotFound (0.00s)
=== RUN   TestAPIUserGet_InvalidId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":412}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001411] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50652 - 200 1156B in 3.978828ms
=== RUN   TestAPIUserGet_InvalidId/non-numeric_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001412] "GET http://localhost:19090/api/v1/admin/users/abc HTTP/1.1" from [::1]:50662 - 400 65B in 277.945Âµs
=== RUN   TestAPIUserGet_InvalidId/empty_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001413] "GET http://localhost:19090/api/v1/admin/users/ HTTP/1.1" from [::1]:50678 - 404 2447B in 370.6Âµs
=== RUN   TestAPIUserGet_InvalidId/negative_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001414] "GET http://localhost:19090/api/v1/admin/users/-1 HTTP/1.1" from [::1]:50684 - 404 63B in 344.772Âµs
--- PASS: TestAPIUserGet_InvalidId (0.01s)
    --- PASS: TestAPIUserGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserGet_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001415] "GET http://localhost:19090/api/v1/admin/users/114 HTTP/1.1" from [::1]:50686 - 401 22B in 102.223Âµs
--- PASS: TestAPIUserGet_Unauthorized (0.00s)
=== RUN   TestAPIUserCreatePost_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":413}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001416] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50692 - 200 1156B in 3.978878ms
2025/11/25 13:26:11 INFO {"audit_event":"created_user","details":{"email":"newuser@create.test","loggedInUser":"admin-test-client-DDkMaFbR"}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001417] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50696 - 201 1144B in 37.004128ms
--- PASS: TestAPIUserCreatePost_Success (0.04s)
=== RUN   TestAPIUserCreatePost_DuplicateEmail
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":414}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001418] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50700 - 200 1156B in 4.229101ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001419] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50712 - 409 95B in 477.973Âµs
--- PASS: TestAPIUserCreatePost_DuplicateEmail (0.01s)
=== RUN   TestAPIUserCreatePost_ValidationErrors
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":415}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001420] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50720 - 200 1156B in 4.012342ms
=== RUN   TestAPIUserCreatePost_ValidationErrors/missing_email
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001421] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50722 - 400 66B in 316.328Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/invalid_email_format
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001422] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50732 - 400 86B in 278.055Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/email_too_long
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001423] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50746 - 400 114B in 267.356Âµs
=== RUN   TestAPIUserCreatePost_ValidationErrors/missing_password_when_required
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001424] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50756 - 400 72B in 2.077244ms
--- PASS: TestAPIUserCreatePost_ValidationErrors (0.01s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/missing_email (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/invalid_email_format (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/email_too_long (0.00s)
    --- PASS: TestAPIUserCreatePost_ValidationErrors/missing_password_when_required (0.00s)
=== RUN   TestAPIUserCreatePost_InvalidRequestBody
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":416}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001425] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50758 - 200 1156B in 4.236595ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001426] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50766 - 400 75B in 298.033Âµs
--- PASS: TestAPIUserCreatePost_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserCreatePost_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001427] "POST http://localhost:19090/api/v1/admin/users/create HTTP/1.1" from [::1]:50774 - 401 22B in 84.108Âµs
--- PASS: TestAPIUserCreatePost_Unauthorized (0.00s)
=== RUN   TestAPIUserEnabledPut_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":417}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001428] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50780 - 200 1156B in 3.982074ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_details","details":{"loggedInUser":"admin-test-client-Jbohjjha","userId":117}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001429] "PUT http://localhost:19090/api/v1/admin/users/117/enabled HTTP/1.1" from [::1]:50784 - 200 705B in 583.984Âµs
--- PASS: TestAPIUserEnabledPut_Success (0.01s)
=== RUN   TestAPIUserEnabledPut_EnableUser
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":418}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001430] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50796 - 200 1156B in 3.931167ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_details","details":{"loggedInUser":"admin-test-client-OhlLQDGo","userId":118}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001431] "PUT http://localhost:19090/api/v1/admin/users/118/enabled HTTP/1.1" from [::1]:50808 - 200 708B in 810.02Âµs
--- PASS: TestAPIUserEnabledPut_EnableUser (0.01s)
=== RUN   TestAPIUserEnabledPut_NotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":419}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001432] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50814 - 200 1156B in 4.121828ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001433] "PUT http://localhost:19090/api/v1/admin/users/99999/enabled HTTP/1.1" from [::1]:50818 - 404 63B in 409.333Âµs
--- PASS: TestAPIUserEnabledPut_NotFound (0.01s)
=== RUN   TestAPIUserEnabledPut_InvalidId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":420}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001434] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50832 - 200 1156B in 4.052537ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001435] "PUT http://localhost:19090/api/v1/admin/users/invalid/enabled HTTP/1.1" from [::1]:50840 - 400 65B in 291.471Âµs
--- PASS: TestAPIUserEnabledPut_InvalidId (0.00s)
=== RUN   TestAPIUserEnabledPut_InvalidRequestBody
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":421}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001436] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50856 - 200 1156B in 3.968929ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001437] "PUT http://localhost:19090/api/v1/admin/users/119/enabled HTTP/1.1" from [::1]:50864 - 400 75B in 312.551Âµs
--- PASS: TestAPIUserEnabledPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserDelete_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":422}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001438] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50882 - 200 1156B in 3.940636ms
2025/11/25 13:26:11 INFO {"audit_event":"deleted_user","details":{"loggedInUser":"admin-test-client-bsJqUPMe","userId":120}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001439] "DELETE http://localhost:19090/api/v1/admin/users/120 HTTP/1.1" from [::1]:50892 - 200 17B in 562.974Âµs
--- PASS: TestAPIUserDelete_Success (0.01s)
=== RUN   TestAPIUserDelete_NotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":423}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001440] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50902 - 200 1156B in 3.946717ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001441] "DELETE http://localhost:19090/api/v1/admin/users/99999 HTTP/1.1" from [::1]:50906 - 404 63B in 392.371Âµs
--- PASS: TestAPIUserDelete_NotFound (0.00s)
=== RUN   TestAPIUserDelete_InvalidId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":424}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001442] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50914 - 200 1156B in 3.982134ms
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_invalid
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001443] "DELETE http://localhost:19090/api/v1/admin/users/invalid HTTP/1.1" from [::1]:50930 - 400 65B in 266.914Âµs
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_abc
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001444] "DELETE http://localhost:19090/api/v1/admin/users/abc HTTP/1.1" from [::1]:50946 - 400 65B in 259.38Âµs
=== RUN   TestAPIUserDelete_InvalidId/invalid_ID:_-1
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001445] "DELETE http://localhost:19090/api/v1/admin/users/-1 HTTP/1.1" from [::1]:50950 - 404 63B in 313.492Âµs
--- PASS: TestAPIUserDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_invalid (0.00s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_abc (0.00s)
    --- PASS: TestAPIUserDelete_InvalidId/invalid_ID:_-1 (0.00s)
=== RUN   TestAPIUserDelete_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001446] "DELETE http://localhost:19090/api/v1/admin/users/121 HTTP/1.1" from [::1]:50952 - 401 22B in 80.623Âµs
--- PASS: TestAPIUserDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserEmailPut_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":425}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001447] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50958 - 200 1156B in 3.91609ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-TjnqMJcS","userId":122}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001448] "PUT http://localhost:19090/api/v1/admin/users/122/email HTTP/1.1" from [::1]:50974 - 200 702B in 721.483Âµs
--- PASS: TestAPIUserEmailPut_Success (0.01s)
=== RUN   TestAPIUserEmailPut_EmailNormalization
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":426}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001449] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50978 - 200 1156B in 3.945134ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-BusGUmxs","userId":123}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001450] "PUT http://localhost:19090/api/v1/admin/users/123/email HTTP/1.1" from [::1]:50988 - 200 705B in 631.283Âµs
--- PASS: TestAPIUserEmailPut_EmailNormalization (0.01s)
=== RUN   TestAPIUserEmailPut_DuplicateEmail
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":427}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001451] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:50990 - 200 1156B in 3.967396ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001452] "PUT http://localhost:19090/api/v1/admin/users/125/email HTTP/1.1" from [::1]:51004 - 400 107B in 703.719Âµs
--- PASS: TestAPIUserEmailPut_DuplicateEmail (0.03s)
=== RUN   TestAPIUserEmailPut_InvalidEmail
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":428}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001453] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51018 - 200 1156B in 3.981653ms
=== RUN   TestAPIUserEmailPut_InvalidEmail/empty_email
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001454] "PUT http://localhost:19090/api/v1/admin/users/126/email HTTP/1.1" from [::1]:51034 - 400 81B in 413.602Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/invalid_format
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001455] "PUT http://localhost:19090/api/v1/admin/users/126/email HTTP/1.1" from [::1]:51040 - 400 86B in 330.574Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/missing_domain
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001456] "PUT http://localhost:19090/api/v1/admin/users/126/email HTTP/1.1" from [::1]:51048 - 400 86B in 340.072Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/missing_username
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001457] "PUT http://localhost:19090/api/v1/admin/users/126/email HTTP/1.1" from [::1]:51054 - 400 86B in 340.743Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/multiple_@
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001458] "PUT http://localhost:19090/api/v1/admin/users/126/email HTTP/1.1" from [::1]:51068 - 400 86B in 333.901Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/spaces_in_middle
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001459] "PUT http://localhost:19090/api/v1/admin/users/126/email HTTP/1.1" from [::1]:51084 - 400 86B in 309.475Âµs
=== RUN   TestAPIUserEmailPut_InvalidEmail/special_chars
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001460] "PUT http://localhost:19090/api/v1/admin/users/126/email HTTP/1.1" from [::1]:51102 - 400 86B in 327.058Âµs
--- PASS: TestAPIUserEmailPut_InvalidEmail (0.01s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/empty_email (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/invalid_format (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/missing_domain (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/missing_username (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/multiple_@ (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/spaces_in_middle (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidEmail/special_chars (0.00s)
=== RUN   TestAPIUserEmailPut_SetEmailVerified
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":429}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001461] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51104 - 200 1156B in 3.956115ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-PfiPRvaa","userId":127}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001462] "PUT http://localhost:19090/api/v1/admin/users/127/email HTTP/1.1" from [::1]:51114 - 200 704B in 1.263838ms
--- PASS: TestAPIUserEmailPut_SetEmailVerified (0.01s)
=== RUN   TestAPIUserEmailPut_UnsetEmailVerified
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":430}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001463] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51124 - 200 1156B in 4.035084ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-IvyyJXxk","userId":128}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001464] "PUT http://localhost:19090/api/v1/admin/users/128/email HTTP/1.1" from [::1]:51138 - 200 707B in 638.867Âµs
--- PASS: TestAPIUserEmailPut_UnsetEmailVerified (0.01s)
=== RUN   TestAPIUserEmailPut_UserNotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":431}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001465] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51140 - 200 1156B in 4.28703ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001466] "PUT http://localhost:19090/api/v1/admin/users/99999/email HTTP/1.1" from [::1]:51144 - 404 63B in 332.909Âµs
--- PASS: TestAPIUserEmailPut_UserNotFound (0.01s)
=== RUN   TestAPIUserEmailPut_InvalidId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":432}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001467] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51158 - 200 1156B in 3.943501ms
=== RUN   TestAPIUserEmailPut_InvalidId/non-numeric_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001468] "PUT http://localhost:19090/api/v1/admin/users/abc/email HTTP/1.1" from [::1]:51172 - 400 65B in 254.711Âµs
=== RUN   TestAPIUserEmailPut_InvalidId/empty_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001469] "PUT http://localhost:19090/api/v1/admin/users//email HTTP/1.1" from [::1]:51180 - 400 70B in 232.269Âµs
=== RUN   TestAPIUserEmailPut_InvalidId/negative_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001470] "PUT http://localhost:19090/api/v1/admin/users/-1/email HTTP/1.1" from [::1]:51182 - 404 63B in 300.468Âµs
--- PASS: TestAPIUserEmailPut_InvalidId (0.01s)
    --- PASS: TestAPIUserEmailPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserEmailPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserEmailPut_InvalidRequestBody
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":433}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001471] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51184 - 200 1156B in 3.978438ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001472] "PUT http://localhost:19090/api/v1/admin/users/129/email HTTP/1.1" from [::1]:51198 - 400 75B in 308.894Âµs
--- PASS: TestAPIUserEmailPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserEmailPut_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001473] "PUT http://localhost:19090/api/v1/admin/users/130/email HTTP/1.1" from [::1]:51212 - 401 22B in 116.57Âµs
--- PASS: TestAPIUserEmailPut_Unauthorized (0.00s)
=== RUN   TestAPIUserEmailPut_PartialUpdate
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":434}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001474] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51218 - 200 1156B in 3.943801ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_email","details":{"loggedInUser":"admin-test-client-NhNsykWa","userId":131}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001475] "PUT http://localhost:19090/api/v1/admin/users/131/email HTTP/1.1" from [::1]:51220 - 200 701B in 606.937Âµs
--- PASS: TestAPIUserEmailPut_PartialUpdate (0.01s)
=== RUN   TestAPIUserPermissionsGet_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":435}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001476] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51234 - 200 1156B in 3.958078ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001477] "GET http://localhost:19090/api/v1/admin/users/132/permissions HTTP/1.1" from [::1]:51240 - 200 1963B in 502.981Âµs
--- PASS: TestAPIUserPermissionsGet_Success (0.01s)
=== RUN   TestAPIUserPermissionsGet_UserNotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":436}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001478] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51250 - 200 1156B in 3.918754ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001479] "GET http://localhost:19090/api/v1/admin/users/99999/permissions HTTP/1.1" from [::1]:51264 - 404 58B in 364.709Âµs
--- PASS: TestAPIUserPermissionsGet_UserNotFound (0.00s)
=== RUN   TestAPIUserPermissionsGet_InvalidUserId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":437}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001480] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51280 - 200 1156B in 3.913585ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001481] "GET http://localhost:19090/api/v1/admin/users/invalid/permissions HTTP/1.1" from [::1]:51282 - 400 73B in 334.842Âµs
--- PASS: TestAPIUserPermissionsGet_InvalidUserId (0.00s)
=== RUN   TestAPIUserPermissionsGet_NoPermissions
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":438}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001482] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51284 - 200 1156B in 3.951306ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001483] "GET http://localhost:19090/api/v1/admin/users/133/permissions HTTP/1.1" from [::1]:51292 - 200 731B in 380.929Âµs
--- PASS: TestAPIUserPermissionsGet_NoPermissions (0.01s)
=== RUN   TestAPIUserPermissionsGet_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001484] "GET http://localhost:19090/api/v1/admin/users/134/permissions HTTP/1.1" from [::1]:51304 - 401 22B in 140.536Âµs
--- PASS: TestAPIUserPermissionsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserPermissionsPut_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":439}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001485] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51316 - 200 1156B in 4.03286ms
2025/11/25 13:26:11 INFO {"audit_event":"added_user_permission","details":{"loggedInUser":"","permissionId":54,"userId":135}}
2025/11/25 13:26:11 INFO {"audit_event":"added_user_permission","details":{"loggedInUser":"","permissionId":55,"userId":135}}
2025/11/25 13:26:11 INFO {"audit_event":"deleted_user_permission","details":{"loggedInUser":"","permissionId":53,"userId":135}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001486] "PUT http://localhost:19090/api/v1/admin/users/135/permissions HTTP/1.1" from [::1]:51324 - 200 17B in 651.24Âµs
--- PASS: TestAPIUserPermissionsPut_Success (0.01s)
=== RUN   TestAPIUserPermissionsPut_RemoveAllPermissions
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":440}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001487] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51332 - 200 1156B in 3.957397ms
2025/11/25 13:26:11 INFO {"audit_event":"deleted_user_permission","details":{"loggedInUser":"","permissionId":56,"userId":136}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001488] "PUT http://localhost:19090/api/v1/admin/users/136/permissions HTTP/1.1" from [::1]:51334 - 200 17B in 483.744Âµs
--- PASS: TestAPIUserPermissionsPut_RemoveAllPermissions (0.01s)
=== RUN   TestAPIUserPermissionsPut_UserNotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":441}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001489] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51338 - 200 1156B in 3.954532ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001490] "PUT http://localhost:19090/api/v1/admin/users/99999/permissions HTTP/1.1" from [::1]:51348 - 404 58B in 368.556Âµs
--- PASS: TestAPIUserPermissionsPut_UserNotFound (0.00s)
=== RUN   TestAPIUserPermissionsPut_PermissionNotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":442}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001491] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51358 - 200 1156B in 3.945515ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001492] "PUT http://localhost:19090/api/v1/admin/users/137/permissions HTTP/1.1" from [::1]:51372 - 404 64B in 415.695Âµs
--- PASS: TestAPIUserPermissionsPut_PermissionNotFound (0.01s)
=== RUN   TestAPIUserPermissionsPut_InvalidRequestBody
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":443}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001493] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51386 - 200 1156B in 3.894799ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001494] "PUT http://localhost:19090/api/v1/admin/users/138/permissions HTTP/1.1" from [::1]:51396 - 400 71B in 330.224Âµs
--- PASS: TestAPIUserPermissionsPut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserPermissionsPut_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001495] "PUT http://localhost:19090/api/v1/admin/users/139/permissions HTTP/1.1" from [::1]:51406 - 401 22B in 114.537Âµs
--- PASS: TestAPIUserPermissionsPut_Unauthorized (0.00s)
=== RUN   TestAPIPhoneCountriesGet_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":444}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001496] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51416 - 200 1156B in 3.928653ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001497] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:51424 - 200 21243B in 61.686564ms
--- PASS: TestAPIPhoneCountriesGet_Success (0.07s)
=== RUN   TestAPIPhoneCountriesGet_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001498] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:51436 - 401 22B in 222.711Âµs
--- PASS: TestAPIPhoneCountriesGet_Unauthorized (0.00s)
=== RUN   TestAPIPhoneCountriesGet_InvalidToken
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001499] "GET http://localhost:19090/api/v1/admin/phone-countries HTTP/1.1" from [::1]:51444 - 401 22B in 288.244Âµs
--- PASS: TestAPIPhoneCountriesGet_InvalidToken (0.00s)
=== RUN   TestAPIUserPhonePut_Success
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":445}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001500] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51446 - 200 1156B in 4.050984ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-YIMSRvMI","userId":140}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001501] "PUT http://localhost:19090/api/v1/admin/users/140/phone HTTP/1.1" from [::1]:51458 - 200 720B in 121.955439ms
--- PASS: TestAPIUserPhonePut_Success (0.13s)
=== RUN   TestAPIUserPhonePut_ClearPhoneNumber
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":446}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001502] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51464 - 200 1156B in 4.439869ms
2025/11/25 13:26:11 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-oySPBnbx","userId":141}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001503] "PUT http://localhost:19090/api/v1/admin/users/141/phone HTTP/1.1" from [::1]:51470 - 200 707B in 62.322846ms
--- PASS: TestAPIUserPhonePut_ClearPhoneNumber (0.07s)
=== RUN   TestAPIUserPhonePut_ValidationErrors
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":447}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001504] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51472 - 200 1156B in 4.130505ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_without_country
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001505] "PUT http://localhost:19090/api/v1/admin/users/142/phone HTTP/1.1" from [::1]:51482 - 400 99B in 459.638Âµs
=== RUN   TestAPIUserPhonePut_ValidationErrors/country_without_phone_number
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001506] "PUT http://localhost:19090/api/v1/admin/users/142/phone HTTP/1.1" from [::1]:51498 - 400 266B in 59.244189ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_too_short
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001507] "PUT http://localhost:19090/api/v1/admin/users/142/phone HTTP/1.1" from [::1]:51510 - 400 99B in 61.537181ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/phone_number_too_long
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001508] "PUT http://localhost:19090/api/v1/admin/users/142/phone HTTP/1.1" from [::1]:51518 - 400 114B in 58.993566ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/invalid_phone_number_characters
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001509] "PUT http://localhost:19090/api/v1/admin/users/142/phone HTTP/1.1" from [::1]:51528 - 400 174B in 60.996359ms
=== RUN   TestAPIUserPhonePut_ValidationErrors/invalid_country_id
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001510] "PUT http://localhost:19090/api/v1/admin/users/142/phone HTTP/1.1" from [::1]:51538 - 400 76B in 59.378794ms
--- PASS: TestAPIUserPhonePut_ValidationErrors (0.31s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_without_country (0.00s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/country_without_phone_number (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_too_short (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/phone_number_too_long (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/invalid_phone_number_characters (0.06s)
    --- PASS: TestAPIUserPhonePut_ValidationErrors/invalid_country_id (0.06s)
=== RUN   TestAPIUserPhonePut_UserNotFound
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":448}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001511] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51548 - 200 1156B in 4.193243ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001512] "PUT http://localhost:19090/api/v1/admin/users/99999/phone HTTP/1.1" from [::1]:51560 - 404 63B in 429.481Âµs
--- PASS: TestAPIUserPhonePut_UserNotFound (0.01s)
=== RUN   TestAPIUserPhonePut_InvalidUserId
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":449}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001513] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51570 - 200 1156B in 4.129953ms
=== RUN   TestAPIUserPhonePut_InvalidUserId/non-numeric_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001514] "PUT http://localhost:19090/api/v1/admin/users/abc/phone HTTP/1.1" from [::1]:51586 - 400 65B in 383.635Âµs
=== RUN   TestAPIUserPhonePut_InvalidUserId/empty_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001515] "PUT http://localhost:19090/api/v1/admin/users//phone HTTP/1.1" from [::1]:51590 - 400 70B in 268.056Âµs
=== RUN   TestAPIUserPhonePut_InvalidUserId/negative_ID
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001516] "PUT http://localhost:19090/api/v1/admin/users/-1/phone HTTP/1.1" from [::1]:51596 - 404 63B in 329.523Âµs
--- PASS: TestAPIUserPhonePut_InvalidUserId (0.01s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/empty_ID (0.00s)
    --- PASS: TestAPIUserPhonePut_InvalidUserId/negative_ID (0.00s)
=== RUN   TestAPIUserPhonePut_InvalidRequestBody
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":450}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001517] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51598 - 200 1156B in 4.088274ms
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001518] "PUT http://localhost:19090/api/v1/admin/users/143/phone HTTP/1.1" from [::1]:51614 - 400 75B in 293.915Âµs
--- PASS: TestAPIUserPhonePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserPhonePut_Unauthorized
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001519] "PUT http://localhost:19090/api/v1/admin/users/144/phone HTTP/1.1" from [::1]:51620 - 401 22B in 93.407Âµs
--- PASS: TestAPIUserPhonePut_Unauthorized (0.00s)
=== RUN   TestAPIUserPhonePut_PhoneNumberVerifiedAutoCleared
2025/11/25 13:26:11 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":451}}
2025/11/25 13:26:11 [a357f2e3b56e/FBsnpuLk6O-001520] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51630 - 200 1156B in 4.048129ms
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_phone","details":{"loggedInUser":"admin-test-client-RrYCJiDE","userId":145}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001521] "PUT http://localhost:19090/api/v1/admin/users/145/phone HTTP/1.1" from [::1]:51642 - 200 710B in 59.336884ms
--- PASS: TestAPIUserPhonePut_PhoneNumberVerifiedAutoCleared (0.06s)
=== RUN   TestAPIUserProfilePut_Success
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":452}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001522] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51654 - 200 1156B in 4.622394ms
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-cCsfjdHw","userId":146}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001523] "PUT http://localhost:19090/api/v1/admin/users/146/profile HTTP/1.1" from [::1]:51658 - 200 827B in 1.711985ms
--- PASS: TestAPIUserProfilePut_Success (0.01s)
=== RUN   TestAPIUserProfilePut_PartialUpdate
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":453}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001524] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51664 - 200 1156B in 3.989518ms
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-kknrjrSv","userId":147}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001525] "PUT http://localhost:19090/api/v1/admin/users/147/profile HTTP/1.1" from [::1]:51678 - 200 712B in 2.358426ms
--- PASS: TestAPIUserProfilePut_PartialUpdate (0.01s)
=== RUN   TestAPIUserProfilePut_InvalidGender
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":454}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001526] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51686 - 200 1156B in 4.63092ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001527] "PUT http://localhost:19090/api/v1/admin/users/148/profile HTTP/1.1" from [::1]:51694 - 400 69B in 1.064671ms
--- PASS: TestAPIUserProfilePut_InvalidGender (0.01s)
=== RUN   TestAPIUserProfilePut_ValidGender
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":455}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001528] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51704 - 200 1156B in 3.993576ms
=== RUN   TestAPIUserProfilePut_ValidGender/female
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-pljajgVm","userId":149}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001529] "PUT http://localhost:19090/api/v1/admin/users/149/profile HTTP/1.1" from [::1]:51718 - 200 716B in 1.241656ms
=== RUN   TestAPIUserProfilePut_ValidGender/male
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-pljajgVm","userId":149}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001530] "PUT http://localhost:19090/api/v1/admin/users/149/profile HTTP/1.1" from [::1]:51730 - 200 714B in 2.075301ms
=== RUN   TestAPIUserProfilePut_ValidGender/other
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_profile","details":{"loggedInUser":"admin-test-client-pljajgVm","userId":149}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001531] "PUT http://localhost:19090/api/v1/admin/users/149/profile HTTP/1.1" from [::1]:51732 - 200 715B in 1.28081ms
--- PASS: TestAPIUserProfilePut_ValidGender (0.01s)
    --- PASS: TestAPIUserProfilePut_ValidGender/female (0.00s)
    --- PASS: TestAPIUserProfilePut_ValidGender/male (0.00s)
    --- PASS: TestAPIUserProfilePut_ValidGender/other (0.00s)
=== RUN   TestAPIUserProfilePut_InvalidDateOfBirth
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":456}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001532] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51748 - 200 1156B in 4.094386ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001533] "PUT http://localhost:19090/api/v1/admin/users/150/profile HTTP/1.1" from [::1]:51758 - 400 114B in 1.028293ms
--- PASS: TestAPIUserProfilePut_InvalidDateOfBirth (0.01s)
=== RUN   TestAPIUserProfilePut_UserNotFound
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":457}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001534] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51766 - 200 1156B in 4.12828ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001535] "PUT http://localhost:19090/api/v1/admin/users/99999/profile HTTP/1.1" from [::1]:51768 - 404 63B in 349.5Âµs
--- PASS: TestAPIUserProfilePut_UserNotFound (0.01s)
=== RUN   TestAPIUserProfilePut_InvalidId
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":458}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001536] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51770 - 200 1156B in 3.993054ms
=== RUN   TestAPIUserProfilePut_InvalidId/non-numeric_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001537] "PUT http://localhost:19090/api/v1/admin/users/abc/profile HTTP/1.1" from [::1]:51772 - 400 65B in 333.36Âµs
=== RUN   TestAPIUserProfilePut_InvalidId/empty_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001538] "PUT http://localhost:19090/api/v1/admin/users//profile HTTP/1.1" from [::1]:51782 - 400 70B in 312.681Âµs
=== RUN   TestAPIUserProfilePut_InvalidId/negative_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001539] "PUT http://localhost:19090/api/v1/admin/users/-1/profile HTTP/1.1" from [::1]:51784 - 404 63B in 582.791Âµs
--- PASS: TestAPIUserProfilePut_InvalidId (0.01s)
    --- PASS: TestAPIUserProfilePut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserProfilePut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserProfilePut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserProfilePut_InvalidRequestBody
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":459}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001540] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51800 - 200 1156B in 4.073537ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001541] "PUT http://localhost:19090/api/v1/admin/users/151/profile HTTP/1.1" from [::1]:51812 - 400 75B in 325.014Âµs
--- PASS: TestAPIUserProfilePut_InvalidRequestBody (0.01s)
=== RUN   TestAPIUserProfilePut_Unauthorized
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001542] "PUT http://localhost:19090/api/v1/admin/users/152/profile HTTP/1.1" from [::1]:51816 - 401 22B in 97.053Âµs
--- PASS: TestAPIUserProfilePut_Unauthorized (0.00s)
=== RUN   TestAPIUserAddressPut_Success
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":460}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001543] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51832 - 200 1156B in 4.132137ms
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-EpCApKJM","userId":153}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001544] "PUT http://localhost:19090/api/v1/admin/users/153/address HTTP/1.1" from [::1]:51834 - 200 742B in 947.721Âµs
--- PASS: TestAPIUserAddressPut_Success (0.01s)
=== RUN   TestAPIUserAddressPut_PartialAddress
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":461}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001545] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51840 - 200 1156B in 3.977885ms
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-bSmnRwWT","userId":154}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001546] "PUT http://localhost:19090/api/v1/admin/users/154/address HTTP/1.1" from [::1]:51846 - 200 729B in 528.939Âµs
--- PASS: TestAPIUserAddressPut_PartialAddress (0.01s)
=== RUN   TestAPIUserAddressPut_ClearAllFields
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":462}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001547] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51858 - 200 1156B in 3.966734ms
2025/11/25 13:26:12 INFO {"audit_event":"updated_user_address","details":{"loggedInUser":"admin-test-client-NBBbbWKJ","userId":155}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001548] "PUT http://localhost:19090/api/v1/admin/users/155/address HTTP/1.1" from [::1]:51868 - 200 708B in 517.167Âµs
--- PASS: TestAPIUserAddressPut_ClearAllFields (0.01s)
=== RUN   TestAPIUserAddressPut_UserNotFound
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":463}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001549] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51880 - 200 1156B in 3.945485ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001550] "PUT http://localhost:19090/api/v1/admin/users/99999/address HTTP/1.1" from [::1]:51884 - 404 63B in 365.01Âµs
--- PASS: TestAPIUserAddressPut_UserNotFound (0.00s)
=== RUN   TestAPIUserAddressPut_InvalidId
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":464}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001551] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51898 - 200 1156B in 3.969961ms
=== RUN   TestAPIUserAddressPut_InvalidId/non-numeric_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001552] "PUT http://localhost:19090/api/v1/admin/users/abc/address HTTP/1.1" from [::1]:51910 - 400 65B in 257.646Âµs
=== RUN   TestAPIUserAddressPut_InvalidId/empty_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001553] "PUT http://localhost:19090/api/v1/admin/users//address HTTP/1.1" from [::1]:51926 - 400 70B in 277.234Âµs
=== RUN   TestAPIUserAddressPut_InvalidId/negative_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001554] "PUT http://localhost:19090/api/v1/admin/users/-1/address HTTP/1.1" from [::1]:51942 - 404 63B in 317.61Âµs
--- PASS: TestAPIUserAddressPut_InvalidId (0.01s)
    --- PASS: TestAPIUserAddressPut_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserAddressPut_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserAddressPut_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserAddressPut_InvalidRequestBody
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":465}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001555] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51946 - 200 1156B in 3.959541ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001556] "PUT http://localhost:19090/api/v1/admin/users/156/address HTTP/1.1" from [::1]:51956 - 400 75B in 311.859Âµs
--- PASS: TestAPIUserAddressPut_InvalidRequestBody (0.00s)
=== RUN   TestAPIUserAddressPut_Unauthorized
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001557] "PUT http://localhost:19090/api/v1/admin/users/157/address HTTP/1.1" from [::1]:51972 - 401 22B in 80.692Âµs
--- PASS: TestAPIUserAddressPut_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_Success
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":466}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001558] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51986 - 200 1156B in 3.957778ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001559] "GET http://localhost:19090/api/v1/admin/users/search?query=annperm&annotatePermissionId=57&page=1&size=200 HTTP/1.1" from [::1]:51992 - 200 3031B in 1.022201ms
--- PASS: TestAPIUsersSearch_AnnotatePermission_Success (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_InvalidParam
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":467}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001560] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:51998 - 200 1156B in 4.05427ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001561] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=abc HTTP/1.1" from [::1]:52014 - 400 85B in 576.69Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_InvalidParam (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_PermissionNotFound
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":468}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001562] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52018 - 200 1156B in 4.493329ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001563] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=8703230 HTTP/1.1" from [::1]:52026 - 404 64B in 589.624Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_PermissionNotFound (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_Unauthorized
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001564] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=58 HTTP/1.1" from [::1]:52030 - 401 22B in 169.31Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_ConflictWithGroupAnnotation
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":469}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001565] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52044 - 200 1156B in 4.056575ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001566] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=59&annotateGroupMembership=75 HTTP/1.1" from [::1]:52060 - 400 123B in 574.736Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_ConflictWithGroupAnnotation (0.01s)
=== RUN   TestAPIUsersSearch_AnnotatePermission_UserinfoForbidden
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":470}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001567] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52066 - 200 1156B in 4.289325ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001568] "GET http://localhost:19090/api/v1/admin/users/search?annotatePermissionId=1 HTTP/1.1" from [::1]:52072 - 400 96B in 766.257Âµs
--- PASS: TestAPIUsersSearch_AnnotatePermission_UserinfoForbidden (0.01s)
=== RUN   TestAPIUsersSearch_Success
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":471}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001569] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52086 - 200 1156B in 4.168486ms
    api_users_search_test.go:31: Created 3 test users:
    api_users_search_test.go:33:   - john.doe@test.com 'AAA John' (ID: 161, Enabled: true)
    api_users_search_test.go:33:   - jane.smith@test.com 'AAA Jane' (ID: 162, Enabled: true)
    api_users_search_test.go:33:   - disabled@test.com 'AAA Disabled' (ID: 163, Enabled: false)
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001570] "GET http://localhost:19090/api/v1/admin/users/search?page=1&size=50 HTTP/1.1" from [::1]:52090 - 200 34624B in 908.527Âµs
    api_users_search_test.go:64: Total users in database: 57
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001571] "GET http://localhost:19090/api/v1/admin/users/search?page=2&size=50 HTTP/1.1" from [::1]:52096 - 200 5008B in 561.03Âµs
    api_users_search_test.go:72: Found test user: disabled@test.com 'AAA Disabled' (ID: 163, Enabled: false)
    api_users_search_test.go:72: Found test user: jane.smith@test.com 'AAA Jane' (ID: 162, Enabled: true)
    api_users_search_test.go:72: Found test user: john.doe@test.com 'AAA John' (ID: 161, Enabled: true)
--- PASS: TestAPIUsersSearch_Success (0.01s)
=== RUN   TestAPIUsersSearch_WithQuery
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":472}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001572] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52102 - 200 1156B in 3.976143ms
    api_users_search_test.go:126: Created test user: uniquejohnIERrdirE@searchtest.com 'UniqueJohn TestUser' (ID: 164, Enabled: true)
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001573] "GET http://localhost:19090/api/v1/admin/users/search?query=uniquejohnIERrdirE HTTP/1.1" from [::1]:52108 - 200 787B in 595.876Âµs
    api_users_search_test.go:148: Search query: 'uniquejohnIERrdirE'
    api_users_search_test.go:149: Total results: 1
    api_users_search_test.go:150: Number of users returned: 1
    api_users_search_test.go:151: Search results:
    api_users_search_test.go:153:   [0] ID: 164, Email: uniquejohnIERrdirE@searchtest.com, GivenName: UniqueJohn, FamilyName: TestUser, Enabled: true
--- PASS: TestAPIUsersSearch_WithQuery (0.01s)
=== RUN   TestAPIUsersSearch_WithPagination
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":473}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001574] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52116 - 200 1156B in 4.016499ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001575] "GET http://localhost:19090/api/v1/admin/users/search?page=1&size=2 HTTP/1.1" from [::1]:52124 - 200 1458B in 409.914Âµs
--- PASS: TestAPIUsersSearch_WithPagination (0.01s)
=== RUN   TestAPIUsersSearch_Unauthorized
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001576] "GET http://localhost:19090/api/v1/admin/users/search HTTP/1.1" from [::1]:52138 - 401 22B in 125.336Âµs
--- PASS: TestAPIUsersSearch_Unauthorized (0.00s)
=== RUN   TestAPIUsersSearch_InvalidToken
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001577] "GET http://localhost:19090/api/v1/admin/users/search HTTP/1.1" from [::1]:52150 - 401 22B in 174.259Âµs
--- PASS: TestAPIUsersSearch_InvalidToken (0.00s)
=== RUN   TestAPIUsersSearch_InvalidParameters
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":474}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001578] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52154 - 200 1156B in 3.978828ms
=== RUN   TestAPIUsersSearch_InvalidParameters/negative_page
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001579] "GET http://localhost:19090/api/v1/admin/users/search?page=-1 HTTP/1.1" from [::1]:52156 - 200 6996B in 483.383Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/zero_page
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001580] "GET http://localhost:19090/api/v1/admin/users/search?page=0 HTTP/1.1" from [::1]:52158 - 200 6996B in 515.754Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/non-numeric_page
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001581] "GET http://localhost:19090/api/v1/admin/users/search?page=abc HTTP/1.1" from [::1]:52162 - 200 6996B in 468.135Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/negative_size
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001582] "GET http://localhost:19090/api/v1/admin/users/search?size=-1 HTTP/1.1" from [::1]:52164 - 200 6996B in 446.173Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/zero_size
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001583] "GET http://localhost:19090/api/v1/admin/users/search?size=0 HTTP/1.1" from [::1]:52174 - 200 6996B in 1.160283ms
=== RUN   TestAPIUsersSearch_InvalidParameters/over-limit_size
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001584] "GET http://localhost:19090/api/v1/admin/users/search?size=300 HTTP/1.1" from [::1]:52190 - 200 6996B in 643.586Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/non-numeric_size
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001585] "GET http://localhost:19090/api/v1/admin/users/search?size=xyz HTTP/1.1" from [::1]:52198 - 200 6996B in 611.475Âµs
=== RUN   TestAPIUsersSearch_InvalidParameters/both_invalid
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001586] "GET http://localhost:19090/api/v1/admin/users/search?page=abc&size=xyz HTTP/1.1" from [::1]:52204 - 200 6996B in 465.51Âµs
--- PASS: TestAPIUsersSearch_InvalidParameters (0.01s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/negative_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/zero_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/non-numeric_page (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/negative_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/zero_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/over-limit_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/non-numeric_size (0.00s)
    --- PASS: TestAPIUsersSearch_InvalidParameters/both_invalid (0.00s)
=== RUN   TestAPIUsersSearch_SizeLimit
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":475}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001587] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52208 - 200 1156B in 3.990671ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001588] "GET http://localhost:19090/api/v1/admin/users/search?size=200 HTTP/1.1" from [::1]:52210 - 200 39580B in 913.687Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001589] "GET http://localhost:19090/api/v1/admin/users/search?size=201 HTTP/1.1" from [::1]:52220 - 200 6996B in 443.788Âµs
--- PASS: TestAPIUsersSearch_SizeLimit (0.01s)
=== RUN   TestAPIUsersSearch_NoResults
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":476}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001590] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52236 - 200 1156B in 3.999307ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001591] "GET http://localhost:19090/api/v1/admin/users/search?query=nonexistent-user-12345 HTTP/1.1" from [::1]:52250 - 200 77B in 529.099Âµs
--- PASS: TestAPIUsersSearch_NoResults (0.01s)
=== RUN   TestAPIUsersSearch_SpecialCharacters
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":477}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001592] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52266 - 200 1156B in 3.937911ms
=== RUN   TestAPIUsersSearch_SpecialCharacters/empty_query
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001593] "GET http://localhost:19090/api/v1/admin/users/search?query= HTTP/1.1" from [::1]:52274 - 200 6996B in 477.102Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/space_query
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001594] "GET http://localhost:19090/api/v1/admin/users/search?query=%20 HTTP/1.1" from [::1]:52278 - 200 2144B in 470.8Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/at_symbol
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001595] "GET http://localhost:19090/api/v1/admin/users/search?query=john%40doe HTTP/1.1" from [::1]:52288 - 200 63B in 411.497Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/plus_symbol
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001596] "GET http://localhost:19090/api/v1/admin/users/search?query=john%2Bdoe HTTP/1.1" from [::1]:52292 - 200 63B in 392.492Âµs
=== RUN   TestAPIUsersSearch_SpecialCharacters/special_chars
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001597] "GET http://localhost:19090/api/v1/admin/users/search?query=%21%40%23%24 HTTP/1.1" from [::1]:52304 - 200 59B in 386.75Âµs
--- PASS: TestAPIUsersSearch_SpecialCharacters (0.01s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/empty_query (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/space_query (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/at_symbol (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/plus_symbol (0.00s)
    --- PASS: TestAPIUsersSearch_SpecialCharacters/special_chars (0.00s)
=== RUN   TestAPIUsersSearch_MultiplePages
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":478}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001598] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52316 - 200 1156B in 4.013654ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001599] "GET http://localhost:19090/api/v1/admin/users/search?size=5&page=1 HTTP/1.1" from [::1]:52324 - 200 3543B in 426.385Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001600] "GET http://localhost:19090/api/v1/admin/users/search?size=5&page=2 HTTP/1.1" from [::1]:52332 - 200 3504B in 391.179Âµs
--- PASS: TestAPIUsersSearch_MultiplePages (0.01s)
=== RUN   TestAPIUserSessionsGet_Success
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":479}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001601] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52344 - 200 1156B in 3.926679ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001602] "GET http://localhost:19090/api/v1/admin/users/188/sessions HTTP/1.1" from [::1]:52354 - 200 1493B in 534.88Âµs
--- PASS: TestAPIUserSessionsGet_Success (0.01s)
=== RUN   TestAPIUserSessionsGet_EmptySessions
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":481}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001603] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52356 - 200 1156B in 3.97979ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001604] "GET http://localhost:19090/api/v1/admin/users/189/sessions HTTP/1.1" from [::1]:52362 - 200 16B in 385.298Âµs
--- PASS: TestAPIUserSessionsGet_EmptySessions (0.01s)
=== RUN   TestAPIUserSessionsGet_UserNotFound
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":482}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001605] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52364 - 200 1156B in 4.74187ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001606] "GET http://localhost:19090/api/v1/admin/users/99999/sessions HTTP/1.1" from [::1]:52378 - 404 63B in 500.896Âµs
--- PASS: TestAPIUserSessionsGet_UserNotFound (0.01s)
=== RUN   TestAPIUserSessionsGet_InvalidId
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":483}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001607] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52394 - 200 1156B in 4.521893ms
=== RUN   TestAPIUserSessionsGet_InvalidId/non-numeric_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001608] "GET http://localhost:19090/api/v1/admin/users/abc/sessions HTTP/1.1" from [::1]:52410 - 400 72B in 259.46Âµs
=== RUN   TestAPIUserSessionsGet_InvalidId/empty_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001609] "GET http://localhost:19090/api/v1/admin/users//sessions HTTP/1.1" from [::1]:52426 - 400 70B in 263.428Âµs
=== RUN   TestAPIUserSessionsGet_InvalidId/negative_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001610] "GET http://localhost:19090/api/v1/admin/users/-1/sessions HTTP/1.1" from [::1]:52442 - 404 63B in 400.928Âµs
--- PASS: TestAPIUserSessionsGet_InvalidId (0.01s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserSessionsGet_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserSessionsGet_Unauthorized
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001611] "GET http://localhost:19090/api/v1/admin/users/190/sessions HTTP/1.1" from [::1]:52446 - 401 22B in 89.83Âµs
--- PASS: TestAPIUserSessionsGet_Unauthorized (0.00s)
=== RUN   TestAPIUserSessionsGet_SessionsWithNoClients
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":484}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001612] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52456 - 200 1156B in 3.993275ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001613] "GET http://localhost:19090/api/v1/admin/users/191/sessions HTTP/1.1" from [::1]:52458 - 200 723B in 419.974Âµs
--- PASS: TestAPIUserSessionsGet_SessionsWithNoClients (0.01s)
=== RUN   TestAPIUserSessionDelete_Success
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":485}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001614] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52460 - 200 1156B in 3.970562ms
2025/11/25 13:26:12 INFO {"audit_event":"deleted_user_session","details":{"loggedInUser":"","userSessionId":189}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001615] "DELETE http://localhost:19090/api/v1/admin/user-sessions/189 HTTP/1.1" from [::1]:52470 - 200 17B in 366.352Âµs
--- PASS: TestAPIUserSessionDelete_Success (0.01s)
=== RUN   TestAPIUserSessionDelete_NotFound
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":486}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001616] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52482 - 200 1156B in 3.949031ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001617] "DELETE http://localhost:19090/api/v1/admin/user-sessions/99999 HTTP/1.1" from [::1]:52492 - 404 79B in 284.848Âµs
--- PASS: TestAPIUserSessionDelete_NotFound (0.00s)
=== RUN   TestAPIUserSessionDelete_InvalidId
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":487}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001618] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52502 - 200 1156B in 4.65212ms
=== RUN   TestAPIUserSessionDelete_InvalidId/non-numeric_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001619] "DELETE http://localhost:19090/api/v1/admin/user-sessions/abc HTTP/1.1" from [::1]:52510 - 400 88B in 290.368Âµs
=== RUN   TestAPIUserSessionDelete_InvalidId/empty_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001620] "DELETE http://localhost:19090/api/v1/admin/user-sessions/ HTTP/1.1" from [::1]:52526 - 404 2447B in 410.956Âµs
=== RUN   TestAPIUserSessionDelete_InvalidId/negative_ID
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001621] "DELETE http://localhost:19090/api/v1/admin/user-sessions/-1 HTTP/1.1" from [::1]:52530 - 404 79B in 271.773Âµs
--- PASS: TestAPIUserSessionDelete_InvalidId (0.01s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/non-numeric_ID (0.00s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/empty_ID (0.00s)
    --- PASS: TestAPIUserSessionDelete_InvalidId/negative_ID (0.00s)
=== RUN   TestAPIUserSessionDelete_Unauthorized
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001622] "DELETE http://localhost:19090/api/v1/admin/user-sessions/190 HTTP/1.1" from [::1]:52534 - 401 22B in 116.4Âµs
--- PASS: TestAPIUserSessionDelete_Unauthorized (0.00s)
=== RUN   TestAPIUserSessionDelete_InvalidToken
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001623] "DELETE http://localhost:19090/api/v1/admin/user-sessions/191 HTTP/1.1" from [::1]:52546 - 401 22B in 150.485Âµs
--- PASS: TestAPIUserSessionDelete_InvalidToken (0.00s)
=== RUN   TestAPIUserSessionsGet_OnlyValidSessions
2025/11/25 13:26:12 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":488}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001624] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:52554 - 200 1156B in 3.928914ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001625] "GET http://localhost:19090/api/v1/admin/users/195/sessions HTTP/1.1" from [::1]:52560 - 200 730B in 455.711Âµs
--- PASS: TestAPIUserSessionsGet_OnlyValidSessions (0.01s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientIdIsMissing
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001626] "GET http://localhost:19090/auth/authorize/ HTTP/1.1" from [::1]:52570 - 200 2129B in 281.441Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientIdIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotExist
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001627] "GET http://localhost:19090/auth/authorize/?client_id=does_not_exist HTTP/1.1" from [::1]:52580 - 200 2149B in 242.688Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotExist (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientIsDisabled
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001628] "GET http://localhost:19090/auth/authorize/?client_id=test-client-blPoAacl HTTP/1.1" from [::1]:52582 - 200 2146B in 263.007Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientIsDisabled (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotSupportTheAuthorizationCodeFlow
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001629] "GET http://localhost:19090/auth/authorize/?client_id=test-client-VKEaqbYu HTTP/1.1" from [::1]:52598 - 200 2179B in 221.479Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotSupportTheAuthorizationCodeFlow (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_RedirectURIIsMissing
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001630] "GET http://localhost:19090/auth/authorize/?client_id=test-client-YJLZWtzU HTTP/1.1" from [::1]:52614 - 200 2132B in 221.799Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_RedirectURIIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotHaveRedirectURI
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001631] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MZRLFnza&redirect_uri=http://www.humansynergize.com/webservices/e-commerce/bleeding-edge HTTP/1.1" from [::1]:52628 - 200 2180B in 609.892Âµs
--- PASS: TestAuthorize_ValidateClientAndRedirectURI_ClientDoesNotHaveRedirectURI (0.00s)
=== RUN   TestAuthorize_ValidateRequest_ResponseTypeIsMissing
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001632] "GET http://localhost:19090/auth/authorize/?client_id=test-client-GqGOKzhs&redirect_uri=https://www.internaldeliver.com/synthesize HTTP/1.1" from [::1]:52640 - 302 187B in 543.507Âµs
--- PASS: TestAuthorize_ValidateRequest_ResponseTypeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_ResponseTypeIsInvalid
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001633] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kNkSBJgo&redirect_uri=http://www.internalimplement.net/schemas/implement&response_type=invalid HTTP/1.1" from [::1]:52654 - 302 195B in 238.05Âµs
--- PASS: TestAuthorize_ValidateRequest_ResponseTypeIsInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeMethodIsMissing
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001634] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SJCLqWdV&redirect_uri=http://www.regionalvisualize.info/value-added/extend/architect/morph&response_type=code HTTP/1.1" from [::1]:52670 - 302 204B in 276.923Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeMethodIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeMethodIsInvalid
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001635] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JlwsjhOc&redirect_uri=https://www.futureuser-centric.org/initiatives/extensible/systems/infomediaries&response_type=code&code_challenge_method=invalid HTTP/1.1" from [::1]:52674 - 302 215B in 284.187Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeMethodIsInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeIsMissing
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001636] "GET http://localhost:19090/auth/authorize/?client_id=test-client-jqcHGYuY&redirect_uri=http://www.legacywebservices.biz/synergies/supply-chains&response_type=code&code_challenge_method=S256 HTTP/1.1" from [::1]:52676 - 302 224B in 208.514Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateRequest_CodeChallengeInvalid
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001637] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XppLoscl&redirect_uri=http://www.humanenterprise.name/functionalities/scale/optimize/dot-com&response_type=code&code_challenge_method=S256&code_challenge=bNzrnSgRDSsUIKVWUXgxrHjzACmJJAOTbUSOHthLTS HTTP/1.1" from [::1]:52678 - 302 238B in 272.454Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001638] "GET http://localhost:19090/auth/authorize/?client_id=test-client-vSFjKDHL&redirect_uri=https://www.centralmaximize.com/web-enabled/functionalities&response_type=code&code_challenge_method=S256&code_challenge=JImuvVZVhjYNzUdhUtUemIMVLXjvYFKSUeleXzXZjurjfwKctShWAFRxGsTGrTVGugJDyNJhNBKchwtfSwzOFbElLQWYNwHiXxQkRSZwvrWRuhKOwicmpOTdWXYVyOUUZ HTTP/1.1" from [::1]:52692 - 302 227B in 221.378Âµs
--- PASS: TestAuthorize_ValidateRequest_CodeChallengeInvalid (0.00s)
=== RUN   TestAuthorize_ValidateRequest_InvalidResponseMode
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001639] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zlsNJyVd&redirect_uri=https://www.customerrelationships.biz/incubate/cross-platform/metrics&response_type=code&code_challenge_method=S256&code_challenge=COMoqTBOluhuzOVSMulkpVlaVoQsOYlZhaZwQtLgbCT&response_mode=invalid HTTP/1.1" from [::1]:52702 - 302 225B in 200.459Âµs
--- PASS: TestAuthorize_ValidateRequest_InvalidResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_QueryResponseMode
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001640] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LxKRIqwQ&redirect_uri=https://www.globalbenchmark.org/value-added/impactful/strategize/supply-chains&response_type=code&code_challenge_method=S256&code_challenge=wnYSfocRSsXaeztQIyatsHIIxmAdYqOWduFAByiKKJn&response_mode=query&scope=invalid_scope HTTP/1.1" from [::1]:52716 - 302 316B in 269.128Âµs
--- PASS: TestAuthorize_ValidateRequest_QueryResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_FragmentResponseMode
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001641] "GET http://localhost:19090/auth/authorize/?client_id=test-client-jfoGUzIA&redirect_uri=http://www.principalextend.com/cross-media/streamline&response_type=code&code_challenge_method=S256&code_challenge=fdqGbVRgfDbWYJqIUTHgpxoCIWuCTuWWxpUAQAoaPFs&response_mode=fragment&scope=invalid_scope HTTP/1.1" from [::1]:52718 - 302 291B in 222.25Âµs
--- PASS: TestAuthorize_ValidateRequest_FragmentResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateRequest_FormPostResponseMode
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001642] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xsdfSUsJ&redirect_uri=http://www.internationaldrive.com/experiences&response_type=code&code_challenge_method=S256&code_challenge=YLAKGgfVCbqFlpSnXyqAmzXLtPcywVBMYBDAqpUXYHr&response_mode=form_post&scope=invalid_scope HTTP/1.1" from [::1]:52720 - 200 668B in 250.703Âµs
--- PASS: TestAuthorize_ValidateRequest_FormPostResponseMode (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ScopeIsMissing
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001643] "GET http://localhost:19090/auth/authorize/?client_id=test-client-OaKwUIXP&redirect_uri=https://www.seniorredefine.name/supply-chains&response_type=code&code_challenge_method=S256&code_challenge=khsksjWJnRRhOuOQoNSSFxkUMtbozwkeUyrhRmJOerP HTTP/1.1" from [::1]:52724 - 302 309B in 264.018Âµs
--- PASS: TestAuthorize_ValidateScopes_ScopeIsMissing (0.00s)
=== RUN   TestAuthorize_ValidateScopes_UserInfoShouldNotBeIncluded
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001644] "GET http://localhost:19090/auth/authorize/?client_id=test-client-OQbQMTMk&code_challenge=GMJKLTItDsQvKSyJJxjcCnRMvtRRGEkdKyqWEjmMdNZ&code_challenge_method=S256&redirect_uri=https%3A%2F%2Fwww.districtportals.name%2Fcross-media%2Fscale%2Fuser-centric&response_type=code&scope=openid+profile+authserver%3Auserinfo HTTP/1.1" from [::1]:52740 - 302 333B in 250.734Âµs
--- PASS: TestAuthorize_ValidateScopes_UserInfoShouldNotBeIncluded (0.00s)
=== RUN   TestAuthorize_ValidateScopes_InvalidScope
=== RUN   TestAuthorize_ValidateScopes_InvalidScope/Invalid_single_scope
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001645] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MKfTuvDw&redirect_uri=https%3A%2F%2Fwww.leadholistic.net%2Ftransition&response_type=code&code_challenge_method=S256&code_challenge=dcZMFJcjtKjVpiFTLtOZpyZXducsqONdsDBhcoyMwxd&scope=my_scope HTTP/1.1" from [::1]:52744 - 302 272B in 240.073Âµs
=== RUN   TestAuthorize_ValidateScopes_InvalidScope/Invalid_complex_scope
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001646] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MKfTuvDw&redirect_uri=https%3A%2F%2Fwww.leadholistic.net%2Ftransition&response_type=code&code_challenge_method=S256&code_challenge=yRImsAjYzoNUWeOpRnrQRyqRuHXQOxTRowNhEvjjYUP&scope=my_resource%3Amy_scope%3Asomething HTTP/1.1" from [::1]:52746 - 302 298B in 196.491Âµs
--- PASS: TestAuthorize_ValidateScopes_InvalidScope (0.00s)
    --- PASS: TestAuthorize_ValidateScopes_InvalidScope/Invalid_single_scope (0.00s)
    --- PASS: TestAuthorize_ValidateScopes_InvalidScope/Invalid_complex_scope (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ResourceDoesNotExist
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001647] "GET http://localhost:19090/auth/authorize/?client_id=test-client-UODdbgRW&redirect_uri=https%3A%2F%2Fwww.seniorviral.biz%2Fdeploy%2Fimpactful%2Fscalable%2Fcompelling&response_type=code&code_challenge_method=S256&code_challenge=uSeSUmXqKYHOSlFOcJAiFNzjXHxuGiYDhjmDQUqLhYs&scope=non_existent_resource%3Aread HTTP/1.1" from [::1]:52750 - 302 253B in 286.12Âµs
--- PASS: TestAuthorize_ValidateScopes_ResourceDoesNotExist (0.00s)
=== RUN   TestAuthorize_ValidateScopes_ResourceDoesNotHavePermissionAssociated
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001648] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SdRapGqS&redirect_uri=https%3A%2F%2Fwww.futureconvergence.io%2Fextensible&response_type=code&code_challenge_method=S256&code_challenge=ObGemoCrZoVKlZmtOwUbAmtArIiUSQIGJuZPMQmzFQv&scope=test-resource-FXCuIBXt%3Anon_existent_permission HTTP/1.1" from [::1]:52760 - 302 311B in 246.866Âµs
--- PASS: TestAuthorize_ValidateScopes_ResourceDoesNotHavePermissionAssociated (0.00s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001649] "GET http://localhost:19090/auth/authorize/?client_id=test-client-mwvCJzQv&redirect_uri=http%3A%2F%2Fwww.internationaliterate.io%2Forchestrate%2Fvirtual&response_type=code&code_challenge_method=S256&code_challenge=fxnRorBrHkqFLqlGeYdzvOjSWuEfMhKhavTxvvbPuSQ&scope=openid+profile+email&state=QafumaKn&nonce=mnrGVCzy HTTP/1.1" from [::1]:52774 - 302 57B in 409.544Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001650] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:52788 - 302 54B in 205.909Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001651] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:52800 - 200 2949B in 265.972Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":196}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001652] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:52800 - 302 0B in 35.537396ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001653] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:52800 - 302 60B in 247.838Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":509,"userId":196}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001654] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:52814 - 302 56B in 562.483Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":509,"codeId":53,"userId":196}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001655] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:52818 - 302 230B in 390.147Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired (0.07s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsNotRequired
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001656] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ifiCiGLf&redirect_uri=https%3A%2F%2Fwww.centralextend.info%2Fkiller%2Fleading-edge&response_type=code&code_challenge_method=S256&code_challenge=WfZezrNHVzSDpYxNhOKXYZHJbOUISEnSQJqgMFUSmeZ&scope=openid+profile+email&state=ACrwRlBu&nonce=aEhDXsNr HTTP/1.1" from [::1]:52822 - 302 57B in 487.711Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001657] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:52836 - 302 54B in 378.866Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001658] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:52852 - 200 2949B in 243.771Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":197}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001659] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:52852 - 302 0B in 35.277756ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001660] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:52852 - 302 57B in 359.349Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001661] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:52862 - 302 60B in 326.116Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":510,"userId":197}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001662] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:52876 - 302 56B in 502.65Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":510,"codeId":54,"userId":197}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001663] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:52884 - 302 226B in 335.584Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsNotRequired (0.07s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsNotRequired
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001664] "GET http://localhost:19090/auth/authorize/?client_id=test-client-bkPaLaKE&redirect_uri=https%3A%2F%2Fwww.forwardcross-platform.info%2Fbandwidth%2Fsyndicate%2Fvortals%2Fe-tailers&response_type=code&code_challenge_method=S256&code_challenge=gbjqeggLXvjxChvhGbTwXCYSBpAnTRqfxenBROkjIXu&scope=openid+profile+email&state=uPKRfcin&nonce=mIOxwlvO HTTP/1.1" from [::1]:52886 - 302 57B in 348.178Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001665] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:52894 - 302 54B in 388.134Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001666] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:52906 - 200 2949B in 295.177Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":198}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001667] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:52906 - 302 0B in 35.834186ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001668] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:52906 - 302 57B in 444.059Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001669] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:52912 - 302 54B in 369.498Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001670] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:52920 - 200 2471B in 379.807Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_otp","details":{"userId":198}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001671] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:52920 - 302 0B in 246.495Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":511,"userId":198}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001672] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:52920 - 302 56B in 501.127Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":511,"codeId":55,"userId":198}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001673] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:52934 - 302 252B in 338.349Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsNotRequired (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001674] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xMUaRrZn&redirect_uri=https%3A%2F%2Fwww.centraldeliver.biz%2Fout-of-the-box%2Fb2c%2Fexpedite%2Futilize&response_type=code&code_challenge_method=S256&code_challenge=VNArCsvpxjhvcEssckHASUmOUPovksnhWjnKLwwNDRX&scope=openid+profile+email&state=NeROtvib&nonce=BbMvNAMH HTTP/1.1" from [::1]:52942 - 302 57B in 576.499Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001675] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:52944 - 302 54B in 198.375Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001676] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:52956 - 200 2949B in 255.202Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":199}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001677] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:52956 - 302 0B in 35.732234ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001678] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:52956 - 302 57B in 205.298Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001679] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:52972 - 302 54B in 318.121Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001680] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:52984 - 200 6174B in 3.703527ms
2025/11/25 13:26:12 INFO {"audit_event":"enabled_otp","details":{"userId":199}}
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_otp","details":{"userId":199}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001681] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:52984 - 302 0B in 765.827Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":512,"userId":199}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001682] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:52984 - 302 56B in 610.313Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":512,"codeId":56,"userId":199}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001683] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:52994 - 302 242B in 748.224Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001684] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zhpaALYC&redirect_uri=http%3A%2F%2Fwww.nationalseize.info%2Fvalue-added%2Fmagnetic&response_type=code&code_challenge_method=S256&code_challenge=yHlevXSvmfoBrstyxANCRmKwnWauAjzdTDIYderGdQf&scope=openid+profile+email&state=jpCKTgsh&nonce=nGbczjYB HTTP/1.1" from [::1]:53008 - 302 57B in 2.017101ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001685] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53018 - 302 54B in 401.889Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001686] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53028 - 200 2949B in 446.624Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":200}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001687] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53028 - 302 0B in 36.51892ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001688] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53028 - 302 57B in 483.333Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001689] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53036 - 302 54B in 614.01Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001690] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53040 - 200 2471B in 483.474Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_otp","details":{"userId":200}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001691] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53040 - 302 0B in 404.193Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":513,"userId":200}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001692] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53040 - 302 56B in 819.158Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":513,"codeId":57,"userId":200}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001693] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53048 - 302 226B in 782.067Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001694] "GET http://localhost:19090/auth/authorize/?client_id=test-client-rqYOaHHM&redirect_uri=http%3A%2F%2Fwww.internalarchitect.io%2Finnovative&response_type=code&code_challenge_method=S256&code_challenge=GitsxjqyPWOXeXQZZqqeevjlAbyHhLaldWIhQaZhvUV&scope=openid+profile+email+res-tATIVkfs%3Aperm-IVWQgUHB+res-paeYLyAo%3Aperm-cVhYbfMC&state=ILKevjZM&nonce=wMSCXrYq HTTP/1.1" from [::1]:53050 - 302 57B in 582.07Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001695] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53052 - 302 54B in 262.296Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001696] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53066 - 200 2949B in 328.01Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":201}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001697] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53066 - 302 0B in 35.318983ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001698] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53066 - 302 60B in 422.849Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":514,"userId":201}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001699] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53068 - 302 58B in 1.389375ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001700] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53076 - 200 4699B in 461.341Âµs
2025/11/25 13:26:12 INFO {"audit_event":"saved_consent","details":{"clientId":514,"consentId":10,"userId":201}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001701] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53076 - 302 0B in 442.927Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":514,"codeId":58,"userId":201}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001702] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53076 - 302 218B in 325.004Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001703] "GET http://localhost:19090/auth/authorize/?client_id=test-client-qsUcobNZ&redirect_uri=https%3A%2F%2Fwww.legacymagnetic.io%2Fengineer%2Fincubate&response_type=code&code_challenge_method=S256&code_challenge=nbXbLyTPVgLAfFrYwrsTRREoYqsnVJldbBcboMoCbcT&scope=openid+profile+email+res-hquvbjiS%3Aperm-YVravLoz+res-gHZpcLak%3Aperm-ABOzztVv&state=epUmfSiN&nonce=EucjiCwY HTTP/1.1" from [::1]:53082 - 302 57B in 641.903Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001704] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53094 - 302 54B in 181.312Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001705] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53104 - 200 2949B in 240.965Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":202}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001706] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53104 - 302 0B in 35.277114ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001707] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53104 - 302 60B in 392.151Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":515,"userId":202}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001708] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53116 - 302 58B in 926.221Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001709] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53130 - 200 4699B in 678.021Âµs
2025/11/25 13:26:12 INFO {"audit_event":"saved_consent","details":{"clientId":515,"consentId":11,"userId":202}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001710] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53130 - 302 0B in 373.236Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":515,"codeId":59,"userId":202}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001711] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53130 - 302 223B in 310.096Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001712] "GET http://localhost:19090/auth/authorize/?client_id=test-client-IrSzKsYD&redirect_uri=http%3A%2F%2Fwww.internationalleverage.io%2Fstrategize%2Ftechnologies%2Fgranular&response_type=code&code_challenge_method=S256&code_challenge=DPDgPrFstuPBYRXFhrpYbrlIvYWguRGgozDCTHrpQUT&scope=openid+profile+email+res-XbevcXJg%3Aperm-PVnVUAgm+res-cWbOeqaZ%3Aperm-alOgFntE&state=xGOcNVaR&nonce=EyzJKHgb HTTP/1.1" from [::1]:53132 - 302 57B in 818.306Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001713] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53146 - 302 54B in 193.665Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001714] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53152 - 200 2949B in 250.473Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":203}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001715] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53152 - 302 0B in 35.277635ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001716] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53152 - 302 57B in 251.195Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001717] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53156 - 302 60B in 296.37Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":516,"userId":203}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001718] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53168 - 302 58B in 881.796Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001719] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53180 - 200 4699B in 451.814Âµs
2025/11/25 13:26:12 INFO {"audit_event":"saved_consent","details":{"clientId":516,"consentId":12,"userId":203}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001720] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53180 - 302 0B in 377.844Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":516,"codeId":60,"userId":203}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001721] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53180 - 302 244B in 303.875Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001722] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kozHhtje&redirect_uri=http%3A%2F%2Fwww.futuredisintermediate.io%2Fchannels%2Fglobal&response_type=code&code_challenge_method=S256&code_challenge=JsgjanTAAelPjKErZdazxvgrfRQXYziqxwlHGCgnUiW&scope=openid+profile+email+res-SirrBVPr%3Aperm-tISbUZYS+res-PPYGICWD%3Aperm-TIRYYOGm&state=HPLOMTyS&nonce=GZgTcvuZ HTTP/1.1" from [::1]:53186 - 302 57B in 592.64Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001723] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53202 - 302 54B in 243.34Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001724] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53214 - 200 2949B in 270.401Âµs
2025/11/25 13:26:12 INFO {"audit_event":"auth_success_pwd","details":{"userId":204}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001725] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53214 - 302 0B in 35.306079ms
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001726] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53214 - 302 57B in 212.221Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001727] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53226 - 302 60B in 274.729Âµs
2025/11/25 13:26:12 INFO {"audit_event":"started_new_user_session","details":{"clientId":517,"userId":204}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001728] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53228 - 302 58B in 800.944Âµs
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001729] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53236 - 200 4699B in 431.927Âµs
2025/11/25 13:26:12 INFO {"audit_event":"saved_consent","details":{"clientId":517,"consentId":13,"userId":204}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001730] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53236 - 302 0B in 366.944Âµs
2025/11/25 13:26:12 INFO {"audit_event":"created_auth_code","details":{"clientId":517,"codeId":61,"userId":204}}
2025/11/25 13:26:12 [a357f2e3b56e/FBsnpuLk6O-001731] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53236 - 302 227B in 291.761Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001732] "GET http://localhost:19090/auth/authorize/?client_id=test-client-RctOoWao&redirect_uri=http%3A%2F%2Fwww.seniorsexy.info%2Fenhance%2Fmethodologies&response_type=code&code_challenge_method=S256&code_challenge=jNvFxeivhdGtUyODIykXbSKGrjlHzssczCUawjUEyEc&scope=openid+profile+email+res-bavkFcGV%3Aperm-ehoRrFzy+res-pBsOCiag%3Aperm-OOrDQtKc&state=ExlFpTWW&nonce=ZUXQsKWK HTTP/1.1" from [::1]:53250 - 302 57B in 653.274Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001733] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53260 - 302 54B in 197.082Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001734] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53262 - 200 2949B in 275.901Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":205}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001735] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53262 - 302 0B in 36.018535ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001736] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53262 - 302 57B in 228.341Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001737] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53278 - 302 54B in 1.191451ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001738] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53280 - 200 2471B in 609.091Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":205}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001739] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53280 - 302 0B in 326.076Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":518,"userId":205}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001740] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53280 - 302 58B in 850.136Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001741] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53288 - 200 4699B in 456.492Âµs
2025/11/25 13:26:13 INFO {"audit_event":"saved_consent","details":{"clientId":518,"consentId":14,"userId":205}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001742] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53288 - 302 0B in 436.104Âµs
2025/11/25 13:26:13 INFO {"audit_event":"created_auth_code","details":{"clientId":518,"codeId":62,"userId":205}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001743] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53288 - 302 224B in 320.666Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001744] "GET http://localhost:19090/auth/authorize/?client_id=test-client-HKXkxtMa&redirect_uri=https%3A%2F%2Fwww.corporatestrategic.info%2Fdisintermediate%2Fmodels%2Fscalable&response_type=code&code_challenge_method=S256&code_challenge=NPSbKyFqTmiKvoatXLMoNXDfGkexCxAzwEvUoGECeds&scope=openid+profile+email+res-xgAYsIZn%3Aperm-WSACgnpm+res-VOweJtYa%3Aperm-hsNXoMhA&state=VOiTypia&nonce=cTGBIrIe HTTP/1.1" from [::1]:53298 - 302 57B in 828.395Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001745] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53304 - 302 54B in 209.296Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001746] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53306 - 200 2949B in 246.796Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":206}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001747] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53306 - 302 0B in 35.368898ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001748] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53306 - 302 57B in 268.117Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001749] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53308 - 302 54B in 387.983Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001750] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53312 - 200 2471B in 410.736Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":206}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001751] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53312 - 302 0B in 298.293Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":519,"userId":206}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001752] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53312 - 302 58B in 1.086483ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001753] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53316 - 200 4699B in 528.839Âµs
2025/11/25 13:26:13 INFO {"audit_event":"saved_consent","details":{"clientId":519,"consentId":15,"userId":206}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001754] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53316 - 302 0B in 469.036Âµs
2025/11/25 13:26:13 INFO {"audit_event":"created_auth_code","details":{"clientId":519,"codeId":63,"userId":206}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001755] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53316 - 302 243B in 343.729Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001756] "GET http://localhost:19090/auth/authorize/?client_id=test-client-efXbgbsk&redirect_uri=https%3A%2F%2Fwww.humane-commerce.name%2Fleverage%2Fenterprise%2Fschemas&response_type=code&code_challenge_method=S256&code_challenge=YQnELJrpHtkcdbzyHrTNUpqwosaxSRloqzUDjTeaGYE&scope=openid+profile+email+res-IpcoPynJ%3Aperm-XlnyTTka+res-uEUSNbta%3Aperm-GiXJqBvo&state=HkUBlHaR&nonce=AlyXwlvL HTTP/1.1" from [::1]:53332 - 302 57B in 610.423Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001757] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53344 - 302 54B in 201.04Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001758] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53354 - 200 2949B in 294.927Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":207}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001759] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53354 - 302 0B in 35.867771ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001760] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53354 - 302 57B in 367.815Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001761] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53370 - 302 54B in 360.531Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001762] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53374 - 200 6166B in 3.602227ms
2025/11/25 13:26:13 INFO {"audit_event":"enabled_otp","details":{"userId":207}}
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":207}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001763] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53374 - 302 0B in 453.276Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":520,"userId":207}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001764] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53374 - 302 58B in 911.211Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001765] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53390 - 200 4699B in 547.955Âµs
2025/11/25 13:26:13 INFO {"audit_event":"saved_consent","details":{"clientId":520,"consentId":16,"userId":207}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001766] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53390 - 302 0B in 450.602Âµs
2025/11/25 13:26:13 INFO {"audit_event":"created_auth_code","details":{"clientId":520,"codeId":64,"userId":207}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001767] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53390 - 302 236B in 349.651Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001768] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MYNVAEqN&redirect_uri=https%3A%2F%2Fwww.dynamicschemas.io%2Fwireless%2Fexploit%2Fdeploy%2Faggregate&response_type=code&code_challenge_method=S256&code_challenge=gciiMJugpEctatKZmqupZSCdLfKJRLKYBtgyFMgIBux&scope=openid+profile+email+res-BghARopD%3Aperm-XVlvNzHF+res-VkUYGOqV%3Aperm-kPIcXRYr&state=zAQpeVWH&nonce=aRdargHW HTTP/1.1" from [::1]:53398 - 302 57B in 477.462Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001769] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53408 - 302 54B in 206.38Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001770] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53410 - 200 2949B in 291.912Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":208}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001771] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53410 - 302 0B in 35.058281ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001772] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53410 - 302 57B in 400.898Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001773] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53424 - 302 54B in 325.044Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001774] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53438 - 200 6178B in 4.255311ms
2025/11/25 13:26:13 INFO {"audit_event":"enabled_otp","details":{"userId":208}}
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":208}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001775] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53438 - 302 0B in 426.716Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":521,"userId":208}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001776] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53438 - 302 58B in 893.729Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001777] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53446 - 200 4699B in 483.524Âµs
2025/11/25 13:26:13 INFO {"audit_event":"saved_consent","details":{"clientId":521,"consentId":17,"userId":208}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001778] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53446 - 302 0B in 406.448Âµs
2025/11/25 13:26:13 INFO {"audit_event":"created_auth_code","details":{"clientId":521,"codeId":65,"userId":208}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001779] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53446 - 302 239B in 363.838Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001780] "GET http://localhost:19090/auth/authorize/?client_id=test-client-cPYgvpOq&redirect_uri=http%3A%2F%2Fwww.humanmodels.io%2Fenterprise%2Fscale%2Frelationships&response_type=code&code_challenge_method=S256&code_challenge=NjGyGLLTEcfSELHnbxsuMgsowfFqRdXyXDRCrPRwlYk&scope=openid+profile+email+res-TJocYyOh%3Aperm-CxmaHZNC+res-miOIQpnt%3Aperm-VTxWuLeU&state=GsBcZdLw&nonce=EKqngycc HTTP/1.1" from [::1]:53454 - 302 57B in 648.185Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001781] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53458 - 302 54B in 198.515Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001782] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53470 - 200 2949B in 512.719Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":209}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001783] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53470 - 302 0B in 35.86729ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001784] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53470 - 302 57B in 515.754Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001785] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53484 - 302 54B in 735.469Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001786] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53500 - 200 2471B in 456.453Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":209}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001787] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53500 - 302 0B in 272.545Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":522,"userId":209}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001788] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53500 - 302 58B in 871.938Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001789] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53508 - 200 4699B in 453.276Âµs
2025/11/25 13:26:13 INFO {"audit_event":"saved_consent","details":{"clientId":522,"consentId":18,"userId":209}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001790] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53508 - 302 0B in 389.326Âµs
2025/11/25 13:26:13 INFO {"audit_event":"created_auth_code","details":{"clientId":522,"codeId":66,"userId":209}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001791] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53508 - 302 232B in 384.396Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsFullyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001792] "GET http://localhost:19090/auth/authorize/?client_id=test-client-lCQpiIdo&redirect_uri=http%3A%2F%2Fwww.legacysynergize.net%2Fimpactful%2Fmaximize%2Fleverage%2Fexperiences&response_type=code&code_challenge_method=S256&code_challenge=rfBxdlARtlsQtXMDXbpSWQxhrlunuuiKzyitErOmvHU&scope=openid+profile+email+res-hZbkmEPZ%3Aperm-vUqUjUiy+res-zafjGIsm%3Aperm-CvFbLstp&state=ubgQhcck&nonce=vOknBdZA HTTP/1.1" from [::1]:53512 - 302 57B in 689.052Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001793] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53520 - 302 54B in 200.158Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001794] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53534 - 200 2949B in 259.911Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":210}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001795] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53534 - 302 0B in 35.596398ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001796] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53534 - 302 57B in 385.528Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001797] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53538 - 302 54B in 316.668Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001798] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53548 - 200 2471B in 315.225Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":210}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001799] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53548 - 302 0B in 296.009Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":523,"userId":210}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001800] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53548 - 302 58B in 761.449Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001801] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53552 - 200 4699B in 453.988Âµs
2025/11/25 13:26:13 INFO {"audit_event":"saved_consent","details":{"clientId":523,"consentId":19,"userId":210}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001802] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53552 - 302 0B in 351.293Âµs
2025/11/25 13:26:13 INFO {"audit_event":"created_auth_code","details":{"clientId":523,"codeId":67,"userId":210}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001803] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53552 - 302 246B in 388.233Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsPartiallyGranted (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001804] "GET http://localhost:19090/auth/authorize/?client_id=test-client-UusbFIlE&redirect_uri=http%3A%2F%2Fwww.nationalone-to-one.biz%2Fwhiteboard%2Fcommunities&response_type=code&code_challenge_method=S256&code_challenge=CXKiSqXQsUQqTljZScsxNuBWBjfujIBlqeGNIhSSDbU&scope=openid+profile+email+res-iBfxngam%3Aperm-higrfoCa+res-IPmFrVPY%3Aperm-pqBYoiIM&state=yLLZoNCw&nonce=JgrROjNP HTTP/1.1" from [::1]:53568 - 302 57B in 605.895Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001805] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53578 - 302 54B in 239.513Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001806] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53592 - 200 2949B in 451.453Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":211}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001807] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53592 - 302 0B in 35.076174ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001808] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53592 - 302 60B in 395.017Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":524,"userId":211}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001809] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53608 - 302 58B in 808.999Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001810] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53620 - 200 4699B in 463.856Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001811] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53620 - 302 0B in 185.39Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsRequired_ConsentIsCancelled (0.07s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001812] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gbNbgMeG&redirect_uri=http%3A%2F%2Fwww.dynamiccross-media.info%2Fclicks-and-mortar%2Fmindshare%2Fleading-edge%2Fcross-media&response_type=code&code_challenge_method=S256&code_challenge=zUuZLDmRLEztjrLTUmkmyEfvqTdCMkcvfEngHiLVgtl&scope=openid+profile+email+res-WorGGjxG%3Aperm-hAhVmThi+res-sGkvNsIv%3Aperm-FtqVktwS&state=RUQkbPWD&nonce=pwICcCJN HTTP/1.1" from [::1]:53636 - 302 57B in 672.621Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001813] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53638 - 302 54B in 168.379Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001814] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53642 - 200 2949B in 466.722Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":212}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001815] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53642 - 302 0B in 35.205759ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001816] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53642 - 302 57B in 429.011Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001817] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53646 - 302 60B in 286.852Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":525,"userId":212}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001818] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53662 - 302 58B in 763.412Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001819] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53674 - 200 4699B in 670.376Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001820] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53674 - 302 0B in 220.737Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001821] "GET http://localhost:19090/auth/authorize/?client_id=test-client-sidrMtvm&redirect_uri=http%3A%2F%2Fwww.globalembrace.com%2Fstrategic%2Ftarget%2Fdrive&response_type=code&code_challenge_method=S256&code_challenge=CrvCVDAcJTHnSvLxbRWViLlpBDVZhiNMaOJovSIggAG&scope=openid+profile+email+res-xzTDBuPJ%3Aperm-ScoEfbGG+res-gczXtcvM%3Aperm-nEMfQOSn&state=AGATMnSb&nonce=lmSwJFkF HTTP/1.1" from [::1]:53676 - 302 57B in 387.392Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001822] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53686 - 302 54B in 193.074Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001823] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53692 - 200 2949B in 691.807Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":213}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001824] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53692 - 302 0B in 37.769854ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001825] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53692 - 302 57B in 445.722Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001826] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53694 - 302 54B in 654.507Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001827] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53702 - 200 2471B in 534.289Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":213}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001828] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53702 - 302 0B in 318.943Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":526,"userId":213}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001829] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53702 - 302 58B in 953.081Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001830] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53712 - 200 4699B in 445.181Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001831] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53712 - 302 0B in 209.606Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Optional_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001832] "GET http://localhost:19090/auth/authorize/?client_id=test-client-JoeWZicB&redirect_uri=http%3A%2F%2Fwww.dynamicmesh.org%2Fintuitive&response_type=code&code_challenge_method=S256&code_challenge=cVpPeQSgIZywDbMSrSpGMEwmOFbTMmSAtHcpgNGPsVO&scope=openid+profile+email+res-xmqTLjMD%3Aperm-MyMZIKnF+res-BYKwrqip%3Aperm-IrkZeOyG&state=avDOENDl&nonce=SZPYLYfs HTTP/1.1" from [::1]:53728 - 302 57B in 451.474Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001833] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53736 - 302 54B in 222.45Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001834] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53738 - 200 2949B in 636.673Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":214}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001835] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53738 - 302 0B in 36.774233ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001836] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53738 - 302 57B in 270.731Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001837] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53742 - 302 54B in 439.771Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001838] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53758 - 200 6154B in 4.203833ms
2025/11/25 13:26:13 INFO {"audit_event":"enabled_otp","details":{"userId":214}}
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":214}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001839] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53758 - 302 0B in 758.503Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":527,"userId":214}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001840] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53758 - 302 58B in 985.873Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001841] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53770 - 200 4699B in 482.662Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001842] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53770 - 302 0B in 297.983Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsRequired_ConsentIsCancelled (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001843] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XOFgTvty&redirect_uri=https%3A%2F%2Fwww.legacyrich.biz%2Frich&response_type=code&code_challenge_method=S256&code_challenge=NyMZIGreLHwNjGeWmXuhosgytKxbyMiBjOYGsgvcVGD&scope=openid+profile+email+res-MTLvdosM%3Aperm-WCXwWvaA+res-hQoapSWJ%3Aperm-FAYqXQQt&state=DUvNrIag&nonce=XDVUfFJF HTTP/1.1" from [::1]:53774 - 302 57B in 735.6Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001844] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53780 - 302 54B in 196.251Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001845] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53790 - 200 2949B in 707.817Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_pwd","details":{"userId":215}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001846] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53790 - 302 0B in 36.248109ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001847] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53790 - 302 57B in 438.679Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001848] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53804 - 302 54B in 579.956Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001849] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53808 - 200 2471B in 734.067Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_success_otp","details":{"userId":215}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001850] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53808 - 302 0B in 301.921Âµs
2025/11/25 13:26:13 INFO {"audit_event":"started_new_user_session","details":{"clientId":528,"userId":215}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001851] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53808 - 302 58B in 1.215297ms
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001852] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53820 - 200 4699B in 500.957Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001853] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:53820 - 302 0B in 196.071Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsRequired_ConsentIsCancelled (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired_PasswordIsIncorrect
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001854] "GET http://localhost:19090/auth/authorize/?client_id=test-client-jhxyvldy&redirect_uri=http%3A%2F%2Fwww.futurecompelling.name%2Fproductize&response_type=code&code_challenge_method=S256&code_challenge=PSYdVQKrFuvHiYPmOaEgTUxTOWmGyKDkYZgMPObvPda&scope=openid+profile+email&state=ZDBXyPtI&nonce=YjQamSFB HTTP/1.1" from [::1]:53834 - 302 57B in 575.798Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001855] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53838 - 302 54B in 166.083Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001856] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53840 - 200 2949B in 465.149Âµs
2025/11/25 13:26:13 INFO {"audit_event":"auth_failed_pwd","details":{"email":"erickschaefer@brakus.net"}}
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001857] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53840 - 200 3012B in 36.603451ms
2025/11/25 13:26:13 ERROR authContext.AuthState 'level1_password' does not match any required state
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthLevel1CompletedGet.3
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_level1.go:78
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthLevel1CompletedGet.3
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_level1.go:78
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/FBsnpuLk6O-001858
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001858] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53840 - 500 2303B in 373.375Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel1_Pwd_ConsentIsNotRequired_PasswordIsIncorrect (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired_OtpCodeIsIncorrect
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001859] "GET http://localhost:19090/auth/authorize/?client_id=test-client-uIIkHeLv&redirect_uri=https%3A%2F%2Fwww.chiefreintermediate.name%2Fusers%2Fvalue-added%2Fincubate%2Fdrive&response_type=code&code_challenge_method=S256&code_challenge=nZhwJqryPnCxxhddeGutDdVLDHhyFmSXooYwsDWiyxO&scope=openid+profile+email&state=xQWPgxKY&nonce=fWoZESUf HTTP/1.1" from [::1]:53844 - 302 57B in 594.113Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001860] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53850 - 302 54B in 180.181Âµs
2025/11/25 13:26:13 [a357f2e3b56e/FBsnpuLk6O-001861] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53864 - 200 2949B in 444.199Âµs
2025/11/25 13:26:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":217}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001862] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53864 - 302 0B in 35.489245ms
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001863] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53864 - 302 57B in 365.921Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001864] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53880 - 302 54B in 287.253Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001865] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53882 - 200 6162B in 3.81057ms
2025/11/25 13:26:14 INFO {"audit_event":"auth_failed_otp","details":{"userId":217}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001866] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53882 - 200 6389B in 599.223Âµs
2025/11/25 13:26:14 ERROR authContext.AuthState is not authentication_completed
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/FBsnpuLk6O-001867
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001867] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53882 - 500 2303B in 299.756Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpDisabled_ConsentIsNotRequired_OtpCodeIsIncorrect (0.08s)
=== RUN   TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired_OtpIsIncorrect
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001868] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XaKeJLKn&redirect_uri=https%3A%2F%2Fwww.directclicks-and-mortar.net%2Frich%2Fseize%2Frecontextualize&response_type=code&code_challenge_method=S256&code_challenge=lSfqHXdSNnAeXPBOFLywCblcwVCLDeUQKSeykInlifj&scope=openid+profile+email&state=IOYFSJQh&nonce=qXFjIxgq HTTP/1.1" from [::1]:53884 - 302 57B in 411.037Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001869] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53888 - 302 54B in 184.188Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001870] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53902 - 200 2949B in 251.425Âµs
2025/11/25 13:26:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":218}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001871] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53902 - 302 0B in 35.072969ms
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001872] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53902 - 302 57B in 407.08Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001873] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:53908 - 302 54B in 295.137Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001874] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53922 - 200 2471B in 327.499Âµs
2025/11/25 13:26:14 INFO {"audit_event":"auth_failed_otp","details":{"userId":218}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001875] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:53922 - 200 2698B in 464.217Âµs
2025/11/25 13:26:14 ERROR authContext.AuthState is not authentication_completed
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
github.com/leodip/goiabada/authserver/internal/server.(*Server).initRoutes.func1.HandleAuthCompletedGet.5
	/workspaces/goiabada/src/authserver/internal/handlers/handler_auth_completed.go:43
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:73
github.com/go-chi/chi/v5.(*Mux).Mount.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:321
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).routeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:477
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSessionIdentifier.func5.1
	/workspaces/goiabada/src/authserver/internal/middleware/middleware_session_identifier.go:54
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareCookieReset.func4.1
	/workspaces/goiabada/src/core/middleware/middleware_cookie_reset.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSettings.func3.1
	/workspaces/goiabada/src/core/middleware/middleware_settings.go:25
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/gorilla/csrf.(*csrf).ServeHTTP
	/root/go/pkg/mod/github.com/gorilla/csrf@v1.7.3/csrf.go:358
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.MiddlewareSkipCsrf.func2.1
	/workspaces/goiabada/src/core/middleware/middleware_csrf.go:27
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.StripSlashes.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/strip.go:31
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.init.0.RequestLogger.func1.1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/logger.go:55
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/leodip/goiabada/authserver/internal/server.(*Server).initMiddleware.func1.1
	/workspaces/goiabada/src/authserver/internal/server/server.go:197
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.Recoverer.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/recoverer.go:45
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5/middleware.RequestID.func1
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/middleware/request_id.go:76
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/cors.(*Cors).Handler-fm.(*Cors).Handler.func1
	/root/go/pkg/mod/github.com/go-chi/cors@v1.2.2/cors.go:231
net/http.HandlerFunc.ServeHTTP
	/usr/local/go/src/net/http/server.go:2322
github.com/go-chi/chi/v5.(*Mux).ServeHTTP
	/root/go/pkg/mod/github.com/go-chi/chi/v5@v5.2.3/mux.go:90
net/http.serverHandler.ServeHTTP
	/usr/local/go/src/net/http/server.go:3340
request-id: a357f2e3b56e/FBsnpuLk6O-001876
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001876] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53922 - 500 2303B in 277.675Âµs
--- PASS: TestAuthorize_NoExistingSession_AcrLevel2Mandatory_Pwd_OtpEnabled_ConsentIsNotRequired_OtpIsIncorrect (0.08s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel1Request
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001877] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PAerXMAd&redirect_uri=http%3A%2F%2Fwww.forwardcultivate.org%2Fenable%2Fcommunities&response_type=code&code_challenge_method=S256&code_challenge=OOMZDVnAIQBXsspmNhrCHTzJfmMAevDYibSPhKSCJnn&scope=openid+profile+email&state=PpiqmbBJ&nonce=rFYjbvdQ HTTP/1.1" from [::1]:53932 - 302 57B in 296.61Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001878] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:53946 - 302 54B in 340.524Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001879] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53950 - 200 2949B in 379.427Âµs
2025/11/25 13:26:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":219}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001880] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:53950 - 302 0B in 35.640801ms
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001881] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:53950 - 302 60B in 466.572Âµs
2025/11/25 13:26:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":532,"userId":219}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001882] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:53954 - 302 56B in 527.016Âµs
2025/11/25 13:26:14 INFO {"audit_event":"created_auth_code","details":{"clientId":532,"codeId":68,"userId":219}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001883] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:53964 - 302 226B in 387.682Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001884] "GET http://localhost:19090/auth/authorize/?client_id=test-client-PAerXMAd&redirect_uri=http%3A%2F%2Fwww.forwardcultivate.org%2Fenable%2Fcommunities&response_type=code&code_challenge_method=S256&code_challenge=jhoqQfOejuScFuPqWurOrpbuLSnSftjZertbbyuWNwe&scope=openid+profile+email&state=fnNYMluB&nonce=dBdCdazZ&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:44734 - 302 66B in 947.661Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001885] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:44748 - 302 60B in 412.589Âµs
2025/11/25 13:26:14 INFO {"audit_event":"bumped_user_session","details":{"clientId":532,"userId":219}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001886] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:44756 - 302 56B in 930.097Âµs
2025/11/25 13:26:14 INFO {"audit_event":"created_auth_code","details":{"clientId":532,"codeId":69,"userId":219}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001887] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:44774 - 302 226B in 633.507Âµs
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel1Request (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001888] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xSXTuDJC&redirect_uri=https%3A%2F%2Fwww.regionalbricks-and-clicks.info%2Fevolve%2Fseize%2Fmarkets&response_type=code&code_challenge_method=S256&code_challenge=wgglXqhQiGeCtGvApPQhuoSrJbVgxDtktMrrlrEdyBY&scope=openid+profile+email&state=SihyyUNe&nonce=xfkFtKqq HTTP/1.1" from [::1]:44780 - 302 57B in 559.267Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001889] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:44788 - 302 54B in 237.949Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001890] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44802 - 200 2949B in 540.531Âµs
2025/11/25 13:26:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":220}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001891] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44802 - 302 0B in 35.320967ms
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001892] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:44802 - 302 60B in 257.878Âµs
2025/11/25 13:26:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":533,"userId":220}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001893] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:44808 - 302 56B in 546.433Âµs
2025/11/25 13:26:14 INFO {"audit_event":"created_auth_code","details":{"clientId":533,"codeId":70,"userId":220}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001894] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:44820 - 302 239B in 329.723Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001895] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xSXTuDJC&redirect_uri=https%3A%2F%2Fwww.regionalbricks-and-clicks.info%2Fevolve%2Fseize%2Fmarkets&response_type=code&code_challenge_method=S256&code_challenge=bdwIhxIiCFYkLDIEbKsgkwhUqDFMOpYgPozfXqhYMIW&scope=openid+profile+email&state=utvHAQKf&nonce=gkGNcJfu&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:44824 - 302 66B in 857.881Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001896] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:44828 - 302 57B in 411.267Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001897] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:44832 - 302 60B in 604.102Âµs
2025/11/25 13:26:14 INFO {"audit_event":"bumped_user_session","details":{"clientId":533,"userId":220}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001898] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:44842 - 302 56B in 556.441Âµs
2025/11/25 13:26:14 INFO {"audit_event":"created_auth_code","details":{"clientId":533,"codeId":71,"userId":220}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001899] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:44854 - 302 239B in 349.29Âµs
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpDisabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001900] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MZhVZqQo&redirect_uri=https%3A%2F%2Fwww.internationalrecontextualize.name%2Fe-commerce&response_type=code&code_challenge_method=S256&code_challenge=sHFMXVHfdpPugFTadImTWFEVeMeSaftDWAMMvDQdqkC&scope=openid+profile+email&state=OeQDWQxS&nonce=vasOfFln HTTP/1.1" from [::1]:44858 - 302 57B in 295.017Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001901] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:44870 - 302 54B in 366.833Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001902] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44882 - 200 2949B in 284.988Âµs
2025/11/25 13:26:14 INFO {"audit_event":"auth_success_pwd","details":{"userId":221}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001903] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44882 - 302 0B in 35.11066ms
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001904] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:44882 - 302 60B in 237.709Âµs
2025/11/25 13:26:14 INFO {"audit_event":"started_new_user_session","details":{"clientId":534,"userId":221}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001905] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:44898 - 302 56B in 472.002Âµs
2025/11/25 13:26:14 INFO {"audit_event":"created_auth_code","details":{"clientId":534,"codeId":72,"userId":221}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001906] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:44902 - 302 232B in 335.043Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001907] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MZhVZqQo&redirect_uri=https%3A%2F%2Fwww.internationalrecontextualize.name%2Fe-commerce&response_type=code&code_challenge_method=S256&code_challenge=aahBAQiCmLLagXUvTEhgqUCglIgQMkTuKtIjHRdKmwr&scope=openid+profile+email&state=JQUPUAHi&nonce=isRMhFFa&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:44912 - 302 66B in 1.146236ms
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001908] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:44918 - 302 57B in 409.624Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001909] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:44930 - 302 54B in 332.138Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001910] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:44938 - 200 2471B in 1.203745ms
2025/11/25 13:26:14 INFO {"audit_event":"auth_success_otp","details":{"userId":221}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001911] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:44938 - 302 0B in 708.318Âµs
2025/11/25 13:26:14 INFO {"audit_event":"bumped_user_session","details":{"clientId":534,"userId":221}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001912] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:44938 - 302 56B in 675.196Âµs
2025/11/25 13:26:14 INFO {"audit_event":"created_auth_code","details":{"clientId":534,"codeId":73,"userId":221}}
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001913] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:44952 - 302 232B in 378.826Âµs
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2OptionalRequest_OtpEnabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001914] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oPPfUESr&redirect_uri=http%3A%2F%2Fwww.seniore-enable.biz%2Fscalable%2Fincentivize%2Finitiatives%2Finfrastructures&response_type=code&code_challenge_method=S256&code_challenge=AVoeDymLAcljwGxMposSydLzLyoLWAwLsGFwSaPVLSB&scope=openid+profile+email&state=cbUUsDrd&nonce=OhnCiNBZ HTTP/1.1" from [::1]:44956 - 302 57B in 306.92Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001915] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:44958 - 302 54B in 288.916Âµs
2025/11/25 13:26:14 [a357f2e3b56e/FBsnpuLk6O-001916] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44972 - 200 2949B in 290.699Âµs
2025/11/25 13:26:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":222}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001917] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:44972 - 302 0B in 35.008006ms
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001918] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:44972 - 302 60B in 345.783Âµs
2025/11/25 13:26:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":535,"userId":222}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001919] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:44988 - 302 56B in 491.689Âµs
2025/11/25 13:26:15 INFO {"audit_event":"created_auth_code","details":{"clientId":535,"codeId":74,"userId":222}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001920] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:44992 - 302 254B in 618.629Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001921] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oPPfUESr&redirect_uri=http%3A%2F%2Fwww.seniore-enable.biz%2Fscalable%2Fincentivize%2Finitiatives%2Finfrastructures&response_type=code&code_challenge_method=S256&code_challenge=QPsSxShkNxRPowXzZUanABjSiWhHjNlIwCaqSLeEmxw&scope=openid+profile+email&state=LxNtsHuy&nonce=rLBkBGLb&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:45002 - 302 66B in 809.048Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001922] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45014 - 302 57B in 461.121Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001923] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45026 - 302 54B in 340.393Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001924] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45034 - 200 6190B in 3.599141ms
2025/11/25 13:26:15 INFO {"audit_event":"enabled_otp","details":{"userId":222}}
2025/11/25 13:26:15 INFO {"audit_event":"auth_success_otp","details":{"userId":222}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001925] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45034 - 302 0B in 520.584Âµs
2025/11/25 13:26:15 INFO {"audit_event":"bumped_user_session","details":{"clientId":535,"userId":222}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001926] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45034 - 302 56B in 675.967Âµs
2025/11/25 13:26:15 INFO {"audit_event":"created_auth_code","details":{"clientId":535,"codeId":75,"userId":222}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001927] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45038 - 302 254B in 392.672Âµs
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpDisabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001928] "GET http://localhost:19090/auth/authorize/?client_id=test-client-GsOvuvfc&redirect_uri=http%3A%2F%2Fwww.regionalcross-media.org%2Fcompelling&response_type=code&code_challenge_method=S256&code_challenge=kajHeuuUGMeLmTyHNOGQTrElljMvnCOxkSDXiiGmleK&scope=openid+profile+email&state=kGSksFSp&nonce=CiXokYci HTTP/1.1" from [::1]:45046 - 302 57B in 341.876Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001929] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45052 - 302 54B in 164.29Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001930] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45056 - 200 2949B in 423.37Âµs
2025/11/25 13:26:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":223}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001931] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45056 - 302 0B in 35.139655ms
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001932] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45056 - 302 60B in 512.118Âµs
2025/11/25 13:26:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":536,"userId":223}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001933] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45062 - 302 56B in 480.087Âµs
2025/11/25 13:26:15 INFO {"audit_event":"created_auth_code","details":{"clientId":536,"codeId":76,"userId":223}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001934] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45076 - 302 221B in 459.017Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001935] "GET http://localhost:19090/auth/authorize/?client_id=test-client-GsOvuvfc&redirect_uri=http%3A%2F%2Fwww.regionalcross-media.org%2Fcompelling&response_type=code&code_challenge_method=S256&code_challenge=cFGNrptvbBclhxhXWzGZBNSDeMbYIXMcoLBNDRvEBaT&scope=openid+profile+email&state=HngDkvQw&nonce=ElJQaFmq&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:45080 - 302 66B in 1.012773ms
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001936] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45088 - 302 57B in 402.611Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001937] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45104 - 302 54B in 348.889Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001938] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45116 - 200 2471B in 402.421Âµs
2025/11/25 13:26:15 INFO {"audit_event":"auth_success_otp","details":{"userId":223}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001939] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45116 - 302 0B in 292.903Âµs
2025/11/25 13:26:15 INFO {"audit_event":"bumped_user_session","details":{"clientId":536,"userId":223}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001940] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45116 - 302 56B in 639.097Âµs
2025/11/25 13:26:15 INFO {"audit_event":"created_auth_code","details":{"clientId":536,"codeId":77,"userId":223}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001941] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45124 - 302 221B in 377.723Âµs
--- PASS: TestAuthorize_ExistingAcrLevel1Session_AcrLevel2MandatoryRequest_OtpEnabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel1Request
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001942] "GET http://localhost:19090/auth/authorize/?client_id=test-client-AoGtxOgF&redirect_uri=https%3A%2F%2Fwww.dynamicextensible.net%2Foptimize%2Ffunctionalities%2Fleverage%2Fvortals&response_type=code&code_challenge_method=S256&code_challenge=iNiMwRubYMFWPdCPGAoISRtfJWEkRGawGOGliVhSssL&scope=openid+profile+email&state=uhxRruDy&nonce=FalMYQab HTTP/1.1" from [::1]:45130 - 302 57B in 293.565Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001943] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45144 - 302 54B in 194.237Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001944] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45160 - 200 2949B in 298.364Âµs
2025/11/25 13:26:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":224}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001945] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45160 - 302 0B in 35.051057ms
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001946] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45160 - 302 57B in 378.766Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001947] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45164 - 302 60B in 289.107Âµs
2025/11/25 13:26:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":537,"userId":224}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001948] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45168 - 302 56B in 759.445Âµs
2025/11/25 13:26:15 INFO {"audit_event":"created_auth_code","details":{"clientId":537,"codeId":78,"userId":224}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001949] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45170 - 302 251B in 321.818Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001950] "GET http://localhost:19090/auth/authorize/?client_id=test-client-AoGtxOgF&redirect_uri=https%3A%2F%2Fwww.dynamicextensible.net%2Foptimize%2Ffunctionalities%2Fleverage%2Fvortals&response_type=code&code_challenge_method=S256&code_challenge=XETzHWevEyeuEHCVFSlUggfbSpwMEKkVHKYzHIrMGEY&scope=openid+profile+email&state=FanBnYqG&nonce=DTGJxqsy&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:45180 - 302 66B in 1.088016ms
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001951] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45190 - 302 60B in 753.604Âµs
2025/11/25 13:26:15 INFO {"audit_event":"bumped_user_session","details":{"clientId":537,"userId":224}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001952] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45196 - 302 56B in 652.172Âµs
2025/11/25 13:26:15 INFO {"audit_event":"created_auth_code","details":{"clientId":537,"codeId":79,"userId":224}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001953] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45206 - 302 251B in 380.049Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel1Request (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001954] "GET http://localhost:19090/auth/authorize/?client_id=test-client-VAcDuYnG&redirect_uri=http%3A%2F%2Fwww.legacyunleash.net%2Fembrace%2Fengineer%2Fglobal%2Fniches&response_type=code&code_challenge_method=S256&code_challenge=BDPoHEUfYkthjahmQojfjXPKIMpAsLCJyrNEUulpizM&scope=openid+profile+email&state=aMsOVOuJ&nonce=onTNVjTh HTTP/1.1" from [::1]:45216 - 302 57B in 606.767Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001955] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45224 - 302 54B in 271.503Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001956] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45240 - 200 2949B in 286.792Âµs
2025/11/25 13:26:15 INFO {"audit_event":"auth_success_pwd","details":{"userId":225}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001957] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45240 - 302 0B in 35.542165ms
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001958] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45240 - 302 57B in 444.8Âµs
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001959] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45246 - 302 60B in 292.002Âµs
2025/11/25 13:26:15 INFO {"audit_event":"started_new_user_session","details":{"clientId":538,"userId":225}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001960] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45260 - 302 56B in 468.676Âµs
2025/11/25 13:26:15 INFO {"audit_event":"created_auth_code","details":{"clientId":538,"codeId":80,"userId":225}}
2025/11/25 13:26:15 [a357f2e3b56e/FBsnpuLk6O-001961] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45266 - 302 235B in 333.661Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001962] "GET http://localhost:19090/auth/authorize/?client_id=test-client-VAcDuYnG&redirect_uri=http%3A%2F%2Fwww.legacyunleash.net%2Fembrace%2Fengineer%2Fglobal%2Fniches&response_type=code&code_challenge_method=S256&code_challenge=cBTBdnAwobqHtmssnUpAIYnHMRZqFCQlQaYnLdseexP&scope=openid+profile+email&state=KFrLfnSX&nonce=DgogDBPj&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:45274 - 302 66B in 786.737Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001963] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45290 - 302 60B in 406.629Âµs
2025/11/25 13:26:16 INFO {"audit_event":"bumped_user_session","details":{"clientId":538,"userId":225}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001964] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45304 - 302 56B in 639.698Âµs
2025/11/25 13:26:16 INFO {"audit_event":"created_auth_code","details":{"clientId":538,"codeId":81,"userId":225}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001965] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45312 - 302 235B in 366.723Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpDisabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001966] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LhczNthu&redirect_uri=http%3A%2F%2Fwww.internalevolve.biz%2Forchestrate%2Fbleeding-edge&response_type=code&code_challenge_method=S256&code_challenge=RtmobluwaXxNoJIdRbEmvcUSXcWKGZurrNYlAkzyJWS&scope=openid+profile+email&state=JFRyXwqg&nonce=dcqrhkwm HTTP/1.1" from [::1]:45318 - 302 57B in 607.749Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001967] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45322 - 302 54B in 192.163Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001968] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45336 - 200 2949B in 560.138Âµs
2025/11/25 13:26:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":226}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001969] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45336 - 302 0B in 35.573124ms
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001970] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45336 - 302 57B in 211.92Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001971] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45338 - 302 60B in 314.304Âµs
2025/11/25 13:26:16 INFO {"audit_event":"started_new_user_session","details":{"clientId":539,"userId":226}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001972] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45344 - 302 56B in 614.291Âµs
2025/11/25 13:26:16 INFO {"audit_event":"created_auth_code","details":{"clientId":539,"codeId":82,"userId":226}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001973] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45346 - 302 231B in 371.963Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001974] "GET http://localhost:19090/auth/authorize/?client_id=test-client-LhczNthu&redirect_uri=http%3A%2F%2Fwww.internalevolve.biz%2Forchestrate%2Fbleeding-edge&response_type=code&code_challenge_method=S256&code_challenge=RtfVuElTdvbuFBXjRkRddxWoOKPKcPCCodWebNidgkU&scope=openid+profile+email&state=oEvvUzrY&nonce=NCLuchGq&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:45356 - 302 66B in 2.210527ms
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001975] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45362 - 302 57B in 578.643Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001976] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45370 - 302 54B in 407.53Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001977] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45372 - 200 2471B in 441.825Âµs
2025/11/25 13:26:16 INFO {"audit_event":"auth_success_otp","details":{"userId":226}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001978] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45372 - 302 0B in 426.125Âµs
2025/11/25 13:26:16 INFO {"audit_event":"bumped_user_session","details":{"clientId":539,"userId":226}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001979] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45372 - 302 56B in 654.907Âµs
2025/11/25 13:26:16 INFO {"audit_event":"created_auth_code","details":{"clientId":539,"codeId":83,"userId":226}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001980] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45376 - 302 231B in 370.861Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2OptionalRequest_OtpEnabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001981] "GET http://localhost:19090/auth/authorize/?client_id=test-client-uQlKdoOx&redirect_uri=https%3A%2F%2Fwww.investorsolutions.org%2Fmaximize%2Ffunctionalities%2Fschemas%2Fconvergence&response_type=code&code_challenge_method=S256&code_challenge=AVOyORNyeLSRqLFetJYwMcNnOWSlSyVGKRfsjriQvnb&scope=openid+profile+email&state=LUBhjukt&nonce=zkkjLpVq HTTP/1.1" from [::1]:45386 - 302 57B in 806.153Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001982] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45388 - 302 54B in 300.908Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001983] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45404 - 200 2949B in 388.253Âµs
2025/11/25 13:26:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":227}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001984] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45404 - 302 0B in 36.376983ms
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001985] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45404 - 302 57B in 574.876Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001986] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45406 - 302 60B in 809.87Âµs
2025/11/25 13:26:16 INFO {"audit_event":"started_new_user_session","details":{"clientId":540,"userId":227}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001987] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45420 - 302 56B in 792.749Âµs
2025/11/25 13:26:16 INFO {"audit_event":"created_auth_code","details":{"clientId":540,"codeId":84,"userId":227}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001988] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45434 - 302 254B in 489.896Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001989] "GET http://localhost:19090/auth/authorize/?client_id=test-client-uQlKdoOx&redirect_uri=https%3A%2F%2Fwww.investorsolutions.org%2Fmaximize%2Ffunctionalities%2Fschemas%2Fconvergence&response_type=code&code_challenge_method=S256&code_challenge=LwxjPZfIruOrQbwNhbKesVliGHFFfLyyvOBTeayClyE&scope=openid+profile+email&state=zofWgVTp&nonce=ghAOTZiC&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:45436 - 302 66B in 866.747Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001990] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45450 - 302 57B in 395.487Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001991] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45456 - 302 54B in 354.349Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001992] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45468 - 200 6194B in 3.727182ms
2025/11/25 13:26:16 INFO {"audit_event":"enabled_otp","details":{"userId":227}}
2025/11/25 13:26:16 INFO {"audit_event":"auth_success_otp","details":{"userId":227}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001993] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45468 - 302 0B in 457.344Âµs
2025/11/25 13:26:16 INFO {"audit_event":"bumped_user_session","details":{"clientId":540,"userId":227}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001994] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45468 - 302 56B in 681.207Âµs
2025/11/25 13:26:16 INFO {"audit_event":"created_auth_code","details":{"clientId":540,"codeId":85,"userId":227}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001995] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45478 - 302 254B in 383.084Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpDisabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001996] "GET http://localhost:19090/auth/authorize/?client_id=test-client-aTHCXWEv&redirect_uri=http%3A%2F%2Fwww.futureincentivize.net%2Fvirtual%2Fevolve&response_type=code&code_challenge_method=S256&code_challenge=yPNZHdPhxrlYfQmjDzyaBBeGXgycHTCwQfwdOLLKUgo&scope=openid+profile+email&state=vzZmPRGD&nonce=zcXecSEf HTTP/1.1" from [::1]:45490 - 302 57B in 342.517Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001997] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45492 - 302 54B in 341.505Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001998] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45498 - 200 2949B in 299.746Âµs
2025/11/25 13:26:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":228}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-001999] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45498 - 302 0B in 35.52898ms
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002000] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45498 - 302 57B in 215.718Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002001] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45500 - 302 60B in 530.092Âµs
2025/11/25 13:26:16 INFO {"audit_event":"started_new_user_session","details":{"clientId":541,"userId":228}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002002] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45512 - 302 56B in 519.592Âµs
2025/11/25 13:26:16 INFO {"audit_event":"created_auth_code","details":{"clientId":541,"codeId":86,"userId":228}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002003] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45514 - 302 223B in 397.792Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002004] "GET http://localhost:19090/auth/authorize/?client_id=test-client-aTHCXWEv&redirect_uri=http%3A%2F%2Fwww.futureincentivize.net%2Fvirtual%2Fevolve&response_type=code&code_challenge_method=S256&code_challenge=RDQUsiWPMWQGMaLPwhUeSWUPAAicOoYNJofhodfmKjl&scope=openid+profile+email&state=RUERtVxT&nonce=XKjdxXea&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:45518 - 302 66B in 1.048341ms
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002005] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45526 - 302 57B in 493.763Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002006] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45528 - 302 54B in 306.81Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002007] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45544 - 200 2471B in 398.864Âµs
2025/11/25 13:26:16 INFO {"audit_event":"auth_success_otp","details":{"userId":228}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002008] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45544 - 302 0B in 316.628Âµs
2025/11/25 13:26:16 INFO {"audit_event":"bumped_user_session","details":{"clientId":541,"userId":228}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002009] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45544 - 302 56B in 579.394Âµs
2025/11/25 13:26:16 INFO {"audit_event":"created_auth_code","details":{"clientId":541,"codeId":87,"userId":228}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002010] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45554 - 302 223B in 852.521Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2OptionalSession_AcrLevel2MandatoryRequest_OtpEnabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel1Request
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002011] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XRXiUwFc&redirect_uri=http%3A%2F%2Fwww.corporatemorph.name%2Foptimize&response_type=code&code_challenge_method=S256&code_challenge=YKXEfShhFOyLmdsKDqsLcBBizyFKcGxyzsCxLHXixpk&scope=openid+profile+email&state=EQDgBkVa&nonce=pSiJqyvd HTTP/1.1" from [::1]:45566 - 302 57B in 374.998Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002012] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45574 - 302 54B in 211.459Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002013] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45586 - 200 2949B in 427.488Âµs
2025/11/25 13:26:16 INFO {"audit_event":"auth_success_pwd","details":{"userId":229}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002014] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45586 - 302 0B in 35.943003ms
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002015] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45586 - 302 57B in 242.869Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002016] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45590 - 302 54B in 586.098Âµs
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002017] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45604 - 200 2471B in 393.794Âµs
2025/11/25 13:26:16 INFO {"audit_event":"auth_success_otp","details":{"userId":229}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002018] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45604 - 302 0B in 290.319Âµs
2025/11/25 13:26:16 INFO {"audit_event":"started_new_user_session","details":{"clientId":542,"userId":229}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002019] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45604 - 302 56B in 480.638Âµs
2025/11/25 13:26:16 INFO {"audit_event":"created_auth_code","details":{"clientId":542,"codeId":88,"userId":229}}
2025/11/25 13:26:16 [a357f2e3b56e/FBsnpuLk6O-002020] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45618 - 302 215B in 314.995Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002021] "GET http://localhost:19090/auth/authorize/?client_id=test-client-XRXiUwFc&redirect_uri=http%3A%2F%2Fwww.corporatemorph.name%2Foptimize&response_type=code&code_challenge_method=S256&code_challenge=wnUKMqSsqLjoeHYDnPIFaZSMOKZxSjPqZBfyWzGFokY&scope=openid+profile+email&state=tgRDyBtP&nonce=lDQlTBet&acr_values=urn:goiabada:level1 HTTP/1.1" from [::1]:45620 - 302 66B in 726.112Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002022] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45626 - 302 60B in 342.297Âµs
2025/11/25 13:26:17 INFO {"audit_event":"bumped_user_session","details":{"clientId":542,"userId":229}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002023] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45636 - 302 56B in 659.126Âµs
2025/11/25 13:26:17 INFO {"audit_event":"created_auth_code","details":{"clientId":542,"codeId":89,"userId":229}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002024] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45648 - 302 215B in 320.255Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel1Request (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpDisabled
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002025] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nCRuhNwZ&redirect_uri=https%3A%2F%2Fwww.corporatebenchmark.info%2Fvertical&response_type=code&code_challenge_method=S256&code_challenge=WsEbkMVYiCfbJJiAsvFTKBaZuRatYkbNgRdLHFuUfoI&scope=openid+profile+email&state=dplZuqKU&nonce=GgCzIHAi HTTP/1.1" from [::1]:45650 - 302 57B in 352.466Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002026] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45656 - 302 54B in 179.85Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002027] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45664 - 200 2949B in 311.709Âµs
2025/11/25 13:26:17 INFO {"audit_event":"auth_success_pwd","details":{"userId":230}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002028] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45664 - 302 0B in 35.560009ms
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002029] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45664 - 302 57B in 311.479Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002030] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45666 - 302 54B in 356.514Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002031] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45680 - 200 2471B in 361.994Âµs
2025/11/25 13:26:17 INFO {"audit_event":"auth_success_otp","details":{"userId":230}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002032] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45680 - 302 0B in 317.991Âµs
2025/11/25 13:26:17 INFO {"audit_event":"started_new_user_session","details":{"clientId":543,"userId":230}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002033] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45680 - 302 56B in 557.924Âµs
2025/11/25 13:26:17 INFO {"audit_event":"created_auth_code","details":{"clientId":543,"codeId":90,"userId":230}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002034] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45686 - 302 220B in 353.538Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002035] "GET http://localhost:19090/auth/authorize/?client_id=test-client-nCRuhNwZ&redirect_uri=https%3A%2F%2Fwww.corporatebenchmark.info%2Fvertical&response_type=code&code_challenge_method=S256&code_challenge=tSzBPpklfqKlTBkFKUnCnnbsnfTwGxnxmLYkqGkSngK&scope=openid+profile+email&state=mObIRyVQ&nonce=kuIzaIhZ&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:45694 - 302 66B in 1.136016ms
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002036] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45710 - 302 60B in 1.027111ms
2025/11/25 13:26:17 INFO {"audit_event":"bumped_user_session","details":{"clientId":543,"userId":230}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002037] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45722 - 302 56B in 1.477782ms
2025/11/25 13:26:17 INFO {"audit_event":"created_auth_code","details":{"clientId":543,"codeId":91,"userId":230}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002038] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45734 - 302 220B in 433.228Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpDisabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpEnabled
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002039] "GET http://localhost:19090/auth/authorize/?client_id=test-client-OUBkUJYC&redirect_uri=http%3A%2F%2Fwww.dynamicrevolutionary.org%2Ftransition%2Ftransition%2Fstrategize&response_type=code&code_challenge_method=S256&code_challenge=qORmFuvCHqIyflqXxLwjeTRRtIbrcHwEkEIImgEHRDn&scope=openid+profile+email&state=fmXzYGwg&nonce=eOSDFsqh HTTP/1.1" from [::1]:45746 - 302 57B in 570.197Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002040] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45760 - 302 54B in 286.992Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002041] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45774 - 200 2949B in 298.093Âµs
2025/11/25 13:26:17 INFO {"audit_event":"auth_success_pwd","details":{"userId":231}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002042] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45774 - 302 0B in 35.42809ms
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002043] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45774 - 302 57B in 448.317Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002044] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45788 - 302 54B in 304.155Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002045] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45794 - 200 2471B in 392.362Âµs
2025/11/25 13:26:17 INFO {"audit_event":"auth_success_otp","details":{"userId":231}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002046] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45794 - 302 0B in 237.248Âµs
2025/11/25 13:26:17 INFO {"audit_event":"started_new_user_session","details":{"clientId":544,"userId":231}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002047] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45794 - 302 56B in 503.792Âµs
2025/11/25 13:26:17 INFO {"audit_event":"created_auth_code","details":{"clientId":544,"codeId":92,"userId":231}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002048] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45808 - 302 244B in 338.77Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002049] "GET http://localhost:19090/auth/authorize/?client_id=test-client-OUBkUJYC&redirect_uri=http%3A%2F%2Fwww.dynamicrevolutionary.org%2Ftransition%2Ftransition%2Fstrategize&response_type=code&code_challenge_method=S256&code_challenge=bMEizvYgxkabtiSSqlhfkUKDbYXXApMQRgIuGhuUxKN&scope=openid+profile+email&state=YsUHXCBx&nonce=FVNTnXbm&acr_values=urn:goiabada:level2_optional HTTP/1.1" from [::1]:45818 - 302 66B in 779.874Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002050] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45828 - 302 60B in 429.181Âµs
2025/11/25 13:26:17 INFO {"audit_event":"bumped_user_session","details":{"clientId":544,"userId":231}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002051] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45832 - 302 56B in 712.617Âµs
2025/11/25 13:26:17 INFO {"audit_event":"created_auth_code","details":{"clientId":544,"codeId":93,"userId":231}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002052] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45850 - 302 244B in 370.3Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2OptionalRequest_OtpEnabled (0.28s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpDisabled
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002053] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FAqIsdwN&redirect_uri=https%3A%2F%2Fwww.productend-to-end.io%2Fout-of-the-box%2Fsynergize%2Fdeliver%2Fsynergize&response_type=code&code_challenge_method=S256&code_challenge=wEUvxeQXnCUptYEbbAcyDAajJmSbpoywnnZqUtjvOaQ&scope=openid+profile+email&state=tpuAjmlp&nonce=LdxXchMa HTTP/1.1" from [::1]:45852 - 302 57B in 298.595Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002054] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45862 - 302 54B in 416.767Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002055] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45872 - 200 2949B in 288.375Âµs
2025/11/25 13:26:17 INFO {"audit_event":"auth_success_pwd","details":{"userId":232}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002056] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45872 - 302 0B in 35.240355ms
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002057] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45872 - 302 57B in 270.922Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002058] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45874 - 302 54B in 281.612Âµs
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002059] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45880 - 200 2471B in 399.084Âµs
2025/11/25 13:26:17 INFO {"audit_event":"auth_success_otp","details":{"userId":232}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002060] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45880 - 302 0B in 218.904Âµs
2025/11/25 13:26:17 INFO {"audit_event":"started_new_user_session","details":{"clientId":545,"userId":232}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002061] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45880 - 302 56B in 602.378Âµs
2025/11/25 13:26:17 INFO {"audit_event":"created_auth_code","details":{"clientId":545,"codeId":94,"userId":232}}
2025/11/25 13:26:17 [a357f2e3b56e/FBsnpuLk6O-002062] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45894 - 302 251B in 309.305Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002063] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FAqIsdwN&redirect_uri=https%3A%2F%2Fwww.productend-to-end.io%2Fout-of-the-box%2Fsynergize%2Fdeliver%2Fsynergize&response_type=code&code_challenge_method=S256&code_challenge=ayHzMYTsmyTxtARJgIKdmlGjlfzfbNKahcRnrOhSlSI&scope=openid+profile+email&state=oxdLyQVN&nonce=dhSiOIqg&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:45898 - 302 66B in 866.737Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002064] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45904 - 302 57B in 810.281Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002065] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45908 - 302 54B in 384.737Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002066] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45918 - 200 6170B in 3.55166ms
2025/11/25 13:26:18 INFO {"audit_event":"enabled_otp","details":{"userId":232}}
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_otp","details":{"userId":232}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002067] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45918 - 302 0B in 475.208Âµs
2025/11/25 13:26:18 INFO {"audit_event":"bumped_user_session","details":{"clientId":545,"userId":232}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002068] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45918 - 302 56B in 665.708Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":545,"codeId":95,"userId":232}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002069] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45924 - 302 251B in 400.607Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpDisabled (0.29s)
=== RUN   TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpEnabled
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002070] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kzpKkQQu&redirect_uri=https%3A%2F%2Fwww.internationalinitiatives.com%2Fdistributed%2Fback-end%2Finnovate%2Feyeballs&response_type=code&code_challenge_method=S256&code_challenge=AMYKsSKaswLudjVVFKzMSlBaSjqblOMsYMgLCuUKUdh&scope=openid+profile+email&state=EgRivdgy&nonce=jiBbsAYC HTTP/1.1" from [::1]:45934 - 302 57B in 296.531Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002071] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:45940 - 302 54B in 183.086Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002072] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45948 - 200 2949B in 350.312Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":233}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002073] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:45948 - 302 0B in 35.376813ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002074] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:45948 - 302 57B in 437.206Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002075] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:45958 - 302 54B in 622.506Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002076] "GET http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45968 - 200 2471B in 337.298Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_otp","details":{"userId":233}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002077] "POST http://localhost:19090/auth/otp HTTP/1.1" from [::1]:45968 - 302 0B in 244.452Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":546,"userId":233}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002078] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:45968 - 302 56B in 519.242Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":546,"codeId":96,"userId":233}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002079] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:45982 - 302 255B in 351.233Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002080] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kzpKkQQu&redirect_uri=https%3A%2F%2Fwww.internationalinitiatives.com%2Fdistributed%2Fback-end%2Finnovate%2Feyeballs&response_type=code&code_challenge_method=S256&code_challenge=wBfgpHWKlHxyuCKaLIfWCAOMBzCYCKOWINyQrrTJvmX&scope=openid+profile+email&state=AZiYICoz&nonce=AOFtLNWx&acr_values=urn:goiabada:level2_mandatory HTTP/1.1" from [::1]:45992 - 302 66B in 730.691Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002081] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46008 - 302 60B in 471.781Âµs
2025/11/25 13:26:18 INFO {"audit_event":"bumped_user_session","details":{"clientId":546,"userId":233}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002082] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46022 - 302 56B in 623.798Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":546,"codeId":97,"userId":233}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002083] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46026 - 302 255B in 377.423Âµs
--- PASS: TestAuthorize_ExistingAcrLevel2MandatorySession_AcrLevel2MandatoryRequest_OtpEnabled (0.28s)
=== RUN   TestDCR_Disabled_Returns403
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002084] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46038 - 403 91B in 118.163Âµs
--- PASS: TestDCR_Disabled_Returns403 (0.00s)
=== RUN   TestDCR_PublicClient_MCP_UseCase_Success
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":547,"clientIdentifier":"dcr_a5d47989-64fc-464b-9aee-5adb378575a1","grantTypes":["authorization_code","refresh_token"],"isPublic":true,"sourceIP":"[::1]:46044"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002085] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46044 - 201 293B in 227.721Âµs
--- PASS: TestDCR_PublicClient_MCP_UseCase_Success (0.00s)
=== RUN   TestDCR_ConfidentialClient_Success
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":548,"clientIdentifier":"dcr_46c28d35-bdf6-45f5-b489-9cb02c63cc15","grantTypes":["authorization_code","client_credentials","refresh_token"],"isPublic":false,"sourceIP":"[::1]:46046"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002086] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46046 - 201 408B in 188.656Âµs
--- PASS: TestDCR_ConfidentialClient_Success (0.00s)
=== RUN   TestDCR_DefaultValues_Applied
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":549,"clientIdentifier":"dcr_084f1a60-8ccb-4514-86c7-ebb0555fbb56","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46060"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002087] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46060 - 201 370B in 171.995Âµs
--- PASS: TestDCR_DefaultValues_Applied (0.00s)
=== RUN   TestDCR_RedirectURI_Validation
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_localhost_HTTP_allowed
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":550,"clientIdentifier":"dcr_1a09100a-850f-4c48-a97e-f1f6f9a9bd8e","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46064"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002088] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46064 - 201 298B in 159.391Âµs
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_127.0.0.1_HTTP_allowed
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":551,"clientIdentifier":"dcr_8069c6f4-ce84-4009-a8c7-e00b7c8a49e4","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46076"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002089] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46076 - 201 298B in 165.703Âµs
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_IPv6_localhost_allowed
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":552,"clientIdentifier":"dcr_e26086a2-edea-45fc-b9dd-70923ffeac27","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46090"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002090] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46090 - 201 294B in 147.609Âµs
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_custom_scheme_allowed
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":553,"clientIdentifier":"dcr_861c93e7-6300-410e-b259-2381ba1920d3","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46098"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002091] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46098 - 201 283B in 214.265Âµs
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_HTTPS_rejected_(security)
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002092] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46108 - 400 143B in 89.77Âµs
=== RUN   TestDCR_RedirectURI_Validation/Public_client_-_non-localhost_HTTP_rejected
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002093] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46124 - 400 116B in 80.452Âµs
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_HTTPS_allowed
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":554,"clientIdentifier":"dcr_2fb812bf-8baf-4d27-94a4-86e670e5f706","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46128"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002094] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46128 - 201 390B in 164.07Âµs
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_localhost_HTTP_allowed
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":555,"clientIdentifier":"dcr_af99ccc4-73d2-4130-8ef9-9e3a052607ca","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46132"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002095] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46132 - 201 397B in 155.434Âµs
=== RUN   TestDCR_RedirectURI_Validation/Confidential_client_-_non-localhost_HTTP_rejected
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002096] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46142 - 400 93B in 85.732Âµs
=== RUN   TestDCR_RedirectURI_Validation/Missing_redirect_uris_for_authorization_code
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002097] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46144 - 400 112B in 76.515Âµs
=== RUN   TestDCR_RedirectURI_Validation/Client_credentials_-_no_redirect_uris_required
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":556,"clientIdentifier":"dcr_432f6bd8-9cc3-419f-bd6a-d5c0d5a5bf71","grantTypes":["client_credentials"],"isPublic":false,"sourceIP":"[::1]:46152"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002098] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46152 - 201 348B in 126.419Âµs
=== RUN   TestDCR_RedirectURI_Validation/Invalid_URI_format
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002099] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46154 - 400 100B in 74.962Âµs
--- PASS: TestDCR_RedirectURI_Validation (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_localhost_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_127.0.0.1_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_IPv6_localhost_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_custom_scheme_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_HTTPS_rejected_(security) (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Public_client_-_non-localhost_HTTP_rejected (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_HTTPS_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_localhost_HTTP_allowed (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Confidential_client_-_non-localhost_HTTP_rejected (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Missing_redirect_uris_for_authorization_code (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Client_credentials_-_no_redirect_uris_required (0.00s)
    --- PASS: TestDCR_RedirectURI_Validation/Invalid_URI_format (0.00s)
=== RUN   TestDCR_GrantType_Validation
=== RUN   TestDCR_GrantType_Validation/Valid_grant_types
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":557,"clientIdentifier":"dcr_912b388c-9d2b-4c68-be9b-53729c6de2a7","grantTypes":["authorization_code","client_credentials","refresh_token"],"isPublic":false,"sourceIP":"[::1]:46164"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002100] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46164 - 201 409B in 149.462Âµs
=== RUN   TestDCR_GrantType_Validation/Unsupported_grant_type
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002101] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46168 - 400 91B in 70.283Âµs
=== RUN   TestDCR_GrantType_Validation/Unsupported_implicit_grant
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002102] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46170 - 400 91B in 74.531Âµs
=== RUN   TestDCR_GrantType_Validation/Mixed_valid_and_invalid
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002103] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46176 - 400 91B in 68.6Âµs
--- PASS: TestDCR_GrantType_Validation (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Valid_grant_types (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Unsupported_grant_type (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Unsupported_implicit_grant (0.00s)
    --- PASS: TestDCR_GrantType_Validation/Mixed_valid_and_invalid (0.00s)
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/none_-_public_client
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":558,"clientIdentifier":"dcr_590ce96c-2b19-4141-acb2-3c8d0ca3abc2","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46184"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002104] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46184 - 201 280B in 188.265Âµs
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/client_secret_basic
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":559,"clientIdentifier":"dcr_2b448fbd-69ea-4bc0-a1c5-57d54a427c9a","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46188"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002105] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46188 - 201 373B in 133.132Âµs
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/client_secret_post
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":560,"clientIdentifier":"dcr_a72f90c4-65d3-4698-8329-a2ca0694adc1","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46202"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002106] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46202 - 201 371B in 142.519Âµs
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_method
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002107] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46214 - 400 116B in 90.661Âµs
=== RUN   TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_private_key_jwt
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002108] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46222 - 400 114B in 70.813Âµs
--- PASS: TestDCR_TokenEndpointAuthMethod_Validation (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/none_-_public_client (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/client_secret_basic (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/client_secret_post (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_method (0.00s)
    --- PASS: TestDCR_TokenEndpointAuthMethod_Validation/Unsupported_private_key_jwt (0.00s)
=== RUN   TestDCR_ClientName_Validation
=== RUN   TestDCR_ClientName_Validation/Normal_name
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":561,"clientIdentifier":"dcr_52403250-045c-4a89-aefb-5aa184b70697","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46226"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002109] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46226 - 201 274B in 135.766Âµs
=== RUN   TestDCR_ClientName_Validation/Empty_name_allowed
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":562,"clientIdentifier":"dcr_948ecef7-61ea-4faf-8ee1-71158630d447","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46240"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002110] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46240 - 201 243B in 154.072Âµs
=== RUN   TestDCR_ClientName_Validation/Max_length_(128_chars)
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":563,"clientIdentifier":"dcr_c8baa74f-45b8-489c-9f87-4f3c562d14d1","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46242"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002111] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46242 - 201 388B in 121.901Âµs
=== RUN   TestDCR_ClientName_Validation/Too_long_(129_chars)
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002112] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46246 - 400 99B in 75.834Âµs
--- PASS: TestDCR_ClientName_Validation (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Normal_name (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Empty_name_allowed (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Max_length_(128_chars) (0.00s)
    --- PASS: TestDCR_ClientName_Validation/Too_long_(129_chars) (0.00s)
=== RUN   TestDCR_WellKnown_Metadata
=== RUN   TestDCR_WellKnown_Metadata/DCR_enabled_-_registration_endpoint_present
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002113] "GET http://localhost:19090/.well-known/openid-configuration HTTP/1.1" from [::1]:46256 - 200 1275B in 97.153Âµs
=== RUN   TestDCR_WellKnown_Metadata/DCR_disabled_-_registration_endpoint_absent
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002114] "GET http://localhost:19090/.well-known/openid-configuration HTTP/1.1" from [::1]:46264 - 200 1209B in 90.541Âµs
--- PASS: TestDCR_WellKnown_Metadata (0.00s)
    --- PASS: TestDCR_WellKnown_Metadata/DCR_enabled_-_registration_endpoint_present (0.00s)
    --- PASS: TestDCR_WellKnown_Metadata/DCR_disabled_-_registration_endpoint_absent (0.00s)
=== RUN   TestDCR_MultipleRedirectURIs
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":564,"clientIdentifier":"dcr_14085129-75b1-4323-9b0c-4ab805c1dff8","grantTypes":["authorization_code"],"isPublic":true,"sourceIP":"[::1]:46268"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002115] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46268 - 201 338B in 228.863Âµs
--- PASS: TestDCR_MultipleRedirectURIs (0.00s)
=== RUN   TestDCR_ConfidentialClient_DefaultAcrLevel
2025/11/25 13:26:18 INFO {"audit_event":"dynamic_client_registration","details":{"clientId":565,"clientIdentifier":"dcr_1812cebe-4d09-401d-b82f-b61112fbcf5a","grantTypes":["authorization_code"],"isPublic":false,"sourceIP":"[::1]:46284"}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002116] "POST http://localhost:19090/connect/register HTTP/1.1" from [::1]:46284 - 201 371B in 149.603Âµs
--- PASS: TestDCR_ConfidentialClient_DefaultAcrLevel (0.00s)
=== RUN   TestToken_ClientIdIsMissing
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002117] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46298 - 400 88B in 109.768Âµs
--- PASS: TestToken_ClientIdIsMissing (0.00s)
=== RUN   TestToken_ClientDoesNotExist
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002118] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46306 - 400 73B in 109.687Âµs
--- PASS: TestToken_ClientDoesNotExist (0.00s)
=== RUN   TestToken_InvalidGrantType
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002119] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46310 - 400 81B in 160.464Âµs
--- PASS: TestToken_InvalidGrantType (0.00s)
=== RUN   TestToken_AuthCode_MissingCode
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002120] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MdaERTCI&redirect_uri=http%3A%2F%2Fwww.seniorback-end.biz%2Fviral%2Fe-business%2Fengineer%2Finnovate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=oCEipajT&nonce=PiJTiWSN HTTP/1.1" from [::1]:46324 - 302 57B in 524.751Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002121] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46334 - 302 54B in 164.691Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002122] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46338 - 200 2949B in 301.4Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":234}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002123] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46338 - 302 0B in 35.086734ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002124] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46338 - 302 57B in 392.953Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002125] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46352 - 302 60B in 570.107Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":567,"userId":234}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002126] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46362 - 302 56B in 483.533Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":567,"codeId":98,"userId":234}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002127] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46364 - 302 240B in 470.058Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002128] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46380 - 400 83B in 202.623Âµs
--- PASS: TestToken_AuthCode_MissingCode (0.08s)
=== RUN   TestToken_AuthCode_MissingRedirectURI
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002129] "GET http://localhost:19090/auth/authorize/?client_id=test-client-FvrMUuvp&redirect_uri=https%3A%2F%2Fwww.forwardrepurpose.info%2Fimpactful&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=ReuTjrzB&nonce=nlEVCVMB HTTP/1.1" from [::1]:46392 - 302 57B in 311.128Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002130] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46406 - 302 54B in 397.492Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002131] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46420 - 200 2949B in 1.553665ms
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":235}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002132] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46420 - 302 0B in 35.732665ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002133] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46420 - 302 57B in 264.61Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002134] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46424 - 302 60B in 359.199Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":568,"userId":235}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002135] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46436 - 302 56B in 498.933Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":568,"codeId":99,"userId":235}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002136] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46444 - 302 219B in 363.347Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002137] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46456 - 400 91B in 212.953Âµs
--- PASS: TestToken_AuthCode_MissingRedirectURI (0.08s)
=== RUN   TestToken_AuthCode_MissingCodeVerifier
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002138] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kLHAUXVZ&redirect_uri=https%3A%2F%2Fwww.directmetrics.name%2Fevolve%2Fcollaborative%2Fgranular&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=PRyBXkYQ&nonce=dfBcpFdK HTTP/1.1" from [::1]:46462 - 302 57B in 523.298Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002139] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46478 - 302 54B in 213.033Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002140] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46494 - 200 2949B in 277.815Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":236}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002141] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46494 - 302 0B in 35.845458ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002142] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46494 - 302 57B in 409.063Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002143] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46504 - 302 60B in 326.056Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":569,"userId":236}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002144] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46518 - 302 56B in 1.062097ms
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":569,"codeId":100,"userId":236}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002145] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46522 - 302 236B in 339.752Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002146] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46524 - 400 92B in 333.009Âµs
--- PASS: TestToken_AuthCode_MissingCodeVerifier (0.08s)
=== RUN   TestToken_AuthCode_ClientDoesNotExist
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002147] "GET http://localhost:19090/auth/authorize/?client_id=test-client-UkMwVFew&redirect_uri=http%3A%2F%2Fwww.principalkiller.org%2Fstrategize%2Fbleeding-edge%2Fe-business&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=OoSHrJUK&nonce=HzxUJrmC HTTP/1.1" from [::1]:46534 - 302 57B in 295.068Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002148] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46542 - 302 54B in 363.888Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002149] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46550 - 200 2949B in 449.479Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":237}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002150] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46550 - 302 0B in 35.652363ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002151] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46550 - 302 57B in 431.936Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002152] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46552 - 302 60B in 330.945Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":570,"userId":237}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002153] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46564 - 302 56B in 516.085Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":570,"codeId":101,"userId":237}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002154] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46578 - 302 242B in 380.419Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002155] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46580 - 400 73B in 202.643Âµs
--- PASS: TestToken_AuthCode_ClientDoesNotExist (0.08s)
=== RUN   TestToken_AuthCode_CodeIsInvalid
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002156] "GET http://localhost:19090/auth/authorize/?client_id=test-client-pDOKezcp&redirect_uri=https%3A%2F%2Fwww.corporategranular.biz%2Fback-end%2Farchitect&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=nusLcaUo&nonce=hRLfeEdl HTTP/1.1" from [::1]:46582 - 302 57B in 511.566Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002157] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46588 - 302 54B in 189.508Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002158] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46602 - 200 2949B in 260.232Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":238}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002159] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46602 - 302 0B in 35.232119ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002160] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46602 - 302 57B in 547.946Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002161] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46604 - 302 60B in 298.845Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":571,"userId":238}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002162] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46614 - 302 56B in 474.968Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":571,"codeId":102,"userId":238}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002163] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46622 - 302 228B in 302.251Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002164] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46636 - 400 65B in 220.918Âµs
--- PASS: TestToken_AuthCode_CodeIsInvalid (0.08s)
=== RUN   TestToken_AuthCode_RedirectURIIsInvalid
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002165] "GET http://localhost:19090/auth/authorize/?client_id=test-client-TEIfllGj&redirect_uri=http%3A%2F%2Fwww.globalmesh.com%2Fapplications%2Fsyndicate%2Fe-tailers%2Fportals&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=QrSyqNsz&nonce=bCHlxPeo HTTP/1.1" from [::1]:46650 - 302 57B in 328.721Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002166] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46658 - 302 54B in 172.326Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002167] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46666 - 200 2949B in 343.379Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":239}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002168] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46666 - 302 0B in 35.286792ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002169] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46666 - 302 57B in 342.547Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002170] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46668 - 302 60B in 384.817Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":572,"userId":239}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002171] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46670 - 302 56B in 536.404Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":572,"codeId":103,"userId":239}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002172] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46672 - 302 242B in 349.229Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002173] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46680 - 400 70B in 229.624Âµs
--- PASS: TestToken_AuthCode_RedirectURIIsInvalid (0.08s)
=== RUN   TestToken_AuthCode_WrongClient
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002174] "GET http://localhost:19090/auth/authorize/?client_id=test-client-kqBJPTqs&redirect_uri=http%3A%2F%2Fwww.regionalplatforms.org%2Fparadigms%2Feyeballs%2Fusers&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=SCbwOuPY&nonce=yfnKksfy HTTP/1.1" from [::1]:46690 - 302 57B in 805.842Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002175] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46694 - 302 54B in 364.699Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002176] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46704 - 200 2949B in 434.791Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":240}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002177] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46704 - 302 0B in 36.085772ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002178] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46704 - 302 57B in 439.4Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002179] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46718 - 302 60B in 469.076Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":573,"userId":240}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002180] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46730 - 302 56B in 550.17Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":573,"codeId":104,"userId":240}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002181] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46734 - 302 233B in 410.446Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002182] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46746 - 400 111B in 363.226Âµs
--- PASS: TestToken_AuthCode_WrongClient (0.08s)
=== RUN   TestToken_AuthCode_ConfidentialClient_NoClientSecret
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002183] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gWkCCmLf&redirect_uri=http%3A%2F%2Fwww.corporaterobust.com%2Fsynergize%2F24-7&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=FhAbgLXp&nonce=NhhcuyZz HTTP/1.1" from [::1]:46748 - 302 57B in 527.326Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002184] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46762 - 302 54B in 213.653Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002185] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46774 - 200 2949B in 266.674Âµs
2025/11/25 13:26:18 INFO {"audit_event":"auth_success_pwd","details":{"userId":241}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002186] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46774 - 302 0B in 35.253169ms
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002187] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46774 - 302 57B in 464.147Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002188] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46786 - 302 60B in 370.49Âµs
2025/11/25 13:26:18 INFO {"audit_event":"started_new_user_session","details":{"clientId":575,"userId":241}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002189] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46800 - 302 56B in 543.036Âµs
2025/11/25 13:26:18 INFO {"audit_event":"created_auth_code","details":{"clientId":575,"codeId":105,"userId":241}}
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002190] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46804 - 302 221B in 372.353Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002191] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46806 - 400 215B in 345.403Âµs
--- PASS: TestToken_AuthCode_ConfidentialClient_NoClientSecret (0.08s)
=== RUN   TestToken_AuthCode_ConfidentialClient_ClientAuthFailed
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002192] "GET http://localhost:19090/auth/authorize/?client_id=test-client-bBKScHlU&redirect_uri=http%3A%2F%2Fwww.forwardbenchmark.com%2Fsynthesize%2Fnext-generation%2F24-7&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=beqenBPc&nonce=UBmBUKRh HTTP/1.1" from [::1]:46820 - 302 57B in 527.717Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002193] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46834 - 302 54B in 244.612Âµs
2025/11/25 13:26:18 [a357f2e3b56e/FBsnpuLk6O-002194] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46840 - 200 2949B in 247.698Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":242}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002195] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46840 - 302 0B in 35.404606ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002196] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46840 - 302 57B in 441.695Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002197] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46852 - 302 60B in 292.122Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":576,"userId":242}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002198] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46860 - 302 56B in 504.884Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":576,"codeId":106,"userId":242}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002199] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46862 - 302 239B in 388.103Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002200] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46864 - 400 112B in 362.385Âµs
--- PASS: TestToken_AuthCode_ConfidentialClient_ClientAuthFailed (0.08s)
=== RUN   TestToken_AuthCode_InvalidCodeVerifier
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002201] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ZQcZdwxq&redirect_uri=https%3A%2F%2Fwww.globalchannels.net%2Fb2c&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=eCILwJPW&nonce=lnaaGjYH HTTP/1.1" from [::1]:46880 - 302 57B in 307.311Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002202] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46892 - 302 54B in 212.612Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002203] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46896 - 200 2949B in 259.942Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":243}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002204] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46896 - 302 0B in 35.301491ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002205] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46896 - 302 57B in 290.7Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002206] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46898 - 302 60B in 281.842Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":577,"userId":243}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002207] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46904 - 302 56B in 528.078Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":577,"codeId":107,"userId":243}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002208] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46912 - 302 210B in 336.225Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002209] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:46916 - 400 78B in 356.363Âµs
--- PASS: TestToken_AuthCode_InvalidCodeVerifier (0.08s)
=== RUN   TestToken_AuthCode_SuccessPath
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002210] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xKiWUOty&redirect_uri=http%3A%2F%2Fwww.nationalexperiences.info%2Fplatforms%2Fwireless%2Fsystems%2Fenhance&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=ZoeXWsjo&nonce=aTILMwmN HTTP/1.1" from [::1]:46928 - 302 57B in 470.579Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002211] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:46944 - 302 54B in 227.079Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002212] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46952 - 200 2949B in 292.312Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":244}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002213] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:46952 - 302 0B in 35.209677ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002214] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:46952 - 302 57B in 369.268Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002215] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:46966 - 302 60B in 257.476Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":578,"userId":244}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002216] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:46976 - 302 56B in 511.036Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":578,"codeId":108,"userId":244}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002217] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:46994 - 302 246B in 671.529Âµs
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":108}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002218] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47000 - 200 4250B in 12.306282ms
--- PASS: TestToken_AuthCode_SuccessPath (0.09s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_Success
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002219] "GET http://localhost:19090/auth/authorize/?client_id=test-client-aiBZLuvx&redirect_uri=https%3A%2F%2Fwww.chiefwireless.org%2Frich%2Fincubate%2Fseamless%2Fmindshare&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=jwJYTWwo&nonce=wsUGQWJB HTTP/1.1" from [::1]:47002 - 302 57B in 599.753Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002220] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47008 - 302 54B in 385.488Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002221] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47016 - 200 2949B in 520.533Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":245}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002222] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47016 - 302 0B in 35.177165ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002223] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47016 - 302 57B in 241.576Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002224] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47018 - 302 60B in 306.098Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":579,"userId":245}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002225] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47022 - 302 56B in 454.479Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":579,"codeId":109,"userId":245}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002226] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47038 - 302 238B in 296.47Âµs
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":109}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002227] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47048 - 200 4232B in 11.45305ms
--- PASS: TestToken_AuthCode_ClientSecretBasic_Success (0.09s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_WrongSecret
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002228] "GET http://localhost:19090/auth/authorize/?client_id=test-client-gOgCWUqp&redirect_uri=http%3A%2F%2Fwww.dynamictransparent.io%2Fsynergies%2Farchitectures%2Finnovative&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=AODGnzBl&nonce=hduqCcZg HTTP/1.1" from [::1]:47054 - 302 57B in 624.79Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002229] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47072 - 302 54B in 250.954Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002230] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47078 - 200 2949B in 328.01Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":246}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002231] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47078 - 302 0B in 35.318463ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002232] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47078 - 302 57B in 196.321Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002233] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47086 - 302 60B in 332.989Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":580,"userId":246}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002234] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47092 - 302 56B in 515.144Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":580,"codeId":110,"userId":246}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002235] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47098 - 302 243B in 331.878Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002236] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47112 - 400 112B in 379.928Âµs
--- PASS: TestToken_AuthCode_ClientSecretBasic_WrongSecret (0.08s)
=== RUN   TestToken_AuthCode_ClientSecretBasic_BothMethodsProvided
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002237] "GET http://localhost:19090/auth/authorize/?client_id=test-client-oMKsYkkq&redirect_uri=http%3A%2F%2Fwww.seniordistributed.net%2Fuser-centric&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=TWWDKmuK&nonce=CjHQDtap HTTP/1.1" from [::1]:47116 - 302 57B in 288.075Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002238] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47132 - 302 54B in 200.229Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002239] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47146 - 200 2949B in 320.706Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":247}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002240] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47146 - 302 0B in 35.296331ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002241] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47146 - 302 57B in 235.214Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002242] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47156 - 302 60B in 482.502Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":581,"userId":247}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002243] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47170 - 302 56B in 539.259Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":581,"codeId":111,"userId":247}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002244] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47174 - 302 221B in 327.969Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002245] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47178 - 400 211B in 150.193Âµs
--- PASS: TestToken_AuthCode_ClientSecretBasic_BothMethodsProvided (0.07s)
=== RUN   TestToken_ClientCred_ClientSecretBasic_Success
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":582}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002246] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47188 - 200 1213B in 3.941116ms
--- PASS: TestToken_ClientCred_ClientSecretBasic_Success (0.00s)
=== RUN   TestToken_ClientCred_ClientSecretBasic_WrongSecret
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002247] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47198 - 401 79B in 133.603Âµs
--- PASS: TestToken_ClientCred_ClientSecretBasic_WrongSecret (0.00s)
=== RUN   TestToken_Refresh_ClientSecretBasic_Success
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002248] "GET http://localhost:19090/auth/authorize/?client_id=test-client-EtsJzozP&redirect_uri=https%3A%2F%2Fwww.forwardmonetize.org%2Fb2b&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=kTdsDVUa&nonce=nCyeLYHq HTTP/1.1" from [::1]:47208 - 302 57B in 497.56Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002249] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47216 - 302 54B in 235.525Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002250] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47218 - 200 2949B in 265.571Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":248}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002251] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47218 - 302 0B in 35.35422ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002252] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47218 - 302 57B in 279.408Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002253] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47230 - 302 60B in 276.432Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":584,"userId":248}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002254] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47238 - 302 56B in 553.816Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":584,"codeId":112,"userId":248}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002255] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47254 - 302 211B in 330.995Âµs
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":112}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002256] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47260 - 200 4232B in 11.127124ms
2025/11/25 13:26:19 INFO {"audit_event":"bumped_user_session","details":{"clientId":584,"userId":248}}
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":112,"refreshTokenJti":"b8ebd7d3-34b7-423b-9b75-d749dd8a38fb"}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002257] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47260 - 200 4232B in 11.689126ms
--- PASS: TestToken_Refresh_ClientSecretBasic_Success (0.10s)
=== RUN   TestToken_Refresh_ClientSecretBasic_WrongSecret
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002258] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zuanJFsf&redirect_uri=https%3A%2F%2Fwww.investore-enable.name%2Ftechnologies%2Fdrive%2Fmagnetic&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=PCwdTaUB&nonce=rglaIGUd HTTP/1.1" from [::1]:47274 - 302 57B in 511.807Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002259] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47284 - 302 54B in 215.718Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002260] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47296 - 200 2949B in 280.821Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":249}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002261] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47296 - 302 0B in 35.459208ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002262] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47296 - 302 57B in 235.705Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002263] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47308 - 302 60B in 480.337Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":585,"userId":249}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002264] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47324 - 302 56B in 461.892Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":585,"codeId":113,"userId":249}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002265] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47326 - 302 237B in 357.486Âµs
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":113}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002266] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47336 - 200 4226B in 11.17234ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002267] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47336 - 400 112B in 231.868Âµs
--- PASS: TestToken_Refresh_ClientSecretBasic_WrongSecret (0.09s)
=== RUN   TestToken_ClientCred_FlowIsNotEnabled
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002268] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47348 - 400 146B in 151.075Âµs
--- PASS: TestToken_ClientCred_FlowIsNotEnabled (0.00s)
=== RUN   TestToken_ClientCred_ClientSecretIsMissing
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002269] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47362 - 400 215B in 137.63Âµs
--- PASS: TestToken_ClientCred_ClientSecretIsMissing (0.00s)
=== RUN   TestToken_ClientCred_ClientAuthFailed
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002270] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47372 - 401 79B in 163.709Âµs
--- PASS: TestToken_ClientCred_ClientAuthFailed (0.00s)
=== RUN   TestToken_ClientCred_InvalidScope
=== RUN   TestToken_ClientCred_InvalidScope/openid
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002271] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47374 - 400 269B in 167.827Âµs
=== RUN   TestToken_ClientCred_InvalidScope/groups
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002272] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47384 - 400 269B in 182.946Âµs
=== RUN   TestToken_ClientCred_InvalidScope/aaa
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002273] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47392 - 400 199B in 134.875Âµs
=== RUN   TestToken_ClientCred_InvalidScope/invalid:perm
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002274] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47404 - 400 132B in 185.62Âµs
=== RUN   TestToken_ClientCred_InvalidScope/backend-svcA-NbafLXmz:perm
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002275] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47410 - 400 190B in 183.837Âµs
=== RUN   TestToken_ClientCred_InvalidScope/backend-svcA-NbafLXmz:read-product-xDgmsVeM
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002276] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47420 - 400 151B in 206.881Âµs
--- PASS: TestToken_ClientCred_InvalidScope (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/openid (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/groups (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/aaa (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/invalid:perm (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/backend-svcA-NbafLXmz:perm (0.00s)
    --- PASS: TestToken_ClientCred_InvalidScope/backend-svcA-NbafLXmz:read-product-xDgmsVeM (0.00s)
=== RUN   TestToken_ClientCred_NoScopesGiven
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":590}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002277] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47424 - 200 1359B in 4.029293ms
--- PASS: TestToken_ClientCred_NoScopesGiven (0.00s)
=== RUN   TestToken_ClientCred_SpecificScope
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_client_credentials_response","details":{"clientId":591}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002278] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47440 - 200 1228B in 3.993686ms
--- PASS: TestToken_ClientCred_SpecificScope (0.00s)
=== RUN   TestToken_Refresh_ClientSecretIsMissing
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002279] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47450 - 400 215B in 222.259Âµs
--- PASS: TestToken_Refresh_ClientSecretIsMissing (0.00s)
=== RUN   TestToken_Refresh_ClientAuthFailed
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002280] "GET http://localhost:19090/auth/authorize/?client_id=test-client-MIXHSZpl&redirect_uri=https%3A%2F%2Fwww.internalincentivize.net%2Fubiquitous%2Frelationships&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=LtdjFMdu&nonce=wPjcpjiY HTTP/1.1" from [::1]:47458 - 302 57B in 511.556Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002281] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47474 - 302 54B in 198.154Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002282] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47478 - 200 2949B in 292.553Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":250}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002283] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47478 - 302 0B in 35.160324ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002284] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47478 - 302 57B in 409.574Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002285] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47492 - 302 60B in 308.512Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":593,"userId":250}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002286] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47494 - 302 56B in 502.008Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":593,"codeId":114,"userId":250}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002287] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47496 - 302 236B in 328.421Âµs
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":114}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002288] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47502 - 200 4224B in 11.214339ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002289] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47502 - 400 112B in 226.789Âµs
--- PASS: TestToken_Refresh_ClientAuthFailed (0.09s)
=== RUN   TestToken_Refresh_MissingRefreshToken
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002290] "GET http://localhost:19090/auth/authorize/?client_id=test-client-VLcBZDjG&redirect_uri=https%3A%2F%2Fwww.seniorsyndicate.info%2Freal-time%2Fapplications%2Fgrow%2Fmesh&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=tSnRxtOt&nonce=bFabozdB HTTP/1.1" from [::1]:47518 - 302 57B in 541.924Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002291] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47520 - 302 54B in 173.878Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002292] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47536 - 200 2949B in 285.058Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":251}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002293] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47536 - 302 0B in 35.322109ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002294] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47536 - 302 57B in 463.165Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002295] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47552 - 302 60B in 346.194Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":594,"userId":251}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002296] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47562 - 302 56B in 673.523Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":594,"codeId":115,"userId":251}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002297] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47564 - 302 241B in 386.25Âµs
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":115}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002298] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47572 - 200 4226B in 11.698504ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002299] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47572 - 400 92B in 293.775Âµs
--- PASS: TestToken_Refresh_MissingRefreshToken (0.09s)
=== RUN   TestToken_Refresh_TokenWithBadSignature
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002300] "GET http://localhost:19090/auth/authorize/?client_id=test-client-fjbcxLpV&redirect_uri=http%3A%2F%2Fwww.corporatefront-end.org%2F24-7%2Finfomediaries%2Fsupply-chains&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=nFEveimO&nonce=RqeYUhHZ HTTP/1.1" from [::1]:47574 - 302 57B in 632.304Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002301] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47576 - 302 54B in 665.557Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002302] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47584 - 200 2949B in 863.762Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":252}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002303] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47584 - 302 0B in 37.7149ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002304] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47584 - 302 57B in 518.7Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002305] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47588 - 302 60B in 332.468Âµs
2025/11/25 13:26:19 INFO {"audit_event":"started_new_user_session","details":{"clientId":595,"userId":252}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002306] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47604 - 302 56B in 652.302Âµs
2025/11/25 13:26:19 INFO {"audit_event":"created_auth_code","details":{"clientId":595,"codeId":116,"userId":252}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002307] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47606 - 302 242B in 344.872Âµs
2025/11/25 13:26:19 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":116}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002308] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47610 - 200 4224B in 11.415268ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002309] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47610 - 400 139B in 432.767Âµs
--- PASS: TestToken_Refresh_TokenWithBadSignature (0.11s)
=== RUN   TestToken_Refresh_TokenExpired
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002310] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:47624 - 400 123B in 402.24Âµs
--- PASS: TestToken_Refresh_TokenExpired (0.01s)
=== RUN   TestToken_Refresh_WrongClient
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002311] "GET http://localhost:19090/auth/authorize/?client_id=test-client-ivbQIzsk&redirect_uri=https%3A%2F%2Fwww.legacywireless.name%2Fnetworks%2Fchannels&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=LqxNBsje&nonce=ZrsOATmD HTTP/1.1" from [::1]:47630 - 302 57B in 313.382Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002312] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47644 - 302 54B in 177.956Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002313] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47650 - 200 2949B in 300.047Âµs
2025/11/25 13:26:19 INFO {"audit_event":"auth_success_pwd","details":{"userId":253}}
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002314] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47650 - 302 0B in 35.780476ms
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002315] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47650 - 302 57B in 439.56Âµs
2025/11/25 13:26:19 [a357f2e3b56e/FBsnpuLk6O-002316] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47656 - 302 60B in 592.038Âµs
2025/11/25 13:26:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":597,"userId":253}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002317] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47666 - 302 56B in 503.05Âµs
2025/11/25 13:26:20 INFO {"audit_event":"created_auth_code","details":{"clientId":597,"codeId":117,"userId":253}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002318] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47680 - 302 225B in 373.085Âµs
2025/11/25 13:26:20 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":117}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002319] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47686 - 200 4256B in 11.431309ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002320] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47686 - 400 121B in 566.35Âµs
--- PASS: TestToken_Refresh_WrongClient (0.09s)
=== RUN   TestToken_Refresh_WithAdditionalScope
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002321] "GET http://localhost:19090/auth/authorize/?client_id=test-client-eBcJclfB&redirect_uri=https%3A%2F%2Fwww.centralrich.io%2F24-7%2Fexperiences&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=XXnLXrCM&nonce=pRVrrrMc HTTP/1.1" from [::1]:47698 - 302 57B in 537.506Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002322] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47706 - 302 54B in 288.014Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002323] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47714 - 200 2949B in 312.581Âµs
2025/11/25 13:26:20 INFO {"audit_event":"auth_success_pwd","details":{"userId":254}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002324] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47714 - 302 0B in 35.436055ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002325] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47714 - 302 57B in 237.359Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002326] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47716 - 302 60B in 552.945Âµs
2025/11/25 13:26:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":599,"userId":254}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002327] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47732 - 302 56B in 532.726Âµs
2025/11/25 13:26:20 INFO {"audit_event":"created_auth_code","details":{"clientId":599,"codeId":118,"userId":254}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002328] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47742 - 302 219B in 350.312Âµs
2025/11/25 13:26:20 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":118}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002329] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47752 - 200 4232B in 11.169183ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002330] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47752 - 400 220B in 624.89Âµs
2025/11/25 13:26:20 INFO {"audit_event":"bumped_user_session","details":{"clientId":599,"userId":254}}
2025/11/25 13:26:20 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":118,"refreshTokenJti":"8c21dbcf-562c-40d0-acdb-fb49bdbccc1d"}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002331] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47752 - 200 4232B in 11.520407ms
--- PASS: TestToken_Refresh_WithAdditionalScope (0.10s)
=== RUN   TestToken_Refresh_ConsentRemoved
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002332] "GET http://localhost:19090/auth/authorize/?client_id=test-client-xBQAWvdC&redirect_uri=http%3A%2F%2Fwww.dynamicexpedite.com%2Fe-markets&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email+res-ZlzgCGvO%3Aperm-RBJhozHx&state=jJkadIHJ&nonce=EuNyhUqO HTTP/1.1" from [::1]:47758 - 302 57B in 590.195Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002333] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47764 - 302 54B in 173.979Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002334] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47768 - 200 2949B in 540.681Âµs
2025/11/25 13:26:20 INFO {"audit_event":"auth_success_pwd","details":{"userId":255}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002335] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47768 - 302 0B in 35.019798ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002336] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47768 - 302 60B in 592.74Âµs
2025/11/25 13:26:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":600,"userId":255}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002337] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47772 - 302 58B in 1.18019ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002338] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47788 - 200 4267B in 466.972Âµs
2025/11/25 13:26:20 INFO {"audit_event":"saved_consent","details":{"clientId":600,"consentId":20,"userId":255}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002339] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47788 - 302 0B in 392.021Âµs
2025/11/25 13:26:20 INFO {"audit_event":"created_auth_code","details":{"clientId":600,"codeId":119,"userId":255}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002340] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47788 - 302 216B in 326.537Âµs
2025/11/25 13:26:20 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":119}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002341] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:47790 - 200 4330B in 11.137814ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002342] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:47790 - 400 153B in 599.924Âµs
--- PASS: TestToken_Refresh_ConsentRemoved (0.09s)
=== RUN   TestToken_Refresh_ConsentDoesNotIncludeScope
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002343] "GET http://localhost:19090/auth/authorize/?client_id=test-client-SXXeVRav&redirect_uri=https%3A%2F%2Fwww.corporatedisintermediate.net%2Fweb-readiness&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=goPQcvPh&nonce=VuhqddAa HTTP/1.1" from [::1]:47794 - 302 57B in 285.279Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002344] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47798 - 302 54B in 197.743Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002345] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47804 - 200 2949B in 281.963Âµs
2025/11/25 13:26:20 INFO {"audit_event":"auth_success_pwd","details":{"userId":256}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002346] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47804 - 302 0B in 35.08981ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002347] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47804 - 302 60B in 455.971Âµs
2025/11/25 13:26:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":601,"userId":256}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002348] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47814 - 302 58B in 636.463Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002349] "GET http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47830 - 200 3835B in 439.971Âµs
2025/11/25 13:26:20 INFO {"audit_event":"saved_consent","details":{"clientId":601,"consentId":21,"userId":256}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002350] "POST http://localhost:19090/auth/consent HTTP/1.1" from [::1]:47830 - 302 0B in 417.279Âµs
2025/11/25 13:26:20 INFO {"audit_event":"created_auth_code","details":{"clientId":601,"codeId":120,"userId":256}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002351] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47830 - 302 230B in 308.684Âµs
2025/11/25 13:26:20 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":120}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002352] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:47840 - 200 4206B in 11.178191ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002353] "POST http://localhost:19090/auth/token HTTP/1.1" from [::1]:47840 - 400 188B in 521.355Âµs
--- PASS: TestToken_Refresh_ConsentDoesNotIncludeScope (0.09s)
=== RUN   TestToken_Refresh_TokenMarkedAsUsed
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002354] "GET http://localhost:19090/auth/authorize/?client_id=test-client-zDlTNQuy&redirect_uri=https%3A%2F%2Fwww.seniorenterprise.org%2Fiterate%2Fsyndicate&response_type=code&code_challenge_method=S256&code_challenge=qdgLLRr1saFHT6DWfWU28VNPIi7e9ynEBnBG3Oadw9g&scope=openid+profile+email&state=EnxMLGTx&nonce=OFdcdMrA HTTP/1.1" from [::1]:47850 - 302 57B in 509.513Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002355] "GET http://localhost:19090/auth/level1 HTTP/1.1" from [::1]:47860 - 302 54B in 233.12Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002356] "GET http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47874 - 200 2949B in 332.047Âµs
2025/11/25 13:26:20 INFO {"audit_event":"auth_success_pwd","details":{"userId":257}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002357] "POST http://localhost:19090/auth/pwd HTTP/1.1" from [::1]:47874 - 302 0B in 35.414704ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002358] "GET http://localhost:19090/auth/level1completed HTTP/1.1" from [::1]:47874 - 302 57B in 244.833Âµs
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002359] "GET http://localhost:19090/auth/level2 HTTP/1.1" from [::1]:47876 - 302 60B in 316.057Âµs
2025/11/25 13:26:20 INFO {"audit_event":"started_new_user_session","details":{"clientId":602,"userId":257}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002360] "GET http://localhost:19090/auth/completed HTTP/1.1" from [::1]:47888 - 302 56B in 599.943Âµs
2025/11/25 13:26:20 INFO {"audit_event":"created_auth_code","details":{"clientId":602,"codeId":121,"userId":257}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002361] "GET http://localhost:19090/auth/issue HTTP/1.1" from [::1]:47890 - 302 226B in 394.255Âµs
2025/11/25 13:26:20 INFO {"audit_event":"token_issued_authorization_code_response","details":{"codeId":121}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002362] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47906 - 200 4248B in 11.898682ms
2025/11/25 13:26:20 INFO {"audit_event":"bumped_user_session","details":{"clientId":602,"userId":257}}
2025/11/25 13:26:20 INFO {"audit_event":"token_issued_refresh_token_response","details":{"codeId":121,"refreshTokenJti":"c418dadb-0566-479e-970d-13ae9563b5b0"}}
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002363] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47906 - 200 4248B in 12.47446ms
2025/11/25 13:26:20 [a357f2e3b56e/FBsnpuLk6O-002364] "POST http://localhost:19090/auth/token/ HTTP/1.1" from [::1]:47906 - 400 85B in 1.31788ms
--- PASS: TestToken_Refresh_TokenMarkedAsUsed (0.10s)
PASS
ok  	github.com/leodip/goiabada/authserver/tests/integration	18.760s
Tests finished. Killing the server...
Checking for processes on port 19090...
Found processes listening on port 19090: 133396
Killing process 133396 on port 19090
Checking for processes on port 19091...
No processes found on port 19091
./run-tests.sh: line 78: 133396 Killed                  ./tmp/goiabada-authserver
Port 19090 is now free
Port 19091 is now free
=== Completed integration tests with sqlite ===

All tests completed successfully.
Cleaning up processes...
Checking for processes on port 19090...
No processes found on port 19090
Checking for processes on port 19091...
No processes found on port 19091
Port 19090 is now free
Port 19091 is now free
Cleaning up temporary SQLite databases...
