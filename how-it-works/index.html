
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://goiabada.dev/how-it-works/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
  <title>Goiabada - open source authentication and authorization server</title>

    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
    <meta name="description" content="Goiabada provides a solution for user management. Easy to use Oauth2 / OpenID Connect server">

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-it-works" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Goiabada" class="md-header__button md-logo" aria-label="Goiabada" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Goiabada
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How it works
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/leodip/goiabada" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Goiabada" class="md-nav__button md-logo" aria-label="Goiabada" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Goiabada
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/leodip/goiabada" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    How it works
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How it works
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#use-cases" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use Cases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#clients" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clients
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#resources-and-permissions" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources & Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#openid-connect-scopes" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenID Connect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#user-sessions" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Sessions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#token-expiration" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Token Expiration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#refresh-tokens" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Refresh Tokens
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#users-and-groups" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users & Groups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#self-registration" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self Registration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="#endpoints" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoints
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Integration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/#javascript-only" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Javascript only
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/#go-web-app" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go web app
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../customizations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customizations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Use cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#users-accessing-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Users accessing resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server-to-server-communications" class="md-nav__link">
    <span class="md-ellipsis">
      Server to server communications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learn-more-about-oauth2" class="md-nav__link">
    <span class="md-ellipsis">
      Learn more about OAuth2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clients" class="md-nav__link">
    <span class="md-ellipsis">
      Clients
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Clients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#public-or-confidential-clients" class="md-nav__link">
    <span class="md-ellipsis">
      Public or confidential clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consent-required" class="md-nav__link">
    <span class="md-ellipsis">
      Consent required
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-acr-level" class="md-nav__link">
    <span class="md-ellipsis">
      Default ACR level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redirect-uris" class="md-nav__link">
    <span class="md-ellipsis">
      Redirect URIs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-origins" class="md-nav__link">
    <span class="md-ellipsis">
      Web origins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Client permissions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources-and-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Resources and permissions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Resources and permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scope" class="md-nav__link">
    <span class="md-ellipsis">
      Scope
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openid-connect-scopes" class="md-nav__link">
    <span class="md-ellipsis">
      OpenID Connect scopes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-sessions" class="md-nav__link">
    <span class="md-ellipsis">
      User sessions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      Token expiration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refresh-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Refresh tokens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#users-and-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Users and groups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#self-registration" class="md-nav__link">
    <span class="md-ellipsis">
      Self registration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      Endpoints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#well-known-discovery-url" class="md-nav__link">
    <span class="md-ellipsis">
      Well-known discovery URL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authauthorize-get" class="md-nav__link">
    <span class="md-ellipsis">
      /auth/authorize (GET)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authtoken-post" class="md-nav__link">
    <span class="md-ellipsis">
      /auth/token (POST)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authlogout-get-or-post" class="md-nav__link">
    <span class="md-ellipsis">
      /auth/logout (GET or POST)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="/auth/logout (GET or POST)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#net-c" class="md-nav__link">
    <span class="md-ellipsis">
      .NET C#
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go" class="md-nav__link">
    <span class="md-ellipsis">
      Go
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodejs" class="md-nav__link">
    <span class="md-ellipsis">
      NodeJS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#userinfo-get-or-post" class="md-nav__link">
    <span class="md-ellipsis">
      /userinfo (GET or POST)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="how-it-works">How it works</h1>
<h2 id="use-cases">Use cases</h2>
<p>Goiabada is useful in two main scenarios:</p>
<ol>
<li>When users need access to specific resources (such as a section of your application or an API) and you want to manage that access.</li>
<li>When servers need to access other servers, and you want to set defined permission levels for them.</li>
</ol>
<p>Let's view those in more details.</p>
<h3 id="users-accessing-resources">Users accessing resources</h3>
<p>When you have users accessing resources, you basically need to know: who the user is (<em>authentication</em>), and whether they're authorized to access that resource (<em>authorization</em>).</p>
<p>Goiabada works with two familiar web protocols to fulfil that: OpenID Connect handles the who's who (<em>authentication</em>), and OAuth2 takes care of who can do what (<em>authorization</em>).</p>
<p>Regardless of your app type (a web app on the server side, a web app using JavaScript, or a mobile native app), the recommended approach is the <strong>Authorization code flow with PKCE</strong>.</p>
<p>The Authorization code flow with PKCE is a secure method for handling user authentication in web applications. It works in two steps: first, the application requests an authorization code from the <code>/authorize</code> endpoint. Then, it exchanges this code for an access token, a refresh token, and optionally an ID token at the <code>/token</code> endpoint.</p>
<p>PKCE adds an extra layer of security by preventing interception of the authorization code, especially in public clients like mobile or single-page applications.</p>
<h3 id="server-to-server-communications">Server to server communications</h3>
<p>When you have a set of servers working together, and you want to ensure that only the right clients can access resources on a specific server, go for the <strong>Client credentials flow</strong>, with a confidential client.</p>
<h3 id="learn-more-about-oauth2">Learn more about OAuth2</h3>
<p>OAuth2 covers a lot of ground. To delve deeper into it, check out this link - <a href="https://www.oauth.com/">https://www.oauth.com/</a></p>
<h2 id="clients">Clients</h2>
<p>A client represents an application that requests access to protected resources.</p>
<p>This access can either be on behalf of a user (using the authorization code flow with PKCE) or for the client itself (using the client credentials flow).</p>
<h3 id="public-or-confidential-clients">Public or confidential clients</h3>
<p>Clients can be either public or confidential.</p>
<p>A <strong>public client</strong> is recommended for applications that cannot ensure the confidentiality of their client credentials. This is relevant for JavaScript-only web applications, where any secrets are exposed in the browser, and also in mobile apps, where an APK can be decompiled, revealing stored secrets.</p>
<p>A <strong>confidential client</strong> is recommended for applications that can securely protect client credentials, such as server-side applications. Confidential clients can safely store sensitive information like passwords, as they run on a secure server rather than on a user's device or browser.</p>
<h3 id="consent-required">Consent required</h3>
<p>In OAuth2, the consent process is important for ensuring that users explicitly authorize third-party applications to access their resources.</p>
<p>When the client is affiliated with the same organization as the authorization server and a high level of trust exists, explicit consent is not usually required.</p>
<p>However, for clients from third-party organizations, it's important to configure the client to request user consent. This ensures that users are aware of who is accessing their tokens.</p>
<h3 id="default-acr-level">Default ACR level</h3>
<p>ACR stands for "Authentication Context Class Reference." It's a way to specify the level of authentication assurance or the strength of the authentication method used to authenticate the end-user.</p>
<p>Goiabada has 3 levels:</p>
<table>
<thead>
<tr>
<th>ACR level</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>urn:goiabada:level1</code></td>
<td>Level 1 authentication only (password)</td>
</tr>
<tr>
<td><code>urn:goiabada:level2_optional</code></td>
<td>Level 1 with optional 2fa (if 2fa is enabled by the user)</td>
</tr>
<tr>
<td><code>urn:goiabada:level2_mandatory</code></td>
<td>Level 1 with mandatory 2fa</td>
</tr>
</tbody>
</table>
<p>By default, a client comes configured with <code>urn:goiabada:level2_optional</code>.</p>
<p>You have the flexibility to override the client's default ACR level on a per-authorization basis. For example, if your client has the default <code>urn:goiabada:level2_optional</code> but you have a specific resource that requires users to authenticate using two-factor authentication (2fa), you can specify <code>urn:goiabada:level2_mandatory</code> in the <code>acr_values</code> parameter of the authorization request.</p>
<h3 id="redirect-uris">Redirect URIs</h3>
<p>In the Authorization code flow with PKCE, the client application specifies a redirect URI in its authorization request.</p>
<p>After the user grants or denies permission, the authorization server redirects the user back to this specified URI.</p>
<p>It's necessary to pre-configure this URI in the client, and only exact matches are accepted (no wildcards).</p>
<h3 id="web-origins">Web origins</h3>
<p>If your client application plans to make calls to the <code>/token</code>, <code>/logout</code> or <code>/userinfo</code> endpoints from Javascript, you must register the URL (origin) of the web application here, to enable Cross-Origin Resource Sharing (CORS) access. Failure to do so will result in CORS blocking the HTTP requests.</p>
<h3 id="client-permissions">Client permissions</h3>
<p>Client permissions are used in server-to-server checks, specifically within the client credentials flow. This is about the permissions granted to the client itself, allowing it to access other resources.</p>
<h2 id="resources-and-permissions">Resources and permissions</h2>
<p>In Goiabada, you have the ability to define both resources and permissions. Each resource can have multiple permissions associated with it. </p>
<p>You can assign these permissions to users, groups, or clients as needed.</p>
<h3 id="scope">Scope</h3>
<p>When you pair a resource with a permission, it forms a <strong>scope</strong>, both in the authorization request and within the tokens. For example, if you have a resource identified as <code>product-api</code> and a permission identified as <code>delete-product</code> the corresponding scope will be represented as <code>product-api:delete-product</code>.</p>
<h2 id="openid-connect-scopes">OpenID Connect scopes</h2>
<p>Besides the authorization scopes that are formed by resources and permissions (as explained in the previous section), Goiabada supports typical OpenID Connect scopes. They are:</p>
<table>
<thead>
<tr>
<th>OIDC scope</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>openid</td>
<td>Will include an <code>id_token</code> in the token response, with the subject identifier (<code>sub</code> claim)</td>
</tr>
<tr>
<td>profile</td>
<td>Access to claims: <code>name</code>, <code>family_name</code>, <code>given_name</code>, <code>middle_name</code>, <code>nickname</code>, <code>preferred_username</code>, <code>profile</code>, <code>website</code>, <code>gender</code>, <code>birthdate</code>, <code>zoneinfo</code>, <code>locale</code>, and <code>updated_at</code></td>
</tr>
<tr>
<td>email</td>
<td>Access to claims: <code>email</code>, <code>email_verified</code></td>
</tr>
<tr>
<td>address</td>
<td>Access to the <code>address</code> claim</td>
</tr>
<tr>
<td>phone</td>
<td>Access to claims: <code>phone_number</code> and <code>phone_number_verified</code></td>
</tr>
<tr>
<td>groups</td>
<td>Access to the list of groups the user belongs to</td>
</tr>
<tr>
<td>attributes</td>
<td>Access to the attributes assigned to the user by an admin, stored as key-value pairs</td>
</tr>
<tr>
<td>offline_access</td>
<td>Access to a refresh token of the type <code>Offline</code>, allowing the client to obtain a new access token without requiring an immediate interaction</td>
</tr>
</tbody>
</table>
<h2 id="user-sessions">User sessions</h2>
<p>User sessions facilitate the single sign-on (SSO) functionality of Goiabada. Once a user logs in, a new session starts. If they try to log in again and their session is still good, they don't need to go through the authentication process again.</p>
<p>There are two configurations that are related to the user session:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>User session idle timeout in seconds</td>
<td>If there is no activity from the user within this timeframe, the session will be terminated. This will look into the <code>last_accessed</code> timestamp of the session.</td>
</tr>
<tr>
<td>User session max lifetime in seconds</td>
<td>The maximum duration a user session can last, irrespective of user activity. This will be checked against the <code>started</code> timestamp of the session.</td>
</tr>
</tbody>
</table>
<p>A user session is bumped (which means, gets a new <code>last_accessed</code> timestamp) in two situations:</p>
<ol>
<li>When a new authorization request completes</li>
<li>When a refresh token associated with the session is used to request a new access token</li>
</ol>
<p>In your authorization request, you have the option to include the <code>max_age</code> parameter. This parameter allows you to define the maximum acceptable time (in seconds) since the user's last authentication. For instance, if you add <code>max_age=120</code> to the authentication request, it implies that the user needs to re-authenticate if their last authentication was over 120 seconds (2 minutes) ago, regardless of having a valid session. This is useful when the client needs to ensure that the user authenticated within a specific timeframe.</p>
<h2 id="token-expiration">Token expiration</h2>
<p>You can customize the expiration (in seconds) for access tokens and id tokens on the Settings &rarr; Tokens page. These configurations apply globally to all clients. However, if needed, individual clients have the flexibility to override the global settings in their specific client configurations.</p>
<p>The default token expiration is set to 5 minutes. Access tokens are intentionally kept short-lived, for security reasons.</p>
<h2 id="refresh-tokens">Refresh tokens</h2>
<p>Refresh tokens are used in the authorization code flow with PKCE (in the client credentials flow we don't have refresh tokens). </p>
<p>Goiabada supports two types of refresh tokens: normal and offline.</p>
<p>Normal tokens are linked to the user session. They can be used to get a new access token, as long as there's an active user session. When a normal refresh token is used, the user session <code>last_accessed</code> timestamp is bumped. The expiration time of a normal refresh token is the same as the user session idle timeout (default is 2 hours). If the user session is terminated,  it will automatically invalidate the refresh tokens linked to that session.</p>
<p>Offline refresh tokens are not linked to a user session. They can be used to obtain a new access token even when the user is not actively using the application. Their expiration time is long (defaults to 30 days).</p>
<p>In your authorization request, when you ask for the <code>offline_access</code> scope, your refresh token will be classified as <code>offline</code>. Otherwise, if you don't include the <code>offline_access</code> scope, your refresh token will be considered normal.</p>
<p>Upon each usage of a refresh token, the refresh token passed in to the <code>/auth/token</code> endpoint becomes inactive, and a new refresh token is provided in the token response. In other words, a refresh token is a one-time-use token; once used, it must be substituted with the new refresh token obtained from the response.</p>
<h2 id="users-and-groups">Users and groups</h2>
<p>As an administrator of Goiabada you can create users and configure their properties (profile information, address, phone, email...). Also, you have the capability to modify their credentials, terminate active user sessions, and revoke consents.</p>
<p>You can also assign permissions and attributes to individual users. Attributes are key-value pairs or arbitraty information, and can be included in the access token or id token.</p>
<p>To facilitate user management, you can create groups of users. When you give a permission to a group, it's given to all group members. The same applies to attributes - group attributes will be included for all group members.
c</p>
<p>Attributes are arbitrary key-value pairs that you can associate with either a user or a group. When creating an attribute, you can choose to include it either in the access token or the id token.</p>
<h2 id="self-registration">Self registration</h2>
<p>When the 'Self registration' setting is activated, users gain the ability to independently register their accounts using a link incorporated into the login form. If this setting is disabled, only administrators have the privilege of creating new user accounts.</p>
<p>For self-registrations, there's an option to require email verification for new users. Enabling this ensures that an account only becomes active after the user clicks a verification link sent to their email. To use this feature, be sure to configure your SMTP settings.</p>
<h2 id="endpoints">Endpoints</h2>
<h3 id="well-known-discovery-url">Well-known discovery URL</h3>
<p>You can find a link to the well-known discovery URL by going to the root of the admin console. The URL will look like this:</p>
<p><code>https://demo-authserver.goiabada.dev/.well-known/openid-configuration</code></p>
<p>This endpoint will show the capabilities that are supported by Goiabada.</p>
<h3 id="authauthorize-get">/auth/authorize (GET)</h3>
<p>The authorize endpoint is used to request authorization codes via the browser. This process normally involves authentication of the end-user and giving consent, when required.</p>
<p>Parameters (* are mandatory):</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>client_id</td>
<td>The client identifier.</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>The redirect URI is the callback entry point of the app. In other words, it's the location where the authorization server sends the user once the <code>/auth/authorize</code> process completes. This must exactly match one of the allowed redirect URIs for the client.</td>
</tr>
<tr>
<td>response_type</td>
<td><code>code</code> is the only value supported - for the authorization code flow with PKCE.</td>
</tr>
<tr>
<td>code_challenge_method</td>
<td><code>S256</code> is the only value supported - for a SHA256 hash of the code verifier.</td>
</tr>
<tr>
<td>code_challenge</td>
<td>A random string between 43 and 128 characters long.</td>
</tr>
<tr>
<td>response_mode</td>
<td>Supported values: <code>query</code>, <code>fragment</code> or <code>form_post</code>. With <code>query</code> the authorization response parameters are encoded in the query string of the <code>redirect_uri</code>. With <code>fragment</code> they are encoded in the fragment (#). And <code>form_post</code> will make the parameters be encoded as HTML form values that are auto-submitted in the browser, via HTTP POST.</td>
</tr>
<tr>
<td>max_age</td>
<td>If the user's authentication timestamp exceeds the max age (in seconds), they will have to re-authenticate</td>
</tr>
<tr>
<td>acr_values</td>
<td>Supported values are: <code>urn:goiabada:pwd</code>, <code>urn:goiabada:pwd:otp_ifpossible</code> or <code>urn:goiabada:pwd:otp_mandatory</code>. This will override the default ACR level configured in the client for this authorization request. See <a href="#default-acr-level">Default ACR level</a>.</td>
</tr>
<tr>
<td>state</td>
<td>Any string. Goiabada will echo back the state value on the token response, for CSRF/replay protection.</td>
</tr>
<tr>
<td>nonce</td>
<td>Any string. Goiabada will echo back the nonce value in the identity token, as a claim, for replay protection.</td>
</tr>
<tr>
<td>scope</td>
<td>One or more registered scopes, separated by a space character. A registered scope can be either a <code>resource:permission</code> or an OIDC scope. See <a href="#scope">Scope</a> and <a href="#openid-connect-scopes">OpenID Connect scopes</a>.</td>
</tr>
</tbody>
</table>
<h3 id="authtoken-post">/auth/token (POST)</h3>
<p>The token endpoint serves the purpose of requesting tokens. This can happen either through the authorization code flow, involving the exchange of an authorization code for tokens, or through the client credentials flow, where a client directly requests tokens.</p>
<p>Parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>grant_type</td>
<td>Supported grant types are <code>authorization_code</code> (to exchange an authorization code for tokens), <code>client_credentials</code> (for the client credentials flow) or <code>refresh_token</code> (to use a refresh token).</td>
</tr>
<tr>
<td>client_id</td>
<td>The client identifier.</td>
</tr>
<tr>
<td>client_secret</td>
<td>The client secret, if it's a confidential client.</td>
</tr>
<tr>
<td>redirect_uri</td>
<td>Required for the <code>authorization_code</code> grant type.</td>
</tr>
<tr>
<td>code</td>
<td>The authorization code. Required for the <code>authorization_code</code> grant type.</td>
</tr>
<tr>
<td>code_verifier</td>
<td>This is the code verifier associated with the PKCE request, initially generated by the app before the authorization request. It represents the original string from which the <code>code_challenge</code> was derived.</td>
</tr>
<tr>
<td>scope</td>
<td>This parameter is used in the <code>client_credentials</code> and <code>refresh_token</code> grant types. In <code>client_credentials</code> grant type, it's a mandatory parameter, and it should encompass one or more registered scopes, separated by a space character. These scopes represent the requested permissions in the format of <code>resource:permission</code>. <br /><br />For the <code>refresh_token</code> grant type, the scope parameter is optional and serves to restrict the original scope to a more specific and narrower subset.</td>
</tr>
<tr>
<td>refresh_token</td>
<td>The refresh token, required for the <code>refresh_token</code> grant type.</td>
</tr>
</tbody>
</table>
<h3 id="authlogout-get-or-post">/auth/logout (GET or POST)</h3>
<p>This endpoint enables the client application to initiate a logout. The client application calls this logout endpoint on the auth server. Upon successful logout from the auth server, the user agent is then redirected to a logout link within the client application. This implementation aligns with the <a href="https://openid.net/specs/openid-connect-rpinitiated-1_0.html">OpenID Connect RP-Initiated Logout 1.0 protocol</a>.</p>
<p>If the <code>/auth/logout</code> endpoint is invoked without parameters, it will display a logout consent screen, prompting the user to confirm their intention to log out. There will be no redirection to the client application in this scenario.</p>
<p>The recommended way of calling <code>/auth/logout</code> involves including additional parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id_token_hint</td>
<td>The previously issued id token.</td>
</tr>
<tr>
<td>post_logout_redirect_uri</td>
<td>A post-logout URI, which must be pre-registered with the client as a redirect URI. Once the logout is finalized on the authentication server, the user agent will be redirected to this post-logout URI. This allows for the termination of the session on the client application as well.</td>
</tr>
<tr>
<td>client_id</td>
<td>The client identifier. Mandatory if the <code>id_token_hint</code> parameter is encrypted with the client secret.</td>
</tr>
<tr>
<td>state</td>
<td>Any arbitraty string that will be echoed back in the <code>post_logout_redirect_uri</code>.</td>
</tr>
</tbody>
</table>
<p>The two possible routes are:</p>
<ol>
<li><code>id_token_hint</code> (unencrypted) + <code>post_logout_redirect_uri</code> + <code>state</code> (optional).  </li>
<li><code>id_token_hint</code> (encrypted with AES GCM) + <code>post_logout_redirect_uri</code> + <code>client_id</code> + <code>state</code> (optional).  </li>
</ol>
<p>Encrypting the <code>id_token_hint</code> (option 2) enhances security by preventing the exposure of the ID token on the client side. Without encryption, calling this endpoint with an unencrypted <code>id_token_hint</code> could potentially expose personally identifiable information (PII) and other claims that are inside of the id token, such as the client identifier.</p>
<p>Below are some examples on how to encrypt the id token for the <code>id_token_hint</code> parameter. You must URL-encode the resulting base64 string, when sending it as a querystring parameter to <code>/auth/logout</code>.</p>
<h4 id="net-c">.NET C#</h4>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">AesGcmEncryption</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">idTokenUnencrypted</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">clientSecret</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="m">32</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// use the first 32 bytes of the client secret as key</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">keyBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">clientSecret</span><span class="p">);</span>
<span class="w">    </span><span class="n">Array</span><span class="p">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">keyBytes</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="n">Min</span><span class="p">(</span><span class="n">keyBytes</span><span class="p">.</span><span class="n">Length</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">.</span><span class="n">Length</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// random nonce</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">nonce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">AesGcm</span><span class="p">.</span><span class="n">NonceByteSizes</span><span class="p">.</span><span class="n">MaxSize</span><span class="p">];</span><span class="w"> </span><span class="c1">// MaxSize = 12</span>
<span class="w">    </span><span class="n">RandomNumberGenerator</span><span class="p">.</span><span class="n">Fill</span><span class="p">(</span><span class="n">nonce</span><span class="p">);</span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="nn">var</span><span class="w"> </span><span class="n">aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AesGcm</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">cipherText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">idTokenUnencrypted</span><span class="p">.</span><span class="n">Length</span><span class="p">];</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">AesGcm</span><span class="p">.</span><span class="n">TagByteSizes</span><span class="p">.</span><span class="n">MaxSize</span><span class="p">];</span><span class="w"> </span><span class="c1">// MaxSize = 16</span>
<span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">Encrypt</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">idTokenUnencrypted</span><span class="p">),</span><span class="w"> </span>
<span class="w">        </span><span class="n">cipherText</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// concatenate nonce (12 bytes) + ciphertext (? bytes) + tag (16 bytes)</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="n">nonce</span><span class="p">.</span><span class="n">Length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cipherText</span><span class="p">.</span><span class="n">Length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tag</span><span class="p">.</span><span class="n">Length</span><span class="p">];</span>
<span class="w">    </span><span class="n">Array</span><span class="p">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">nonce</span><span class="p">,</span><span class="w"> </span><span class="n">encrypted</span><span class="p">,</span><span class="w"> </span><span class="n">nonce</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
<span class="w">    </span><span class="n">Array</span><span class="p">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">cipherText</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">encrypted</span><span class="p">,</span><span class="w"> </span><span class="n">nonce</span><span class="p">.</span><span class="n">Length</span><span class="p">,</span><span class="w"> </span><span class="n">cipherText</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
<span class="w">    </span><span class="n">Array</span><span class="p">.</span><span class="n">Copy</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">encrypted</span><span class="p">,</span><span class="w"> </span><span class="n">nonce</span><span class="p">.</span><span class="n">Length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cipherText</span><span class="p">.</span><span class="n">Length</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">encrypted</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="go">Go</h4>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;crypto/aes&quot;</span>
<span class="w">    </span><span class="s">&quot;crypto/cipher&quot;</span>
<span class="w">    </span><span class="s">&quot;crypto/rand&quot;</span>
<span class="w">    </span><span class="s">&quot;encoding/base64&quot;</span>
<span class="w">    </span><span class="s">&quot;io&quot;</span>
<span class="w">    </span><span class="s">&quot;math&quot;</span>
<span class="p">)</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">AesGcmEncryption</span><span class="p">(</span><span class="nx">idTokenUnencrypted</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">clientSecret</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">key</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Use the first 32 bytes of the client secret as key</span>
<span class="w">    </span><span class="nx">keyBytes</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">clientSecret</span><span class="p">)</span>
<span class="w">    </span><span class="nb">copy</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">keyBytes</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="nx">math</span><span class="p">.</span><span class="nx">Min</span><span class="p">(</span><span class="nb">float64</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">keyBytes</span><span class="p">)),</span><span class="w"> </span><span class="nb">float64</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nx">key</span><span class="p">))))])</span>

<span class="w">    </span><span class="c1">// Random nonce</span>
<span class="w">    </span><span class="nx">nonce</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">io</span><span class="p">.</span><span class="nx">ReadFull</span><span class="p">(</span><span class="nx">rand</span><span class="p">.</span><span class="nx">Reader</span><span class="p">,</span><span class="w"> </span><span class="nx">nonce</span><span class="p">);</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">block</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">aes</span><span class="p">.</span><span class="nx">NewCipher</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">aesGcm</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">cipher</span><span class="p">.</span><span class="nx">NewGCM</span><span class="p">(</span><span class="nx">block</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">cipherText</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">aesGcm</span><span class="p">.</span><span class="nx">Seal</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">nonce</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">idTokenUnencrypted</span><span class="p">),</span><span class="w"> </span><span class="kc">nil</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Concatenate nonce (12 bytes) + ciphertext (? bytes) + tag (16 bytes)</span>
<span class="w">    </span><span class="nx">encrypted</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nx">nonce</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="nx">cipherText</span><span class="p">))</span>
<span class="w">    </span><span class="nb">copy</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">,</span><span class="w"> </span><span class="nx">nonce</span><span class="p">)</span>
<span class="w">    </span><span class="nb">copy</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nx">nonce</span><span class="p">):],</span><span class="w"> </span><span class="nx">cipherText</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">base64</span><span class="p">.</span><span class="nx">StdEncoding</span><span class="p">.</span><span class="nx">EncodeToString</span><span class="p">(</span><span class="nx">encrypted</span><span class="p">),</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="nodejs">NodeJS</h4>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">crypto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;crypto&#39;</span><span class="p">);</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">aesGcmEncryption</span><span class="p">(</span><span class="nx">idTokenUnencrypted</span><span class="p">,</span><span class="w"> </span><span class="nx">clientSecret</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">alloc</span><span class="p">(</span><span class="mf">32</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Use the first 32 bytes of the client secret as the key</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">keyBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Buffer</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">clientSecret</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">keyBytes</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">keyBytes</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">.</span><span class="nx">length</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// Random nonce</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">nonce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">crypto</span><span class="p">.</span><span class="nx">randomBytes</span><span class="p">(</span><span class="mf">12</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">crypto</span><span class="p">.</span><span class="nx">createCipheriv</span><span class="p">(</span><span class="s1">&#39;aes-256-gcm&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">nonce</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">cipherText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">idTokenUnencrypted</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;base64&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">cipherText</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">cipher</span><span class="p">.</span><span class="kr">final</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cipher</span><span class="p">.</span><span class="nx">getAuthTag</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Concatenate nonce (12 bytes) + ciphertext (? bytes) + tag (16 bytes)</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">encrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">nonce</span><span class="p">,</span><span class="w"> </span><span class="nx">Buffer</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">cipherText</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;base64&#39;</span><span class="p">),</span><span class="w"> </span><span class="nx">tag</span><span class="p">]);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">encrypted</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>You can explore the libraries available on your platform and use the same approach as shown here.</p>
<h3 id="userinfo-get-or-post">/userinfo (GET or POST)</h3>
<p>The UserInfo endpoint, a component of OpenID Connect, is used to retrieve identity information about a user.</p>
<p>The caller needs to send a valid access token to be able to access this endpoint. This is done by adding the <code>Authorization: Bearer token-value</code> header to the HTTP request.</p>
<p>The endpoint validates the presence of the <code>authserver:userinfo</code> scope within the access token. If this scope is present, the endpoint responds by providing claims about the user. </p>
<p>Please note that you don't need to manually request the <code>authserver:userinfo</code> scope in the authorization request. Instead, it will be automatically included in the access token whenever any OpenID Connect scope is included in the request.</p>
<p>The specific claims returned by the UserInfo endpoint depend on the OpenID Connect scopes included in the access token. For instance, if the <code>openid</code> and <code>email</code> scopes are present, the endpoint will return the <code>sub</code> (subject) claim from the <code>openid</code> scope, as well as the <code>email</code> and <code>email_verified</code> claims from the email scope.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "navigation.sections"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>